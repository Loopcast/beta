block seo
  title Loopcast | Stream live from anywhere at anytime 
  meta( name="description" content="Stream, record and save your DJ mixes instantly. Create your own room, interact with your audience and see whoâ€™s listening in real time." ) 

extends layout

block content

  input#owner_id(type="hidden", value="#{id}")

  .profile_theme.request_preloading.centered.no_information_yet(data-menu="profile", data-view="profile")
    .cover
      .cover_image(style="background-image:url(#{cover})")
        
      .content
        h1.name.black_background(data-view="components/editables/editable_text")
          span.text #{name}
        br

        if occupation
          h3.type.black_background(data-view="components/editables/editable_select", data-text="#{occupation}", data-default-selected="false")
            span.text Select Profession
        else
          h3.type.black_background(data-view="components/editables/editable_select", data-text="", data-default-selected="true")
            span.text Select Profession
          
        
        br
        .genres.black_background(data-view="components/editables/editable_profile_tags")
          span.text.empty Add your genres
          span.text.values #{genres.join( ", " )}

        .profile_image.upload_wrapper(data-view="components/image_uploader", data-id="profile_picture")
          img(src="/images/profile-150.jpg")
          p.upload_element.edit_image
            span.icon.ss-camera
            span Update profile picture
            span.progress

            form.element_on_write_mode(class="cloudinary_form")
              input.api_key(type="hidden", name="api_key", value="#{cloudinary.api_key}")
              input.cloud_name(type="hidden", name="cloud_name", value="#{cloudinary.cloud_name}")
              input.unsigned_id(type="hidden", name="unsigned_id", value="#{cloudinary.unsigned_ids.profile}")



          

        .sidebar_right
          .big_number
            .inner
              span.number #{followers}
              span.text Followers

          .big_number
            .inner
              span.number #{streams}
              span.text Streams 

          .big_number
            .inner
              span.number #{listeners}
              span.text 
                | Listeners 
                br
                | 

        a.cover_button.button_with_icon.element_on_read_mode(href="#", data-profile="set-write-mode")
          //- span.spritesheet.edit_icon
          span.icon.ss-write
          span Edit Profile

        a.cover_button.button_with_icon.element_on_write_mode(href="#", data-profile="set-read-mode")
          //- span.spritesheet.edit_icon
          span.icon.ss-write
          span Save Profile

        .change_cover.upload_wrapper(data-view="components/image_uploader", data-id="profile_cover")
          a.upload_element.button_with_icon.black_button.element_on_write_mode(href="#", data-profile="set-write-mode")
            span.icon.ss-camera
            span Change Cover
            span.progress

          form.element_on_write_mode(class="cloudinary_form")
            input.api_key(type="hidden", name="api_key", value="#{cloudinary.api_key}")
            input.cloud_name(type="hidden", name="cloud_name", value="#{cloudinary.cloud_name}")
            input.unsigned_id(type="hidden", name="unsigned_id", value="#{cloudinary.unsigned_ids.cover}")

    .profile_content
      .profile_left
        .profile_bio.outline_box
          .profile_bio_without_information.element_on_read_mode
            .for_owner
              .text
                p 1. Add your location
                p 2. Add your bio
                p 3. Add your social links

              a.rounded_border.big.add_information(href="#", data-profile="set-write-mode")
                span.icon.ss-write
                | Add

            .for_guest.text
              p No data provided


          .element_on_read_mode.profile_bio_with_information
            a.outline_icon(href="#", title="Edit Profile", data-profile="set-write-mode")
              //- span.spritesheet.edit_icon
              span.icon.ss-write

            if location
              h4.location #{location}
            else
              h4.location
            

            if about
              .bio #{about}
            else
              .bio

            .social.social_read_mode

          form.element_on_write_mode.profile_form
            input.squared_input.location_input(type="text", placeholder="Add your location", name="location")
            textarea.squared_input.bio_input(placeholder="Add a bio to your profile", name="bio")
            .social_links(data-view="components/editables/social_links", data-links="#{social}")
            button.button.save_button.no_shadow(data-profile="set-read-mode") Save






      .list_sessions

        if live
          .session.outline_box
            a.image(href="/#{live.info.user}/#{live.info.slug}", title="Old School House session", style="background-image:url(#{live.info.cover_url})")
            .content
              h2.session_title 
                a(href="/#{live.info.user}/#{live.info.slug}", title="#{live.info.title}") #{live.info.title}
              a.session_author.underline_link(href="/#{live.info.user}", title="#{live.info.user}") #{live.info.user}
              .genres
                for genre in live.info.genres
                  a.tag(href="/explore?genres=#{genre}", title="#{genre}") #{genre}

              .small_info
                .location 
                  span.icon.ss-location
                  //- span.spritesheet.icon_location
                  span.text #{live.info.location}
                .likes 
                  span.icon.ss-heart
                  //- span.spritesheet.icon_guests
                  span.text #{live.status.loves}
                .guests 
                  span.icon.ss-users
                  //- span.spritesheet.icon_plays
                  span.text #{live.status.live.listeners}

              a.live(href="/#{live.info.user}/#{live.info.slug}", title="#{live.info.title}")
                p.label now live
                p.time 02:33

        if recorded && recorded.length
          .recorded_sessions
            .title
              h2 Recorded sessions
              .icon.ss-record-wrapper
                span.ss-record
              span.session_text #{recorded.length}

              span.icon.ss-alert.for_owner
              span.alert_text.for_owner #{free_storage} free storage remaining

            for room in recorded
              - room.url = "/" + room.info.user + "/" + room.info.slug 
              .session.outline_box(id="session_recorded_#{room.id}", data-view="[components/user_set,components/audio/player_preview]", data-data="#{JSON.stringify(room)}")

                .image(style="background-image:url(#{room.info.cover_url})")
                  a.icon.ss-play.circle_icon(href="#",title="Play") 
                  .share_wrapper(data-view="buttons/share", data-permalink="#{room.url}")
                    a.yellow.ss-action(href="#", title="Share")


                .content
                  h2.session_title 
                    a(href="#{room.url}", title="#{room.info.title}") #{room.info.title}
                  a.session_author.underline_link(href="#{room.url}", title="#{name}") #{name}
                  .genres
                    for genre in room.info.genres
                      a.tag(href="#", title="#{genre}") #{genre}
                    
                  .small_info
                    .location 
                      span.icon.ss-location
                      span.text #{room.info.location}
                    .likes 
                      span.icon.ss-heart
                      span.text #{room.status.loves}
                    .guests 
                      span.icon.ss-play
                      span.text #{room.status.recording.plays}

                  .edit_session_wrapper
                    a.icon.settings_button.ss-settings(href="#", title="Setting Session", data-view="components/click_trigger" data-target="#session_recorded_#{room.id} .edit_session_popup")
                    .edit_session_popup
                      .triangle
                      a.download_button.button.yellow_button.small_button_4(href="#", title="Download") Download
                      a.edit_button.button.yellow_button.small_button_4(href="#", title="Edit") Edit
                      a.delete_button.button.red_button.small_button_4(href="#", title="Delete") Delete

                .delete_screen
                  .content
                    h2 Are you sure you want to delete this recording?
                    a.button.red_button.small_button_4.confirm_delete(href="#", title="Delete") Delete
                    a.button.white_button.small_button_4.cancel_delete(href="#", title="Cancel") Cancel

        if recorded.length <= 0 && !live
          .no_activity_wrapper
            h3.no_activity.for_guest #{name} does not have any live or recorded sessions
            h3.no_activity.for_owner You don't have any live or recorded sessions
            a.button.bold_button.yellow_button.small_button_2.for_owner(href="/rooms/create") Get Started

  include ./profile/room_modal.jade

  script
    | var profile_info = !{JSON.stringify(locals)};;
