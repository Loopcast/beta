(function(){(function(e){if("function"==typeof bootstrap)bootstrap("jade",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeJade=e}else"undefined"!=typeof window?window.jade=e():global.jade=e()})(function(){var define,ses,bootstrap,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){if(!Array.isArray){Array.isArray=function(arr){return"[object Array]"==Object.prototype.toString.call(arr)}}if(!Object.keys){Object.keys=function(obj){var arr=[];for(var key in obj){if(obj.hasOwnProperty(key)){arr.push(key)}}return arr}}exports.merge=function merge(a,b){var ac=a["class"];var bc=b["class"];if(ac||bc){ac=ac||[];bc=bc||[];if(!Array.isArray(ac))ac=[ac];if(!Array.isArray(bc))bc=[bc];a["class"]=ac.concat(bc).filter(nulls)}for(var key in b){if(key!="class"){a[key]=b[key]}}return a};function nulls(val){return val!=null&&val!==""}function joinClasses(val){return Array.isArray(val)?val.map(joinClasses).filter(nulls).join(" "):val}exports.attrs=function attrs(obj,escaped){var buf=[],terse=obj.terse;delete obj.terse;var keys=Object.keys(obj),len=keys.length;if(len){buf.push("");for(var i=0;i<len;++i){var key=keys[i],val=obj[key];if("boolean"==typeof val||null==val){if(val){terse?buf.push(key):buf.push(key+'="'+key+'"')}}else if(0==key.indexOf("data")&&"string"!=typeof val){buf.push(key+"='"+JSON.stringify(val)+"'")}else if("class"==key){if(escaped&&escaped[key]){if(val=exports.escape(joinClasses(val))){buf.push(key+'="'+val+'"')}}else{if(val=joinClasses(val)){buf.push(key+'="'+val+'"')}}}else if(escaped&&escaped[key]){buf.push(key+'="'+exports.escape(val)+'"')}else{buf.push(key+'="'+val+'"')}}}return buf.join(" ")};exports.escape=function escape(html){return String(html).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};exports.rethrow=function rethrow(err,filename,lineno,str){if(!(err instanceof Error))throw err;if((typeof window!="undefined"||!filename)&&!str){err.message+=" on line "+lineno;throw err}try{str=str||require("fs").readFileSync(filename,"utf8")}catch(ex){rethrow(err,null,lineno)}var context=3,lines=str.split("\n"),start=Math.max(lineno-context,0),end=Math.min(lines.length,lineno+context);var context=lines.slice(start,end).map(function(line,i){var curr=i+start+1;return(curr==lineno?"  > ":"    ")+curr+"| "+line}).join("\n");err.path=filename;err.message=(filename||"Jade")+":"+lineno+"\n"+context+"\n\n"+err.message;throw err}},{fs:2}],2:[function(require,module,exports){},{}]},{},[1])(1)});function require(path,parent){var realpath=require.resolve(path,parent),m=require.mods[realpath];if(!m.init){m.factory.call(this,require.local(realpath),m.module,m.module.exports);m.init=true}return m.module.exports}require.mods={};require.local=function(path){var r=function(id){return require(id,path)};r.resolve=function(id){return require.resolve(id,path)};return r};require.register=function(path,mod,aliases){require.mods[path]={factory:mod,aliases:aliases,module:{exports:{}}}};require.aliases={app:"src/frontend/scripts",api:"src/frontend/scripts/api",templates:"src/frontend/templates",client_templates:"src/frontend/templates",vendors:"src/frontend/vendors",lib:"src/lib",src:"src"};require.alias=function(path){for(var alias in require.aliases)if(path.indexOf(alias)==0)return require.aliases[alias]+path.match(/\/(.+)/)[0];return null};require.resolve=function(path,parent){var realpath;if(parent)if(!(realpath=require.mods[parent].aliases[path]))realpath=require.alias(path);if(!require.mods[realpath||path])throw new Error("Module not found: "+path);return realpath||path};window.require=require;require.register("node_modules/aware/index",function(require,module,exports){var happens=require("happens");module.exports=function(target){target=target||{};for(var prop in Aware)target[prop]=Aware[prop];target.__init();return target};var Aware={__init:function(){this.__store={};this.__handlers={};this.__happens=happens()},on:function(key,fn,bypass){if(!(fn&&fn instanceof Function))throw new Error(fn+" is not a Function");this.__happens.on(key,fn);if(this.__store.hasOwnProperty(key)&&!bypass)fn(this.get(key))},off:function(key,fn){this.__happens.off(key,fn)},get:function(key){return interpolate(this,this.__store[key])},set:function(key,value){if(arguments.length==2){if(this.__store[key]!==value){this.__store[key]=value;emit(this,key);toogle(this,key,value)}return value}else if(key instanceof Object){for(var p in key)this.set(p,key[p]);return key}throw new Error("Cannot set property, it must be a dictionary")}};function interpolate(aw,value){if(value===undefined)return null;var t,token,tokens=tokenize(value);for(t in tokens){token=tokens[t];value=value.replace(token,aw.get(clean(token)))}return value}function toogle(aw,key,value){var parent,t,tokens=tokenize(value);for(t in tokens)bind(aw,key,tokens[t]=clean(tokens[t]));for(parent in aw.__handlers[key])if(tokens.indexOf(parent)===-1)unbind(aw,key,parent)}function bind(aw,key,parent){if(!aw.__handlers[key]||!aw.__handlers[key][parent]){if(!aw.__handlers[key])aw.__handlers[key]={};aw.on(parent,aw.__handlers[key][parent]=function(value){emit(aw,key)},true)}}function unbind(aw,key,parent){aw.off(parent,aw.__handlers[key][parent]);aw.__handlers[key][parent]=null;delete aw.__handlers[key][parent]}function emit(aw,key){aw.__happens.emit(key,aw.get(key))}function tokenize(str){if(typeof str==="string")return str.match(/#\{[^\}]+\}/g)||[];return[]}function clean(str){return str.replace(/#\{([^\}]+)\}/g,"$1")}},{happens:"node_modules/aware/node_modules/happens/index"});require.register("node_modules/aware/node_modules/happens/index",function(require,module,exports){(function(global,factory){"object"===typeof exports?module.exports=factory():"function"===typeof define&&define.amd?define(factory):global.Happens=factory()})(this,function(){"use strict";function Happens(target){var nu=this instanceof Happens;if(target){if(!nu)for(var prop in Happens.prototype)target[prop]=Happens.prototype[prop];else throw new Error("You can't pass a target when instantiating with the `new` keyword")}else if(!nu)return new Happens}Happens.prototype.__init=function(event){var tmp=this.__listeners||(this.__listeners=[]);return tmp[event]||(tmp[event]=[])};Happens.prototype.on=function(event,fn){validate(fn);this.__init(event).push(fn)};Happens.prototype.off=function(event,fn){var pool=this.__init(event);pool.splice(pool.indexOf(fn),1)};Happens.prototype.once=function(event,fn){validate(fn);var self=this,wrapper=function(){self.off(event,wrapper);fn.apply(this,arguments)};this.on(event,wrapper)};Happens.prototype.emit=function(event){var i,pool=this.__init(event).slice(0);for(i in pool)pool[i].apply(this,[].slice.call(arguments,1))};function validate(fn){if(!(fn&&fn instanceof Function))throw new Error(fn+" is not a Function")}return Happens})},{});require.register("node_modules/dropzone/dist/dropzone",function(require,module,exports){(function(){var Dropzone,Emitter,camelize,contentLoaded,detectVerticalSquash,drawImageIOSFix,noop,without,__slice=[].slice,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};noop=function(){};Emitter=function(){function Emitter(){}Emitter.prototype.addEventListener=Emitter.prototype.on;Emitter.prototype.on=function(event,fn){this._callbacks=this._callbacks||{};if(!this._callbacks[event]){this._callbacks[event]=[]}this._callbacks[event].push(fn);return this};Emitter.prototype.emit=function(){var args,callback,callbacks,event,_i,_len;event=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[];this._callbacks=this._callbacks||{};callbacks=this._callbacks[event];if(callbacks){for(_i=0,_len=callbacks.length;_i<_len;_i++){callback=callbacks[_i];callback.apply(this,args)}}return this};Emitter.prototype.removeListener=Emitter.prototype.off;Emitter.prototype.removeAllListeners=Emitter.prototype.off;Emitter.prototype.removeEventListener=Emitter.prototype.off;Emitter.prototype.off=function(event,fn){var callback,callbacks,i,_i,_len;if(!this._callbacks||arguments.length===0){this._callbacks={};return this}callbacks=this._callbacks[event];if(!callbacks){return this}if(arguments.length===1){delete this._callbacks[event];return this}for(i=_i=0,_len=callbacks.length;_i<_len;i=++_i){callback=callbacks[i];if(callback===fn){callbacks.splice(i,1);break}}return this};return Emitter}();Dropzone=function(_super){var extend,resolveOption;__extends(Dropzone,_super);Dropzone.prototype.Emitter=Emitter;Dropzone.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","addedfiles","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"];Dropzone.prototype.defaultOptions={url:null,method:"post",withCredentials:false,parallelUploads:2,uploadMultiple:false,maxFilesize:256,paramName:"file",createImageThumbnails:true,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,filesizeBase:1e3,maxFiles:null,params:{},clickable:true,ignoreHiddenFiles:true,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:true,autoQueue:true,addRemoveLinks:false,previewsContainer:null,hiddenInputContainer:"body",capture:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(file,done){return done()},init:function(){return noop},forceFallback:false,fallback:function(){var child,messageElement,span,_i,_len,_ref;this.element.className=""+this.element.className+" dz-browser-not-supported";_ref=this.element.getElementsByTagName("div");for(_i=0,_len=_ref.length;_i<_len;_i++){child=_ref[_i];if(/(^| )dz-message($| )/.test(child.className)){messageElement=child;child.className="dz-message";continue}}if(!messageElement){messageElement=Dropzone.createElement('<div class="dz-message"><span></span></div>');this.element.appendChild(messageElement)}span=messageElement.getElementsByTagName("span")[0];if(span){if(span.textContent!=null){span.textContent=this.options.dictFallbackMessage}else if(span.innerText!=null){span.innerText=this.options.dictFallbackMessage}}return this.element.appendChild(this.getFallbackForm())},resize:function(file){var info,srcRatio,trgRatio;info={srcX:0,srcY:0,srcWidth:file.width,srcHeight:file.height};srcRatio=file.width/file.height;info.optWidth=this.options.thumbnailWidth;info.optHeight=this.options.thumbnailHeight;if(info.optWidth==null&&info.optHeight==null){info.optWidth=info.srcWidth;info.optHeight=info.srcHeight}else if(info.optWidth==null){info.optWidth=srcRatio*info.optHeight}else if(info.optHeight==null){info.optHeight=1/srcRatio*info.optWidth}trgRatio=info.optWidth/info.optHeight;if(file.height<info.optHeight||file.width<info.optWidth){info.trgHeight=info.srcHeight;info.trgWidth=info.srcWidth}else{if(srcRatio>trgRatio){info.srcHeight=file.height;info.srcWidth=info.srcHeight*trgRatio}else{info.srcWidth=file.width;info.srcHeight=info.srcWidth/trgRatio}}info.srcX=(file.width-info.srcWidth)/2;info.srcY=(file.height-info.srcHeight)/2;return info},drop:function(e){return this.element.classList.remove("dz-drag-hover")},dragstart:noop,dragend:function(e){return this.element.classList.remove("dz-drag-hover")},dragenter:function(e){return this.element.classList.add("dz-drag-hover")},dragover:function(e){return this.element.classList.add("dz-drag-hover")},dragleave:function(e){return this.element.classList.remove("dz-drag-hover")},paste:noop,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(file){var node,removeFileEvent,removeLink,_i,_j,_k,_len,_len1,_len2,_ref,_ref1,_ref2,_results;if(this.element===this.previewsContainer){this.element.classList.add("dz-started")}if(this.previewsContainer){file.previewElement=Dropzone.createElement(this.options.previewTemplate.trim());file.previewTemplate=file.previewElement;this.previewsContainer.appendChild(file.previewElement);_ref=file.previewElement.querySelectorAll("[data-dz-name]");for(_i=0,_len=_ref.length;_i<_len;_i++){node=_ref[_i];node.textContent=file.name}_ref1=file.previewElement.querySelectorAll("[data-dz-size]");for(_j=0,_len1=_ref1.length;_j<_len1;_j++){node=_ref1[_j];node.innerHTML=this.filesize(file.size)}if(this.options.addRemoveLinks){file._removeLink=Dropzone.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>");file.previewElement.appendChild(file._removeLink)}removeFileEvent=function(_this){return function(e){e.preventDefault();e.stopPropagation();if(file.status===Dropzone.UPLOADING){return Dropzone.confirm(_this.options.dictCancelUploadConfirmation,function(){return _this.removeFile(file)})}else{if(_this.options.dictRemoveFileConfirmation){return Dropzone.confirm(_this.options.dictRemoveFileConfirmation,function(){return _this.removeFile(file)})}else{return _this.removeFile(file)}}}}(this);_ref2=file.previewElement.querySelectorAll("[data-dz-remove]");_results=[];for(_k=0,_len2=_ref2.length;_k<_len2;_k++){removeLink=_ref2[_k];_results.push(removeLink.addEventListener("click",removeFileEvent))}return _results}},removedfile:function(file){var _ref;if(file.previewElement){if((_ref=file.previewElement)!=null){_ref.parentNode.removeChild(file.previewElement)}}return this._updateMaxFilesReachedClass()},thumbnail:function(file,dataUrl){var thumbnailElement,_i,_len,_ref;if(file.previewElement){file.previewElement.classList.remove("dz-file-preview");_ref=file.previewElement.querySelectorAll("[data-dz-thumbnail]");for(_i=0,_len=_ref.length;_i<_len;_i++){thumbnailElement=_ref[_i];thumbnailElement.alt=file.name;thumbnailElement.src=dataUrl}return setTimeout(function(_this){return function(){return file.previewElement.classList.add("dz-image-preview")}}(this),1)}},error:function(file,message){var node,_i,_len,_ref,_results;if(file.previewElement){file.previewElement.classList.add("dz-error");if(typeof message!=="String"&&message.error){message=message.error}_ref=file.previewElement.querySelectorAll("[data-dz-errormessage]");_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){node=_ref[_i];_results.push(node.textContent=message)}return _results}},errormultiple:noop,processing:function(file){if(file.previewElement){file.previewElement.classList.add("dz-processing");if(file._removeLink){return file._removeLink.textContent=this.options.dictCancelUpload}}},processingmultiple:noop,uploadprogress:function(file,progress,bytesSent){var node,_i,_len,_ref,_results;if(file.previewElement){_ref=file.previewElement.querySelectorAll("[data-dz-uploadprogress]");_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){node=_ref[_i];if(node.nodeName==="PROGRESS"){_results.push(node.value=progress)}else{_results.push(node.style.width=""+progress+"%")}}return _results}},totaluploadprogress:noop,sending:noop,sendingmultiple:noop,success:function(file){if(file.previewElement){return file.previewElement.classList.add("dz-success")}},successmultiple:noop,canceled:function(file){return this.emit("error",file,"Upload canceled.")},canceledmultiple:noop,complete:function(file){if(file._removeLink){file._removeLink.textContent=this.options.dictRemoveFile}if(file.previewElement){return file.previewElement.classList.add("dz-complete")}},completemultiple:noop,maxfilesexceeded:noop,maxfilesreached:noop,queuecomplete:noop,addedfiles:noop,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-image"><img data-dz-thumbnail /></div>\n  <div class="dz-details">\n    <div class="dz-size"><span data-dz-size></span></div>\n    <div class="dz-filename"><span data-dz-name></span></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Check</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>\n      </g>\n    </svg>\n  </div>\n  <div class="dz-error-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Error</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <g id="Check-+-Oval-2" sketch:type="MSLayerGroup" stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">\n          <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" sketch:type="MSShapeGroup"></path>\n        </g>\n      </g>\n    </svg>\n  </div>\n</div>'};extend=function(){var key,object,objects,target,val,_i,_len;target=arguments[0],objects=2<=arguments.length?__slice.call(arguments,1):[];for(_i=0,_len=objects.length;_i<_len;_i++){object=objects[_i];for(key in object){val=object[key];target[key]=val}}return target};function Dropzone(element,options){var elementOptions,fallback,_ref;this.element=element;this.version=Dropzone.version;this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,"");this.clickableElements=[];this.listeners=[];this.files=[];if(typeof this.element==="string"){this.element=document.querySelector(this.element)}if(!(this.element&&this.element.nodeType!=null)){throw new Error("Invalid dropzone element.")}if(this.element.dropzone){throw new Error("Dropzone already attached.")}Dropzone.instances.push(this);this.element.dropzone=this;elementOptions=(_ref=Dropzone.optionsForElement(this.element))!=null?_ref:{};this.options=extend({},this.defaultOptions,elementOptions,options!=null?options:{});if(this.options.forceFallback||!Dropzone.isBrowserSupported()){return this.options.fallback.call(this)}if(this.options.url==null){this.options.url=this.element.getAttribute("action")}if(!this.options.url){throw new Error("No URL provided.")}if(this.options.acceptedFiles&&this.options.acceptedMimeTypes){throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.")}if(this.options.acceptedMimeTypes){this.options.acceptedFiles=this.options.acceptedMimeTypes;delete this.options.acceptedMimeTypes}this.options.method=this.options.method.toUpperCase();if((fallback=this.getExistingFallback())&&fallback.parentNode){fallback.parentNode.removeChild(fallback)}if(this.options.previewsContainer!==false){if(this.options.previewsContainer){this.previewsContainer=Dropzone.getElement(this.options.previewsContainer,"previewsContainer")}else{this.previewsContainer=this.element}}if(this.options.clickable){if(this.options.clickable===true){this.clickableElements=[this.element]}else{this.clickableElements=Dropzone.getElements(this.options.clickable,"clickable")}}this.init()}Dropzone.prototype.getAcceptedFiles=function(){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.accepted){_results.push(file)}}return _results};Dropzone.prototype.getRejectedFiles=function(){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(!file.accepted){_results.push(file)}}return _results};Dropzone.prototype.getFilesWithStatus=function(status){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.status===status){_results.push(file)}}return _results};Dropzone.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(Dropzone.QUEUED)};Dropzone.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(Dropzone.UPLOADING)};Dropzone.prototype.getAddedFiles=function(){return this.getFilesWithStatus(Dropzone.ADDED)};Dropzone.prototype.getActiveFiles=function(){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.status===Dropzone.UPLOADING||file.status===Dropzone.QUEUED){_results.push(file)}}return _results};Dropzone.prototype.init=function(){var eventName,noPropagation,setupHiddenFileInput,_i,_len,_ref,_ref1;if(this.element.tagName==="form"){this.element.setAttribute("enctype","multipart/form-data")}if(this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")){this.element.appendChild(Dropzone.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>"))}if(this.clickableElements.length){setupHiddenFileInput=function(_this){return function(){if(_this.hiddenFileInput){_this.hiddenFileInput.parentNode.removeChild(_this.hiddenFileInput)}_this.hiddenFileInput=document.createElement("input");_this.hiddenFileInput.setAttribute("type","file");if(_this.options.maxFiles==null||_this.options.maxFiles>1){_this.hiddenFileInput.setAttribute("multiple","multiple")}_this.hiddenFileInput.className="dz-hidden-input";if(_this.options.acceptedFiles!=null){_this.hiddenFileInput.setAttribute("accept",_this.options.acceptedFiles)}if(_this.options.capture!=null){_this.hiddenFileInput.setAttribute("capture",_this.options.capture)}_this.hiddenFileInput.style.visibility="hidden";_this.hiddenFileInput.style.position="absolute";_this.hiddenFileInput.style.top="0";_this.hiddenFileInput.style.left="0";_this.hiddenFileInput.style.height="0";_this.hiddenFileInput.style.width="0";document.querySelector(_this.options.hiddenInputContainer).appendChild(_this.hiddenFileInput);return _this.hiddenFileInput.addEventListener("change",function(){var file,files,_i,_len;files=_this.hiddenFileInput.files;if(files.length){for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];_this.addFile(file)}}_this.emit("addedfiles",files);return setupHiddenFileInput()})}}(this);setupHiddenFileInput()}this.URL=(_ref=window.URL)!=null?_ref:window.webkitURL;_ref1=this.events;for(_i=0,_len=_ref1.length;_i<_len;_i++){eventName=_ref1[_i];this.on(eventName,this.options[eventName])}this.on("uploadprogress",function(_this){return function(){return _this.updateTotalUploadProgress()}}(this));this.on("removedfile",function(_this){return function(){return _this.updateTotalUploadProgress()}}(this));this.on("canceled",function(_this){return function(file){return _this.emit("complete",file)}}(this));this.on("complete",function(_this){return function(file){if(_this.getAddedFiles().length===0&&_this.getUploadingFiles().length===0&&_this.getQueuedFiles().length===0){return setTimeout(function(){return _this.emit("queuecomplete")},0)}}}(this));noPropagation=function(e){e.stopPropagation();if(e.preventDefault){return e.preventDefault()}else{return e.returnValue=false}};this.listeners=[{element:this.element,events:{dragstart:function(_this){return function(e){return _this.emit("dragstart",e)}}(this),dragenter:function(_this){return function(e){noPropagation(e);return _this.emit("dragenter",e)}}(this),dragover:function(_this){return function(e){var efct;try{efct=e.dataTransfer.effectAllowed}catch(_error){}e.dataTransfer.dropEffect="move"===efct||"linkMove"===efct?"move":"copy";noPropagation(e);return _this.emit("dragover",e)}}(this),dragleave:function(_this){return function(e){return _this.emit("dragleave",e)}}(this),drop:function(_this){return function(e){noPropagation(e);return _this.drop(e)}}(this),dragend:function(_this){return function(e){return _this.emit("dragend",e)}}(this)}}];this.clickableElements.forEach(function(_this){return function(clickableElement){return _this.listeners.push({element:clickableElement,events:{click:function(evt){if(clickableElement!==_this.element||(evt.target===_this.element||Dropzone.elementInside(evt.target,_this.element.querySelector(".dz-message")))){_this.hiddenFileInput.click()}return true}}})}}(this));this.enable();return this.options.init.call(this)};Dropzone.prototype.destroy=function(){var _ref;this.disable();this.removeAllFiles(true);if((_ref=this.hiddenFileInput)!=null?_ref.parentNode:void 0){this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput);this.hiddenFileInput=null}delete this.element.dropzone;return Dropzone.instances.splice(Dropzone.instances.indexOf(this),1)};Dropzone.prototype.updateTotalUploadProgress=function(){var activeFiles,file,totalBytes,totalBytesSent,totalUploadProgress,_i,_len,_ref;totalBytesSent=0;totalBytes=0;activeFiles=this.getActiveFiles();if(activeFiles.length){_ref=this.getActiveFiles();for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];totalBytesSent+=file.upload.bytesSent;totalBytes+=file.upload.total}totalUploadProgress=100*totalBytesSent/totalBytes}else{totalUploadProgress=100}return this.emit("totaluploadprogress",totalUploadProgress,totalBytes,totalBytesSent)};Dropzone.prototype._getParamName=function(n){if(typeof this.options.paramName==="function"){return this.options.paramName(n)}else{return""+this.options.paramName+(this.options.uploadMultiple?"["+n+"]":"")}};Dropzone.prototype.getFallbackForm=function(){var existingFallback,fields,fieldsString,form;if(existingFallback=this.getExistingFallback()){return existingFallback}fieldsString='<div class="dz-fallback">';if(this.options.dictFallbackText){fieldsString+="<p>"+this.options.dictFallbackText+"</p>"}fieldsString+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>';fields=Dropzone.createElement(fieldsString);if(this.element.tagName!=="FORM"){form=Dropzone.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>');form.appendChild(fields)}else{this.element.setAttribute("enctype","multipart/form-data");this.element.setAttribute("method",this.options.method)}return form!=null?form:fields};Dropzone.prototype.getExistingFallback=function(){var fallback,getFallback,tagName,_i,_len,_ref;getFallback=function(elements){var el,_i,_len;for(_i=0,_len=elements.length;_i<_len;_i++){el=elements[_i];if(/(^| )fallback($| )/.test(el.className)){return el}}};_ref=["div","form"];for(_i=0,_len=_ref.length;_i<_len;_i++){tagName=_ref[_i];if(fallback=getFallback(this.element.getElementsByTagName(tagName))){return fallback}}};Dropzone.prototype.setupEventListeners=function(){var elementListeners,event,listener,_i,_len,_ref,_results;_ref=this.listeners;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){elementListeners=_ref[_i];_results.push(function(){var _ref1,_results1;_ref1=elementListeners.events;_results1=[];for(event in _ref1){listener=_ref1[event];_results1.push(elementListeners.element.addEventListener(event,listener,false))}return _results1}())}return _results};Dropzone.prototype.removeEventListeners=function(){var elementListeners,event,listener,_i,_len,_ref,_results;_ref=this.listeners;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){elementListeners=_ref[_i];_results.push(function(){var _ref1,_results1;_ref1=elementListeners.events;_results1=[];for(event in _ref1){listener=_ref1[event];_results1.push(elementListeners.element.removeEventListener(event,listener,false))}return _results1}())}return _results};Dropzone.prototype.disable=function(){var file,_i,_len,_ref,_results;this.clickableElements.forEach(function(element){return element.classList.remove("dz-clickable")});this.removeEventListeners();_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];_results.push(this.cancelUpload(file))}return _results};Dropzone.prototype.enable=function(){this.clickableElements.forEach(function(element){return element.classList.add("dz-clickable")});return this.setupEventListeners()};Dropzone.prototype.filesize=function(size){var cutoff,i,selectedSize,selectedUnit,unit,units,_i,_len;selectedSize=0;selectedUnit="b";if(size>0){units=["TB","GB","MB","KB","b"];for(i=_i=0,_len=units.length;_i<_len;i=++_i){unit=units[i];cutoff=Math.pow(this.options.filesizeBase,4-i)/10;if(size>=cutoff){selectedSize=size/Math.pow(this.options.filesizeBase,4-i);selectedUnit=unit;break}}selectedSize=Math.round(10*selectedSize)/10}return"<strong>"+selectedSize+"</strong> "+selectedUnit};Dropzone.prototype._updateMaxFilesReachedClass=function(){if(this.options.maxFiles!=null&&this.getAcceptedFiles().length>=this.options.maxFiles){if(this.getAcceptedFiles().length===this.options.maxFiles){this.emit("maxfilesreached",this.files)}return this.element.classList.add("dz-max-files-reached")}else{return this.element.classList.remove("dz-max-files-reached")}};Dropzone.prototype.drop=function(e){var files,items;if(!e.dataTransfer){return}this.emit("drop",e);files=e.dataTransfer.files;this.emit("addedfiles",files);if(files.length){items=e.dataTransfer.items;if(items&&items.length&&items[0].webkitGetAsEntry!=null){this._addFilesFromItems(items)}else{this.handleFiles(files)}}};Dropzone.prototype.paste=function(e){
var items,_ref;if((e!=null?(_ref=e.clipboardData)!=null?_ref.items:void 0:void 0)==null){return}this.emit("paste",e);items=e.clipboardData.items;if(items.length){return this._addFilesFromItems(items)}};Dropzone.prototype.handleFiles=function(files){var file,_i,_len,_results;_results=[];for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];_results.push(this.addFile(file))}return _results};Dropzone.prototype._addFilesFromItems=function(items){var entry,item,_i,_len,_results;_results=[];for(_i=0,_len=items.length;_i<_len;_i++){item=items[_i];if(item.webkitGetAsEntry!=null&&(entry=item.webkitGetAsEntry())){if(entry.isFile){_results.push(this.addFile(item.getAsFile()))}else if(entry.isDirectory){_results.push(this._addFilesFromDirectory(entry,entry.name))}else{_results.push(void 0)}}else if(item.getAsFile!=null){if(item.kind==null||item.kind==="file"){_results.push(this.addFile(item.getAsFile()))}else{_results.push(void 0)}}else{_results.push(void 0)}}return _results};Dropzone.prototype._addFilesFromDirectory=function(directory,path){var dirReader,entriesReader;dirReader=directory.createReader();entriesReader=function(_this){return function(entries){var entry,_i,_len;for(_i=0,_len=entries.length;_i<_len;_i++){entry=entries[_i];if(entry.isFile){entry.file(function(file){if(_this.options.ignoreHiddenFiles&&file.name.substring(0,1)==="."){return}file.fullPath=""+path+"/"+file.name;return _this.addFile(file)})}else if(entry.isDirectory){_this._addFilesFromDirectory(entry,""+path+"/"+entry.name)}}}}(this);return dirReader.readEntries(entriesReader,function(error){return typeof console!=="undefined"&&console!==null?typeof console.log==="function"?console.log(error):void 0:void 0})};Dropzone.prototype.accept=function(file,done){if(file.size>this.options.maxFilesize*1024*1024){return done(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(file.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize))}else if(!Dropzone.isValidFile(file,this.options.acceptedFiles)){return done(this.options.dictInvalidFileType)}else if(this.options.maxFiles!=null&&this.getAcceptedFiles().length>=this.options.maxFiles){done(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles));return this.emit("maxfilesexceeded",file)}else{return this.options.accept.call(this,file,done)}};Dropzone.prototype.addFile=function(file){file.upload={progress:0,total:file.size,bytesSent:0};this.files.push(file);file.status=Dropzone.ADDED;this.emit("addedfile",file);this._enqueueThumbnail(file);return this.accept(file,function(_this){return function(error){if(error){file.accepted=false;_this._errorProcessing([file],error)}else{file.accepted=true;if(_this.options.autoQueue){_this.enqueueFile(file)}}return _this._updateMaxFilesReachedClass()}}(this))};Dropzone.prototype.enqueueFiles=function(files){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];this.enqueueFile(file)}return null};Dropzone.prototype.enqueueFile=function(file){if(file.status===Dropzone.ADDED&&file.accepted===true){file.status=Dropzone.QUEUED;if(this.options.autoProcessQueue){return setTimeout(function(_this){return function(){return _this.processQueue()}}(this),0)}}else{throw new Error("This file can't be queued because it has already been processed or was rejected.")}};Dropzone.prototype._thumbnailQueue=[];Dropzone.prototype._processingThumbnail=false;Dropzone.prototype._enqueueThumbnail=function(file){if(this.options.createImageThumbnails&&file.type.match(/image.*/)&&file.size<=this.options.maxThumbnailFilesize*1024*1024){this._thumbnailQueue.push(file);return setTimeout(function(_this){return function(){return _this._processThumbnailQueue()}}(this),0)}};Dropzone.prototype._processThumbnailQueue=function(){if(this._processingThumbnail||this._thumbnailQueue.length===0){return}this._processingThumbnail=true;return this.createThumbnail(this._thumbnailQueue.shift(),function(_this){return function(){_this._processingThumbnail=false;return _this._processThumbnailQueue()}}(this))};Dropzone.prototype.removeFile=function(file){if(file.status===Dropzone.UPLOADING){this.cancelUpload(file)}this.files=without(this.files,file);this.emit("removedfile",file);if(this.files.length===0){return this.emit("reset")}};Dropzone.prototype.removeAllFiles=function(cancelIfNecessary){var file,_i,_len,_ref;if(cancelIfNecessary==null){cancelIfNecessary=false}_ref=this.files.slice();for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.status!==Dropzone.UPLOADING||cancelIfNecessary){this.removeFile(file)}}return null};Dropzone.prototype.createThumbnail=function(file,callback){var fileReader;fileReader=new FileReader;fileReader.onload=function(_this){return function(){if(file.type==="image/svg+xml"){_this.emit("thumbnail",file,fileReader.result);if(callback!=null){callback()}return}return _this.createThumbnailFromUrl(file,fileReader.result,callback)}}(this);return fileReader.readAsDataURL(file)};Dropzone.prototype.createThumbnailFromUrl=function(file,imageUrl,callback,crossOrigin){var img;img=document.createElement("img");if(crossOrigin){img.crossOrigin=crossOrigin}img.onload=function(_this){return function(){var canvas,ctx,resizeInfo,thumbnail,_ref,_ref1,_ref2,_ref3;file.width=img.width;file.height=img.height;resizeInfo=_this.options.resize.call(_this,file);if(resizeInfo.trgWidth==null){resizeInfo.trgWidth=resizeInfo.optWidth}if(resizeInfo.trgHeight==null){resizeInfo.trgHeight=resizeInfo.optHeight}canvas=document.createElement("canvas");ctx=canvas.getContext("2d");canvas.width=resizeInfo.trgWidth;canvas.height=resizeInfo.trgHeight;drawImageIOSFix(ctx,img,(_ref=resizeInfo.srcX)!=null?_ref:0,(_ref1=resizeInfo.srcY)!=null?_ref1:0,resizeInfo.srcWidth,resizeInfo.srcHeight,(_ref2=resizeInfo.trgX)!=null?_ref2:0,(_ref3=resizeInfo.trgY)!=null?_ref3:0,resizeInfo.trgWidth,resizeInfo.trgHeight);thumbnail=canvas.toDataURL("image/png");_this.emit("thumbnail",file,thumbnail);if(callback!=null){return callback()}}}(this);if(callback!=null){img.onerror=callback}return img.src=imageUrl};Dropzone.prototype.processQueue=function(){var i,parallelUploads,processingLength,queuedFiles;parallelUploads=this.options.parallelUploads;processingLength=this.getUploadingFiles().length;i=processingLength;if(processingLength>=parallelUploads){return}queuedFiles=this.getQueuedFiles();if(!(queuedFiles.length>0)){return}if(this.options.uploadMultiple){return this.processFiles(queuedFiles.slice(0,parallelUploads-processingLength))}else{while(i<parallelUploads){if(!queuedFiles.length){return}this.processFile(queuedFiles.shift());i++}}};Dropzone.prototype.processFile=function(file){return this.processFiles([file])};Dropzone.prototype.processFiles=function(files){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];file.processing=true;file.status=Dropzone.UPLOADING;this.emit("processing",file)}if(this.options.uploadMultiple){this.emit("processingmultiple",files)}return this.uploadFiles(files)};Dropzone.prototype._getFilesWithXhr=function(xhr){var file,files;return files=function(){var _i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.xhr===xhr){_results.push(file)}}return _results}.call(this)};Dropzone.prototype.cancelUpload=function(file){var groupedFile,groupedFiles,_i,_j,_len,_len1,_ref;if(file.status===Dropzone.UPLOADING){groupedFiles=this._getFilesWithXhr(file.xhr);for(_i=0,_len=groupedFiles.length;_i<_len;_i++){groupedFile=groupedFiles[_i];groupedFile.status=Dropzone.CANCELED}file.xhr.abort();for(_j=0,_len1=groupedFiles.length;_j<_len1;_j++){groupedFile=groupedFiles[_j];this.emit("canceled",groupedFile)}if(this.options.uploadMultiple){this.emit("canceledmultiple",groupedFiles)}}else if((_ref=file.status)===Dropzone.ADDED||_ref===Dropzone.QUEUED){file.status=Dropzone.CANCELED;this.emit("canceled",file);if(this.options.uploadMultiple){this.emit("canceledmultiple",[file])}}if(this.options.autoProcessQueue){return this.processQueue()}};resolveOption=function(){var args,option;option=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[];if(typeof option==="function"){return option.apply(this,args)}return option};Dropzone.prototype.uploadFile=function(file){return this.uploadFiles([file])};Dropzone.prototype.uploadFiles=function(files){var file,formData,handleError,headerName,headerValue,headers,i,input,inputName,inputType,key,method,option,progressObj,response,updateProgress,url,value,xhr,_i,_j,_k,_l,_len,_len1,_len2,_len3,_m,_ref,_ref1,_ref2,_ref3,_ref4,_ref5;xhr=new XMLHttpRequest;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];file.xhr=xhr}method=resolveOption(this.options.method,files);url=resolveOption(this.options.url,files);xhr.open(method,url,true);xhr.withCredentials=!!this.options.withCredentials;response=null;handleError=function(_this){return function(){var _j,_len1,_results;_results=[];for(_j=0,_len1=files.length;_j<_len1;_j++){file=files[_j];_results.push(_this._errorProcessing(files,response||_this.options.dictResponseError.replace("{{statusCode}}",xhr.status),xhr))}return _results}}(this);updateProgress=function(_this){return function(e){var allFilesFinished,progress,_j,_k,_l,_len1,_len2,_len3,_results;if(e!=null){progress=100*e.loaded/e.total;for(_j=0,_len1=files.length;_j<_len1;_j++){file=files[_j];file.upload={progress:progress,total:e.total,bytesSent:e.loaded}}}else{allFilesFinished=true;progress=100;for(_k=0,_len2=files.length;_k<_len2;_k++){file=files[_k];if(!(file.upload.progress===100&&file.upload.bytesSent===file.upload.total)){allFilesFinished=false}file.upload.progress=progress;file.upload.bytesSent=file.upload.total}if(allFilesFinished){return}}_results=[];for(_l=0,_len3=files.length;_l<_len3;_l++){file=files[_l];_results.push(_this.emit("uploadprogress",file,progress,file.upload.bytesSent))}return _results}}(this);xhr.onload=function(_this){return function(e){var _ref;if(files[0].status===Dropzone.CANCELED){return}if(xhr.readyState!==4){return}response=xhr.responseText;if(xhr.getResponseHeader("content-type")&&~xhr.getResponseHeader("content-type").indexOf("application/json")){try{response=JSON.parse(response)}catch(_error){e=_error;response="Invalid JSON response from server."}}updateProgress();if(!(200<=(_ref=xhr.status)&&_ref<300)){return handleError()}else{return _this._finished(files,response,e)}}}(this);xhr.onerror=function(_this){return function(){if(files[0].status===Dropzone.CANCELED){return}return handleError()}}(this);progressObj=(_ref=xhr.upload)!=null?_ref:xhr;progressObj.onprogress=updateProgress;headers={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"};if(this.options.headers){extend(headers,this.options.headers)}for(headerName in headers){headerValue=headers[headerName];if(headerValue){xhr.setRequestHeader(headerName,headerValue)}}formData=new FormData;if(this.options.params){_ref1=this.options.params;for(key in _ref1){value=_ref1[key];formData.append(key,value)}}for(_j=0,_len1=files.length;_j<_len1;_j++){file=files[_j];this.emit("sending",file,xhr,formData)}if(this.options.uploadMultiple){this.emit("sendingmultiple",files,xhr,formData)}if(this.element.tagName==="FORM"){_ref2=this.element.querySelectorAll("input, textarea, select, button");for(_k=0,_len2=_ref2.length;_k<_len2;_k++){input=_ref2[_k];inputName=input.getAttribute("name");inputType=input.getAttribute("type");if(input.tagName==="SELECT"&&input.hasAttribute("multiple")){_ref3=input.options;for(_l=0,_len3=_ref3.length;_l<_len3;_l++){option=_ref3[_l];if(option.selected){formData.append(inputName,option.value)}}}else if(!inputType||(_ref4=inputType.toLowerCase())!=="checkbox"&&_ref4!=="radio"||input.checked){formData.append(inputName,input.value)}}}for(i=_m=0,_ref5=files.length-1;0<=_ref5?_m<=_ref5:_m>=_ref5;i=0<=_ref5?++_m:--_m){formData.append(this._getParamName(i),files[i],files[i].name)}return this.submitRequest(xhr,formData,files)};Dropzone.prototype.submitRequest=function(xhr,formData,files){return xhr.send(formData)};Dropzone.prototype._finished=function(files,responseText,e){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];file.status=Dropzone.SUCCESS;this.emit("success",file,responseText,e);this.emit("complete",file)}if(this.options.uploadMultiple){this.emit("successmultiple",files,responseText,e);this.emit("completemultiple",files)}if(this.options.autoProcessQueue){return this.processQueue()}};Dropzone.prototype._errorProcessing=function(files,message,xhr){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];file.status=Dropzone.ERROR;this.emit("error",file,message,xhr);this.emit("complete",file)}if(this.options.uploadMultiple){this.emit("errormultiple",files,message,xhr);this.emit("completemultiple",files)}if(this.options.autoProcessQueue){return this.processQueue()}};return Dropzone}(Emitter);Dropzone.version="4.2.0";Dropzone.options={};Dropzone.optionsForElement=function(element){if(element.getAttribute("id")){return Dropzone.options[camelize(element.getAttribute("id"))]}else{return void 0}};Dropzone.instances=[];Dropzone.forElement=function(element){if(typeof element==="string"){element=document.querySelector(element)}if((element!=null?element.dropzone:void 0)==null){throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.")}return element.dropzone};Dropzone.autoDiscover=true;Dropzone.discover=function(){var checkElements,dropzone,dropzones,_i,_len,_results;if(document.querySelectorAll){dropzones=document.querySelectorAll(".dropzone")}else{dropzones=[];checkElements=function(elements){var el,_i,_len,_results;_results=[];for(_i=0,_len=elements.length;_i<_len;_i++){el=elements[_i];if(/(^| )dropzone($| )/.test(el.className)){_results.push(dropzones.push(el))}else{_results.push(void 0)}}return _results};checkElements(document.getElementsByTagName("div"));checkElements(document.getElementsByTagName("form"))}_results=[];for(_i=0,_len=dropzones.length;_i<_len;_i++){dropzone=dropzones[_i];if(Dropzone.optionsForElement(dropzone)!==false){_results.push(new Dropzone(dropzone))}else{_results.push(void 0)}}return _results};Dropzone.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i];Dropzone.isBrowserSupported=function(){var capableBrowser,regex,_i,_len,_ref;capableBrowser=true;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector){if(!("classList"in document.createElement("a"))){capableBrowser=false}else{_ref=Dropzone.blacklistedBrowsers;for(_i=0,_len=_ref.length;_i<_len;_i++){regex=_ref[_i];if(regex.test(navigator.userAgent)){capableBrowser=false;continue}}}}else{capableBrowser=false}return capableBrowser};without=function(list,rejectedItem){var item,_i,_len,_results;_results=[];for(_i=0,_len=list.length;_i<_len;_i++){item=list[_i];if(item!==rejectedItem){_results.push(item)}}return _results};camelize=function(str){return str.replace(/[\-_](\w)/g,function(match){return match.charAt(1).toUpperCase()})};Dropzone.createElement=function(string){var div;div=document.createElement("div");div.innerHTML=string;return div.childNodes[0]};Dropzone.elementInside=function(element,container){if(element===container){return true}while(element=element.parentNode){if(element===container){return true}}return false};Dropzone.getElement=function(el,name){var element;if(typeof el==="string"){element=document.querySelector(el)}else if(el.nodeType!=null){element=el}if(element==null){throw new Error("Invalid `"+name+"` option provided. Please provide a CSS selector or a plain HTML element.")}return element};Dropzone.getElements=function(els,name){var e,el,elements,_i,_j,_len,_len1,_ref;if(els instanceof Array){elements=[];try{for(_i=0,_len=els.length;_i<_len;_i++){el=els[_i];elements.push(this.getElement(el,name))}}catch(_error){e=_error;elements=null}}else if(typeof els==="string"){elements=[];_ref=document.querySelectorAll(els);for(_j=0,_len1=_ref.length;_j<_len1;_j++){el=_ref[_j];elements.push(el)}}else if(els.nodeType!=null){elements=[els]}if(!(elements!=null&&elements.length)){throw new Error("Invalid `"+name+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.")}return elements};Dropzone.confirm=function(question,accepted,rejected){if(window.confirm(question)){return accepted()}else if(rejected!=null){return rejected()}};Dropzone.isValidFile=function(file,acceptedFiles){var baseMimeType,mimeType,validType,_i,_len;if(!acceptedFiles){return true}acceptedFiles=acceptedFiles.split(",");mimeType=file.type;baseMimeType=mimeType.replace(/\/.*$/,"");for(_i=0,_len=acceptedFiles.length;_i<_len;_i++){validType=acceptedFiles[_i];validType=validType.trim();if(validType.charAt(0)==="."){if(file.name.toLowerCase().indexOf(validType.toLowerCase(),file.name.length-validType.length)!==-1){return true}}else if(/\/\*$/.test(validType)){if(baseMimeType===validType.replace(/\/.*$/,"")){return true}}else{if(mimeType===validType){return true}}}return false};if(typeof jQuery!=="undefined"&&jQuery!==null){jQuery.fn.dropzone=function(options){return this.each(function(){return new Dropzone(this,options)})}}if(typeof module!=="undefined"&&module!==null){module.exports=Dropzone}else{window.Dropzone=Dropzone}Dropzone.ADDED="added";Dropzone.QUEUED="queued";Dropzone.ACCEPTED=Dropzone.QUEUED;Dropzone.UPLOADING="uploading";Dropzone.PROCESSING=Dropzone.UPLOADING;Dropzone.CANCELED="canceled";Dropzone.ERROR="error";Dropzone.SUCCESS="success";detectVerticalSquash=function(img){var alpha,canvas,ctx,data,ey,ih,iw,py,ratio,sy;iw=img.naturalWidth;ih=img.naturalHeight;canvas=document.createElement("canvas");canvas.width=1;canvas.height=ih;ctx=canvas.getContext("2d");ctx.drawImage(img,0,0);data=ctx.getImageData(0,0,1,ih).data;sy=0;ey=ih;py=ih;while(py>sy){alpha=data[(py-1)*4+3];if(alpha===0){ey=py}else{sy=py}py=ey+sy>>1}ratio=py/ih;if(ratio===0){return 1}else{return ratio}};drawImageIOSFix=function(ctx,img,sx,sy,sw,sh,dx,dy,dw,dh){var vertSquashRatio;vertSquashRatio=detectVerticalSquash(img);return ctx.drawImage(img,sx,sy,sw,sh,dx,dy,dw,dh/vertSquashRatio)};contentLoaded=function(win,fn){var add,doc,done,init,poll,pre,rem,root,top;done=false;top=true;doc=win.document;root=doc.documentElement;add=doc.addEventListener?"addEventListener":"attachEvent";rem=doc.addEventListener?"removeEventListener":"detachEvent";pre=doc.addEventListener?"":"on";init=function(e){if(e.type==="readystatechange"&&doc.readyState!=="complete"){return}(e.type==="load"?win:doc)[rem](pre+e.type,init,false);if(!done&&(done=true)){return fn.call(win,e.type||e)}};poll=function(){var e;try{root.doScroll("left")}catch(_error){e=_error;setTimeout(poll,50);return}return init("poll")};if(doc.readyState!=="complete"){if(doc.createEventObject&&root.doScroll){try{top=!win.frameElement}catch(_error){}if(top){poll()}}doc[add](pre+"DOMContentLoaded",init,false);doc[add](pre+"readystatechange",init,false);return win[add](pre+"load",init,false)}};Dropzone._autoDiscoverFunction=function(){if(Dropzone.autoDiscover){return Dropzone.discover()}};contentLoaded(window,Dropzone._autoDiscoverFunction)}).call(this)},{});require.register("node_modules/happens/index",function(require,module,exports){module.exports=function(target){target=target||{};for(var prop in Happens)target[prop]=Happens[prop];return target};var Happens={__init:function(event){var tmp=this.__listeners||(this.__listeners=[]);return tmp[event]||(tmp[event]=[])},on:function(event,fn){validate(fn);this.__init(event).push(fn)},off:function(event,fn){var pool=this.__init(event);pool.splice(pool.indexOf(fn),1)},once:function(event,fn){validate(fn);var self=this,wrapper=function(){self.off(event,wrapper);fn.apply(this,arguments)};this.on(event,wrapper)},emit:function(event){var i,pool=this.__init(event).slice(0);for(i in pool)pool[i].apply(this,[].slice.call(arguments,1))}};function validate(fn){if(!(fn&&fn instanceof Function))throw new Error(fn+" is not a Function")}},{});require.register("node_modules/isotope-layout/js/isotope",function(require,module,exports){(function(window,factory){"use strict";if(typeof define=="function"&&define.amd){define(["outlayer/outlayer","get-size/get-size","matches-selector/matches-selector","fizzy-ui-utils/utils","./item","./layout-mode","./layout-modes/masonry","./layout-modes/fit-rows","./layout-modes/vertical"],function(Outlayer,getSize,matchesSelector,utils,Item,LayoutMode){return factory(window,Outlayer,getSize,matchesSelector,utils,Item,LayoutMode)})}else if(typeof exports=="object"){module.exports=factory(window,require("outlayer"),require("get-size"),require("desandro-matches-selector"),require("fizzy-ui-utils"),require("./item"),require("./layout-mode"),require("./layout-modes/masonry"),require("./layout-modes/fit-rows"),require("./layout-modes/vertical"))}else{window.Isotope=factory(window,window.Outlayer,window.getSize,window.matchesSelector,window.fizzyUIUtils,window.Isotope.Item,window.Isotope.LayoutMode)}})(window,function factory(window,Outlayer,getSize,matchesSelector,utils,Item,LayoutMode){"use strict";var jQuery=window.jQuery;var trim=String.prototype.trim?function(str){return str.trim()}:function(str){return str.replace(/^\s+|\s+$/g,"")};var docElem=document.documentElement;var getText=docElem.textContent?function(elem){return elem.textContent}:function(elem){return elem.innerText};var Isotope=Outlayer.create("isotope",{layoutMode:"masonry",isJQueryFiltering:true,sortAscending:true});Isotope.Item=Item;Isotope.LayoutMode=LayoutMode;Isotope.prototype._create=function(){this.itemGUID=0;this._sorters={};this._getSorters();Outlayer.prototype._create.call(this);this.modes={};this.filteredItems=this.items;this.sortHistory=["original-order"];for(var name in LayoutMode.modes){this._initLayoutMode(name)}};Isotope.prototype.reloadItems=function(){this.itemGUID=0;Outlayer.prototype.reloadItems.call(this)};Isotope.prototype._itemize=function(){var items=Outlayer.prototype._itemize.apply(this,arguments);for(var i=0,len=items.length;i<len;i++){var item=items[i];item.id=this.itemGUID++}this._updateItemsSortData(items);return items};Isotope.prototype._initLayoutMode=function(name){var Mode=LayoutMode.modes[name];var initialOpts=this.options[name]||{};this.options[name]=Mode.options?utils.extend(Mode.options,initialOpts):initialOpts;this.modes[name]=new Mode(this)};Isotope.prototype.layout=function(){if(!this._isLayoutInited&&this.options.isInitLayout){this.arrange();return}this._layout()};Isotope.prototype._layout=function(){var isInstant=this._getIsInstant();this._resetLayout();this._manageStamps();this.layoutItems(this.filteredItems,isInstant);this._isLayoutInited=true};Isotope.prototype.arrange=function(opts){this.option(opts);this._getIsInstant();var filtered=this._filter(this.items);this.filteredItems=filtered.matches;var _this=this;function hideReveal(){_this.reveal(filtered.needReveal);_this.hide(filtered.needHide)}this._bindArrangeComplete();if(this._isInstant){this._noTransition(hideReveal)}else{hideReveal()}this._sort();this._layout()};Isotope.prototype._init=Isotope.prototype.arrange;Isotope.prototype._getIsInstant=function(){var isInstant=this.options.isLayoutInstant!==undefined?this.options.isLayoutInstant:!this._isLayoutInited;this._isInstant=isInstant;return isInstant};Isotope.prototype._bindArrangeComplete=function(){var isLayoutComplete,isHideComplete,isRevealComplete;var _this=this;function arrangeParallelCallback(){if(isLayoutComplete&&isHideComplete&&isRevealComplete){_this.dispatchEvent("arrangeComplete",null,[_this.filteredItems])}}this.once("layoutComplete",function(){isLayoutComplete=true;arrangeParallelCallback()});this.once("hideComplete",function(){isHideComplete=true;arrangeParallelCallback()});this.once("revealComplete",function(){isRevealComplete=true;arrangeParallelCallback()})};Isotope.prototype._filter=function(items){var filter=this.options.filter;filter=filter||"*";var matches=[];var hiddenMatched=[];var visibleUnmatched=[];var test=this._getFilterTest(filter);for(var i=0,len=items.length;i<len;i++){var item=items[i];if(item.isIgnored){continue}var isMatched=test(item);if(isMatched){matches.push(item)}if(isMatched&&item.isHidden){hiddenMatched.push(item)}else if(!isMatched&&!item.isHidden){visibleUnmatched.push(item)}}return{matches:matches,needReveal:hiddenMatched,needHide:visibleUnmatched}};Isotope.prototype._getFilterTest=function(filter){if(jQuery&&this.options.isJQueryFiltering){return function(item){return jQuery(item.element).is(filter)}}if(typeof filter=="function"){return function(item){return filter(item.element)}}return function(item){return matchesSelector(item.element,filter)}};Isotope.prototype.updateSortData=function(elems){var items;if(elems){elems=utils.makeArray(elems);items=this.getItems(elems)}else{items=this.items}this._getSorters();this._updateItemsSortData(items)};Isotope.prototype._getSorters=function(){var getSortData=this.options.getSortData;for(var key in getSortData){var sorter=getSortData[key];this._sorters[key]=mungeSorter(sorter)}};Isotope.prototype._updateItemsSortData=function(items){var len=items&&items.length;for(var i=0;len&&i<len;i++){var item=items[i];item.updateSortData()}};var mungeSorter=function(){function mungeSorter(sorter){if(typeof sorter!="string"){return sorter}var args=trim(sorter).split(" ");var query=args[0];var attrMatch=query.match(/^\[(.+)\]$/);var attr=attrMatch&&attrMatch[1];var getValue=getValueGetter(attr,query);var parser=Isotope.sortDataParsers[args[1]];sorter=parser?function(elem){return elem&&parser(getValue(elem))}:function(elem){return elem&&getValue(elem)};return sorter}function getValueGetter(attr,query){var getValue;if(attr){getValue=function(elem){return elem.getAttribute(attr)}}else{getValue=function(elem){var child=elem.querySelector(query);return child&&getText(child)}}return getValue}return mungeSorter}();Isotope.sortDataParsers={parseInt:function(val){return parseInt(val,10)},parseFloat:function(val){return parseFloat(val)}};Isotope.prototype._sort=function(){var sortByOpt=this.options.sortBy;if(!sortByOpt){return}var sortBys=[].concat.apply(sortByOpt,this.sortHistory);var itemSorter=getItemSorter(sortBys,this.options.sortAscending);this.filteredItems.sort(itemSorter);if(sortByOpt!=this.sortHistory[0]){this.sortHistory.unshift(sortByOpt)}};function getItemSorter(sortBys,sortAsc){return function sorter(itemA,itemB){for(var i=0,len=sortBys.length;i<len;i++){var sortBy=sortBys[i];var a=itemA.sortData[sortBy];var b=itemB.sortData[sortBy];if(a>b||a<b){var isAscending=sortAsc[sortBy]!==undefined?sortAsc[sortBy]:sortAsc;var direction=isAscending?1:-1;return(a>b?1:-1)*direction}}return 0}}Isotope.prototype._mode=function(){var layoutMode=this.options.layoutMode;var mode=this.modes[layoutMode];if(!mode){throw new Error("No layout mode: "+layoutMode)}mode.options=this.options[layoutMode];return mode};Isotope.prototype._resetLayout=function(){Outlayer.prototype._resetLayout.call(this);this._mode()._resetLayout()};Isotope.prototype._getItemLayoutPosition=function(item){return this._mode()._getItemLayoutPosition(item)};Isotope.prototype._manageStamp=function(stamp){this._mode()._manageStamp(stamp)};Isotope.prototype._getContainerSize=function(){return this._mode()._getContainerSize()};Isotope.prototype.needsResizeLayout=function(){return this._mode().needsResizeLayout()};Isotope.prototype.appended=function(elems){var items=this.addItems(elems);if(!items.length){return}var filteredItems=this._filterRevealAdded(items);this.filteredItems=this.filteredItems.concat(filteredItems)};Isotope.prototype.prepended=function(elems){var items=this._itemize(elems);if(!items.length){return}this._resetLayout();this._manageStamps();var filteredItems=this._filterRevealAdded(items);this.layoutItems(this.filteredItems);this.filteredItems=filteredItems.concat(this.filteredItems);this.items=items.concat(this.items)};Isotope.prototype._filterRevealAdded=function(items){var filtered=this._filter(items);this.hide(filtered.needHide);this.reveal(filtered.matches);this.layoutItems(filtered.matches,true);return filtered.matches};Isotope.prototype.insert=function(elems){var items=this.addItems(elems);if(!items.length){return}var i,item;var len=items.length;for(i=0;i<len;i++){item=items[i];this.element.appendChild(item.element)}var filteredInsertItems=this._filter(items).matches;for(i=0;i<len;i++){items[i].isLayoutInstant=true}this.arrange();for(i=0;i<len;i++){delete items[i].isLayoutInstant}this.reveal(filteredInsertItems)};var _remove=Isotope.prototype.remove;Isotope.prototype.remove=function(elems){elems=utils.makeArray(elems);var removeItems=this.getItems(elems);_remove.call(this,elems);var len=removeItems&&removeItems.length;if(!len){return}for(var i=0;i<len;i++){var item=removeItems[i];utils.removeFrom(this.filteredItems,item)}};Isotope.prototype.shuffle=function(){for(var i=0,len=this.items.length;i<len;i++){var item=this.items[i];item.sortData.random=Math.random()}this.options.sortBy="random";this._sort();this._layout()};Isotope.prototype._noTransition=function(fn){var transitionDuration=this.options.transitionDuration;this.options.transitionDuration=0;var returnValue=fn.call(this);this.options.transitionDuration=transitionDuration;return returnValue};Isotope.prototype.getFilteredItemElements=function(){var elems=[];for(var i=0,len=this.filteredItems.length;i<len;i++){elems.push(this.filteredItems[i].element)}return elems};return Isotope})},{outlayer:"node_modules/isotope-layout/node_modules/outlayer/outlayer","get-size":"node_modules/isotope-layout/node_modules/get-size/get-size","desandro-matches-selector":"node_modules/isotope-layout/node_modules/desandro-matches-selector/matches-selector","fizzy-ui-utils":"node_modules/isotope-layout/node_modules/fizzy-ui-utils/utils","./item":"node_modules/isotope-layout/js/item","./layout-mode":"node_modules/isotope-layout/js/layout-mode","./layout-modes/masonry":"node_modules/isotope-layout/js/layout-modes/masonry","./layout-modes/fit-rows":"node_modules/isotope-layout/js/layout-modes/fit-rows","./layout-modes/vertical":"node_modules/isotope-layout/js/layout-modes/vertical"});require.register("node_modules/isotope-layout/js/item",function(require,module,exports){(function(window,factory){"use strict";if(typeof define=="function"&&define.amd){define(["outlayer/outlayer"],factory)}else if(typeof exports=="object"){module.exports=factory(require("outlayer"))}else{window.Isotope=window.Isotope||{};window.Isotope.Item=factory(window.Outlayer)}})(window,function factory(Outlayer){"use strict";function Item(){Outlayer.Item.apply(this,arguments)}Item.prototype=new Outlayer.Item;Item.prototype._create=function(){this.id=this.layout.itemGUID++;Outlayer.Item.prototype._create.call(this);this.sortData={}};Item.prototype.updateSortData=function(){if(this.isIgnored){return}this.sortData.id=this.id;this.sortData["original-order"]=this.id;this.sortData.random=Math.random();var getSortData=this.layout.options.getSortData;var sorters=this.layout._sorters;for(var key in getSortData){var sorter=sorters[key];this.sortData[key]=sorter(this.element,this)}};var _destroy=Item.prototype.destroy;Item.prototype.destroy=function(){_destroy.apply(this,arguments);this.css({display:""})};return Item})},{outlayer:"node_modules/isotope-layout/node_modules/outlayer/outlayer"});require.register("node_modules/isotope-layout/js/layout-mode",function(require,module,exports){(function(window,factory){"use strict";if(typeof define=="function"&&define.amd){define(["get-size/get-size","outlayer/outlayer"],factory)}else if(typeof exports=="object"){module.exports=factory(require("get-size"),require("outlayer"))}else{window.Isotope=window.Isotope||{};window.Isotope.LayoutMode=factory(window.getSize,window.Outlayer)}})(window,function factory(getSize,Outlayer){"use strict";function LayoutMode(isotope){this.isotope=isotope;if(isotope){this.options=isotope.options[this.namespace];
this.element=isotope.element;this.items=isotope.filteredItems;this.size=isotope.size}}(function(){var facadeMethods=["_resetLayout","_getItemLayoutPosition","_manageStamp","_getContainerSize","_getElementOffset","needsResizeLayout"];for(var i=0,len=facadeMethods.length;i<len;i++){var methodName=facadeMethods[i];LayoutMode.prototype[methodName]=getOutlayerMethod(methodName)}function getOutlayerMethod(methodName){return function(){return Outlayer.prototype[methodName].apply(this.isotope,arguments)}}})();LayoutMode.prototype.needsVerticalResizeLayout=function(){var size=getSize(this.isotope.element);var hasSizes=this.isotope.size&&size;return hasSizes&&size.innerHeight!=this.isotope.size.innerHeight};LayoutMode.prototype._getMeasurement=function(){this.isotope._getMeasurement.apply(this,arguments)};LayoutMode.prototype.getColumnWidth=function(){this.getSegmentSize("column","Width")};LayoutMode.prototype.getRowHeight=function(){this.getSegmentSize("row","Height")};LayoutMode.prototype.getSegmentSize=function(segment,size){var segmentName=segment+size;var outerSize="outer"+size;this._getMeasurement(segmentName,outerSize);if(this[segmentName]){return}var firstItemSize=this.getFirstItemSize();this[segmentName]=firstItemSize&&firstItemSize[outerSize]||this.isotope.size["inner"+size]};LayoutMode.prototype.getFirstItemSize=function(){var firstItem=this.isotope.filteredItems[0];return firstItem&&firstItem.element&&getSize(firstItem.element)};LayoutMode.prototype.layout=function(){this.isotope.layout.apply(this.isotope,arguments)};LayoutMode.prototype.getSize=function(){this.isotope.getSize();this.size=this.isotope.size};LayoutMode.modes={};LayoutMode.create=function(namespace,options){function Mode(){LayoutMode.apply(this,arguments)}Mode.prototype=new LayoutMode;if(options){Mode.options=options}Mode.prototype.namespace=namespace;LayoutMode.modes[namespace]=Mode;return Mode};return LayoutMode})},{"get-size":"node_modules/isotope-layout/node_modules/get-size/get-size",outlayer:"node_modules/isotope-layout/node_modules/outlayer/outlayer"});require.register("node_modules/isotope-layout/js/layout-modes/fit-rows",function(require,module,exports){(function(window,factory){"use strict";if(typeof define=="function"&&define.amd){define(["../layout-mode"],factory)}else if(typeof exports=="object"){module.exports=factory(require("../layout-mode"))}else{factory(window.Isotope.LayoutMode)}})(window,function factory(LayoutMode){"use strict";var FitRows=LayoutMode.create("fitRows");FitRows.prototype._resetLayout=function(){this.x=0;this.y=0;this.maxY=0;this._getMeasurement("gutter","outerWidth")};FitRows.prototype._getItemLayoutPosition=function(item){item.getSize();var itemWidth=item.size.outerWidth+this.gutter;var containerWidth=this.isotope.size.innerWidth+this.gutter;if(this.x!==0&&itemWidth+this.x>containerWidth){this.x=0;this.y=this.maxY}var position={x:this.x,y:this.y};this.maxY=Math.max(this.maxY,this.y+item.size.outerHeight);this.x+=itemWidth;return position};FitRows.prototype._getContainerSize=function(){return{height:this.maxY}};return FitRows})},{"../layout-mode":"node_modules/isotope-layout/js/layout-mode"});require.register("node_modules/isotope-layout/js/layout-modes/masonry",function(require,module,exports){(function(window,factory){"use strict";if(typeof define=="function"&&define.amd){define(["../layout-mode","masonry/masonry"],factory)}else if(typeof exports=="object"){module.exports=factory(require("../layout-mode"),require("masonry-layout"))}else{factory(window.Isotope.LayoutMode,window.Masonry)}})(window,function factory(LayoutMode,Masonry){"use strict";function extend(a,b){for(var prop in b){a[prop]=b[prop]}return a}var MasonryMode=LayoutMode.create("masonry");var _getElementOffset=MasonryMode.prototype._getElementOffset;var layout=MasonryMode.prototype.layout;var _getMeasurement=MasonryMode.prototype._getMeasurement;extend(MasonryMode.prototype,Masonry.prototype);MasonryMode.prototype._getElementOffset=_getElementOffset;MasonryMode.prototype.layout=layout;MasonryMode.prototype._getMeasurement=_getMeasurement;var measureColumns=MasonryMode.prototype.measureColumns;MasonryMode.prototype.measureColumns=function(){this.items=this.isotope.filteredItems;measureColumns.call(this)};var _manageStamp=MasonryMode.prototype._manageStamp;MasonryMode.prototype._manageStamp=function(){this.options.isOriginLeft=this.isotope.options.isOriginLeft;this.options.isOriginTop=this.isotope.options.isOriginTop;_manageStamp.apply(this,arguments)};return MasonryMode})},{"../layout-mode":"node_modules/isotope-layout/js/layout-mode","masonry-layout":"node_modules/isotope-layout/node_modules/masonry-layout/masonry"});require.register("node_modules/isotope-layout/js/layout-modes/vertical",function(require,module,exports){(function(window,factory){"use strict";if(typeof define=="function"&&define.amd){define(["../layout-mode"],factory)}else if(typeof exports=="object"){module.exports=factory(require("../layout-mode"))}else{factory(window.Isotope.LayoutMode)}})(window,function factory(LayoutMode){"use strict";var Vertical=LayoutMode.create("vertical",{horizontalAlignment:0});Vertical.prototype._resetLayout=function(){this.y=0};Vertical.prototype._getItemLayoutPosition=function(item){item.getSize();var x=(this.isotope.size.innerWidth-item.size.outerWidth)*this.options.horizontalAlignment;var y=this.y;this.y+=item.size.outerHeight;return{x:x,y:y}};Vertical.prototype._getContainerSize=function(){return{height:this.y}};return Vertical})},{"../layout-mode":"node_modules/isotope-layout/js/layout-mode"});require.register("node_modules/isotope-layout/node_modules/desandro-matches-selector/matches-selector",function(require,module,exports){(function(ElemProto){"use strict";var matchesMethod=function(){if(ElemProto.matches){return"matches"}if(ElemProto.matchesSelector){return"matchesSelector"}var prefixes=["webkit","moz","ms","o"];for(var i=0,len=prefixes.length;i<len;i++){var prefix=prefixes[i];var method=prefix+"MatchesSelector";if(ElemProto[method]){return method}}}();function match(elem,selector){return elem[matchesMethod](selector)}function checkParent(elem){if(elem.parentNode){return}var fragment=document.createDocumentFragment();fragment.appendChild(elem)}function query(elem,selector){checkParent(elem);var elems=elem.parentNode.querySelectorAll(selector);for(var i=0,len=elems.length;i<len;i++){if(elems[i]===elem){return true}}return false}function matchChild(elem,selector){checkParent(elem);return match(elem,selector)}var matchesSelector;if(matchesMethod){var div=document.createElement("div");var supportsOrphans=match(div,"div");matchesSelector=supportsOrphans?match:matchChild}else{matchesSelector=query}if(typeof define==="function"&&define.amd){define(function(){return matchesSelector})}else if(typeof exports==="object"){module.exports=matchesSelector}else{window.matchesSelector=matchesSelector}})(Element.prototype)},{});require.register("node_modules/isotope-layout/node_modules/fizzy-ui-utils/node_modules/doc-ready/doc-ready",function(require,module,exports){(function(window){"use strict";var document=window.document;var queue=[];function docReady(fn){if(typeof fn!=="function"){return}if(docReady.isReady){fn()}else{queue.push(fn)}}docReady.isReady=false;function init(event){var isIE8NotReady=event.type==="readystatechange"&&document.readyState!=="complete";if(docReady.isReady||isIE8NotReady){return}docReady.isReady=true;for(var i=0,len=queue.length;i<len;i++){var fn=queue[i];fn()}}function defineDocReady(eventie){eventie.bind(document,"DOMContentLoaded",init);eventie.bind(document,"readystatechange",init);eventie.bind(window,"load",init);return docReady}if(typeof define==="function"&&define.amd){docReady.isReady=typeof requirejs==="function";define(["eventie/eventie"],defineDocReady)}else if(typeof exports==="object"){module.exports=defineDocReady(require("eventie"))}else{window.docReady=defineDocReady(window.eventie)}})(window)},{eventie:"node_modules/isotope-layout/node_modules/fizzy-ui-utils/node_modules/doc-ready/node_modules/eventie/eventie"});require.register("node_modules/isotope-layout/node_modules/fizzy-ui-utils/node_modules/doc-ready/node_modules/eventie/eventie",function(require,module,exports){(function(window){"use strict";var docElem=document.documentElement;var bind=function(){};function getIEEvent(obj){var event=window.event;event.target=event.target||event.srcElement||obj;return event}if(docElem.addEventListener){bind=function(obj,type,fn){obj.addEventListener(type,fn,false)}}else if(docElem.attachEvent){bind=function(obj,type,fn){obj[type+fn]=fn.handleEvent?function(){var event=getIEEvent(obj);fn.handleEvent.call(fn,event)}:function(){var event=getIEEvent(obj);fn.call(obj,event)};obj.attachEvent("on"+type,obj[type+fn])}}var unbind=function(){};if(docElem.removeEventListener){unbind=function(obj,type,fn){obj.removeEventListener(type,fn,false)}}else if(docElem.detachEvent){unbind=function(obj,type,fn){obj.detachEvent("on"+type,obj[type+fn]);try{delete obj[type+fn]}catch(err){obj[type+fn]=undefined}}}var eventie={bind:bind,unbind:unbind};if(typeof define==="function"&&define.amd){define(eventie)}else if(typeof exports==="object"){module.exports=eventie}else{window.eventie=eventie}})(window)},{});require.register("node_modules/isotope-layout/node_modules/fizzy-ui-utils/utils",function(require,module,exports){(function(window,factory){"use strict";if(typeof define=="function"&&define.amd){define(["doc-ready/doc-ready","matches-selector/matches-selector"],function(docReady,matchesSelector){return factory(window,docReady,matchesSelector)})}else if(typeof exports=="object"){module.exports=factory(window,require("doc-ready"),require("desandro-matches-selector"))}else{window.fizzyUIUtils=factory(window,window.docReady,window.matchesSelector)}})(window,function factory(window,docReady,matchesSelector){"use strict";var utils={};utils.extend=function(a,b){for(var prop in b){a[prop]=b[prop]}return a};utils.modulo=function(num,div){return(num%div+div)%div};var objToString=Object.prototype.toString;utils.isArray=function(obj){return objToString.call(obj)=="[object Array]"};utils.makeArray=function(obj){var ary=[];if(utils.isArray(obj)){ary=obj}else if(obj&&typeof obj.length=="number"){for(var i=0,len=obj.length;i<len;i++){ary.push(obj[i])}}else{ary.push(obj)}return ary};utils.indexOf=Array.prototype.indexOf?function(ary,obj){return ary.indexOf(obj)}:function(ary,obj){for(var i=0,len=ary.length;i<len;i++){if(ary[i]===obj){return i}}return-1};utils.removeFrom=function(ary,obj){var index=utils.indexOf(ary,obj);if(index!=-1){ary.splice(index,1)}};utils.isElement=typeof HTMLElement=="function"||typeof HTMLElement=="object"?function isElementDOM2(obj){return obj instanceof HTMLElement}:function isElementQuirky(obj){return obj&&typeof obj=="object"&&obj.nodeType==1&&typeof obj.nodeName=="string"};utils.setText=function(){var setTextProperty;function setText(elem,text){setTextProperty=setTextProperty||(document.documentElement.textContent!==undefined?"textContent":"innerText");elem[setTextProperty]=text}return setText}();utils.getParent=function(elem,selector){while(elem!=document.body){elem=elem.parentNode;if(matchesSelector(elem,selector)){return elem}}};utils.getQueryElement=function(elem){if(typeof elem=="string"){return document.querySelector(elem)}return elem};utils.handleEvent=function(event){var method="on"+event.type;if(this[method]){this[method](event)}};utils.filterFindElements=function(elems,selector){elems=utils.makeArray(elems);var ffElems=[];for(var i=0,len=elems.length;i<len;i++){var elem=elems[i];if(!utils.isElement(elem)){continue}if(selector){if(matchesSelector(elem,selector)){ffElems.push(elem)}var childElems=elem.querySelectorAll(selector);for(var j=0,jLen=childElems.length;j<jLen;j++){ffElems.push(childElems[j])}}else{ffElems.push(elem)}}return ffElems};utils.debounceMethod=function(_class,methodName,threshold){var method=_class.prototype[methodName];var timeoutName=methodName+"Timeout";_class.prototype[methodName]=function(){var timeout=this[timeoutName];if(timeout){clearTimeout(timeout)}var args=arguments;var _this=this;this[timeoutName]=setTimeout(function(){method.apply(_this,args);delete _this[timeoutName]},threshold||100)}};utils.toDashed=function(str){return str.replace(/(.)([A-Z])/g,function(match,$1,$2){return $1+"-"+$2}).toLowerCase()};var console=window.console;utils.htmlInit=function(WidgetClass,namespace){docReady(function(){var dashedNamespace=utils.toDashed(namespace);var elems=document.querySelectorAll(".js-"+dashedNamespace);var dataAttr="data-"+dashedNamespace+"-options";for(var i=0,len=elems.length;i<len;i++){var elem=elems[i];var attr=elem.getAttribute(dataAttr);var options;try{options=attr&&JSON.parse(attr)}catch(error){if(console){console.error("Error parsing "+dataAttr+" on "+elem.nodeName.toLowerCase()+(elem.id?"#"+elem.id:"")+": "+error)}continue}var instance=new WidgetClass(elem,options);var jQuery=window.jQuery;if(jQuery){jQuery.data(elem,namespace,instance)}}})};return utils})},{"doc-ready":"node_modules/isotope-layout/node_modules/fizzy-ui-utils/node_modules/doc-ready/doc-ready","desandro-matches-selector":"node_modules/isotope-layout/node_modules/desandro-matches-selector/matches-selector"});require.register("node_modules/isotope-layout/node_modules/get-size/get-size",function(require,module,exports){(function(window,undefined){"use strict";function getStyleSize(value){var num=parseFloat(value);var isValid=value.indexOf("%")===-1&&!isNaN(num);return isValid&&num}function noop(){}var logError=typeof console==="undefined"?noop:function(message){console.error(message)};var measurements=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];function getZeroSize(){var size={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0};for(var i=0,len=measurements.length;i<len;i++){var measurement=measurements[i];size[measurement]=0}return size}function defineGetSize(getStyleProperty){var isSetup=false;var getStyle,boxSizingProp,isBoxSizeOuter;function setup(){if(isSetup){return}isSetup=true;var getComputedStyle=window.getComputedStyle;getStyle=function(){var getStyleFn=getComputedStyle?function(elem){return getComputedStyle(elem,null)}:function(elem){return elem.currentStyle};return function getStyle(elem){var style=getStyleFn(elem);if(!style){logError("Style returned "+style+". Are you running this code in a hidden iframe on Firefox? "+"See http://bit.ly/getsizebug1")}return style}}();boxSizingProp=getStyleProperty("boxSizing");if(boxSizingProp){var div=document.createElement("div");div.style.width="200px";div.style.padding="1px 2px 3px 4px";div.style.borderStyle="solid";div.style.borderWidth="1px 2px 3px 4px";div.style[boxSizingProp]="border-box";var body=document.body||document.documentElement;body.appendChild(div);var style=getStyle(div);isBoxSizeOuter=getStyleSize(style.width)===200;body.removeChild(div)}}function getSize(elem){setup();if(typeof elem==="string"){elem=document.querySelector(elem)}if(!elem||typeof elem!=="object"||!elem.nodeType){return}var style=getStyle(elem);if(style.display==="none"){return getZeroSize()}var size={};size.width=elem.offsetWidth;size.height=elem.offsetHeight;var isBorderBox=size.isBorderBox=!!(boxSizingProp&&style[boxSizingProp]&&style[boxSizingProp]==="border-box");for(var i=0,len=measurements.length;i<len;i++){var measurement=measurements[i];var value=style[measurement];value=mungeNonPixel(elem,value);var num=parseFloat(value);size[measurement]=!isNaN(num)?num:0}var paddingWidth=size.paddingLeft+size.paddingRight;var paddingHeight=size.paddingTop+size.paddingBottom;var marginWidth=size.marginLeft+size.marginRight;var marginHeight=size.marginTop+size.marginBottom;var borderWidth=size.borderLeftWidth+size.borderRightWidth;var borderHeight=size.borderTopWidth+size.borderBottomWidth;var isBorderBoxSizeOuter=isBorderBox&&isBoxSizeOuter;var styleWidth=getStyleSize(style.width);if(styleWidth!==false){size.width=styleWidth+(isBorderBoxSizeOuter?0:paddingWidth+borderWidth)}var styleHeight=getStyleSize(style.height);if(styleHeight!==false){size.height=styleHeight+(isBorderBoxSizeOuter?0:paddingHeight+borderHeight)}size.innerWidth=size.width-(paddingWidth+borderWidth);size.innerHeight=size.height-(paddingHeight+borderHeight);size.outerWidth=size.width+marginWidth;size.outerHeight=size.height+marginHeight;return size}function mungeNonPixel(elem,value){if(window.getComputedStyle||value.indexOf("%")===-1){return value}var style=elem.style;var left=style.left;var rs=elem.runtimeStyle;var rsLeft=rs&&rs.left;if(rsLeft){rs.left=elem.currentStyle.left}style.left=value;value=style.pixelLeft;style.left=left;if(rsLeft){rs.left=rsLeft}return value}return getSize}if(typeof define==="function"&&define.amd){define(["get-style-property/get-style-property"],defineGetSize)}else if(typeof exports==="object"){module.exports=defineGetSize(require("desandro-get-style-property"))}else{window.getSize=defineGetSize(window.getStyleProperty)}})(window)},{"desandro-get-style-property":"node_modules/isotope-layout/node_modules/get-size/node_modules/desandro-get-style-property/get-style-property"});require.register("node_modules/isotope-layout/node_modules/get-size/node_modules/desandro-get-style-property/get-style-property",function(require,module,exports){(function(window){"use strict";var prefixes="Webkit Moz ms Ms O".split(" ");var docElemStyle=document.documentElement.style;function getStyleProperty(propName){if(!propName){return}if(typeof docElemStyle[propName]==="string"){return propName}propName=propName.charAt(0).toUpperCase()+propName.slice(1);var prefixed;for(var i=0,len=prefixes.length;i<len;i++){prefixed=prefixes[i]+propName;if(typeof docElemStyle[prefixed]==="string"){return prefixed}}}if(typeof define==="function"&&define.amd){define(function(){return getStyleProperty})}else if(typeof exports==="object"){module.exports=getStyleProperty}else{window.getStyleProperty=getStyleProperty}})(window)},{});require.register("node_modules/isotope-layout/node_modules/masonry-layout/masonry",function(require,module,exports){(function(window,factory){"use strict";if(typeof define==="function"&&define.amd){define(["outlayer/outlayer","get-size/get-size","fizzy-ui-utils/utils"],factory)}else if(typeof exports==="object"){module.exports=factory(require("outlayer"),require("get-size"),require("fizzy-ui-utils"))}else{window.Masonry=factory(window.Outlayer,window.getSize,window.fizzyUIUtils)}})(window,function factory(Outlayer,getSize,utils){"use strict";var Masonry=Outlayer.create("masonry");Masonry.prototype._resetLayout=function(){this.getSize();this._getMeasurement("columnWidth","outerWidth");this._getMeasurement("gutter","outerWidth");this.measureColumns();var i=this.cols;this.colYs=[];while(i--){this.colYs.push(0)}this.maxY=0};Masonry.prototype.measureColumns=function(){this.getContainerWidth();if(!this.columnWidth){var firstItem=this.items[0];var firstItemElem=firstItem&&firstItem.element;this.columnWidth=firstItemElem&&getSize(firstItemElem).outerWidth||this.containerWidth}var columnWidth=this.columnWidth+=this.gutter;var containerWidth=this.containerWidth+this.gutter;var cols=containerWidth/columnWidth;var excess=columnWidth-containerWidth%columnWidth;var mathMethod=excess&&excess<1?"round":"floor";cols=Math[mathMethod](cols);this.cols=Math.max(cols,1)};Masonry.prototype.getContainerWidth=function(){var container=this.options.isFitWidth?this.element.parentNode:this.element;var size=getSize(container);this.containerWidth=size&&size.innerWidth};Masonry.prototype._getItemLayoutPosition=function(item){item.getSize();var remainder=item.size.outerWidth%this.columnWidth;var mathMethod=remainder&&remainder<1?"round":"ceil";var colSpan=Math[mathMethod](item.size.outerWidth/this.columnWidth);colSpan=Math.min(colSpan,this.cols);var colGroup=this._getColGroup(colSpan);var minimumY=Math.min.apply(Math,colGroup);var shortColIndex=utils.indexOf(colGroup,minimumY);var position={x:this.columnWidth*shortColIndex,y:minimumY};var setHeight=minimumY+item.size.outerHeight;var setSpan=this.cols+1-colGroup.length;for(var i=0;i<setSpan;i++){this.colYs[shortColIndex+i]=setHeight}return position};Masonry.prototype._getColGroup=function(colSpan){if(colSpan<2){return this.colYs}var colGroup=[];var groupCount=this.cols+1-colSpan;for(var i=0;i<groupCount;i++){var groupColYs=this.colYs.slice(i,i+colSpan);colGroup[i]=Math.max.apply(Math,groupColYs)}return colGroup};Masonry.prototype._manageStamp=function(stamp){var stampSize=getSize(stamp);var offset=this._getElementOffset(stamp);var firstX=this.options.isOriginLeft?offset.left:offset.right;var lastX=firstX+stampSize.outerWidth;var firstCol=Math.floor(firstX/this.columnWidth);firstCol=Math.max(0,firstCol);var lastCol=Math.floor(lastX/this.columnWidth);lastCol-=lastX%this.columnWidth?0:1;lastCol=Math.min(this.cols-1,lastCol);var stampMaxY=(this.options.isOriginTop?offset.top:offset.bottom)+stampSize.outerHeight;for(var i=firstCol;i<=lastCol;i++){this.colYs[i]=Math.max(stampMaxY,this.colYs[i])}};Masonry.prototype._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var size={height:this.maxY};if(this.options.isFitWidth){size.width=this._getContainerFitWidth()}return size};Masonry.prototype._getContainerFitWidth=function(){var unusedCols=0;var i=this.cols;while(--i){if(this.colYs[i]!==0){break}unusedCols++}return(this.cols-unusedCols)*this.columnWidth-this.gutter};Masonry.prototype.needsResizeLayout=function(){var previousWidth=this.containerWidth;this.getContainerWidth();return previousWidth!==this.containerWidth};return Masonry})},{outlayer:"node_modules/isotope-layout/node_modules/outlayer/outlayer","get-size":"node_modules/isotope-layout/node_modules/get-size/get-size","fizzy-ui-utils":"node_modules/isotope-layout/node_modules/fizzy-ui-utils/utils"});require.register("node_modules/isotope-layout/node_modules/outlayer/item",function(require,module,exports){(function(window,factory){"use strict";if(typeof define==="function"&&define.amd){define(["eventEmitter/EventEmitter","get-size/get-size","get-style-property/get-style-property","fizzy-ui-utils/utils"],function(EventEmitter,getSize,getStyleProperty,utils){return factory(window,EventEmitter,getSize,getStyleProperty,utils)})}else if(typeof exports==="object"){module.exports=factory(window,require("wolfy87-eventemitter"),require("get-size"),require("desandro-get-style-property"),require("fizzy-ui-utils"))}else{window.Outlayer={};window.Outlayer.Item=factory(window,window.EventEmitter,window.getSize,window.getStyleProperty,window.fizzyUIUtils)}})(window,function factory(window,EventEmitter,getSize,getStyleProperty,utils){"use strict";var getComputedStyle=window.getComputedStyle;var getStyle=getComputedStyle?function(elem){return getComputedStyle(elem,null)}:function(elem){return elem.currentStyle};function isEmptyObj(obj){for(var prop in obj){return false}prop=null;return true}var transitionProperty=getStyleProperty("transition");var transformProperty=getStyleProperty("transform");var supportsCSS3=transitionProperty&&transformProperty;var is3d=!!getStyleProperty("perspective");var transitionEndEvent={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"}[transitionProperty];var prefixableProperties=["transform","transition","transitionDuration","transitionProperty"];var vendorProperties=function(){var cache={};for(var i=0,len=prefixableProperties.length;i<len;i++){var prop=prefixableProperties[i];var supportedProp=getStyleProperty(prop);if(supportedProp&&supportedProp!==prop){cache[prop]=supportedProp}}return cache}();function Item(element,layout){if(!element){return}this.element=element;this.layout=layout;this.position={x:0,y:0};this._create()}utils.extend(Item.prototype,EventEmitter.prototype);Item.prototype._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}};this.css({position:"absolute"})};Item.prototype.handleEvent=function(event){var method="on"+event.type;if(this[method]){this[method](event)}};Item.prototype.getSize=function(){this.size=getSize(this.element)};Item.prototype.css=function(style){var elemStyle=this.element.style;for(var prop in style){var supportedProp=vendorProperties[prop]||prop;elemStyle[supportedProp]=style[prop]}};Item.prototype.getPosition=function(){var style=getStyle(this.element);var layoutOptions=this.layout.options;var isOriginLeft=layoutOptions.isOriginLeft;var isOriginTop=layoutOptions.isOriginTop;var xValue=style[isOriginLeft?"left":"right"];var yValue=style[isOriginTop?"top":"bottom"];var layoutSize=this.layout.size;var x=xValue.indexOf("%")!=-1?parseFloat(xValue)/100*layoutSize.width:parseInt(xValue,10);var y=yValue.indexOf("%")!=-1?parseFloat(yValue)/100*layoutSize.height:parseInt(yValue,10);x=isNaN(x)?0:x;y=isNaN(y)?0:y;x-=isOriginLeft?layoutSize.paddingLeft:layoutSize.paddingRight;y-=isOriginTop?layoutSize.paddingTop:layoutSize.paddingBottom;this.position.x=x;this.position.y=y};Item.prototype.layoutPosition=function(){var layoutSize=this.layout.size;var layoutOptions=this.layout.options;var style={};var xPadding=layoutOptions.isOriginLeft?"paddingLeft":"paddingRight";var xProperty=layoutOptions.isOriginLeft?"left":"right";var xResetProperty=layoutOptions.isOriginLeft?"right":"left";var x=this.position.x+layoutSize[xPadding];style[xProperty]=this.getXValue(x);style[xResetProperty]="";var yPadding=layoutOptions.isOriginTop?"paddingTop":"paddingBottom";var yProperty=layoutOptions.isOriginTop?"top":"bottom";var yResetProperty=layoutOptions.isOriginTop?"bottom":"top";var y=this.position.y+layoutSize[yPadding];style[yProperty]=this.getYValue(y);style[yResetProperty]="";this.css(style);this.emitEvent("layout",[this])};Item.prototype.getXValue=function(x){var layoutOptions=this.layout.options;return layoutOptions.percentPosition&&!layoutOptions.isHorizontal?x/this.layout.size.width*100+"%":x+"px"};Item.prototype.getYValue=function(y){var layoutOptions=this.layout.options;return layoutOptions.percentPosition&&layoutOptions.isHorizontal?y/this.layout.size.height*100+"%":y+"px"};Item.prototype._transitionTo=function(x,y){this.getPosition();var curX=this.position.x;var curY=this.position.y;var compareX=parseInt(x,10);var compareY=parseInt(y,10);var didNotMove=compareX===this.position.x&&compareY===this.position.y;this.setPosition(x,y);if(didNotMove&&!this.isTransitioning){this.layoutPosition();return}var transX=x-curX;var transY=y-curY;var transitionStyle={};transitionStyle.transform=this.getTranslate(transX,transY);this.transition({to:transitionStyle,onTransitionEnd:{transform:this.layoutPosition},isCleaning:true})};Item.prototype.getTranslate=function(x,y){var layoutOptions=this.layout.options;x=layoutOptions.isOriginLeft?x:-x;y=layoutOptions.isOriginTop?y:-y;if(is3d){return"translate3d("+x+"px, "+y+"px, 0)"}return"translate("+x+"px, "+y+"px)"};Item.prototype.goTo=function(x,y){this.setPosition(x,y);this.layoutPosition()};Item.prototype.moveTo=supportsCSS3?Item.prototype._transitionTo:Item.prototype.goTo;Item.prototype.setPosition=function(x,y){this.position.x=parseInt(x,10);this.position.y=parseInt(y,10)};Item.prototype._nonTransition=function(args){this.css(args.to);if(args.isCleaning){this._removeStyles(args.to)}for(var prop in args.onTransitionEnd){args.onTransitionEnd[prop].call(this)}};Item.prototype._transition=function(args){if(!parseFloat(this.layout.options.transitionDuration)){this._nonTransition(args);return}var _transition=this._transn;for(var prop in args.onTransitionEnd){_transition.onEnd[prop]=args.onTransitionEnd[prop]}for(prop in args.to){_transition.ingProperties[prop]=true;if(args.isCleaning){_transition.clean[prop]=true}}if(args.from){this.css(args.from);var h=this.element.offsetHeight;h=null}this.enableTransition(args.to);this.css(args.to);this.isTransitioning=true};function toDashedAll(str){return str.replace(/([A-Z])/g,function($1){return"-"+$1.toLowerCase()})}var transitionProps="opacity,"+toDashedAll(vendorProperties.transform||"transform");Item.prototype.enableTransition=function(){if(this.isTransitioning){return}this.css({transitionProperty:transitionProps,transitionDuration:this.layout.options.transitionDuration});this.element.addEventListener(transitionEndEvent,this,false)};Item.prototype.transition=Item.prototype[transitionProperty?"_transition":"_nonTransition"];Item.prototype.onwebkitTransitionEnd=function(event){this.ontransitionend(event)};Item.prototype.onotransitionend=function(event){this.ontransitionend(event)};var dashedVendorProperties={"-webkit-transform":"transform","-moz-transform":"transform","-o-transform":"transform"};Item.prototype.ontransitionend=function(event){if(event.target!==this.element){return}var _transition=this._transn;var propertyName=dashedVendorProperties[event.propertyName]||event.propertyName;delete _transition.ingProperties[propertyName];if(isEmptyObj(_transition.ingProperties)){this.disableTransition()}if(propertyName in _transition.clean){this.element.style[event.propertyName]="";delete _transition.clean[propertyName]}if(propertyName in _transition.onEnd){var onTransitionEnd=_transition.onEnd[propertyName];onTransitionEnd.call(this);delete _transition.onEnd[propertyName]}this.emitEvent("transitionEnd",[this])};Item.prototype.disableTransition=function(){this.removeTransitionStyles();this.element.removeEventListener(transitionEndEvent,this,false);this.isTransitioning=false};Item.prototype._removeStyles=function(style){var cleanStyle={};for(var prop in style){cleanStyle[prop]=""}this.css(cleanStyle)};var cleanTransitionStyle={transitionProperty:"",transitionDuration:""};Item.prototype.removeTransitionStyles=function(){this.css(cleanTransitionStyle)};Item.prototype.removeElem=function(){this.element.parentNode.removeChild(this.element);this.css({display:""});this.emitEvent("remove",[this])};Item.prototype.remove=function(){if(!transitionProperty||!parseFloat(this.layout.options.transitionDuration)){this.removeElem();return}var _this=this;this.once("transitionEnd",function(){_this.removeElem()});this.hide()};Item.prototype.reveal=function(){delete this.isHidden;this.css({display:""});var options=this.layout.options;var onTransitionEnd={};var transitionEndProperty=this.getHideRevealTransitionEndProperty("visibleStyle");onTransitionEnd[transitionEndProperty]=this.onRevealTransitionEnd;this.transition({from:options.hiddenStyle,to:options.visibleStyle,isCleaning:true,onTransitionEnd:onTransitionEnd})};Item.prototype.onRevealTransitionEnd=function(){if(!this.isHidden){this.emitEvent("reveal")}};Item.prototype.getHideRevealTransitionEndProperty=function(styleProperty){var optionStyle=this.layout.options[styleProperty];if(optionStyle.opacity){return"opacity"}for(var prop in optionStyle){return prop}};Item.prototype.hide=function(){this.isHidden=true;this.css({display:""});var options=this.layout.options;var onTransitionEnd={};var transitionEndProperty=this.getHideRevealTransitionEndProperty("hiddenStyle");onTransitionEnd[transitionEndProperty]=this.onHideTransitionEnd;this.transition({from:options.visibleStyle,to:options.hiddenStyle,isCleaning:true,onTransitionEnd:onTransitionEnd})};Item.prototype.onHideTransitionEnd=function(){if(this.isHidden){this.css({display:"none"});this.emitEvent("hide")}};Item.prototype.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})};return Item})},{"wolfy87-eventemitter":"node_modules/isotope-layout/node_modules/outlayer/node_modules/wolfy87-eventemitter/EventEmitter","get-size":"node_modules/isotope-layout/node_modules/get-size/get-size","desandro-get-style-property":"node_modules/isotope-layout/node_modules/outlayer/node_modules/desandro-get-style-property/get-style-property","fizzy-ui-utils":"node_modules/isotope-layout/node_modules/fizzy-ui-utils/utils"});require.register("node_modules/isotope-layout/node_modules/outlayer/node_modules/desandro-get-style-property/get-style-property",function(require,module,exports){
(function(window){"use strict";var prefixes="Webkit Moz ms Ms O".split(" ");var docElemStyle=document.documentElement.style;function getStyleProperty(propName){if(!propName){return}if(typeof docElemStyle[propName]==="string"){return propName}propName=propName.charAt(0).toUpperCase()+propName.slice(1);var prefixed;for(var i=0,len=prefixes.length;i<len;i++){prefixed=prefixes[i]+propName;if(typeof docElemStyle[prefixed]==="string"){return prefixed}}}if(typeof define==="function"&&define.amd){define(function(){return getStyleProperty})}else if(typeof exports==="object"){module.exports=getStyleProperty}else{window.getStyleProperty=getStyleProperty}})(window)},{});require.register("node_modules/isotope-layout/node_modules/outlayer/node_modules/eventie/eventie",function(require,module,exports){(function(window){"use strict";var docElem=document.documentElement;var bind=function(){};function getIEEvent(obj){var event=window.event;event.target=event.target||event.srcElement||obj;return event}if(docElem.addEventListener){bind=function(obj,type,fn){obj.addEventListener(type,fn,false)}}else if(docElem.attachEvent){bind=function(obj,type,fn){obj[type+fn]=fn.handleEvent?function(){var event=getIEEvent(obj);fn.handleEvent.call(fn,event)}:function(){var event=getIEEvent(obj);fn.call(obj,event)};obj.attachEvent("on"+type,obj[type+fn])}}var unbind=function(){};if(docElem.removeEventListener){unbind=function(obj,type,fn){obj.removeEventListener(type,fn,false)}}else if(docElem.detachEvent){unbind=function(obj,type,fn){obj.detachEvent("on"+type,obj[type+fn]);try{delete obj[type+fn]}catch(err){obj[type+fn]=undefined}}}var eventie={bind:bind,unbind:unbind};if(typeof define==="function"&&define.amd){define(eventie)}else if(typeof exports==="object"){module.exports=eventie}else{window.eventie=eventie}})(window)},{});require.register("node_modules/isotope-layout/node_modules/outlayer/node_modules/wolfy87-eventemitter/EventEmitter",function(require,module,exports){(function(){"use strict";function EventEmitter(){}var proto=EventEmitter.prototype;var exports=this;var originalGlobalValue=exports.EventEmitter;function indexOfListener(listeners,listener){var i=listeners.length;while(i--){if(listeners[i].listener===listener){return i}}return-1}function alias(name){return function aliasClosure(){return this[name].apply(this,arguments)}}proto.getListeners=function getListeners(evt){var events=this._getEvents();var response;var key;if(evt instanceof RegExp){response={};for(key in events){if(events.hasOwnProperty(key)&&evt.test(key)){response[key]=events[key]}}}else{response=events[evt]||(events[evt]=[])}return response};proto.flattenListeners=function flattenListeners(listeners){var flatListeners=[];var i;for(i=0;i<listeners.length;i+=1){flatListeners.push(listeners[i].listener)}return flatListeners};proto.getListenersAsObject=function getListenersAsObject(evt){var listeners=this.getListeners(evt);var response;if(listeners instanceof Array){response={};response[evt]=listeners}return response||listeners};proto.addListener=function addListener(evt,listener){var listeners=this.getListenersAsObject(evt);var listenerIsWrapped=typeof listener==="object";var key;for(key in listeners){if(listeners.hasOwnProperty(key)&&indexOfListener(listeners[key],listener)===-1){listeners[key].push(listenerIsWrapped?listener:{listener:listener,once:false})}}return this};proto.on=alias("addListener");proto.addOnceListener=function addOnceListener(evt,listener){return this.addListener(evt,{listener:listener,once:true})};proto.once=alias("addOnceListener");proto.defineEvent=function defineEvent(evt){this.getListeners(evt);return this};proto.defineEvents=function defineEvents(evts){for(var i=0;i<evts.length;i+=1){this.defineEvent(evts[i])}return this};proto.removeListener=function removeListener(evt,listener){var listeners=this.getListenersAsObject(evt);var index;var key;for(key in listeners){if(listeners.hasOwnProperty(key)){index=indexOfListener(listeners[key],listener);if(index!==-1){listeners[key].splice(index,1)}}}return this};proto.off=alias("removeListener");proto.addListeners=function addListeners(evt,listeners){return this.manipulateListeners(false,evt,listeners)};proto.removeListeners=function removeListeners(evt,listeners){return this.manipulateListeners(true,evt,listeners)};proto.manipulateListeners=function manipulateListeners(remove,evt,listeners){var i;var value;var single=remove?this.removeListener:this.addListener;var multiple=remove?this.removeListeners:this.addListeners;if(typeof evt==="object"&&!(evt instanceof RegExp)){for(i in evt){if(evt.hasOwnProperty(i)&&(value=evt[i])){if(typeof value==="function"){single.call(this,i,value)}else{multiple.call(this,i,value)}}}}else{i=listeners.length;while(i--){single.call(this,evt,listeners[i])}}return this};proto.removeEvent=function removeEvent(evt){var type=typeof evt;var events=this._getEvents();var key;if(type==="string"){delete events[evt]}else if(evt instanceof RegExp){for(key in events){if(events.hasOwnProperty(key)&&evt.test(key)){delete events[key]}}}else{delete this._events}return this};proto.removeAllListeners=alias("removeEvent");proto.emitEvent=function emitEvent(evt,args){var listenersMap=this.getListenersAsObject(evt);var listeners;var listener;var i;var key;var response;for(key in listenersMap){if(listenersMap.hasOwnProperty(key)){listeners=listenersMap[key].slice(0);i=listeners.length;while(i--){listener=listeners[i];if(listener.once===true){this.removeListener(evt,listener.listener)}response=listener.listener.apply(this,args||[]);if(response===this._getOnceReturnValue()){this.removeListener(evt,listener.listener)}}}}return this};proto.trigger=alias("emitEvent");proto.emit=function emit(evt){var args=Array.prototype.slice.call(arguments,1);return this.emitEvent(evt,args)};proto.setOnceReturnValue=function setOnceReturnValue(value){this._onceReturnValue=value;return this};proto._getOnceReturnValue=function _getOnceReturnValue(){if(this.hasOwnProperty("_onceReturnValue")){return this._onceReturnValue}else{return true}};proto._getEvents=function _getEvents(){return this._events||(this._events={})};EventEmitter.noConflict=function noConflict(){exports.EventEmitter=originalGlobalValue;return EventEmitter};if(typeof define==="function"&&define.amd){define(function(){return EventEmitter})}else if(typeof module==="object"&&module.exports){module.exports=EventEmitter}else{exports.EventEmitter=EventEmitter}}).call(this)},{});require.register("node_modules/isotope-layout/node_modules/outlayer/outlayer",function(require,module,exports){(function(window,factory){"use strict";if(typeof define=="function"&&define.amd){define(["eventie/eventie","eventEmitter/EventEmitter","get-size/get-size","fizzy-ui-utils/utils","./item"],function(eventie,EventEmitter,getSize,utils,Item){return factory(window,eventie,EventEmitter,getSize,utils,Item)})}else if(typeof exports=="object"){module.exports=factory(window,require("eventie"),require("wolfy87-eventemitter"),require("get-size"),require("fizzy-ui-utils"),require("./item"))}else{window.Outlayer=factory(window,window.eventie,window.EventEmitter,window.getSize,window.fizzyUIUtils,window.Outlayer.Item)}})(window,function factory(window,eventie,EventEmitter,getSize,utils,Item){"use strict";var console=window.console;var jQuery=window.jQuery;var noop=function(){};var GUID=0;var instances={};function Outlayer(element,options){var queryElement=utils.getQueryElement(element);if(!queryElement){if(console){console.error("Bad element for "+this.constructor.namespace+": "+(queryElement||element))}return}this.element=queryElement;if(jQuery){this.$element=jQuery(this.element)}this.options=utils.extend({},this.constructor.defaults);this.option(options);var id=++GUID;this.element.outlayerGUID=id;instances[id]=this;this._create();if(this.options.isInitLayout){this.layout()}}Outlayer.namespace="outlayer";Outlayer.Item=Item;Outlayer.defaults={containerStyle:{position:"relative"},isInitLayout:true,isOriginLeft:true,isOriginTop:true,isResizeBound:true,isResizingContainer:true,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};utils.extend(Outlayer.prototype,EventEmitter.prototype);Outlayer.prototype.option=function(opts){utils.extend(this.options,opts)};Outlayer.prototype._create=function(){this.reloadItems();this.stamps=[];this.stamp(this.options.stamp);utils.extend(this.element.style,this.options.containerStyle);if(this.options.isResizeBound){this.bindResize()}};Outlayer.prototype.reloadItems=function(){this.items=this._itemize(this.element.children)};Outlayer.prototype._itemize=function(elems){var itemElems=this._filterFindItemElements(elems);var Item=this.constructor.Item;var items=[];for(var i=0,len=itemElems.length;i<len;i++){var elem=itemElems[i];var item=new Item(elem,this);items.push(item)}return items};Outlayer.prototype._filterFindItemElements=function(elems){return utils.filterFindElements(elems,this.options.itemSelector)};Outlayer.prototype.getItemElements=function(){var elems=[];for(var i=0,len=this.items.length;i<len;i++){elems.push(this.items[i].element)}return elems};Outlayer.prototype.layout=function(){this._resetLayout();this._manageStamps();var isInstant=this.options.isLayoutInstant!==undefined?this.options.isLayoutInstant:!this._isLayoutInited;this.layoutItems(this.items,isInstant);this._isLayoutInited=true};Outlayer.prototype._init=Outlayer.prototype.layout;Outlayer.prototype._resetLayout=function(){this.getSize()};Outlayer.prototype.getSize=function(){this.size=getSize(this.element)};Outlayer.prototype._getMeasurement=function(measurement,size){var option=this.options[measurement];var elem;if(!option){this[measurement]=0}else{if(typeof option==="string"){elem=this.element.querySelector(option)}else if(utils.isElement(option)){elem=option}this[measurement]=elem?getSize(elem)[size]:option}};Outlayer.prototype.layoutItems=function(items,isInstant){items=this._getItemsForLayout(items);this._layoutItems(items,isInstant);this._postLayout()};Outlayer.prototype._getItemsForLayout=function(items){var layoutItems=[];for(var i=0,len=items.length;i<len;i++){var item=items[i];if(!item.isIgnored){layoutItems.push(item)}}return layoutItems};Outlayer.prototype._layoutItems=function(items,isInstant){this._emitCompleteOnItems("layout",items);if(!items||!items.length){return}var queue=[];for(var i=0,len=items.length;i<len;i++){var item=items[i];var position=this._getItemLayoutPosition(item);position.item=item;position.isInstant=isInstant||item.isLayoutInstant;queue.push(position)}this._processLayoutQueue(queue)};Outlayer.prototype._getItemLayoutPosition=function(){return{x:0,y:0}};Outlayer.prototype._processLayoutQueue=function(queue){for(var i=0,len=queue.length;i<len;i++){var obj=queue[i];this._positionItem(obj.item,obj.x,obj.y,obj.isInstant)}};Outlayer.prototype._positionItem=function(item,x,y,isInstant){if(isInstant){item.goTo(x,y)}else{item.moveTo(x,y)}};Outlayer.prototype._postLayout=function(){this.resizeContainer()};Outlayer.prototype.resizeContainer=function(){if(!this.options.isResizingContainer){return}var size=this._getContainerSize();if(size){this._setContainerMeasure(size.width,true);this._setContainerMeasure(size.height,false)}};Outlayer.prototype._getContainerSize=noop;Outlayer.prototype._setContainerMeasure=function(measure,isWidth){if(measure===undefined){return}var elemSize=this.size;if(elemSize.isBorderBox){measure+=isWidth?elemSize.paddingLeft+elemSize.paddingRight+elemSize.borderLeftWidth+elemSize.borderRightWidth:elemSize.paddingBottom+elemSize.paddingTop+elemSize.borderTopWidth+elemSize.borderBottomWidth}measure=Math.max(measure,0);this.element.style[isWidth?"width":"height"]=measure+"px"};Outlayer.prototype._emitCompleteOnItems=function(eventName,items){var _this=this;function onComplete(){_this.dispatchEvent(eventName+"Complete",null,[items])}var count=items.length;if(!items||!count){onComplete();return}var doneCount=0;function tick(){doneCount++;if(doneCount===count){onComplete()}}for(var i=0,len=items.length;i<len;i++){var item=items[i];item.once(eventName,tick)}};Outlayer.prototype.dispatchEvent=function(type,event,args){var emitArgs=event?[event].concat(args):args;this.emitEvent(type,emitArgs);if(jQuery){this.$element=this.$element||jQuery(this.element);if(event){var $event=jQuery.Event(event);$event.type=type;this.$element.trigger($event,args)}else{this.$element.trigger(type,args)}}};Outlayer.prototype.ignore=function(elem){var item=this.getItem(elem);if(item){item.isIgnored=true}};Outlayer.prototype.unignore=function(elem){var item=this.getItem(elem);if(item){delete item.isIgnored}};Outlayer.prototype.stamp=function(elems){elems=this._find(elems);if(!elems){return}this.stamps=this.stamps.concat(elems);for(var i=0,len=elems.length;i<len;i++){var elem=elems[i];this.ignore(elem)}};Outlayer.prototype.unstamp=function(elems){elems=this._find(elems);if(!elems){return}for(var i=0,len=elems.length;i<len;i++){var elem=elems[i];utils.removeFrom(this.stamps,elem);this.unignore(elem)}};Outlayer.prototype._find=function(elems){if(!elems){return}if(typeof elems==="string"){elems=this.element.querySelectorAll(elems)}elems=utils.makeArray(elems);return elems};Outlayer.prototype._manageStamps=function(){if(!this.stamps||!this.stamps.length){return}this._getBoundingRect();for(var i=0,len=this.stamps.length;i<len;i++){var stamp=this.stamps[i];this._manageStamp(stamp)}};Outlayer.prototype._getBoundingRect=function(){var boundingRect=this.element.getBoundingClientRect();var size=this.size;this._boundingRect={left:boundingRect.left+size.paddingLeft+size.borderLeftWidth,top:boundingRect.top+size.paddingTop+size.borderTopWidth,right:boundingRect.right-(size.paddingRight+size.borderRightWidth),bottom:boundingRect.bottom-(size.paddingBottom+size.borderBottomWidth)}};Outlayer.prototype._manageStamp=noop;Outlayer.prototype._getElementOffset=function(elem){var boundingRect=elem.getBoundingClientRect();var thisRect=this._boundingRect;var size=getSize(elem);var offset={left:boundingRect.left-thisRect.left-size.marginLeft,top:boundingRect.top-thisRect.top-size.marginTop,right:thisRect.right-boundingRect.right-size.marginRight,bottom:thisRect.bottom-boundingRect.bottom-size.marginBottom};return offset};Outlayer.prototype.handleEvent=function(event){var method="on"+event.type;if(this[method]){this[method](event)}};Outlayer.prototype.bindResize=function(){if(this.isResizeBound){return}eventie.bind(window,"resize",this);this.isResizeBound=true};Outlayer.prototype.unbindResize=function(){if(this.isResizeBound){eventie.unbind(window,"resize",this)}this.isResizeBound=false};Outlayer.prototype.onresize=function(){if(this.resizeTimeout){clearTimeout(this.resizeTimeout)}var _this=this;function delayed(){_this.resize();delete _this.resizeTimeout}this.resizeTimeout=setTimeout(delayed,100)};Outlayer.prototype.resize=function(){if(!this.isResizeBound||!this.needsResizeLayout()){return}this.layout()};Outlayer.prototype.needsResizeLayout=function(){var size=getSize(this.element);var hasSizes=this.size&&size;return hasSizes&&size.innerWidth!==this.size.innerWidth};Outlayer.prototype.addItems=function(elems){var items=this._itemize(elems);if(items.length){this.items=this.items.concat(items)}return items};Outlayer.prototype.appended=function(elems){var items=this.addItems(elems);if(!items.length){return}this.layoutItems(items,true);this.reveal(items)};Outlayer.prototype.prepended=function(elems){var items=this._itemize(elems);if(!items.length){return}var previousItems=this.items.slice(0);this.items=items.concat(previousItems);this._resetLayout();this._manageStamps();this.layoutItems(items,true);this.reveal(items);this.layoutItems(previousItems)};Outlayer.prototype.reveal=function(items){this._emitCompleteOnItems("reveal",items);var len=items&&items.length;for(var i=0;len&&i<len;i++){var item=items[i];item.reveal()}};Outlayer.prototype.hide=function(items){this._emitCompleteOnItems("hide",items);var len=items&&items.length;for(var i=0;len&&i<len;i++){var item=items[i];item.hide()}};Outlayer.prototype.revealItemElements=function(elems){var items=this.getItems(elems);this.reveal(items)};Outlayer.prototype.hideItemElements=function(elems){var items=this.getItems(elems);this.hide(items)};Outlayer.prototype.getItem=function(elem){for(var i=0,len=this.items.length;i<len;i++){var item=this.items[i];if(item.element===elem){return item}}};Outlayer.prototype.getItems=function(elems){elems=utils.makeArray(elems);var items=[];for(var i=0,len=elems.length;i<len;i++){var elem=elems[i];var item=this.getItem(elem);if(item){items.push(item)}}return items};Outlayer.prototype.remove=function(elems){var removeItems=this.getItems(elems);this._emitCompleteOnItems("remove",removeItems);if(!removeItems||!removeItems.length){return}for(var i=0,len=removeItems.length;i<len;i++){var item=removeItems[i];item.remove();utils.removeFrom(this.items,item)}};Outlayer.prototype.destroy=function(){var style=this.element.style;style.height="";style.position="";style.width="";for(var i=0,len=this.items.length;i<len;i++){var item=this.items[i];item.destroy()}this.unbindResize();var id=this.element.outlayerGUID;delete instances[id];delete this.element.outlayerGUID;if(jQuery){jQuery.removeData(this.element,this.constructor.namespace)}};Outlayer.data=function(elem){elem=utils.getQueryElement(elem);var id=elem&&elem.outlayerGUID;return id&&instances[id]};Outlayer.create=function(namespace,options){function Layout(){Outlayer.apply(this,arguments)}if(Object.create){Layout.prototype=Object.create(Outlayer.prototype)}else{utils.extend(Layout.prototype,Outlayer.prototype)}Layout.prototype.constructor=Layout;Layout.defaults=utils.extend({},Outlayer.defaults);utils.extend(Layout.defaults,options);Layout.prototype.settings={};Layout.namespace=namespace;Layout.data=Outlayer.data;Layout.Item=function LayoutItem(){Item.apply(this,arguments)};Layout.Item.prototype=new Item;utils.htmlInit(Layout,namespace);if(jQuery&&jQuery.bridget){jQuery.bridget(namespace,Layout)}return Layout};Outlayer.Item=Item;return Outlayer})},{eventie:"node_modules/isotope-layout/node_modules/outlayer/node_modules/eventie/eventie","wolfy87-eventemitter":"node_modules/isotope-layout/node_modules/outlayer/node_modules/wolfy87-eventemitter/EventEmitter","get-size":"node_modules/isotope-layout/node_modules/get-size/get-size","fizzy-ui-utils":"node_modules/isotope-layout/node_modules/fizzy-ui-utils/utils","./item":"node_modules/isotope-layout/node_modules/outlayer/item"});require.register("node_modules/lodash/index",function(require,module,exports){(function(){var undefined;var VERSION="3.10.1";var BIND_FLAG=1,BIND_KEY_FLAG=2,CURRY_BOUND_FLAG=4,CURRY_FLAG=8,CURRY_RIGHT_FLAG=16,PARTIAL_FLAG=32,PARTIAL_RIGHT_FLAG=64,ARY_FLAG=128,REARG_FLAG=256;var DEFAULT_TRUNC_LENGTH=30,DEFAULT_TRUNC_OMISSION="...";var HOT_COUNT=150,HOT_SPAN=16;var LARGE_ARRAY_SIZE=200;var LAZY_FILTER_FLAG=1,LAZY_MAP_FLAG=2;var FUNC_ERROR_TEXT="Expected a function";var PLACEHOLDER="__lodash_placeholder__";var argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]";var arrayBufferTag="[object ArrayBuffer]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]";var reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var reEscapedHtml=/&(?:amp|lt|gt|quot|#39|#96);/g,reUnescapedHtml=/[&<>"'`]/g,reHasEscapedHtml=RegExp(reEscapedHtml.source),reHasUnescapedHtml=RegExp(reUnescapedHtml.source);var reEscape=/<%-([\s\S]+?)%>/g,reEvaluate=/<%([\s\S]+?)%>/g,reInterpolate=/<%=([\s\S]+?)%>/g;var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g;var reRegExpChars=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,reHasRegExpChars=RegExp(reRegExpChars.source);var reComboMark=/[\u0300-\u036f\ufe20-\ufe23]/g;var reEscapeChar=/\\(\\)?/g;var reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var reFlags=/\w*$/;var reHasHexPrefix=/^0[xX]/;var reIsHostCtor=/^\[object .+?Constructor\]$/;var reIsUint=/^\d+$/;var reLatin1=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g;var reNoMatch=/($^)/;var reUnescapedString=/['\n\r\u2028\u2029\\]/g;var reWords=function(){var upper="[A-Z\\xc0-\\xd6\\xd8-\\xde]",lower="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(upper+"+(?="+upper+lower+")|"+upper+"?"+lower+"|"+upper+"+|[0-9]+","g")}();var contextProps=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"];var templateCounter=-1;var typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=true;typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=false;var cloneableTags={};cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[stringTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=true;cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[mapTag]=cloneableTags[setTag]=cloneableTags[weakMapTag]=false;var deburredLetters={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss"};var htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"};var htmlUnescapes={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"};var objectTypes={"function":true,object:true};var regexpEscapes={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"};var stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};var freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType&&exports;var freeModule=objectTypes[typeof module]&&module&&!module.nodeType&&module;var freeGlobal=freeExports&&freeModule&&typeof global=="object"&&global&&global.Object&&global;var freeSelf=objectTypes[typeof self]&&self&&self.Object&&self;var freeWindow=objectTypes[typeof window]&&window&&window.Object&&window;var moduleExports=freeModule&&freeModule.exports===freeExports&&freeExports;var root=freeGlobal||freeWindow!==(this&&this.window)&&freeWindow||freeSelf||this;function baseCompareAscending(value,other){if(value!==other){var valIsNull=value===null,valIsUndef=value===undefined,valIsReflexive=value===value;var othIsNull=other===null,othIsUndef=other===undefined,othIsReflexive=other===other;if(value>other&&!othIsNull||!valIsReflexive||valIsNull&&!othIsUndef&&othIsReflexive||valIsUndef&&othIsReflexive){return 1}if(value<other&&!valIsNull||!othIsReflexive||othIsNull&&!valIsUndef&&valIsReflexive||othIsUndef&&valIsReflexive){return-1}}return 0}function baseFindIndex(array,predicate,fromRight){var length=array.length,index=fromRight?length:-1;while(fromRight?index--:++index<length){if(predicate(array[index],index,array)){return index}}return-1}function baseIndexOf(array,value,fromIndex){if(value!==value){return indexOfNaN(array,fromIndex)}var index=fromIndex-1,length=array.length;while(++index<length){if(array[index]===value){return index}}return-1}function baseIsFunction(value){return typeof value=="function"||false}function baseToString(value){return value==null?"":value+""}function charsLeftIndex(string,chars){var index=-1,length=string.length;while(++index<length&&chars.indexOf(string.charAt(index))>-1){}return index}function charsRightIndex(string,chars){var index=string.length;while(index--&&chars.indexOf(string.charAt(index))>-1){}return index}function compareAscending(object,other){return baseCompareAscending(object.criteria,other.criteria)||object.index-other.index}function compareMultiple(object,other,orders){var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;while(++index<length){var result=baseCompareAscending(objCriteria[index],othCriteria[index]);if(result){if(index>=ordersLength){return result}var order=orders[index];return result*(order==="asc"||order===true?1:-1)}}return object.index-other.index}function deburrLetter(letter){return deburredLetters[letter]}function escapeHtmlChar(chr){return htmlEscapes[chr]}function escapeRegExpChar(chr,leadingChar,whitespaceChar){if(leadingChar){chr=regexpEscapes[chr]}else if(whitespaceChar){chr=stringEscapes[chr]}return"\\"+chr}function escapeStringChar(chr){return"\\"+stringEscapes[chr]}function indexOfNaN(array,fromIndex,fromRight){var length=array.length,index=fromIndex+(fromRight?0:-1);while(fromRight?index--:++index<length){var other=array[index];if(other!==other){return index}}return-1}function isObjectLike(value){return!!value&&typeof value=="object"}function isSpace(charCode){return charCode<=160&&(charCode>=9&&charCode<=13)||charCode==32||charCode==160||charCode==5760||charCode==6158||charCode>=8192&&(charCode<=8202||charCode==8232||charCode==8233||charCode==8239||charCode==8287||charCode==12288||charCode==65279)}function replaceHolders(array,placeholder){var index=-1,length=array.length,resIndex=-1,result=[];while(++index<length){if(array[index]===placeholder){array[index]=PLACEHOLDER;result[++resIndex]=index}}return result}function sortedUniq(array,iteratee){var seen,index=-1,length=array.length,resIndex=-1,result=[];while(++index<length){var value=array[index],computed=iteratee?iteratee(value,index,array):value;if(!index||seen!==computed){seen=computed;result[++resIndex]=value}}return result}function trimmedLeftIndex(string){var index=-1,length=string.length;while(++index<length&&isSpace(string.charCodeAt(index))){}return index}function trimmedRightIndex(string){var index=string.length;while(index--&&isSpace(string.charCodeAt(index))){}return index}function unescapeHtmlChar(chr){return htmlUnescapes[chr]}function runInContext(context){context=context?_.defaults(root.Object(),context,_.pick(root,contextProps)):root;var Array=context.Array,Date=context.Date,Error=context.Error,Function=context.Function,Math=context.Math,Number=context.Number,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError;var arrayProto=Array.prototype,objectProto=Object.prototype,stringProto=String.prototype;var fnToString=Function.prototype.toString;var hasOwnProperty=objectProto.hasOwnProperty;var idCounter=0;var objToString=objectProto.toString;var oldDash=root._;var reIsNative=RegExp("^"+fnToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ArrayBuffer=context.ArrayBuffer,clearTimeout=context.clearTimeout,parseFloat=context.parseFloat,pow=Math.pow,propertyIsEnumerable=objectProto.propertyIsEnumerable,Set=getNative(context,"Set"),setTimeout=context.setTimeout,splice=arrayProto.splice,Uint8Array=context.Uint8Array,WeakMap=getNative(context,"WeakMap");var nativeCeil=Math.ceil,nativeCreate=getNative(Object,"create"),nativeFloor=Math.floor,nativeIsArray=getNative(Array,"isArray"),nativeIsFinite=context.isFinite,nativeKeys=getNative(Object,"keys"),nativeMax=Math.max,nativeMin=Math.min,nativeNow=getNative(Date,"now"),nativeParseInt=context.parseInt,nativeRandom=Math.random;var NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,POSITIVE_INFINITY=Number.POSITIVE_INFINITY;var MAX_ARRAY_LENGTH=4294967295,MAX_ARRAY_INDEX=MAX_ARRAY_LENGTH-1,HALF_MAX_ARRAY_LENGTH=MAX_ARRAY_LENGTH>>>1;var MAX_SAFE_INTEGER=9007199254740991;var metaMap=WeakMap&&new WeakMap;var realNames={};function lodash(value){if(isObjectLike(value)&&!isArray(value)&&!(value instanceof LazyWrapper)){if(value instanceof LodashWrapper){return value}if(hasOwnProperty.call(value,"__chain__")&&hasOwnProperty.call(value,"__wrapped__")){return wrapperClone(value)}}return new LodashWrapper(value)}function baseLodash(){}function LodashWrapper(value,chainAll,actions){this.__wrapped__=value;this.__actions__=actions||[];this.__chain__=!!chainAll}var support=lodash.support={};lodash.templateSettings={escape:reEscape,evaluate:reEvaluate,interpolate:reInterpolate,variable:"",imports:{_:lodash}};function LazyWrapper(value){this.__wrapped__=value;this.__actions__=[];this.__dir__=1;this.__filtered__=false;this.__iteratees__=[];this.__takeCount__=POSITIVE_INFINITY;this.__views__=[]}function lazyClone(){var result=new LazyWrapper(this.__wrapped__);result.__actions__=arrayCopy(this.__actions__);result.__dir__=this.__dir__;result.__filtered__=this.__filtered__;result.__iteratees__=arrayCopy(this.__iteratees__);result.__takeCount__=this.__takeCount__;result.__views__=arrayCopy(this.__views__);return result}function lazyReverse(){if(this.__filtered__){var result=new LazyWrapper(this);result.__dir__=-1;result.__filtered__=true}else{result=this.clone();result.__dir__*=-1}return result}function lazyValue(){var array=this.__wrapped__.value(),dir=this.__dir__,isArr=isArray(array),isRight=dir<0,arrLength=isArr?array.length:0,view=getView(0,arrLength,this.__views__),start=view.start,end=view.end,length=end-start,index=isRight?end:start-1,iteratees=this.__iteratees__,iterLength=iteratees.length,resIndex=0,takeCount=nativeMin(length,this.__takeCount__);if(!isArr||arrLength<LARGE_ARRAY_SIZE||arrLength==length&&takeCount==length){return baseWrapperValue(isRight&&isArr?array.reverse():array,this.__actions__)}var result=[];outer:while(length--&&resIndex<takeCount){index+=dir;var iterIndex=-1,value=array[index];while(++iterIndex<iterLength){var data=iteratees[iterIndex],iteratee=data.iteratee,type=data.type,computed=iteratee(value);if(type==LAZY_MAP_FLAG){value=computed}else if(!computed){if(type==LAZY_FILTER_FLAG){continue outer}else{break outer}}}result[resIndex++]=value}return result}function MapCache(){this.__data__={}}function mapDelete(key){return this.has(key)&&delete this.__data__[key]}function mapGet(key){return key=="__proto__"?undefined:this.__data__[key]}function mapHas(key){return key!="__proto__"&&hasOwnProperty.call(this.__data__,key)}function mapSet(key,value){if(key!="__proto__"){this.__data__[key]=value}return this}function SetCache(values){var length=values?values.length:0;
this.data={hash:nativeCreate(null),set:new Set};while(length--){this.push(values[length])}}function cacheIndexOf(cache,value){var data=cache.data,result=typeof value=="string"||isObject(value)?data.set.has(value):data.hash[value];return result?0:-1}function cachePush(value){var data=this.data;if(typeof value=="string"||isObject(value)){data.set.add(value)}else{data.hash[value]=true}}function arrayConcat(array,other){var index=-1,length=array.length,othIndex=-1,othLength=other.length,result=Array(length+othLength);while(++index<length){result[index]=array[index]}while(++othIndex<othLength){result[index++]=other[othIndex]}return result}function arrayCopy(source,array){var index=-1,length=source.length;array||(array=Array(length));while(++index<length){array[index]=source[index]}return array}function arrayEach(array,iteratee){var index=-1,length=array.length;while(++index<length){if(iteratee(array[index],index,array)===false){break}}return array}function arrayEachRight(array,iteratee){var length=array.length;while(length--){if(iteratee(array[length],length,array)===false){break}}return array}function arrayEvery(array,predicate){var index=-1,length=array.length;while(++index<length){if(!predicate(array[index],index,array)){return false}}return true}function arrayExtremum(array,iteratee,comparator,exValue){var index=-1,length=array.length,computed=exValue,result=computed;while(++index<length){var value=array[index],current=+iteratee(value);if(comparator(current,computed)){computed=current;result=value}}return result}function arrayFilter(array,predicate){var index=-1,length=array.length,resIndex=-1,result=[];while(++index<length){var value=array[index];if(predicate(value,index,array)){result[++resIndex]=value}}return result}function arrayMap(array,iteratee){var index=-1,length=array.length,result=Array(length);while(++index<length){result[index]=iteratee(array[index],index,array)}return result}function arrayPush(array,values){var index=-1,length=values.length,offset=array.length;while(++index<length){array[offset+index]=values[index]}return array}function arrayReduce(array,iteratee,accumulator,initFromArray){var index=-1,length=array.length;if(initFromArray&&length){accumulator=array[++index]}while(++index<length){accumulator=iteratee(accumulator,array[index],index,array)}return accumulator}function arrayReduceRight(array,iteratee,accumulator,initFromArray){var length=array.length;if(initFromArray&&length){accumulator=array[--length]}while(length--){accumulator=iteratee(accumulator,array[length],length,array)}return accumulator}function arraySome(array,predicate){var index=-1,length=array.length;while(++index<length){if(predicate(array[index],index,array)){return true}}return false}function arraySum(array,iteratee){var length=array.length,result=0;while(length--){result+=+iteratee(array[length])||0}return result}function assignDefaults(objectValue,sourceValue){return objectValue===undefined?sourceValue:objectValue}function assignOwnDefaults(objectValue,sourceValue,key,object){return objectValue===undefined||!hasOwnProperty.call(object,key)?sourceValue:objectValue}function assignWith(object,source,customizer){var index=-1,props=keys(source),length=props.length;while(++index<length){var key=props[index],value=object[key],result=customizer(value,source[key],key,object,source);if((result===result?result!==value:value===value)||value===undefined&&!(key in object)){object[key]=result}}return object}function baseAssign(object,source){return source==null?object:baseCopy(source,keys(source),object)}function baseAt(collection,props){var index=-1,isNil=collection==null,isArr=!isNil&&isArrayLike(collection),length=isArr?collection.length:0,propsLength=props.length,result=Array(propsLength);while(++index<propsLength){var key=props[index];if(isArr){result[index]=isIndex(key,length)?collection[key]:undefined}else{result[index]=isNil?undefined:collection[key]}}return result}function baseCopy(source,props,object){object||(object={});var index=-1,length=props.length;while(++index<length){var key=props[index];object[key]=source[key]}return object}function baseCallback(func,thisArg,argCount){var type=typeof func;if(type=="function"){return thisArg===undefined?func:bindCallback(func,thisArg,argCount)}if(func==null){return identity}if(type=="object"){return baseMatches(func)}return thisArg===undefined?property(func):baseMatchesProperty(func,thisArg)}function baseClone(value,isDeep,customizer,key,object,stackA,stackB){var result;if(customizer){result=object?customizer(value,key,object):customizer(value)}if(result!==undefined){return result}if(!isObject(value)){return value}var isArr=isArray(value);if(isArr){result=initCloneArray(value);if(!isDeep){return arrayCopy(value,result)}}else{var tag=objToString.call(value),isFunc=tag==funcTag;if(tag==objectTag||tag==argsTag||isFunc&&!object){result=initCloneObject(isFunc?{}:value);if(!isDeep){return baseAssign(result,value)}}else{return cloneableTags[tag]?initCloneByTag(value,tag,isDeep):object?value:{}}}stackA||(stackA=[]);stackB||(stackB=[]);var length=stackA.length;while(length--){if(stackA[length]==value){return stackB[length]}}stackA.push(value);stackB.push(result);(isArr?arrayEach:baseForOwn)(value,function(subValue,key){result[key]=baseClone(subValue,isDeep,customizer,key,value,stackA,stackB)});return result}var baseCreate=function(){function object(){}return function(prototype){if(isObject(prototype)){object.prototype=prototype;var result=new object;object.prototype=undefined}return result||{}}}();function baseDelay(func,wait,args){if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}return setTimeout(function(){func.apply(undefined,args)},wait)}function baseDifference(array,values){var length=array?array.length:0,result=[];if(!length){return result}var index=-1,indexOf=getIndexOf(),isCommon=indexOf==baseIndexOf,cache=isCommon&&values.length>=LARGE_ARRAY_SIZE?createCache(values):null,valuesLength=values.length;if(cache){indexOf=cacheIndexOf;isCommon=false;values=cache}outer:while(++index<length){var value=array[index];if(isCommon&&value===value){var valuesIndex=valuesLength;while(valuesIndex--){if(values[valuesIndex]===value){continue outer}}result.push(value)}else if(indexOf(values,value,0)<0){result.push(value)}}return result}var baseEach=createBaseEach(baseForOwn);var baseEachRight=createBaseEach(baseForOwnRight,true);function baseEvery(collection,predicate){var result=true;baseEach(collection,function(value,index,collection){result=!!predicate(value,index,collection);return result});return result}function baseExtremum(collection,iteratee,comparator,exValue){var computed=exValue,result=computed;baseEach(collection,function(value,index,collection){var current=+iteratee(value,index,collection);if(comparator(current,computed)||current===exValue&&current===result){computed=current;result=value}});return result}function baseFill(array,value,start,end){var length=array.length;start=start==null?0:+start||0;if(start<0){start=-start>length?0:length+start}end=end===undefined||end>length?length:+end||0;if(end<0){end+=length}length=start>end?0:end>>>0;start>>>=0;while(start<length){array[start++]=value}return array}function baseFilter(collection,predicate){var result=[];baseEach(collection,function(value,index,collection){if(predicate(value,index,collection)){result.push(value)}});return result}function baseFind(collection,predicate,eachFunc,retKey){var result;eachFunc(collection,function(value,key,collection){if(predicate(value,key,collection)){result=retKey?key:value;return false}});return result}function baseFlatten(array,isDeep,isStrict,result){result||(result=[]);var index=-1,length=array.length;while(++index<length){var value=array[index];if(isObjectLike(value)&&isArrayLike(value)&&(isStrict||isArray(value)||isArguments(value))){if(isDeep){baseFlatten(value,isDeep,isStrict,result)}else{arrayPush(result,value)}}else if(!isStrict){result[result.length]=value}}return result}var baseFor=createBaseFor();var baseForRight=createBaseFor(true);function baseForIn(object,iteratee){return baseFor(object,iteratee,keysIn)}function baseForOwn(object,iteratee){return baseFor(object,iteratee,keys)}function baseForOwnRight(object,iteratee){return baseForRight(object,iteratee,keys)}function baseFunctions(object,props){var index=-1,length=props.length,resIndex=-1,result=[];while(++index<length){var key=props[index];if(isFunction(object[key])){result[++resIndex]=key}}return result}function baseGet(object,path,pathKey){if(object==null){return}if(pathKey!==undefined&&pathKey in toObject(object)){path=[pathKey]}var index=0,length=path.length;while(object!=null&&index<length){object=object[path[index++]]}return index&&index==length?object:undefined}function baseIsEqual(value,other,customizer,isLoose,stackA,stackB){if(value===other){return true}if(value==null||other==null||!isObject(value)&&!isObjectLike(other)){return value!==value&&other!==other}return baseIsEqualDeep(value,other,baseIsEqual,customizer,isLoose,stackA,stackB)}function baseIsEqualDeep(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=arrayTag,othTag=arrayTag;if(!objIsArr){objTag=objToString.call(object);if(objTag==argsTag){objTag=objectTag}else if(objTag!=objectTag){objIsArr=isTypedArray(object)}}if(!othIsArr){othTag=objToString.call(other);if(othTag==argsTag){othTag=objectTag}else if(othTag!=objectTag){othIsArr=isTypedArray(other)}}var objIsObj=objTag==objectTag,othIsObj=othTag==objectTag,isSameTag=objTag==othTag;if(isSameTag&&!(objIsArr||objIsObj)){return equalByTag(object,other,objTag)}if(!isLoose){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){return equalFunc(objIsWrapped?object.value():object,othIsWrapped?other.value():other,customizer,isLoose,stackA,stackB)}}if(!isSameTag){return false}stackA||(stackA=[]);stackB||(stackB=[]);var length=stackA.length;while(length--){if(stackA[length]==object){return stackB[length]==other}}stackA.push(object);stackB.push(other);var result=(objIsArr?equalArrays:equalObjects)(object,other,equalFunc,customizer,isLoose,stackA,stackB);stackA.pop();stackB.pop();return result}function baseIsMatch(object,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(object==null){return!length}object=toObject(object);while(index--){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object)){return false}}while(++index<length){data=matchData[index];var key=data[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(objValue===undefined&&!(key in object)){return false}}else{var result=customizer?customizer(objValue,srcValue,key):undefined;if(!(result===undefined?baseIsEqual(srcValue,objValue,customizer,true):result)){return false}}}return true}function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];baseEach(collection,function(value,key,collection){result[++index]=iteratee(value,key,collection)});return result}function baseMatches(source){var matchData=getMatchData(source);if(matchData.length==1&&matchData[0][2]){var key=matchData[0][0],value=matchData[0][1];return function(object){if(object==null){return false}return object[key]===value&&(value!==undefined||key in toObject(object))}}return function(object){return baseIsMatch(object,matchData)}}function baseMatchesProperty(path,srcValue){var isArr=isArray(path),isCommon=isKey(path)&&isStrictComparable(srcValue),pathKey=path+"";path=toPath(path);return function(object){if(object==null){return false}var key=pathKey;object=toObject(object);if((isArr||!isCommon)&&!(key in object)){object=path.length==1?object:baseGet(object,baseSlice(path,0,-1));if(object==null){return false}key=last(path);object=toObject(object)}return object[key]===srcValue?srcValue!==undefined||key in object:baseIsEqual(srcValue,object[key],undefined,true)}}function baseMerge(object,source,customizer,stackA,stackB){if(!isObject(object)){return object}var isSrcArr=isArrayLike(source)&&(isArray(source)||isTypedArray(source)),props=isSrcArr?undefined:keys(source);arrayEach(props||source,function(srcValue,key){if(props){key=srcValue;srcValue=source[key]}if(isObjectLike(srcValue)){stackA||(stackA=[]);stackB||(stackB=[]);baseMergeDeep(object,source,key,baseMerge,customizer,stackA,stackB)}else{var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;if(isCommon){result=srcValue}if((result!==undefined||isSrcArr&&!(key in object))&&(isCommon||(result===result?result!==value:value===value))){object[key]=result}}});return object}function baseMergeDeep(object,source,key,mergeFunc,customizer,stackA,stackB){var length=stackA.length,srcValue=source[key];while(length--){if(stackA[length]==srcValue){object[key]=stackB[length];return}}var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;if(isCommon){result=srcValue;if(isArrayLike(srcValue)&&(isArray(srcValue)||isTypedArray(srcValue))){result=isArray(value)?value:isArrayLike(value)?arrayCopy(value):[]}else if(isPlainObject(srcValue)||isArguments(srcValue)){result=isArguments(value)?toPlainObject(value):isPlainObject(value)?value:{}}else{isCommon=false}}stackA.push(srcValue);stackB.push(result);if(isCommon){object[key]=mergeFunc(result,srcValue,customizer,stackA,stackB)}else if(result===result?result!==value:value===value){object[key]=result}}function baseProperty(key){return function(object){return object==null?undefined:object[key]}}function basePropertyDeep(path){var pathKey=path+"";path=toPath(path);return function(object){return baseGet(object,path,pathKey)}}function basePullAt(array,indexes){var length=array?indexes.length:0;while(length--){var index=indexes[length];if(index!=previous&&isIndex(index)){var previous=index;splice.call(array,index,1)}}return array}function baseRandom(min,max){return min+nativeFloor(nativeRandom()*(max-min+1))}function baseReduce(collection,iteratee,accumulator,initFromCollection,eachFunc){eachFunc(collection,function(value,index,collection){accumulator=initFromCollection?(initFromCollection=false,value):iteratee(accumulator,value,index,collection)});return accumulator}var baseSetData=!metaMap?identity:function(func,data){metaMap.set(func,data);return func};function baseSlice(array,start,end){var index=-1,length=array.length;start=start==null?0:+start||0;if(start<0){start=-start>length?0:length+start}end=end===undefined||end>length?length:+end||0;if(end<0){end+=length}length=start>end?0:end-start>>>0;start>>>=0;var result=Array(length);while(++index<length){result[index]=array[index+start]}return result}function baseSome(collection,predicate){var result;baseEach(collection,function(value,index,collection){result=predicate(value,index,collection);return!result});return!!result}function baseSortBy(array,comparer){var length=array.length;array.sort(comparer);while(length--){array[length]=array[length].value}return array}function baseSortByOrder(collection,iteratees,orders){var callback=getCallback(),index=-1;iteratees=arrayMap(iteratees,function(iteratee){return callback(iteratee)});var result=baseMap(collection,function(value){var criteria=arrayMap(iteratees,function(iteratee){return iteratee(value)});return{criteria:criteria,index:++index,value:value}});return baseSortBy(result,function(object,other){return compareMultiple(object,other,orders)})}function baseSum(collection,iteratee){var result=0;baseEach(collection,function(value,index,collection){result+=+iteratee(value,index,collection)||0});return result}function baseUniq(array,iteratee){var index=-1,indexOf=getIndexOf(),length=array.length,isCommon=indexOf==baseIndexOf,isLarge=isCommon&&length>=LARGE_ARRAY_SIZE,seen=isLarge?createCache():null,result=[];if(seen){indexOf=cacheIndexOf;isCommon=false}else{isLarge=false;seen=iteratee?[]:result}outer:while(++index<length){var value=array[index],computed=iteratee?iteratee(value,index,array):value;if(isCommon&&value===value){var seenIndex=seen.length;while(seenIndex--){if(seen[seenIndex]===computed){continue outer}}if(iteratee){seen.push(computed)}result.push(value)}else if(indexOf(seen,computed,0)<0){if(iteratee||isLarge){seen.push(computed)}result.push(value)}}return result}function baseValues(object,props){var index=-1,length=props.length,result=Array(length);while(++index<length){result[index]=object[props[index]]}return result}function baseWhile(array,predicate,isDrop,fromRight){var length=array.length,index=fromRight?length:-1;while((fromRight?index--:++index<length)&&predicate(array[index],index,array)){}return isDrop?baseSlice(array,fromRight?0:index,fromRight?index+1:length):baseSlice(array,fromRight?index+1:0,fromRight?length:index)}function baseWrapperValue(value,actions){var result=value;if(result instanceof LazyWrapper){result=result.value()}var index=-1,length=actions.length;while(++index<length){var action=actions[index];result=action.func.apply(action.thisArg,arrayPush([result],action.args))}return result}function binaryIndex(array,value,retHighest){var low=0,high=array?array.length:low;if(typeof value=="number"&&value===value&&high<=HALF_MAX_ARRAY_LENGTH){while(low<high){var mid=low+high>>>1,computed=array[mid];if((retHighest?computed<=value:computed<value)&&computed!==null){low=mid+1}else{high=mid}}return high}return binaryIndexBy(array,value,identity,retHighest)}function binaryIndexBy(array,value,iteratee,retHighest){value=iteratee(value);var low=0,high=array?array.length:0,valIsNaN=value!==value,valIsNull=value===null,valIsUndef=value===undefined;while(low<high){var mid=nativeFloor((low+high)/2),computed=iteratee(array[mid]),isDef=computed!==undefined,isReflexive=computed===computed;if(valIsNaN){var setLow=isReflexive||retHighest}else if(valIsNull){setLow=isReflexive&&isDef&&(retHighest||computed!=null)}else if(valIsUndef){setLow=isReflexive&&(retHighest||isDef)}else if(computed==null){setLow=false}else{setLow=retHighest?computed<=value:computed<value}if(setLow){low=mid+1}else{high=mid}}return nativeMin(high,MAX_ARRAY_INDEX)}function bindCallback(func,thisArg,argCount){if(typeof func!="function"){return identity}if(thisArg===undefined){return func}switch(argCount){case 1:return function(value){return func.call(thisArg,value)};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)};case 5:return function(value,other,key,object,source){return func.call(thisArg,value,other,key,object,source)}}return function(){return func.apply(thisArg,arguments)}}function bufferClone(buffer){var result=new ArrayBuffer(buffer.byteLength),view=new Uint8Array(result);view.set(new Uint8Array(buffer));return result}function composeArgs(args,partials,holders){var holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),leftIndex=-1,leftLength=partials.length,result=Array(leftLength+argsLength);while(++leftIndex<leftLength){result[leftIndex]=partials[leftIndex]}while(++argsIndex<holdersLength){result[holders[argsIndex]]=args[argsIndex]}while(argsLength--){result[leftIndex++]=args[argsIndex++]}return result}function composeArgsRight(args,partials,holders){var holdersIndex=-1,holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),rightIndex=-1,rightLength=partials.length,result=Array(argsLength+rightLength);while(++argsIndex<argsLength){result[argsIndex]=args[argsIndex]}var offset=argsIndex;while(++rightIndex<rightLength){result[offset+rightIndex]=partials[rightIndex]}while(++holdersIndex<holdersLength){result[offset+holders[holdersIndex]]=args[argsIndex++]}return result}function createAggregator(setter,initializer){return function(collection,iteratee,thisArg){var result=initializer?initializer():{};iteratee=getCallback(iteratee,thisArg,3);if(isArray(collection)){var index=-1,length=collection.length;while(++index<length){var value=collection[index];setter(result,value,iteratee(value,index,collection),collection)}}else{baseEach(collection,function(value,key,collection){setter(result,value,iteratee(value,key,collection),collection)})}return result}}function createAssigner(assigner){return restParam(function(object,sources){var index=-1,length=object==null?0:sources.length,customizer=length>2?sources[length-2]:undefined,guard=length>2?sources[2]:undefined,thisArg=length>1?sources[length-1]:undefined;if(typeof customizer=="function"){customizer=bindCallback(customizer,thisArg,5);length-=2}else{customizer=typeof thisArg=="function"?thisArg:undefined;length-=customizer?1:0}if(guard&&isIterateeCall(sources[0],sources[1],guard)){customizer=length<3?undefined:customizer;length=1}while(++index<length){var source=sources[index];if(source){assigner(object,source,customizer)}}return object})}function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){var length=collection?getLength(collection):0;if(!isLength(length)){return eachFunc(collection,iteratee)}var index=fromRight?length:-1,iterable=toObject(collection);while(fromRight?index--:++index<length){if(iteratee(iterable[index],index,iterable)===false){break}}return collection}}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){var iterable=toObject(object),props=keysFunc(object),length=props.length,index=fromRight?length:-1;while(fromRight?index--:++index<length){var key=props[index];if(iteratee(iterable[key],key,iterable)===false){break}}return object}}function createBindWrapper(func,thisArg){var Ctor=createCtorWrapper(func);function wrapper(){var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return fn.apply(thisArg,arguments)}return wrapper}function createCache(values){return nativeCreate&&Set?new SetCache(values):null}function createCompounder(callback){return function(string){var index=-1,array=words(deburr(string)),length=array.length,result="";while(++index<length){result=callback(result,array[index],index)}return result}}function createCtorWrapper(Ctor){return function(){var args=arguments;switch(args.length){case 0:return new Ctor;case 1:return new Ctor(args[0]);case 2:return new Ctor(args[0],args[1]);case 3:return new Ctor(args[0],args[1],args[2]);case 4:return new Ctor(args[0],args[1],args[2],args[3]);case 5:return new Ctor(args[0],args[1],args[2],args[3],args[4]);case 6:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5],args[6])}var thisBinding=baseCreate(Ctor.prototype),result=Ctor.apply(thisBinding,args);return isObject(result)?result:thisBinding}}function createCurry(flag){function curryFunc(func,arity,guard){if(guard&&isIterateeCall(func,arity,guard)){arity=undefined}var result=createWrapper(func,flag,undefined,undefined,undefined,undefined,undefined,arity);result.placeholder=curryFunc.placeholder;return result}return curryFunc}function createDefaults(assigner,customizer){return restParam(function(args){var object=args[0];if(object==null){return object}args.push(customizer);return assigner.apply(undefined,args)})}function createExtremum(comparator,exValue){return function(collection,iteratee,thisArg){if(thisArg&&isIterateeCall(collection,iteratee,thisArg)){iteratee=undefined}iteratee=getCallback(iteratee,thisArg,3);if(iteratee.length==1){collection=isArray(collection)?collection:toIterable(collection);var result=arrayExtremum(collection,iteratee,comparator,exValue);if(!(collection.length&&result===exValue)){return result}}return baseExtremum(collection,iteratee,comparator,exValue)}}function createFind(eachFunc,fromRight){return function(collection,predicate,thisArg){predicate=getCallback(predicate,thisArg,3);if(isArray(collection)){var index=baseFindIndex(collection,predicate,fromRight);return index>-1?collection[index]:undefined}return baseFind(collection,predicate,eachFunc)}}function createFindIndex(fromRight){return function(array,predicate,thisArg){if(!(array&&array.length)){return-1}predicate=getCallback(predicate,thisArg,3);return baseFindIndex(array,predicate,fromRight)}}function createFindKey(objectFunc){return function(object,predicate,thisArg){predicate=getCallback(predicate,thisArg,3);return baseFind(object,predicate,objectFunc,true)}}function createFlow(fromRight){return function(){var wrapper,length=arguments.length,index=fromRight?length:-1,leftIndex=0,funcs=Array(length);while(fromRight?index--:++index<length){var func=funcs[leftIndex++]=arguments[index];if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}if(!wrapper&&LodashWrapper.prototype.thru&&getFuncName(func)=="wrapper"){wrapper=new LodashWrapper([],true)}}index=wrapper?-1:length;while(++index<length){func=funcs[index];var funcName=getFuncName(func),data=funcName=="wrapper"?getData(func):undefined;if(data&&isLaziable(data[0])&&data[1]==(ARY_FLAG|CURRY_FLAG|PARTIAL_FLAG|REARG_FLAG)&&!data[4].length&&data[9]==1){wrapper=wrapper[getFuncName(data[0])].apply(wrapper,data[3])}else{wrapper=func.length==1&&isLaziable(func)?wrapper[funcName]():wrapper.thru(func)}}return function(){var args=arguments,value=args[0];if(wrapper&&args.length==1&&isArray(value)&&value.length>=LARGE_ARRAY_SIZE){return wrapper.plant(value).value()}var index=0,result=length?funcs[index].apply(this,args):value;while(++index<length){result=funcs[index].call(this,result)}return result}}}function createForEach(arrayFunc,eachFunc){return function(collection,iteratee,thisArg){return typeof iteratee=="function"&&thisArg===undefined&&isArray(collection)?arrayFunc(collection,iteratee):eachFunc(collection,bindCallback(iteratee,thisArg,3))}}function createForIn(objectFunc){return function(object,iteratee,thisArg){if(typeof iteratee!="function"||thisArg!==undefined){iteratee=bindCallback(iteratee,thisArg,3)}return objectFunc(object,iteratee,keysIn)}}function createForOwn(objectFunc){return function(object,iteratee,thisArg){if(typeof iteratee!="function"||thisArg!==undefined){iteratee=bindCallback(iteratee,thisArg,3)}return objectFunc(object,iteratee)}}function createObjectMapper(isMapKeys){return function(object,iteratee,thisArg){var result={};iteratee=getCallback(iteratee,thisArg,3);baseForOwn(object,function(value,key,object){var mapped=iteratee(value,key,object);key=isMapKeys?mapped:key;value=isMapKeys?value:mapped;result[key]=value});return result}}function createPadDir(fromRight){return function(string,length,chars){string=baseToString(string);return(fromRight?string:"")+createPadding(string,length,chars)+(fromRight?"":string)}}function createPartial(flag){var partialFunc=restParam(function(func,partials){var holders=replaceHolders(partials,partialFunc.placeholder);return createWrapper(func,flag,undefined,partials,holders)});return partialFunc}function createReduce(arrayFunc,eachFunc){return function(collection,iteratee,accumulator,thisArg){var initFromArray=arguments.length<3;return typeof iteratee=="function"&&thisArg===undefined&&isArray(collection)?arrayFunc(collection,iteratee,accumulator,initFromArray):baseReduce(collection,getCallback(iteratee,thisArg,4),accumulator,initFromArray,eachFunc)}}function createHybridWrapper(func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity){var isAry=bitmask&ARY_FLAG,isBind=bitmask&BIND_FLAG,isBindKey=bitmask&BIND_KEY_FLAG,isCurry=bitmask&CURRY_FLAG,isCurryBound=bitmask&CURRY_BOUND_FLAG,isCurryRight=bitmask&CURRY_RIGHT_FLAG,Ctor=isBindKey?undefined:createCtorWrapper(func);function wrapper(){var length=arguments.length,index=length,args=Array(length);while(index--){args[index]=arguments[index]}if(partials){args=composeArgs(args,partials,holders)}if(partialsRight){args=composeArgsRight(args,partialsRight,holdersRight)}if(isCurry||isCurryRight){var placeholder=wrapper.placeholder,argsHolders=replaceHolders(args,placeholder);length-=argsHolders.length;if(length<arity){var newArgPos=argPos?arrayCopy(argPos):undefined,newArity=nativeMax(arity-length,0),newsHolders=isCurry?argsHolders:undefined,newHoldersRight=isCurry?undefined:argsHolders,newPartials=isCurry?args:undefined,newPartialsRight=isCurry?undefined:args;bitmask|=isCurry?PARTIAL_FLAG:PARTIAL_RIGHT_FLAG;bitmask&=~(isCurry?PARTIAL_RIGHT_FLAG:PARTIAL_FLAG);if(!isCurryBound){bitmask&=~(BIND_FLAG|BIND_KEY_FLAG)}var newData=[func,bitmask,thisArg,newPartials,newsHolders,newPartialsRight,newHoldersRight,newArgPos,ary,newArity],result=createHybridWrapper.apply(undefined,newData);if(isLaziable(func)){setData(result,newData)}result.placeholder=placeholder;return result}}var thisBinding=isBind?thisArg:this,fn=isBindKey?thisBinding[func]:func;if(argPos){args=reorder(args,argPos)}if(isAry&&ary<args.length){args.length=ary}if(this&&this!==root&&this instanceof wrapper){fn=Ctor||createCtorWrapper(func)}return fn.apply(thisBinding,args)}return wrapper}function createPadding(string,length,chars){var strLength=string.length;length=+length;if(strLength>=length||!nativeIsFinite(length)){return""}var padLength=length-strLength;chars=chars==null?" ":chars+"";return repeat(chars,nativeCeil(padLength/chars.length)).slice(0,padLength)}function createPartialWrapper(func,bitmask,thisArg,partials){var isBind=bitmask&BIND_FLAG,Ctor=createCtorWrapper(func);function wrapper(){var argsIndex=-1,argsLength=arguments.length,leftIndex=-1,leftLength=partials.length,args=Array(leftLength+argsLength);while(++leftIndex<leftLength){args[leftIndex]=partials[leftIndex]}while(argsLength--){args[leftIndex++]=arguments[++argsIndex]}var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return fn.apply(isBind?thisArg:this,args)}return wrapper}function createRound(methodName){var func=Math[methodName];return function(number,precision){precision=precision===undefined?0:+precision||0;if(precision){precision=pow(10,precision);return func(number*precision)/precision}return func(number)}}function createSortedIndex(retHighest){return function(array,value,iteratee,thisArg){var callback=getCallback(iteratee);return iteratee==null&&callback===baseCallback?binaryIndex(array,value,retHighest):binaryIndexBy(array,value,callback(iteratee,thisArg,1),retHighest)}}function createWrapper(func,bitmask,thisArg,partials,holders,argPos,ary,arity){var isBindKey=bitmask&BIND_KEY_FLAG;if(!isBindKey&&typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}var length=partials?partials.length:0;if(!length){bitmask&=~(PARTIAL_FLAG|PARTIAL_RIGHT_FLAG);partials=holders=undefined}length-=holders?holders.length:0;if(bitmask&PARTIAL_RIGHT_FLAG){var partialsRight=partials,holdersRight=holders;partials=holders=undefined}var data=isBindKey?undefined:getData(func),newData=[func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity];if(data){mergeData(newData,data);bitmask=newData[1];arity=newData[9]}newData[9]=arity==null?isBindKey?0:func.length:nativeMax(arity-length,0)||0;if(bitmask==BIND_FLAG){var result=createBindWrapper(newData[0],newData[2])}else if((bitmask==PARTIAL_FLAG||bitmask==(BIND_FLAG|PARTIAL_FLAG))&&!newData[4].length){result=createPartialWrapper.apply(undefined,newData)}else{result=createHybridWrapper.apply(undefined,newData)}var setter=data?baseSetData:setData;return setter(result,newData)}function equalArrays(array,other,equalFunc,customizer,isLoose,stackA,stackB){var index=-1,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isLoose&&othLength>arrLength)){return false}while(++index<arrLength){var arrValue=array[index],othValue=other[index],result=customizer?customizer(isLoose?othValue:arrValue,isLoose?arrValue:othValue,index):undefined;if(result!==undefined){if(result){continue}return false}if(isLoose){if(!arraySome(other,function(othValue){return arrValue===othValue||equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB)})){return false}}else if(!(arrValue===othValue||equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB))){
return false}}return true}function equalByTag(object,other,tag){switch(tag){case boolTag:case dateTag:return+object==+other;case errorTag:return object.name==other.name&&object.message==other.message;case numberTag:return object!=+object?other!=+other:object==+other;case regexpTag:case stringTag:return object==other+""}return false}function equalObjects(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objProps=keys(object),objLength=objProps.length,othProps=keys(other),othLength=othProps.length;if(objLength!=othLength&&!isLoose){return false}var index=objLength;while(index--){var key=objProps[index];if(!(isLoose?key in other:hasOwnProperty.call(other,key))){return false}}var skipCtor=isLoose;while(++index<objLength){key=objProps[index];var objValue=object[key],othValue=other[key],result=customizer?customizer(isLoose?othValue:objValue,isLoose?objValue:othValue,key):undefined;if(!(result===undefined?equalFunc(objValue,othValue,customizer,isLoose,stackA,stackB):result)){return false}skipCtor||(skipCtor=key=="constructor")}if(!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;if(objCtor!=othCtor&&("constructor"in object&&"constructor"in other)&&!(typeof objCtor=="function"&&objCtor instanceof objCtor&&typeof othCtor=="function"&&othCtor instanceof othCtor)){return false}}return true}function getCallback(func,thisArg,argCount){var result=lodash.callback||callback;result=result===callback?baseCallback:result;return argCount?result(func,thisArg,argCount):result}var getData=!metaMap?noop:function(func){return metaMap.get(func)};function getFuncName(func){var result=func.name,array=realNames[result],length=array?array.length:0;while(length--){var data=array[length],otherFunc=data.func;if(otherFunc==null||otherFunc==func){return data.name}}return result}function getIndexOf(collection,target,fromIndex){var result=lodash.indexOf||indexOf;result=result===indexOf?baseIndexOf:result;return collection?result(collection,target,fromIndex):result}var getLength=baseProperty("length");function getMatchData(object){var result=pairs(object),length=result.length;while(length--){result[length][2]=isStrictComparable(result[length][1])}return result}function getNative(object,key){var value=object==null?undefined:object[key];return isNative(value)?value:undefined}function getView(start,end,transforms){var index=-1,length=transforms.length;while(++index<length){var data=transforms[index],size=data.size;switch(data.type){case"drop":start+=size;break;case"dropRight":end-=size;break;case"take":end=nativeMin(end,start+size);break;case"takeRight":start=nativeMax(start,end-size);break}}return{start:start,end:end}}function initCloneArray(array){var length=array.length,result=new array.constructor(length);if(length&&typeof array[0]=="string"&&hasOwnProperty.call(array,"index")){result.index=array.index;result.input=array.input}return result}function initCloneObject(object){var Ctor=object.constructor;if(!(typeof Ctor=="function"&&Ctor instanceof Ctor)){Ctor=Object}return new Ctor}function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag:return bufferClone(object);case boolTag:case dateTag:return new Ctor(+object);case float32Tag:case float64Tag:case int8Tag:case int16Tag:case int32Tag:case uint8Tag:case uint8ClampedTag:case uint16Tag:case uint32Tag:var buffer=object.buffer;return new Ctor(isDeep?bufferClone(buffer):buffer,object.byteOffset,object.length);case numberTag:case stringTag:return new Ctor(object);case regexpTag:var result=new Ctor(object.source,reFlags.exec(object));result.lastIndex=object.lastIndex}return result}function invokePath(object,path,args){if(object!=null&&!isKey(path,object)){path=toPath(path);object=path.length==1?object:baseGet(object,baseSlice(path,0,-1));path=last(path)}var func=object==null?object:object[path];return func==null?undefined:func.apply(object,args)}function isArrayLike(value){return value!=null&&isLength(getLength(value))}function isIndex(value,length){value=typeof value=="number"||reIsUint.test(value)?+value:-1;length=length==null?MAX_SAFE_INTEGER:length;return value>-1&&value%1==0&&value<length}function isIterateeCall(value,index,object){if(!isObject(object)){return false}var type=typeof index;if(type=="number"?isArrayLike(object)&&isIndex(index,object.length):type=="string"&&index in object){var other=object[index];return value===value?value===other:other!==other}return false}function isKey(value,object){var type=typeof value;if(type=="string"&&reIsPlainProp.test(value)||type=="number"){return true}if(isArray(value)){return false}var result=!reIsDeepProp.test(value);return result||object!=null&&value in toObject(object)}function isLaziable(func){var funcName=getFuncName(func);if(!(funcName in LazyWrapper.prototype)){return false}var other=lodash[funcName];if(func===other){return true}var data=getData(other);return!!data&&func===data[0]}function isLength(value){return typeof value=="number"&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}function isStrictComparable(value){return value===value&&!isObject(value)}function mergeData(data,source){var bitmask=data[1],srcBitmask=source[1],newBitmask=bitmask|srcBitmask,isCommon=newBitmask<ARY_FLAG;var isCombo=srcBitmask==ARY_FLAG&&bitmask==CURRY_FLAG||srcBitmask==ARY_FLAG&&bitmask==REARG_FLAG&&data[7].length<=source[8]||srcBitmask==(ARY_FLAG|REARG_FLAG)&&bitmask==CURRY_FLAG;if(!(isCommon||isCombo)){return data}if(srcBitmask&BIND_FLAG){data[2]=source[2];newBitmask|=bitmask&BIND_FLAG?0:CURRY_BOUND_FLAG}var value=source[3];if(value){var partials=data[3];data[3]=partials?composeArgs(partials,value,source[4]):arrayCopy(value);data[4]=partials?replaceHolders(data[3],PLACEHOLDER):arrayCopy(source[4])}value=source[5];if(value){partials=data[5];data[5]=partials?composeArgsRight(partials,value,source[6]):arrayCopy(value);data[6]=partials?replaceHolders(data[5],PLACEHOLDER):arrayCopy(source[6])}value=source[7];if(value){data[7]=arrayCopy(value)}if(srcBitmask&ARY_FLAG){data[8]=data[8]==null?source[8]:nativeMin(data[8],source[8])}if(data[9]==null){data[9]=source[9]}data[0]=source[0];data[1]=newBitmask;return data}function mergeDefaults(objectValue,sourceValue){return objectValue===undefined?sourceValue:merge(objectValue,sourceValue,mergeDefaults)}function pickByArray(object,props){object=toObject(object);var index=-1,length=props.length,result={};while(++index<length){var key=props[index];if(key in object){result[key]=object[key]}}return result}function pickByCallback(object,predicate){var result={};baseForIn(object,function(value,key,object){if(predicate(value,key,object)){result[key]=value}});return result}function reorder(array,indexes){var arrLength=array.length,length=nativeMin(indexes.length,arrLength),oldArray=arrayCopy(array);while(length--){var index=indexes[length];array[length]=isIndex(index,arrLength)?oldArray[index]:undefined}return array}var setData=function(){var count=0,lastCalled=0;return function(key,value){var stamp=now(),remaining=HOT_SPAN-(stamp-lastCalled);lastCalled=stamp;if(remaining>0){if(++count>=HOT_COUNT){return key}}else{count=0}return baseSetData(key,value)}}();function shimKeys(object){var props=keysIn(object),propsLength=props.length,length=propsLength&&object.length;var allowIndexes=!!length&&isLength(length)&&(isArray(object)||isArguments(object));var index=-1,result=[];while(++index<propsLength){var key=props[index];if(allowIndexes&&isIndex(key,length)||hasOwnProperty.call(object,key)){result.push(key)}}return result}function toIterable(value){if(value==null){return[]}if(!isArrayLike(value)){return values(value)}return isObject(value)?value:Object(value)}function toObject(value){return isObject(value)?value:Object(value)}function toPath(value){if(isArray(value)){return value}var result=[];baseToString(value).replace(rePropName,function(match,number,quote,string){result.push(quote?string.replace(reEscapeChar,"$1"):number||match)});return result}function wrapperClone(wrapper){return wrapper instanceof LazyWrapper?wrapper.clone():new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__,arrayCopy(wrapper.__actions__))}function chunk(array,size,guard){if(guard?isIterateeCall(array,size,guard):size==null){size=1}else{size=nativeMax(nativeFloor(size)||1,1)}var index=0,length=array?array.length:0,resIndex=-1,result=Array(nativeCeil(length/size));while(index<length){result[++resIndex]=baseSlice(array,index,index+=size)}return result}function compact(array){var index=-1,length=array?array.length:0,resIndex=-1,result=[];while(++index<length){var value=array[index];if(value){result[++resIndex]=value}}return result}var difference=restParam(function(array,values){return isObjectLike(array)&&isArrayLike(array)?baseDifference(array,baseFlatten(values,false,true)):[]});function drop(array,n,guard){var length=array?array.length:0;if(!length){return[]}if(guard?isIterateeCall(array,n,guard):n==null){n=1}return baseSlice(array,n<0?0:n)}function dropRight(array,n,guard){var length=array?array.length:0;if(!length){return[]}if(guard?isIterateeCall(array,n,guard):n==null){n=1}n=length-(+n||0);return baseSlice(array,0,n<0?0:n)}function dropRightWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),true,true):[]}function dropWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),true):[]}function fill(array,value,start,end){var length=array?array.length:0;if(!length){return[]}if(start&&typeof start!="number"&&isIterateeCall(array,value,start)){start=0;end=length}return baseFill(array,value,start,end)}var findIndex=createFindIndex();var findLastIndex=createFindIndex(true);function first(array){return array?array[0]:undefined}function flatten(array,isDeep,guard){var length=array?array.length:0;if(guard&&isIterateeCall(array,isDeep,guard)){isDeep=false}return length?baseFlatten(array,isDeep):[]}function flattenDeep(array){var length=array?array.length:0;return length?baseFlatten(array,true):[]}function indexOf(array,value,fromIndex){var length=array?array.length:0;if(!length){return-1}if(typeof fromIndex=="number"){fromIndex=fromIndex<0?nativeMax(length+fromIndex,0):fromIndex}else if(fromIndex){var index=binaryIndex(array,value);if(index<length&&(value===value?value===array[index]:array[index]!==array[index])){return index}return-1}return baseIndexOf(array,value,fromIndex||0)}function initial(array){return dropRight(array,1)}var intersection=restParam(function(arrays){var othLength=arrays.length,othIndex=othLength,caches=Array(length),indexOf=getIndexOf(),isCommon=indexOf==baseIndexOf,result=[];while(othIndex--){var value=arrays[othIndex]=isArrayLike(value=arrays[othIndex])?value:[];caches[othIndex]=isCommon&&value.length>=120?createCache(othIndex&&value):null}var array=arrays[0],index=-1,length=array?array.length:0,seen=caches[0];outer:while(++index<length){value=array[index];if((seen?cacheIndexOf(seen,value):indexOf(result,value,0))<0){var othIndex=othLength;while(--othIndex){var cache=caches[othIndex];if((cache?cacheIndexOf(cache,value):indexOf(arrays[othIndex],value,0))<0){continue outer}}if(seen){seen.push(value)}result.push(value)}}return result});function last(array){var length=array?array.length:0;return length?array[length-1]:undefined}function lastIndexOf(array,value,fromIndex){var length=array?array.length:0;if(!length){return-1}var index=length;if(typeof fromIndex=="number"){index=(fromIndex<0?nativeMax(length+fromIndex,0):nativeMin(fromIndex||0,length-1))+1}else if(fromIndex){index=binaryIndex(array,value,true)-1;var other=array[index];if(value===value?value===other:other!==other){return index}return-1}if(value!==value){return indexOfNaN(array,index,true)}while(index--){if(array[index]===value){return index}}return-1}function pull(){var args=arguments,array=args[0];if(!(array&&array.length)){return array}var index=0,indexOf=getIndexOf(),length=args.length;while(++index<length){var fromIndex=0,value=args[index];while((fromIndex=indexOf(array,value,fromIndex))>-1){splice.call(array,fromIndex,1)}}return array}var pullAt=restParam(function(array,indexes){indexes=baseFlatten(indexes);var result=baseAt(array,indexes);basePullAt(array,indexes.sort(baseCompareAscending));return result});function remove(array,predicate,thisArg){var result=[];if(!(array&&array.length)){return result}var index=-1,indexes=[],length=array.length;predicate=getCallback(predicate,thisArg,3);while(++index<length){var value=array[index];if(predicate(value,index,array)){result.push(value);indexes.push(index)}}basePullAt(array,indexes);return result}function rest(array){return drop(array,1)}function slice(array,start,end){var length=array?array.length:0;if(!length){return[]}if(end&&typeof end!="number"&&isIterateeCall(array,start,end)){start=0;end=length}return baseSlice(array,start,end)}var sortedIndex=createSortedIndex();var sortedLastIndex=createSortedIndex(true);function take(array,n,guard){var length=array?array.length:0;if(!length){return[]}if(guard?isIterateeCall(array,n,guard):n==null){n=1}return baseSlice(array,0,n<0?0:n)}function takeRight(array,n,guard){var length=array?array.length:0;if(!length){return[]}if(guard?isIterateeCall(array,n,guard):n==null){n=1}n=length-(+n||0);return baseSlice(array,n<0?0:n)}function takeRightWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),false,true):[]}function takeWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3)):[]}var union=restParam(function(arrays){return baseUniq(baseFlatten(arrays,false,true))});function uniq(array,isSorted,iteratee,thisArg){var length=array?array.length:0;if(!length){return[]}if(isSorted!=null&&typeof isSorted!="boolean"){thisArg=iteratee;iteratee=isIterateeCall(array,isSorted,thisArg)?undefined:isSorted;isSorted=false}var callback=getCallback();if(!(iteratee==null&&callback===baseCallback)){iteratee=callback(iteratee,thisArg,3)}return isSorted&&getIndexOf()==baseIndexOf?sortedUniq(array,iteratee):baseUniq(array,iteratee)}function unzip(array){if(!(array&&array.length)){return[]}var index=-1,length=0;array=arrayFilter(array,function(group){if(isArrayLike(group)){length=nativeMax(group.length,length);return true}});var result=Array(length);while(++index<length){result[index]=arrayMap(array,baseProperty(index))}return result}function unzipWith(array,iteratee,thisArg){var length=array?array.length:0;if(!length){return[]}var result=unzip(array);if(iteratee==null){return result}iteratee=bindCallback(iteratee,thisArg,4);return arrayMap(result,function(group){return arrayReduce(group,iteratee,undefined,true)})}var without=restParam(function(array,values){return isArrayLike(array)?baseDifference(array,values):[]});function xor(){var index=-1,length=arguments.length;while(++index<length){var array=arguments[index];if(isArrayLike(array)){var result=result?arrayPush(baseDifference(result,array),baseDifference(array,result)):array}}return result?baseUniq(result):[]}var zip=restParam(unzip);function zipObject(props,values){var index=-1,length=props?props.length:0,result={};if(length&&!values&&!isArray(props[0])){values=[]}while(++index<length){var key=props[index];if(values){result[key]=values[index]}else if(key){result[key[0]]=key[1]}}return result}var zipWith=restParam(function(arrays){var length=arrays.length,iteratee=length>2?arrays[length-2]:undefined,thisArg=length>1?arrays[length-1]:undefined;if(length>2&&typeof iteratee=="function"){length-=2}else{iteratee=length>1&&typeof thisArg=="function"?(--length,thisArg):undefined;thisArg=undefined}arrays.length=length;return unzipWith(arrays,iteratee,thisArg)});function chain(value){var result=lodash(value);result.__chain__=true;return result}function tap(value,interceptor,thisArg){interceptor.call(thisArg,value);return value}function thru(value,interceptor,thisArg){return interceptor.call(thisArg,value)}function wrapperChain(){return chain(this)}function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__)}var wrapperConcat=restParam(function(values){values=baseFlatten(values);return this.thru(function(array){return arrayConcat(isArray(array)?array:[toObject(array)],values)})});function wrapperPlant(value){var result,parent=this;while(parent instanceof baseLodash){var clone=wrapperClone(parent);if(result){previous.__wrapped__=clone}else{result=clone}var previous=clone;parent=parent.__wrapped__}previous.__wrapped__=value;return result}function wrapperReverse(){var value=this.__wrapped__;var interceptor=function(value){return wrapped&&wrapped.__dir__<0?value:value.reverse()};if(value instanceof LazyWrapper){var wrapped=value;if(this.__actions__.length){wrapped=new LazyWrapper(this)}wrapped=wrapped.reverse();wrapped.__actions__.push({func:thru,args:[interceptor],thisArg:undefined});return new LodashWrapper(wrapped,this.__chain__)}return this.thru(interceptor)}function wrapperToString(){return this.value()+""}function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__)}var at=restParam(function(collection,props){return baseAt(collection,baseFlatten(props))});var countBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?++result[key]:result[key]=1});function every(collection,predicate,thisArg){var func=isArray(collection)?arrayEvery:baseEvery;if(thisArg&&isIterateeCall(collection,predicate,thisArg)){predicate=undefined}if(typeof predicate!="function"||thisArg!==undefined){predicate=getCallback(predicate,thisArg,3)}return func(collection,predicate)}function filter(collection,predicate,thisArg){var func=isArray(collection)?arrayFilter:baseFilter;predicate=getCallback(predicate,thisArg,3);return func(collection,predicate)}var find=createFind(baseEach);var findLast=createFind(baseEachRight,true);function findWhere(collection,source){return find(collection,baseMatches(source))}var forEach=createForEach(arrayEach,baseEach);var forEachRight=createForEach(arrayEachRight,baseEachRight);var groupBy=createAggregator(function(result,value,key){if(hasOwnProperty.call(result,key)){result[key].push(value)}else{result[key]=[value]}});function includes(collection,target,fromIndex,guard){var length=collection?getLength(collection):0;if(!isLength(length)){collection=values(collection);length=collection.length}if(typeof fromIndex!="number"||guard&&isIterateeCall(target,fromIndex,guard)){fromIndex=0}else{fromIndex=fromIndex<0?nativeMax(length+fromIndex,0):fromIndex||0}return typeof collection=="string"||!isArray(collection)&&isString(collection)?fromIndex<=length&&collection.indexOf(target,fromIndex)>-1:!!length&&getIndexOf(collection,target,fromIndex)>-1}var indexBy=createAggregator(function(result,value,key){result[key]=value});var invoke=restParam(function(collection,path,args){var index=-1,isFunc=typeof path=="function",isProp=isKey(path),result=isArrayLike(collection)?Array(collection.length):[];baseEach(collection,function(value){var func=isFunc?path:isProp&&value!=null?value[path]:undefined;result[++index]=func?func.apply(value,args):invokePath(value,path,args)});return result});function map(collection,iteratee,thisArg){var func=isArray(collection)?arrayMap:baseMap;iteratee=getCallback(iteratee,thisArg,3);return func(collection,iteratee)}var partition=createAggregator(function(result,value,key){result[key?0:1].push(value)},function(){return[[],[]]});function pluck(collection,path){return map(collection,property(path))}var reduce=createReduce(arrayReduce,baseEach);var reduceRight=createReduce(arrayReduceRight,baseEachRight);function reject(collection,predicate,thisArg){var func=isArray(collection)?arrayFilter:baseFilter;predicate=getCallback(predicate,thisArg,3);return func(collection,function(value,index,collection){return!predicate(value,index,collection)})}function sample(collection,n,guard){if(guard?isIterateeCall(collection,n,guard):n==null){collection=toIterable(collection);var length=collection.length;return length>0?collection[baseRandom(0,length-1)]:undefined}var index=-1,result=toArray(collection),length=result.length,lastIndex=length-1;n=nativeMin(n<0?0:+n||0,length);while(++index<n){var rand=baseRandom(index,lastIndex),value=result[rand];result[rand]=result[index];result[index]=value}result.length=n;return result}function shuffle(collection){return sample(collection,POSITIVE_INFINITY)}function size(collection){var length=collection?getLength(collection):0;return isLength(length)?length:keys(collection).length}function some(collection,predicate,thisArg){var func=isArray(collection)?arraySome:baseSome;if(thisArg&&isIterateeCall(collection,predicate,thisArg)){predicate=undefined}if(typeof predicate!="function"||thisArg!==undefined){predicate=getCallback(predicate,thisArg,3)}return func(collection,predicate)}function sortBy(collection,iteratee,thisArg){if(collection==null){return[]}if(thisArg&&isIterateeCall(collection,iteratee,thisArg)){iteratee=undefined}var index=-1;iteratee=getCallback(iteratee,thisArg,3);var result=baseMap(collection,function(value,key,collection){return{criteria:iteratee(value,key,collection),index:++index,value:value}});return baseSortBy(result,compareAscending)}var sortByAll=restParam(function(collection,iteratees){if(collection==null){return[]}var guard=iteratees[2];if(guard&&isIterateeCall(iteratees[0],iteratees[1],guard)){iteratees.length=1}return baseSortByOrder(collection,baseFlatten(iteratees),[])});function sortByOrder(collection,iteratees,orders,guard){if(collection==null){return[]}if(guard&&isIterateeCall(iteratees,orders,guard)){orders=undefined}if(!isArray(iteratees)){iteratees=iteratees==null?[]:[iteratees]}if(!isArray(orders)){orders=orders==null?[]:[orders]}return baseSortByOrder(collection,iteratees,orders)}function where(collection,source){return filter(collection,baseMatches(source))}var now=nativeNow||function(){return(new Date).getTime()};function after(n,func){if(typeof func!="function"){if(typeof n=="function"){var temp=n;n=func;func=temp}else{throw new TypeError(FUNC_ERROR_TEXT)}}n=nativeIsFinite(n=+n)?n:0;return function(){if(--n<1){return func.apply(this,arguments)}}}function ary(func,n,guard){if(guard&&isIterateeCall(func,n,guard)){n=undefined}n=func&&n==null?func.length:nativeMax(+n||0,0);return createWrapper(func,ARY_FLAG,undefined,undefined,undefined,undefined,n)}function before(n,func){var result;if(typeof func!="function"){if(typeof n=="function"){var temp=n;n=func;func=temp}else{throw new TypeError(FUNC_ERROR_TEXT)}}return function(){if(--n>0){result=func.apply(this,arguments)}if(n<=1){func=undefined}return result}}var bind=restParam(function(func,thisArg,partials){var bitmask=BIND_FLAG;if(partials.length){var holders=replaceHolders(partials,bind.placeholder);bitmask|=PARTIAL_FLAG}return createWrapper(func,bitmask,thisArg,partials,holders)});var bindAll=restParam(function(object,methodNames){methodNames=methodNames.length?baseFlatten(methodNames):functions(object);var index=-1,length=methodNames.length;while(++index<length){var key=methodNames[index];object[key]=createWrapper(object[key],BIND_FLAG,object)}return object});var bindKey=restParam(function(object,key,partials){var bitmask=BIND_FLAG|BIND_KEY_FLAG;if(partials.length){var holders=replaceHolders(partials,bindKey.placeholder);bitmask|=PARTIAL_FLAG}return createWrapper(key,bitmask,object,partials,holders)});var curry=createCurry(CURRY_FLAG);var curryRight=createCurry(CURRY_RIGHT_FLAG);function debounce(func,wait,options){var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=false,trailing=true;if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}wait=wait<0?0:+wait||0;if(options===true){var leading=true;trailing=false}else if(isObject(options)){leading=!!options.leading;maxWait="maxWait"in options&&nativeMax(+options.maxWait||0,wait);trailing="trailing"in options?!!options.trailing:trailing}function cancel(){if(timeoutId){clearTimeout(timeoutId)}if(maxTimeoutId){clearTimeout(maxTimeoutId)}lastCalled=0;maxTimeoutId=timeoutId=trailingCall=undefined}function complete(isCalled,id){if(id){clearTimeout(id)}maxTimeoutId=timeoutId=trailingCall=undefined;if(isCalled){lastCalled=now();result=func.apply(thisArg,args);if(!timeoutId&&!maxTimeoutId){args=thisArg=undefined}}}function delayed(){var remaining=wait-(now()-stamp);if(remaining<=0||remaining>wait){complete(trailingCall,maxTimeoutId)}else{timeoutId=setTimeout(delayed,remaining)}}function maxDelayed(){complete(trailing,timeoutId)}function debounced(){args=arguments;stamp=now();thisArg=this;trailingCall=trailing&&(timeoutId||!leading);if(maxWait===false){var leadingCall=leading&&!timeoutId}else{if(!maxTimeoutId&&!leading){lastCalled=stamp}var remaining=maxWait-(stamp-lastCalled),isCalled=remaining<=0||remaining>maxWait;if(isCalled){if(maxTimeoutId){maxTimeoutId=clearTimeout(maxTimeoutId)}lastCalled=stamp;result=func.apply(thisArg,args)}else if(!maxTimeoutId){maxTimeoutId=setTimeout(maxDelayed,remaining)}}if(isCalled&&timeoutId){timeoutId=clearTimeout(timeoutId)}else if(!timeoutId&&wait!==maxWait){timeoutId=setTimeout(delayed,wait)}if(leadingCall){isCalled=true;result=func.apply(thisArg,args)}if(isCalled&&!timeoutId&&!maxTimeoutId){args=thisArg=undefined}return result}debounced.cancel=cancel;return debounced}var defer=restParam(function(func,args){return baseDelay(func,1,args)});var delay=restParam(function(func,wait,args){return baseDelay(func,wait,args)});var flow=createFlow();var flowRight=createFlow(true);function memoize(func,resolver){if(typeof func!="function"||resolver&&typeof resolver!="function"){throw new TypeError(FUNC_ERROR_TEXT)}var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key)){return cache.get(key)}var result=func.apply(this,args);memoized.cache=cache.set(key,result);return result};memoized.cache=new memoize.Cache;return memoized}var modArgs=restParam(function(func,transforms){transforms=baseFlatten(transforms);if(typeof func!="function"||!arrayEvery(transforms,baseIsFunction)){throw new TypeError(FUNC_ERROR_TEXT)}var length=transforms.length;return restParam(function(args){var index=nativeMin(args.length,length);while(index--){args[index]=transforms[index](args[index])}return func.apply(this,args)})});function negate(predicate){if(typeof predicate!="function"){throw new TypeError(FUNC_ERROR_TEXT)}return function(){return!predicate.apply(this,arguments)}}function once(func){return before(2,func)}var partial=createPartial(PARTIAL_FLAG);var partialRight=createPartial(PARTIAL_RIGHT_FLAG);var rearg=restParam(function(func,indexes){return createWrapper(func,REARG_FLAG,undefined,undefined,undefined,baseFlatten(indexes))});function restParam(func,start){if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}start=nativeMax(start===undefined?func.length-1:+start||0,0);return function(){var args=arguments,index=-1,length=nativeMax(args.length-start,0),rest=Array(length);while(++index<length){rest[index]=args[start+index]}switch(start){case 0:return func.call(this,rest);case 1:return func.call(this,args[0],rest);case 2:return func.call(this,args[0],args[1],rest)}var otherArgs=Array(start+1);index=-1;while(++index<start){otherArgs[index]=args[index]}otherArgs[start]=rest;return func.apply(this,otherArgs)}}function spread(func){if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}return function(array){return func.apply(this,array)}}function throttle(func,wait,options){var leading=true,trailing=true;if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}if(options===false){leading=false}else if(isObject(options)){leading="leading"in options?!!options.leading:leading;trailing="trailing"in options?!!options.trailing:trailing}return debounce(func,wait,{leading:leading,maxWait:+wait,trailing:trailing})}function wrap(value,wrapper){wrapper=wrapper==null?identity:wrapper;return createWrapper(wrapper,PARTIAL_FLAG,undefined,[value],[])}function clone(value,isDeep,customizer,thisArg){if(isDeep&&typeof isDeep!="boolean"&&isIterateeCall(value,isDeep,customizer)){isDeep=false}else if(typeof isDeep=="function"){thisArg=customizer;customizer=isDeep;isDeep=false}return typeof customizer=="function"?baseClone(value,isDeep,bindCallback(customizer,thisArg,1)):baseClone(value,isDeep)}function cloneDeep(value,customizer,thisArg){return typeof customizer=="function"?baseClone(value,true,bindCallback(customizer,thisArg,1)):baseClone(value,true)}function gt(value,other){return value>other}function gte(value,other){return value>=other}function isArguments(value){return isObjectLike(value)&&isArrayLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")}var isArray=nativeIsArray||function(value){return isObjectLike(value)&&isLength(value.length)&&objToString.call(value)==arrayTag};function isBoolean(value){return value===true||value===false||isObjectLike(value)&&objToString.call(value)==boolTag}function isDate(value){return isObjectLike(value)&&objToString.call(value)==dateTag}function isElement(value){return!!value&&value.nodeType===1&&isObjectLike(value)&&!isPlainObject(value)}function isEmpty(value){if(value==null){return true}if(isArrayLike(value)&&(isArray(value)||isString(value)||isArguments(value)||isObjectLike(value)&&isFunction(value.splice))){return!value.length}return!keys(value).length}function isEqual(value,other,customizer,thisArg){customizer=typeof customizer=="function"?bindCallback(customizer,thisArg,3):undefined;var result=customizer?customizer(value,other):undefined;return result===undefined?baseIsEqual(value,other,customizer):!!result}function isError(value){return isObjectLike(value)&&typeof value.message=="string"&&objToString.call(value)==errorTag}function isFinite(value){return typeof value=="number"&&nativeIsFinite(value)}function isFunction(value){return isObject(value)&&objToString.call(value)==funcTag}function isObject(value){var type=typeof value;return!!value&&(type=="object"||type=="function")}function isMatch(object,source,customizer,thisArg){customizer=typeof customizer=="function"?bindCallback(customizer,thisArg,3):undefined;return baseIsMatch(object,getMatchData(source),customizer)}function isNaN(value){return isNumber(value)&&value!=+value}function isNative(value){if(value==null){return false}if(isFunction(value)){return reIsNative.test(fnToString.call(value))}return isObjectLike(value)&&reIsHostCtor.test(value)}function isNull(value){return value===null}function isNumber(value){return typeof value=="number"||isObjectLike(value)&&objToString.call(value)==numberTag}function isPlainObject(value){var Ctor;if(!(isObjectLike(value)&&objToString.call(value)==objectTag&&!isArguments(value))||!hasOwnProperty.call(value,"constructor")&&(Ctor=value.constructor,typeof Ctor=="function"&&!(Ctor instanceof Ctor))){return false}var result;baseForIn(value,function(subValue,key){result=key});return result===undefined||hasOwnProperty.call(value,result)}function isRegExp(value){return isObject(value)&&objToString.call(value)==regexpTag}function isString(value){return typeof value=="string"||isObjectLike(value)&&objToString.call(value)==stringTag}function isTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[objToString.call(value)]}function isUndefined(value){return value===undefined}function lt(value,other){return value<other}function lte(value,other){return value<=other}function toArray(value){var length=value?getLength(value):0;if(!isLength(length)){return values(value)}if(!length){return[]}return arrayCopy(value)}function toPlainObject(value){return baseCopy(value,keysIn(value))}var merge=createAssigner(baseMerge);var assign=createAssigner(function(object,source,customizer){return customizer?assignWith(object,source,customizer):baseAssign(object,source)});function create(prototype,properties,guard){var result=baseCreate(prototype);if(guard&&isIterateeCall(prototype,properties,guard)){properties=undefined}return properties?baseAssign(result,properties):result;
}var defaults=createDefaults(assign,assignDefaults);var defaultsDeep=createDefaults(merge,mergeDefaults);var findKey=createFindKey(baseForOwn);var findLastKey=createFindKey(baseForOwnRight);var forIn=createForIn(baseFor);var forInRight=createForIn(baseForRight);var forOwn=createForOwn(baseForOwn);var forOwnRight=createForOwn(baseForOwnRight);function functions(object){return baseFunctions(object,keysIn(object))}function get(object,path,defaultValue){var result=object==null?undefined:baseGet(object,toPath(path),path+"");return result===undefined?defaultValue:result}function has(object,path){if(object==null){return false}var result=hasOwnProperty.call(object,path);if(!result&&!isKey(path)){path=toPath(path);object=path.length==1?object:baseGet(object,baseSlice(path,0,-1));if(object==null){return false}path=last(path);result=hasOwnProperty.call(object,path)}return result||isLength(object.length)&&isIndex(path,object.length)&&(isArray(object)||isArguments(object))}function invert(object,multiValue,guard){if(guard&&isIterateeCall(object,multiValue,guard)){multiValue=undefined}var index=-1,props=keys(object),length=props.length,result={};while(++index<length){var key=props[index],value=object[key];if(multiValue){if(hasOwnProperty.call(result,value)){result[value].push(key)}else{result[value]=[key]}}else{result[value]=key}}return result}var keys=!nativeKeys?shimKeys:function(object){var Ctor=object==null?undefined:object.constructor;if(typeof Ctor=="function"&&Ctor.prototype===object||typeof object!="function"&&isArrayLike(object)){return shimKeys(object)}return isObject(object)?nativeKeys(object):[]};function keysIn(object){if(object==null){return[]}if(!isObject(object)){object=Object(object)}var length=object.length;length=length&&isLength(length)&&(isArray(object)||isArguments(object))&&length||0;var Ctor=object.constructor,index=-1,isProto=typeof Ctor=="function"&&Ctor.prototype===object,result=Array(length),skipIndexes=length>0;while(++index<length){result[index]=index+""}for(var key in object){if(!(skipIndexes&&isIndex(key,length))&&!(key=="constructor"&&(isProto||!hasOwnProperty.call(object,key)))){result.push(key)}}return result}var mapKeys=createObjectMapper(true);var mapValues=createObjectMapper();var omit=restParam(function(object,props){if(object==null){return{}}if(typeof props[0]!="function"){var props=arrayMap(baseFlatten(props),String);return pickByArray(object,baseDifference(keysIn(object),props))}var predicate=bindCallback(props[0],props[1],3);return pickByCallback(object,function(value,key,object){return!predicate(value,key,object)})});function pairs(object){object=toObject(object);var index=-1,props=keys(object),length=props.length,result=Array(length);while(++index<length){var key=props[index];result[index]=[key,object[key]]}return result}var pick=restParam(function(object,props){if(object==null){return{}}return typeof props[0]=="function"?pickByCallback(object,bindCallback(props[0],props[1],3)):pickByArray(object,baseFlatten(props))});function result(object,path,defaultValue){var result=object==null?undefined:object[path];if(result===undefined){if(object!=null&&!isKey(path,object)){path=toPath(path);object=path.length==1?object:baseGet(object,baseSlice(path,0,-1));result=object==null?undefined:object[last(path)]}result=result===undefined?defaultValue:result}return isFunction(result)?result.call(object):result}function set(object,path,value){if(object==null){return object}var pathKey=path+"";path=object[pathKey]!=null||isKey(path,object)?[pathKey]:toPath(path);var index=-1,length=path.length,lastIndex=length-1,nested=object;while(nested!=null&&++index<length){var key=path[index];if(isObject(nested)){if(index==lastIndex){nested[key]=value}else if(nested[key]==null){nested[key]=isIndex(path[index+1])?[]:{}}}nested=nested[key]}return object}function transform(object,iteratee,accumulator,thisArg){var isArr=isArray(object)||isTypedArray(object);iteratee=getCallback(iteratee,thisArg,4);if(accumulator==null){if(isArr||isObject(object)){var Ctor=object.constructor;if(isArr){accumulator=isArray(object)?new Ctor:[]}else{accumulator=baseCreate(isFunction(Ctor)?Ctor.prototype:undefined)}}else{accumulator={}}}(isArr?arrayEach:baseForOwn)(object,function(value,index,object){return iteratee(accumulator,value,index,object)});return accumulator}function values(object){return baseValues(object,keys(object))}function valuesIn(object){return baseValues(object,keysIn(object))}function inRange(value,start,end){start=+start||0;if(end===undefined){end=start;start=0}else{end=+end||0}return value>=nativeMin(start,end)&&value<nativeMax(start,end)}function random(min,max,floating){if(floating&&isIterateeCall(min,max,floating)){max=floating=undefined}var noMin=min==null,noMax=max==null;if(floating==null){if(noMax&&typeof min=="boolean"){floating=min;min=1}else if(typeof max=="boolean"){floating=max;noMax=true}}if(noMin&&noMax){max=1;noMax=false}min=+min||0;if(noMax){max=min;min=0}else{max=+max||0}if(floating||min%1||max%1){var rand=nativeRandom();return nativeMin(min+rand*(max-min+parseFloat("1e-"+((rand+"").length-1))),max)}return baseRandom(min,max)}var camelCase=createCompounder(function(result,word,index){word=word.toLowerCase();return result+(index?word.charAt(0).toUpperCase()+word.slice(1):word)});function capitalize(string){string=baseToString(string);return string&&string.charAt(0).toUpperCase()+string.slice(1)}function deburr(string){string=baseToString(string);return string&&string.replace(reLatin1,deburrLetter).replace(reComboMark,"")}function endsWith(string,target,position){string=baseToString(string);target=target+"";var length=string.length;position=position===undefined?length:nativeMin(position<0?0:+position||0,length);position-=target.length;return position>=0&&string.indexOf(target,position)==position}function escape(string){string=baseToString(string);return string&&reHasUnescapedHtml.test(string)?string.replace(reUnescapedHtml,escapeHtmlChar):string}function escapeRegExp(string){string=baseToString(string);return string&&reHasRegExpChars.test(string)?string.replace(reRegExpChars,escapeRegExpChar):string||"(?:)"}var kebabCase=createCompounder(function(result,word,index){return result+(index?"-":"")+word.toLowerCase()});function pad(string,length,chars){string=baseToString(string);length=+length;var strLength=string.length;if(strLength>=length||!nativeIsFinite(length)){return string}var mid=(length-strLength)/2,leftLength=nativeFloor(mid),rightLength=nativeCeil(mid);chars=createPadding("",rightLength,chars);return chars.slice(0,leftLength)+string+chars}var padLeft=createPadDir();var padRight=createPadDir(true);function parseInt(string,radix,guard){if(guard?isIterateeCall(string,radix,guard):radix==null){radix=0}else if(radix){radix=+radix}string=trim(string);return nativeParseInt(string,radix||(reHasHexPrefix.test(string)?16:10))}function repeat(string,n){var result="";string=baseToString(string);n=+n;if(n<1||!string||!nativeIsFinite(n)){return result}do{if(n%2){result+=string}n=nativeFloor(n/2);string+=string}while(n);return result}var snakeCase=createCompounder(function(result,word,index){return result+(index?"_":"")+word.toLowerCase()});var startCase=createCompounder(function(result,word,index){return result+(index?" ":"")+(word.charAt(0).toUpperCase()+word.slice(1))});function startsWith(string,target,position){string=baseToString(string);position=position==null?0:nativeMin(position<0?0:+position||0,string.length);return string.lastIndexOf(target,position)==position}function template(string,options,otherOptions){var settings=lodash.templateSettings;if(otherOptions&&isIterateeCall(string,options,otherOptions)){options=otherOptions=undefined}string=baseToString(string);options=assignWith(baseAssign({},otherOptions||options),settings,assignOwnDefaults);var imports=assignWith(baseAssign({},options.imports),settings.imports,assignOwnDefaults),importsKeys=keys(imports),importsValues=baseValues(imports,importsKeys);var isEscaping,isEvaluating,index=0,interpolate=options.interpolate||reNoMatch,source="__p += '";var reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g");var sourceURL="//# sourceURL="+("sourceURL"in options?options.sourceURL:"lodash.templateSources["+ ++templateCounter+"]")+"\n";string.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){interpolateValue||(interpolateValue=esTemplateValue);source+=string.slice(index,offset).replace(reUnescapedString,escapeStringChar);if(escapeValue){isEscaping=true;source+="' +\n__e("+escapeValue+") +\n'"}if(evaluateValue){isEvaluating=true;source+="';\n"+evaluateValue+";\n__p += '"}if(interpolateValue){source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"}index=offset+match.length;return match});source+="';\n";var variable=options.variable;if(!variable){source="with (obj) {\n"+source+"\n}\n"}source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;");source="function("+(variable||"obj")+") {\n"+(variable?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(isEscaping?", __e = _.escape":"")+(isEvaluating?", __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var result=attempt(function(){return Function(importsKeys,sourceURL+"return "+source).apply(undefined,importsValues)});result.source=source;if(isError(result)){throw result}return result}function trim(string,chars,guard){var value=string;string=baseToString(string);if(!string){return string}if(guard?isIterateeCall(value,chars,guard):chars==null){return string.slice(trimmedLeftIndex(string),trimmedRightIndex(string)+1)}chars=chars+"";return string.slice(charsLeftIndex(string,chars),charsRightIndex(string,chars)+1)}function trimLeft(string,chars,guard){var value=string;string=baseToString(string);if(!string){return string}if(guard?isIterateeCall(value,chars,guard):chars==null){return string.slice(trimmedLeftIndex(string))}return string.slice(charsLeftIndex(string,chars+""))}function trimRight(string,chars,guard){var value=string;string=baseToString(string);if(!string){return string}if(guard?isIterateeCall(value,chars,guard):chars==null){return string.slice(0,trimmedRightIndex(string)+1)}return string.slice(0,charsRightIndex(string,chars+"")+1)}function trunc(string,options,guard){if(guard&&isIterateeCall(string,options,guard)){options=undefined}var length=DEFAULT_TRUNC_LENGTH,omission=DEFAULT_TRUNC_OMISSION;if(options!=null){if(isObject(options)){var separator="separator"in options?options.separator:separator;length="length"in options?+options.length||0:length;omission="omission"in options?baseToString(options.omission):omission}else{length=+options||0}}string=baseToString(string);if(length>=string.length){return string}var end=length-omission.length;if(end<1){return omission}var result=string.slice(0,end);if(separator==null){return result+omission}if(isRegExp(separator)){if(string.slice(end).search(separator)){var match,newEnd,substring=string.slice(0,end);if(!separator.global){separator=RegExp(separator.source,(reFlags.exec(separator)||"")+"g")}separator.lastIndex=0;while(match=separator.exec(substring)){newEnd=match.index}result=result.slice(0,newEnd==null?end:newEnd)}}else if(string.indexOf(separator,end)!=end){var index=result.lastIndexOf(separator);if(index>-1){result=result.slice(0,index)}}return result+omission}function unescape(string){string=baseToString(string);return string&&reHasEscapedHtml.test(string)?string.replace(reEscapedHtml,unescapeHtmlChar):string}function words(string,pattern,guard){if(guard&&isIterateeCall(string,pattern,guard)){pattern=undefined}string=baseToString(string);return string.match(pattern||reWords)||[]}var attempt=restParam(function(func,args){try{return func.apply(undefined,args)}catch(e){return isError(e)?e:new Error(e)}});function callback(func,thisArg,guard){if(guard&&isIterateeCall(func,thisArg,guard)){thisArg=undefined}return isObjectLike(func)?matches(func):baseCallback(func,thisArg)}function constant(value){return function(){return value}}function identity(value){return value}function matches(source){return baseMatches(baseClone(source,true))}function matchesProperty(path,srcValue){return baseMatchesProperty(path,baseClone(srcValue,true))}var method=restParam(function(path,args){return function(object){return invokePath(object,path,args)}});var methodOf=restParam(function(object,args){return function(path){return invokePath(object,path,args)}});function mixin(object,source,options){if(options==null){var isObj=isObject(source),props=isObj?keys(source):undefined,methodNames=props&&props.length?baseFunctions(source,props):undefined;if(!(methodNames?methodNames.length:isObj)){methodNames=false;options=source;source=object;object=this}}if(!methodNames){methodNames=baseFunctions(source,keys(source))}var chain=true,index=-1,isFunc=isFunction(object),length=methodNames.length;if(options===false){chain=false}else if(isObject(options)&&"chain"in options){chain=options.chain}while(++index<length){var methodName=methodNames[index],func=source[methodName];object[methodName]=func;if(isFunc){object.prototype[methodName]=function(func){return function(){var chainAll=this.__chain__;if(chain||chainAll){var result=object(this.__wrapped__),actions=result.__actions__=arrayCopy(this.__actions__);actions.push({func:func,args:arguments,thisArg:object});result.__chain__=chainAll;return result}return func.apply(object,arrayPush([this.value()],arguments))}}(func)}}return object}function noConflict(){root._=oldDash;return this}function noop(){}function property(path){return isKey(path)?baseProperty(path):basePropertyDeep(path)}function propertyOf(object){return function(path){return baseGet(object,toPath(path),path+"")}}function range(start,end,step){if(step&&isIterateeCall(start,end,step)){end=step=undefined}start=+start||0;step=step==null?1:+step||0;if(end==null){end=start;start=0}else{end=+end||0}var index=-1,length=nativeMax(nativeCeil((end-start)/(step||1)),0),result=Array(length);while(++index<length){result[index]=start;start+=step}return result}function times(n,iteratee,thisArg){n=nativeFloor(n);if(n<1||!nativeIsFinite(n)){return[]}var index=-1,result=Array(nativeMin(n,MAX_ARRAY_LENGTH));iteratee=bindCallback(iteratee,thisArg,1);while(++index<n){if(index<MAX_ARRAY_LENGTH){result[index]=iteratee(index)}else{iteratee(index)}}return result}function uniqueId(prefix){var id=++idCounter;return baseToString(prefix)+id}function add(augend,addend){return(+augend||0)+(+addend||0)}var ceil=createRound("ceil");var floor=createRound("floor");var max=createExtremum(gt,NEGATIVE_INFINITY);var min=createExtremum(lt,POSITIVE_INFINITY);var round=createRound("round");function sum(collection,iteratee,thisArg){if(thisArg&&isIterateeCall(collection,iteratee,thisArg)){iteratee=undefined}iteratee=getCallback(iteratee,thisArg,3);return iteratee.length==1?arraySum(isArray(collection)?collection:toIterable(collection),iteratee):baseSum(collection,iteratee)}lodash.prototype=baseLodash.prototype;LodashWrapper.prototype=baseCreate(baseLodash.prototype);LodashWrapper.prototype.constructor=LodashWrapper;LazyWrapper.prototype=baseCreate(baseLodash.prototype);LazyWrapper.prototype.constructor=LazyWrapper;MapCache.prototype["delete"]=mapDelete;MapCache.prototype.get=mapGet;MapCache.prototype.has=mapHas;MapCache.prototype.set=mapSet;SetCache.prototype.push=cachePush;memoize.Cache=MapCache;lodash.after=after;lodash.ary=ary;lodash.assign=assign;lodash.at=at;lodash.before=before;lodash.bind=bind;lodash.bindAll=bindAll;lodash.bindKey=bindKey;lodash.callback=callback;lodash.chain=chain;lodash.chunk=chunk;lodash.compact=compact;lodash.constant=constant;lodash.countBy=countBy;lodash.create=create;lodash.curry=curry;lodash.curryRight=curryRight;lodash.debounce=debounce;lodash.defaults=defaults;lodash.defaultsDeep=defaultsDeep;lodash.defer=defer;lodash.delay=delay;lodash.difference=difference;lodash.drop=drop;lodash.dropRight=dropRight;lodash.dropRightWhile=dropRightWhile;lodash.dropWhile=dropWhile;lodash.fill=fill;lodash.filter=filter;lodash.flatten=flatten;lodash.flattenDeep=flattenDeep;lodash.flow=flow;lodash.flowRight=flowRight;lodash.forEach=forEach;lodash.forEachRight=forEachRight;lodash.forIn=forIn;lodash.forInRight=forInRight;lodash.forOwn=forOwn;lodash.forOwnRight=forOwnRight;lodash.functions=functions;lodash.groupBy=groupBy;lodash.indexBy=indexBy;lodash.initial=initial;lodash.intersection=intersection;lodash.invert=invert;lodash.invoke=invoke;lodash.keys=keys;lodash.keysIn=keysIn;lodash.map=map;lodash.mapKeys=mapKeys;lodash.mapValues=mapValues;lodash.matches=matches;lodash.matchesProperty=matchesProperty;lodash.memoize=memoize;lodash.merge=merge;lodash.method=method;lodash.methodOf=methodOf;lodash.mixin=mixin;lodash.modArgs=modArgs;lodash.negate=negate;lodash.omit=omit;lodash.once=once;lodash.pairs=pairs;lodash.partial=partial;lodash.partialRight=partialRight;lodash.partition=partition;lodash.pick=pick;lodash.pluck=pluck;lodash.property=property;lodash.propertyOf=propertyOf;lodash.pull=pull;lodash.pullAt=pullAt;lodash.range=range;lodash.rearg=rearg;lodash.reject=reject;lodash.remove=remove;lodash.rest=rest;lodash.restParam=restParam;lodash.set=set;lodash.shuffle=shuffle;lodash.slice=slice;lodash.sortBy=sortBy;lodash.sortByAll=sortByAll;lodash.sortByOrder=sortByOrder;lodash.spread=spread;lodash.take=take;lodash.takeRight=takeRight;lodash.takeRightWhile=takeRightWhile;lodash.takeWhile=takeWhile;lodash.tap=tap;lodash.throttle=throttle;lodash.thru=thru;lodash.times=times;lodash.toArray=toArray;lodash.toPlainObject=toPlainObject;lodash.transform=transform;lodash.union=union;lodash.uniq=uniq;lodash.unzip=unzip;lodash.unzipWith=unzipWith;lodash.values=values;lodash.valuesIn=valuesIn;lodash.where=where;lodash.without=without;lodash.wrap=wrap;lodash.xor=xor;lodash.zip=zip;lodash.zipObject=zipObject;lodash.zipWith=zipWith;lodash.backflow=flowRight;lodash.collect=map;lodash.compose=flowRight;lodash.each=forEach;lodash.eachRight=forEachRight;lodash.extend=assign;lodash.iteratee=callback;lodash.methods=functions;lodash.object=zipObject;lodash.select=filter;lodash.tail=rest;lodash.unique=uniq;mixin(lodash,lodash);lodash.add=add;lodash.attempt=attempt;lodash.camelCase=camelCase;lodash.capitalize=capitalize;lodash.ceil=ceil;lodash.clone=clone;lodash.cloneDeep=cloneDeep;lodash.deburr=deburr;lodash.endsWith=endsWith;lodash.escape=escape;lodash.escapeRegExp=escapeRegExp;lodash.every=every;lodash.find=find;lodash.findIndex=findIndex;lodash.findKey=findKey;lodash.findLast=findLast;lodash.findLastIndex=findLastIndex;lodash.findLastKey=findLastKey;lodash.findWhere=findWhere;lodash.first=first;lodash.floor=floor;lodash.get=get;lodash.gt=gt;lodash.gte=gte;lodash.has=has;lodash.identity=identity;lodash.includes=includes;lodash.indexOf=indexOf;lodash.inRange=inRange;lodash.isArguments=isArguments;lodash.isArray=isArray;lodash.isBoolean=isBoolean;lodash.isDate=isDate;lodash.isElement=isElement;lodash.isEmpty=isEmpty;lodash.isEqual=isEqual;lodash.isError=isError;lodash.isFinite=isFinite;lodash.isFunction=isFunction;lodash.isMatch=isMatch;lodash.isNaN=isNaN;lodash.isNative=isNative;lodash.isNull=isNull;lodash.isNumber=isNumber;lodash.isObject=isObject;lodash.isPlainObject=isPlainObject;lodash.isRegExp=isRegExp;lodash.isString=isString;lodash.isTypedArray=isTypedArray;lodash.isUndefined=isUndefined;lodash.kebabCase=kebabCase;lodash.last=last;lodash.lastIndexOf=lastIndexOf;lodash.lt=lt;lodash.lte=lte;lodash.max=max;lodash.min=min;lodash.noConflict=noConflict;lodash.noop=noop;lodash.now=now;lodash.pad=pad;lodash.padLeft=padLeft;lodash.padRight=padRight;lodash.parseInt=parseInt;lodash.random=random;lodash.reduce=reduce;lodash.reduceRight=reduceRight;lodash.repeat=repeat;lodash.result=result;lodash.round=round;lodash.runInContext=runInContext;lodash.size=size;lodash.snakeCase=snakeCase;lodash.some=some;lodash.sortedIndex=sortedIndex;lodash.sortedLastIndex=sortedLastIndex;lodash.startCase=startCase;lodash.startsWith=startsWith;lodash.sum=sum;lodash.template=template;lodash.trim=trim;lodash.trimLeft=trimLeft;lodash.trimRight=trimRight;lodash.trunc=trunc;lodash.unescape=unescape;lodash.uniqueId=uniqueId;lodash.words=words;lodash.all=every;lodash.any=some;lodash.contains=includes;lodash.eq=isEqual;lodash.detect=find;lodash.foldl=reduce;lodash.foldr=reduceRight;lodash.head=first;lodash.include=includes;lodash.inject=reduce;mixin(lodash,function(){var source={};baseForOwn(lodash,function(func,methodName){if(!lodash.prototype[methodName]){source[methodName]=func}});return source}(),false);lodash.sample=sample;lodash.prototype.sample=function(n){if(!this.__chain__&&n==null){return sample(this.value())}return this.thru(function(value){return sample(value,n)})};lodash.VERSION=VERSION;arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],function(methodName){lodash[methodName].placeholder=lodash});arrayEach(["drop","take"],function(methodName,index){LazyWrapper.prototype[methodName]=function(n){var filtered=this.__filtered__;if(filtered&&!index){return new LazyWrapper(this)}n=n==null?1:nativeMax(nativeFloor(n)||0,0);var result=this.clone();if(filtered){result.__takeCount__=nativeMin(result.__takeCount__,n)}else{result.__views__.push({size:n,type:methodName+(result.__dir__<0?"Right":"")})}return result};LazyWrapper.prototype[methodName+"Right"]=function(n){return this.reverse()[methodName](n).reverse()}});arrayEach(["filter","map","takeWhile"],function(methodName,index){var type=index+1,isFilter=type!=LAZY_MAP_FLAG;LazyWrapper.prototype[methodName]=function(iteratee,thisArg){var result=this.clone();result.__iteratees__.push({iteratee:getCallback(iteratee,thisArg,1),type:type});result.__filtered__=result.__filtered__||isFilter;return result}});arrayEach(["first","last"],function(methodName,index){var takeName="take"+(index?"Right":"");LazyWrapper.prototype[methodName]=function(){return this[takeName](1).value()[0]}});arrayEach(["initial","rest"],function(methodName,index){var dropName="drop"+(index?"":"Right");LazyWrapper.prototype[methodName]=function(){return this.__filtered__?new LazyWrapper(this):this[dropName](1)}});arrayEach(["pluck","where"],function(methodName,index){var operationName=index?"filter":"map",createCallback=index?baseMatches:property;LazyWrapper.prototype[methodName]=function(value){return this[operationName](createCallback(value))}});LazyWrapper.prototype.compact=function(){return this.filter(identity)};LazyWrapper.prototype.reject=function(predicate,thisArg){predicate=getCallback(predicate,thisArg,1);return this.filter(function(value){return!predicate(value)})};LazyWrapper.prototype.slice=function(start,end){start=start==null?0:+start||0;var result=this;if(result.__filtered__&&(start>0||end<0)){return new LazyWrapper(result)}if(start<0){result=result.takeRight(-start)}else if(start){result=result.drop(start)}if(end!==undefined){end=+end||0;result=end<0?result.dropRight(-end):result.take(end-start)}return result};LazyWrapper.prototype.takeRightWhile=function(predicate,thisArg){return this.reverse().takeWhile(predicate,thisArg).reverse()};LazyWrapper.prototype.toArray=function(){return this.take(POSITIVE_INFINITY)};baseForOwn(LazyWrapper.prototype,function(func,methodName){var checkIteratee=/^(?:filter|map|reject)|While$/.test(methodName),retUnwrapped=/^(?:first|last)$/.test(methodName),lodashFunc=lodash[retUnwrapped?"take"+(methodName=="last"?"Right":""):methodName];if(!lodashFunc){return}lodash.prototype[methodName]=function(){var args=retUnwrapped?[1]:arguments,chainAll=this.__chain__,value=this.__wrapped__,isHybrid=!!this.__actions__.length,isLazy=value instanceof LazyWrapper,iteratee=args[0],useLazy=isLazy||isArray(value);if(useLazy&&checkIteratee&&typeof iteratee=="function"&&iteratee.length!=1){isLazy=useLazy=false}var interceptor=function(value){return retUnwrapped&&chainAll?lodashFunc(value,1)[0]:lodashFunc.apply(undefined,arrayPush([value],args))};var action={func:thru,args:[interceptor],thisArg:undefined},onlyLazy=isLazy&&!isHybrid;if(retUnwrapped&&!chainAll){if(onlyLazy){value=value.clone();value.__actions__.push(action);return func.call(value)}return lodashFunc.call(undefined,this.value())[0]}if(!retUnwrapped&&useLazy){value=onlyLazy?value:new LazyWrapper(this);var result=func.apply(value,args);result.__actions__.push(action);return new LodashWrapper(result,chainAll)}return this.thru(interceptor)}});arrayEach(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(methodName){var func=(/^(?:replace|split)$/.test(methodName)?stringProto:arrayProto)[methodName],chainName=/^(?:push|sort|unshift)$/.test(methodName)?"tap":"thru",retUnwrapped=/^(?:join|pop|replace|shift)$/.test(methodName);lodash.prototype[methodName]=function(){var args=arguments;if(retUnwrapped&&!this.__chain__){return func.apply(this.value(),args)}return this[chainName](function(value){return func.apply(value,args)})}});baseForOwn(LazyWrapper.prototype,function(func,methodName){var lodashFunc=lodash[methodName];if(lodashFunc){var key=lodashFunc.name,names=realNames[key]||(realNames[key]=[]);names.push({name:methodName,func:lodashFunc})}});realNames[createHybridWrapper(undefined,BIND_KEY_FLAG).name]=[{name:"wrapper",func:undefined}];LazyWrapper.prototype.clone=lazyClone;LazyWrapper.prototype.reverse=lazyReverse;LazyWrapper.prototype.value=lazyValue;lodash.prototype.chain=wrapperChain;lodash.prototype.commit=wrapperCommit;lodash.prototype.concat=wrapperConcat;lodash.prototype.plant=wrapperPlant;lodash.prototype.reverse=wrapperReverse;lodash.prototype.toString=wrapperToString;lodash.prototype.run=lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=wrapperValue;lodash.prototype.collect=lodash.prototype.map;lodash.prototype.head=lodash.prototype.first;lodash.prototype.select=lodash.prototype.filter;lodash.prototype.tail=lodash.prototype.rest;return lodash}var _=runInContext();if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){root._=_;define(function(){return _})}else if(freeExports&&freeModule){if(moduleExports){(freeModule.exports=_)._=_}else{freeExports._=_}}else{root._=_}}).call(this)},{});require.register("node_modules/moment/moment",function(require,module,exports){(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.moment=factory()})(this,function(){"use strict";var hookCallback;function utils_hooks__hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(callback){hookCallback=callback}function isArray(input){return Object.prototype.toString.call(input)==="[object Array]"}function isDate(input){return input instanceof Date||Object.prototype.toString.call(input)==="[object Date]"}function map(arr,fn){var res=[],i;for(i=0;i<arr.length;++i){res.push(fn(arr[i],i))}return res}function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function extend(a,b){for(var i in b){if(hasOwnProp(b,i)){a[i]=b[i]}}if(hasOwnProp(b,"toString")){a.toString=b.toString}if(hasOwnProp(b,"valueOf")){a.valueOf=b.valueOf}return a}function create_utc__createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,true).utc()}function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false}}function getParsingFlags(m){if(m._pf==null){m._pf=defaultParsingFlags()}return m._pf}function valid__isValid(m){if(m._isValid==null){var flags=getParsingFlags(m);m._isValid=!isNaN(m._d.getTime())&&flags.overflow<0&&!flags.empty&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated;if(m._strict){m._isValid=m._isValid&&flags.charsLeftOver===0&&flags.unusedTokens.length===0&&flags.bigHour===undefined}}return m._isValid}function valid__createInvalid(flags){var m=create_utc__createUTC(NaN);if(flags!=null){extend(getParsingFlags(m),flags)}else{getParsingFlags(m).userInvalidated=true}return m}var momentProperties=utils_hooks__hooks.momentProperties=[];function copyConfig(to,from){var i,prop,val;if(typeof from._isAMomentObject!=="undefined"){to._isAMomentObject=from._isAMomentObject}if(typeof from._i!=="undefined"){to._i=from._i}if(typeof from._f!=="undefined"){to._f=from._f}if(typeof from._l!=="undefined"){to._l=from._l}if(typeof from._strict!=="undefined"){to._strict=from._strict}if(typeof from._tzm!=="undefined"){to._tzm=from._tzm}if(typeof from._isUTC!=="undefined"){to._isUTC=from._isUTC}if(typeof from._offset!=="undefined"){to._offset=from._offset}if(typeof from._pf!=="undefined"){to._pf=getParsingFlags(from)}if(typeof from._locale!=="undefined"){to._locale=from._locale}if(momentProperties.length>0){for(i in momentProperties){prop=momentProperties[i];val=from[prop];if(typeof val!=="undefined"){to[prop]=val}}}return to}var updateInProgress=false;function Moment(config){copyConfig(this,config);this._d=new Date(config._d!=null?config._d.getTime():NaN);if(updateInProgress===false){updateInProgress=true;utils_hooks__hooks.updateOffset(this);updateInProgress=false}}function isMoment(obj){return obj instanceof Moment||obj!=null&&obj._isAMomentObject!=null}function absFloor(number){if(number<0){return Math.ceil(number)}else{return Math.floor(number)}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){value=absFloor(coercedNumber)}return value}function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i])){diffs++}}return diffs+lengthDiff}function Locale(){}var locales={};var globalLocale;function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){var i=0,j,next,locale,split;while(i<names.length){split=normalizeLocale(names[i]).split("-");j=split.length;next=normalizeLocale(names[i+1]);next=next?next.split("-"):null;while(j>0){locale=loadLocale(split.slice(0,j).join("-"));if(locale){return locale}if(next&&next.length>=j&&compareArrays(split,next,true)>=j-1){break}j--}i++}return null}function loadLocale(name){var oldLocale=null;if(!locales[name]&&typeof module!=="undefined"&&module&&module.exports){try{oldLocale=globalLocale._abbr;require("./locale/"+name);locale_locales__getSetGlobalLocale(oldLocale)}catch(e){}}return locales[name]}function locale_locales__getSetGlobalLocale(key,values){var data;if(key){if(typeof values==="undefined"){data=locale_locales__getLocale(key)}else{data=defineLocale(key,values)}if(data){globalLocale=data}}return globalLocale._abbr}function defineLocale(name,values){if(values!==null){values.abbr=name;locales[name]=locales[name]||new Locale;locales[name].set(values);locale_locales__getSetGlobalLocale(name);return locales[name]}else{delete locales[name];return null}}function locale_locales__getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr){key=key._locale._abbr}if(!key){return globalLocale}if(!isArray(key)){locale=loadLocale(key);if(locale){return locale}key=[key]}return chooseLocale(key)}var aliases={};function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+"s"]=aliases[shorthand]=unit}function normalizeUnits(units){return typeof units==="string"?aliases[units]||aliases[units.toLowerCase()]:undefined}function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(hasOwnProp(inputObject,prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop];
}}}return normalizedInput}function makeGetSet(unit,keepTime){return function(value){if(value!=null){get_set__set(this,unit,value);utils_hooks__hooks.updateOffset(this,keepTime);return this}else{return get_set__get(this,unit)}}}function get_set__get(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function get_set__set(mom,unit,value){return mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}function getSet(units,value){var unit;if(typeof units==="object"){for(unit in units){this.set(unit,units[unit])}}else{units=normalizeUnits(units);if(typeof this[units]==="function"){return this[units](value)}}return this}function zeroFill(number,targetLength,forceSign){var absNumber=""+Math.abs(number),zerosToFill=targetLength-absNumber.length,sign=number>=0;return(sign?forceSign?"+":"":"-")+Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber}var formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;var localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g;var formatFunctions={};var formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;if(typeof callback==="string"){func=function(){return this[callback]()}}if(token){formatTokenFunctions[token]=func}if(padded){formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2])}}if(ordinal){formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token)}}}function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,"")}return input.replace(/\\/g,"")}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]]}else{array[i]=removeFormattingTokens(array[i])}}return function(mom){var output="";for(i=0;i<length;i++){output+=array[i]instanceof Function?array[i].call(mom,format):array[i]}return output}}function formatMoment(m,format){if(!m.isValid()){return m.localeData().invalidDate()}format=expandFormat(format,m.localeData());formatFunctions[format]=formatFunctions[format]||makeFormatFunction(format);return formatFunctions[format](m)}function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1}return format}var match1=/\d/;var match2=/\d\d/;var match3=/\d{3}/;var match4=/\d{4}/;var match6=/[+-]?\d{6}/;var match1to2=/\d\d?/;var match1to3=/\d{1,3}/;var match1to4=/\d{1,4}/;var match1to6=/[+-]?\d{1,6}/;var matchUnsigned=/\d+/;var matchSigned=/[+-]?\d+/;var matchOffset=/Z|[+-]\d\d:?\d\d/gi;var matchTimestamp=/[+-]?\d+(\.\d{1,3})?/;var matchWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i;var regexes={};function isFunction(sth){return typeof sth==="function"&&Object.prototype.toString.call(sth)==="[object Function]"}function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict){return isStrict&&strictRegex?strictRegex:regex}}function getParseRegexForToken(token,config){if(!hasOwnProp(regexes,token)){return new RegExp(unescapeFormat(token))}return regexes[token](config._strict,config._locale)}function unescapeFormat(s){return s.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var tokens={};function addParseToken(token,callback){var i,func=callback;if(typeof token==="string"){token=[token]}if(typeof callback==="number"){func=function(input,array){array[callback]=toInt(input)}}for(i=0;i<token.length;i++){tokens[token[i]]=func}}function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{};callback(input,config._w,config,token)})}function addTimeToArrayFromToken(token,input,config){if(input!=null&&hasOwnProp(tokens,token)){tokens[token](input,config._a,config,token)}}var YEAR=0;var MONTH=1;var DATE=2;var HOUR=3;var MINUTE=4;var SECOND=5;var MILLISECOND=6;function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1});addFormatToken("MMM",0,0,function(format){return this.localeData().monthsShort(this,format)});addFormatToken("MMMM",0,0,function(format){return this.localeData().months(this,format)});addUnitAlias("month","M");addRegexToken("M",match1to2);addRegexToken("MM",match1to2,match2);addRegexToken("MMM",matchWord);addRegexToken("MMMM",matchWord);addParseToken(["M","MM"],function(input,array){array[MONTH]=toInt(input)-1});addParseToken(["MMM","MMMM"],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);if(month!=null){array[MONTH]=month}else{getParsingFlags(config).invalidMonth=input}});var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function localeMonths(m){return this._months[m.month()]}var defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function localeMonthsShort(m){return this._monthsShort[m.month()]}function localeMonthsParse(monthName,format,strict){var i,mom,regex;if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(i=0;i<12;i++){mom=create_utc__createUTC([2e3,i]);if(strict&&!this._longMonthsParse[i]){this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i");this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")}if(!strict&&!this._monthsParse[i]){regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,"");this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")}if(strict&&format==="MMMM"&&this._longMonthsParse[i].test(monthName)){return i}else if(strict&&format==="MMM"&&this._shortMonthsParse[i].test(monthName)){return i}else if(!strict&&this._monthsParse[i].test(monthName)){return i}}}function setMonth(mom,value){var dayOfMonth;if(typeof value==="string"){value=mom.localeData().monthsParse(value);if(typeof value!=="number"){return mom}}dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth);return mom}function getSetMonth(value){if(value!=null){setMonth(this,value);utils_hooks__hooks.updateOffset(this,true);return this}else{return get_set__get(this,"Month")}}function getDaysInMonth(){return daysInMonth(this.year(),this.month())}function checkOverflow(m){var overflow;var a=m._a;if(a&&getParsingFlags(m).overflow===-2){overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||a[HOUR]===24&&(a[MINUTE]!==0||a[SECOND]!==0||a[MILLISECOND]!==0)?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1;if(getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE}getParsingFlags(m).overflow=overflow}return m}function warn(msg){if(utils_hooks__hooks.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+msg)}}function deprecate(msg,fn){var firstTime=true;return extend(function(){if(firstTime){warn(msg+"\n"+(new Error).stack);firstTime=false}return fn.apply(this,arguments)},fn)}var deprecations={};function deprecateSimple(name,msg){if(!deprecations[name]){warn(msg);deprecations[name]=true}}utils_hooks__hooks.suppressDeprecationWarnings=false;var from_string__isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]];var isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]];var aspNetJsonRegex=/^\/?Date\((\-?\d+)/i;function configFromISO(config){var i,l,string=config._i,match=from_string__isoRegex.exec(string);if(match){getParsingFlags(config).iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(string)){config._f=isoDates[i][0];break}}for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(string)){config._f+=(match[6]||" ")+isoTimes[i][0];break}}if(string.match(matchOffset)){config._f+="Z"}configFromStringAndFormat(config)}else{config._isValid=false}}function configFromString(config){var matched=aspNetJsonRegex.exec(config._i);if(matched!==null){config._d=new Date(+matched[1]);return}configFromISO(config);if(config._isValid===false){delete config._isValid;utils_hooks__hooks.createFromInputFallback(config)}}utils_hooks__hooks.createFromInputFallback=deprecate("moment construction falls back to js Date. This is "+"discouraged and will be removed in upcoming major "+"release. Please refer to "+"https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))});function createDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);if(y<1970){date.setFullYear(y)}return date}function createUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));if(y<1970){date.setUTCFullYear(y)}return date}addFormatToken(0,["YY",2],0,function(){return this.year()%100});addFormatToken(0,["YYYY",4],0,"year");addFormatToken(0,["YYYYY",5],0,"year");addFormatToken(0,["YYYYYY",6,true],0,"year");addUnitAlias("year","y");addRegexToken("Y",matchSigned);addRegexToken("YY",match1to2,match2);addRegexToken("YYYY",match1to4,match4);addRegexToken("YYYYY",match1to6,match6);addRegexToken("YYYYYY",match1to6,match6);addParseToken(["YYYYY","YYYYYY"],YEAR);addParseToken("YYYY",function(input,array){array[YEAR]=input.length===2?utils_hooks__hooks.parseTwoDigitYear(input):toInt(input)});addParseToken("YY",function(input,array){array[YEAR]=utils_hooks__hooks.parseTwoDigitYear(input)});function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}utils_hooks__hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",false);function getIsLeapYear(){return isLeapYear(this.year())}addFormatToken("w",["ww",2],"wo","week");addFormatToken("W",["WW",2],"Wo","isoWeek");addUnitAlias("week","w");addUnitAlias("isoWeek","W");addRegexToken("w",match1to2);addRegexToken("ww",match1to2,match2);addRegexToken("W",match1to2);addRegexToken("WW",match1to2,match2);addWeekParseToken(["w","ww","W","WW"],function(input,week,config,token){week[token.substr(0,1)]=toInt(input)});function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day(),adjustedMoment;if(daysToDayOfWeek>end){daysToDayOfWeek-=7}if(daysToDayOfWeek<end-7){daysToDayOfWeek+=7}adjustedMoment=local__createLocal(mom).add(daysToDayOfWeek,"d");return{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function localeWeek(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week}var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(input){var week=this.localeData().week(this);return input==null?week:this.add((input-week)*7,"d")}function getSetISOWeek(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add((input-week)*7,"d")}addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear");addUnitAlias("dayOfYear","DDD");addRegexToken("DDD",match1to3);addRegexToken("DDDD",match3);addParseToken(["DDD","DDDD"],function(input,array,config){config._dayOfYear=toInt(input)});function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var week1Jan=6+firstDayOfWeek-firstDayOfWeekOfYear,janX=createUTCDate(year,0,1+week1Jan),d=janX.getUTCDay(),dayOfYear;if(d<firstDayOfWeek){d+=7}weekday=weekday!=null?1*weekday:firstDayOfWeek;dayOfYear=1+week1Jan+7*(week-1)-d+weekday;return{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}function getSetDayOfYear(input){var dayOfYear=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return input==null?dayOfYear:this.add(input-dayOfYear,"d")}function defaults(a,b,c){if(a!=null){return a}if(b!=null){return b}return c}function currentDateArray(config){var now=new Date;if(config._useUTC){return[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]}return[now.getFullYear(),now.getMonth(),now.getDate()]}function configFromArray(config){var i,date,input=[],currentDate,yearToUse;if(config._d){return}currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){dayOfYearFromWeekInfo(config)}if(config._dayOfYear){yearToUse=defaults(config._a[YEAR],currentDate[YEAR]);if(config._dayOfYear>daysInYear(yearToUse)){getParsingFlags(config)._overflowDayOfYear=true}date=createUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate()}for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i]}for(;i<7;i++){config._a[i]=input[i]=config._a[i]==null?i===2?1:0:config._a[i]}if(config._a[HOUR]===24&&config._a[MINUTE]===0&&config._a[SECOND]===0&&config._a[MILLISECOND]===0){config._nextDay=true;config._a[HOUR]=0}config._d=(config._useUTC?createUTCDate:createDate).apply(null,input);if(config._tzm!=null){config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm)}if(config._nextDay){config._a[HOUR]=24}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp;w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){dow=1;doy=4;weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(local__createLocal(),1,4).year);week=defaults(w.W,1);weekday=defaults(w.E,1)}else{dow=config._locale._week.dow;doy=config._locale._week.doy;weekYear=defaults(w.gg,config._a[YEAR],weekOfYear(local__createLocal(),dow,doy).year);week=defaults(w.w,1);if(w.d!=null){weekday=w.d;if(weekday<dow){++week}}else if(w.e!=null){weekday=w.e+dow}else{weekday=dow}}temp=dayOfYearFromWeeks(weekYear,week,weekday,doy,dow);config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear}utils_hooks__hooks.ISO_8601=function(){};function configFromStringAndFormat(config){if(config._f===utils_hooks__hooks.ISO_8601){configFromISO(config);return}config._a=[];getParsingFlags(config).empty=true;var string=""+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0;tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){getParsingFlags(config).unusedInput.push(skipped)}string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length}if(formatTokenFunctions[token]){if(parsedInput){getParsingFlags(config).empty=false}else{getParsingFlags(config).unusedTokens.push(token)}addTimeToArrayFromToken(token,parsedInput,config)}else if(config._strict&&!parsedInput){getParsingFlags(config).unusedTokens.push(token)}}getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){getParsingFlags(config).unusedInput.push(string)}if(getParsingFlags(config).bigHour===true&&config._a[HOUR]<=12&&config._a[HOUR]>0){getParsingFlags(config).bigHour=undefined}config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem);configFromArray(config);checkOverflow(config)}function meridiemFixWrap(locale,hour,meridiem){var isPm;if(meridiem==null){return hour}if(locale.meridiemHour!=null){return locale.meridiemHour(hour,meridiem)}else if(locale.isPM!=null){isPm=locale.isPM(meridiem);if(isPm&&hour<12){hour+=12}if(!isPm&&hour===12){hour=0}return hour}else{return hour}}function configFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(config._f.length===0){getParsingFlags(config).invalidFormat=true;config._d=new Date(NaN);return}for(i=0;i<config._f.length;i++){currentScore=0;tempConfig=copyConfig({},config);if(config._useUTC!=null){tempConfig._useUTC=config._useUTC}tempConfig._f=config._f[i];configFromStringAndFormat(tempConfig);if(!valid__isValid(tempConfig)){continue}currentScore+=getParsingFlags(tempConfig).charsLeftOver;currentScore+=getParsingFlags(tempConfig).unusedTokens.length*10;getParsingFlags(tempConfig).score=currentScore;if(scoreToBeat==null||currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig}}extend(config,bestMoment||tempConfig)}function configFromObject(config){if(config._d){return}var i=normalizeObjectUnits(config._i);config._a=[i.year,i.month,i.day||i.date,i.hour,i.minute,i.second,i.millisecond];configFromArray(config)}function createFromConfig(config){var res=new Moment(checkOverflow(prepareConfig(config)));if(res._nextDay){res.add(1,"d");res._nextDay=undefined}return res}function prepareConfig(config){var input=config._i,format=config._f;config._locale=config._locale||locale_locales__getLocale(config._l);if(input===null||format===undefined&&input===""){return valid__createInvalid({nullInput:true})}if(typeof input==="string"){config._i=input=config._locale.preparse(input)}if(isMoment(input)){return new Moment(checkOverflow(input))}else if(isArray(format)){configFromStringAndArray(config)}else if(format){configFromStringAndFormat(config)}else if(isDate(input)){config._d=input}else{configFromInput(config)}return config}function configFromInput(config){var input=config._i;if(input===undefined){config._d=new Date}else if(isDate(input)){config._d=new Date(+input)}else if(typeof input==="string"){configFromString(config)}else if(isArray(input)){config._a=map(input.slice(0),function(obj){return parseInt(obj,10)});configFromArray(config)}else if(typeof input==="object"){configFromObject(config)}else if(typeof input==="number"){config._d=new Date(input)}else{utils_hooks__hooks.createFromInputFallback(config)}}function createLocalOrUTC(input,format,locale,strict,isUTC){var c={};if(typeof locale==="boolean"){strict=locale;locale=undefined}c._isAMomentObject=true;c._useUTC=c._isUTC=isUTC;c._l=locale;c._i=input;c._f=format;c._strict=strict;return createFromConfig(c)}function local__createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,false)}var prototypeMin=deprecate("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var other=local__createLocal.apply(null,arguments);return other<this?this:other});var prototypeMax=deprecate("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var other=local__createLocal.apply(null,arguments);return other>this?this:other});function pickBy(fn,moments){var res,i;if(moments.length===1&&isArray(moments[0])){moments=moments[0]}if(!moments.length){return local__createLocal()}res=moments[0];for(i=1;i<moments.length;++i){if(!moments[i].isValid()||moments[i][fn](res)){res=moments[i]}}return res}function min(){var args=[].slice.call(arguments,0);return pickBy("isBefore",args)}function max(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+seconds*1e3+minutes*6e4+hours*36e5;this._days=+days+weeks*7;this._months=+months+quarters*3+years*12;this._data={};this._locale=locale_locales__getLocale();this._bubble()}function isDuration(obj){return obj instanceof Duration}function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset();var sign="+";if(offset<0){offset=-offset;sign="-"}return sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~offset%60,2)})}offset("Z",":");offset("ZZ","");addRegexToken("Z",matchOffset);addRegexToken("ZZ",matchOffset);addParseToken(["Z","ZZ"],function(input,array,config){config._useUTC=true;config._tzm=offsetFromString(input)});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(string){var matches=(string||"").match(matchOffset)||[];var chunk=matches[matches.length-1]||[];var parts=(chunk+"").match(chunkOffset)||["-",0,0];var minutes=+(parts[1]*60)+toInt(parts[2]);return parts[0]==="+"?minutes:-minutes}function cloneWithOffset(input,model){var res,diff;if(model._isUTC){res=model.clone();diff=(isMoment(input)||isDate(input)?+input:+local__createLocal(input))-+res;res._d.setTime(+res._d+diff);utils_hooks__hooks.updateOffset(res,false);return res}else{return local__createLocal(input).local()}}function getDateOffset(m){return-Math.round(m._d.getTimezoneOffset()/15)*15}utils_hooks__hooks.updateOffset=function(){};function getSetOffset(input,keepLocalTime){var offset=this._offset||0,localAdjust;if(input!=null){if(typeof input==="string"){input=offsetFromString(input)}if(Math.abs(input)<16){input=input*60}if(!this._isUTC&&keepLocalTime){localAdjust=getDateOffset(this)}this._offset=input;this._isUTC=true;if(localAdjust!=null){this.add(localAdjust,"m")}if(offset!==input){if(!keepLocalTime||this._changeInProgress){add_subtract__addSubtract(this,create__createDuration(input-offset,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;utils_hooks__hooks.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?offset:getDateOffset(this)}}function getSetZone(input,keepLocalTime){if(input!=null){if(typeof input!=="string"){input=-input}this.utcOffset(input,keepLocalTime);return this}else{return-this.utcOffset()}}function setOffsetToUTC(keepLocalTime){return this.utcOffset(0,keepLocalTime)}function setOffsetToLocal(keepLocalTime){if(this._isUTC){this.utcOffset(0,keepLocalTime);this._isUTC=false;if(keepLocalTime){this.subtract(getDateOffset(this),"m")}}return this}function setOffsetToParsedOffset(){if(this._tzm){this.utcOffset(this._tzm)}else if(typeof this._i==="string"){this.utcOffset(offsetFromString(this._i))}return this}function hasAlignedHourOffset(input){input=input?local__createLocal(input).utcOffset():0;return(this.utcOffset()-input)%60===0}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(typeof this._isDSTShifted!=="undefined"){return this._isDSTShifted}var c={};copyConfig(c,this);c=prepareConfig(c);if(c._a){var other=c._isUTC?create_utc__createUTC(c._a):local__createLocal(c._a);this._isDSTShifted=this.isValid()&&compareArrays(c._a,other.toArray())>0}else{this._isDSTShifted=false}return this._isDSTShifted}function isLocal(){return!this._isUTC}function isUtcOffset(){return this._isUTC}function isUtc(){return this._isUTC&&this._offset===0}var aspNetRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/;var create__isoRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;function create__createDuration(input,key){var duration=input,match=null,sign,ret,diffRes;if(isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months}}else if(typeof input==="number"){duration={};if(key){duration[key]=input}else{duration.milliseconds=input}}else if(!!(match=aspNetRegex.exec(input))){sign=match[1]==="-"?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}}else if(!!(match=create__isoRegex.exec(input))){sign=match[1]==="-"?-1:1;duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),d:parseIso(match[4],sign),h:parseIso(match[5],sign),m:parseIso(match[6],sign),s:parseIso(match[7],sign),w:parseIso(match[8],sign)}}else if(duration==null){duration={}}else if(typeof duration==="object"&&("from"in duration||"to"in duration)){diffRes=momentsDifference(local__createLocal(duration.from),local__createLocal(duration.to));duration={};duration.ms=diffRes.milliseconds;duration.M=diffRes.months}ret=new Duration(duration);if(isDuration(input)&&hasOwnProp(input,"_locale")){ret._locale=input._locale}return ret}create__createDuration.fn=Duration.prototype;function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign}function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};res.months=other.month()-base.month()+(other.year()-base.year())*12;if(base.clone().add(res.months,"M").isAfter(other)){--res.months}res.milliseconds=+other-+base.clone().add(res.months,"M");return res}function momentsDifference(base,other){var res;other=cloneWithOffset(other,base);if(base.isBefore(other)){res=positiveMomentsDifference(base,other)}else{res=positiveMomentsDifference(other,base);res.milliseconds=-res.milliseconds;res.months=-res.months}return res}function createAdder(direction,name){return function(val,period){var dur,tmp;if(period!==null&&!isNaN(+period)){deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period).");tmp=val;val=period;period=tmp}val=typeof val==="string"?+val:val;dur=create__createDuration(val,period);add_subtract__addSubtract(this,dur,direction);return this}}function add_subtract__addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=updateOffset==null?true:updateOffset;if(milliseconds){mom._d.setTime(+mom._d+milliseconds*isAdding)}if(days){get_set__set(mom,"Date",get_set__get(mom,"Date")+days*isAdding)}if(months){setMonth(mom,get_set__get(mom,"Month")+months*isAdding)}if(updateOffset){utils_hooks__hooks.updateOffset(mom,days||months)}}var add_subtract__add=createAdder(1,"add");var add_subtract__subtract=createAdder(-1,"subtract");function moment_calendar__calendar(time,formats){var now=time||local__createLocal(),sod=cloneWithOffset(now,this).startOf("day"),diff=this.diff(sod,"days",true),format=diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse";return this.format(formats&&formats[format]||this.localeData().calendar(format,this,local__createLocal(now)))}function clone(){return new Moment(this)}function isAfter(input,units){var inputMs;units=normalizeUnits(typeof units!=="undefined"?units:"millisecond");if(units==="millisecond"){input=isMoment(input)?input:local__createLocal(input);return+this>+input}else{inputMs=isMoment(input)?+input:+local__createLocal(input);return inputMs<+this.clone().startOf(units)}}function isBefore(input,units){var inputMs;units=normalizeUnits(typeof units!=="undefined"?units:"millisecond");if(units==="millisecond"){input=isMoment(input)?input:local__createLocal(input);return+this<+input}else{inputMs=isMoment(input)?+input:+local__createLocal(input);return+this.clone().endOf(units)<inputMs}}function isBetween(from,to,units){return this.isAfter(from,units)&&this.isBefore(to,units)}function isSame(input,units){var inputMs;units=normalizeUnits(units||"millisecond");if(units==="millisecond"){input=isMoment(input)?input:local__createLocal(input);return+this===+input}else{inputMs=+local__createLocal(input);return+this.clone().startOf(units)<=inputMs&&inputMs<=+this.clone().endOf(units)}}function diff(input,units,asFloat){var that=cloneWithOffset(input,this),zoneDelta=(that.utcOffset()-this.utcOffset())*6e4,delta,output;units=normalizeUnits(units);if(units==="year"||units==="month"||units==="quarter"){output=monthDiff(this,that);if(units==="quarter"){output=output/3}else if(units==="year"){output=output/12}}else{delta=this-that;output=units==="second"?delta/1e3:units==="minute"?delta/6e4:units==="hour"?delta/36e5:units==="day"?(delta-zoneDelta)/864e5:units==="week"?(delta-zoneDelta)/6048e5:delta}return asFloat?output:absFloor(output)}function monthDiff(a,b){var wholeMonthDiff=(b.year()-a.year())*12+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months"),anchor2,adjust;if(b-anchor<0){anchor2=a.clone().add(wholeMonthDiff-1,"months");adjust=(b-anchor)/(anchor-anchor2)}else{anchor2=a.clone().add(wholeMonthDiff+1,"months");adjust=(b-anchor)/(anchor2-anchor)}return-(wholeMonthDiff+adjust)}utils_hooks__hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";function toString(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function moment_format__toISOString(){var m=this.clone().utc();if(0<m.year()&&m.year()<=9999){if("function"===typeof Date.prototype.toISOString){return this.toDate().toISOString()}else{return formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}}else{return formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}}function format(inputString){var output=formatMoment(this,inputString||utils_hooks__hooks.defaultFormat);return this.localeData().postformat(output)}function from(time,withoutSuffix){if(!this.isValid()){return this.localeData().invalidDate()}return create__createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix)}function fromNow(withoutSuffix){return this.from(local__createLocal(),withoutSuffix)}function to(time,withoutSuffix){if(!this.isValid()){return this.localeData().invalidDate()}return create__createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix)}function toNow(withoutSuffix){return this.to(local__createLocal(),withoutSuffix)}function locale(key){var newLocaleData;if(key===undefined){return this._locale._abbr}else{newLocaleData=locale_locales__getLocale(key);if(newLocaleData!=null){this._locale=newLocaleData}return this}}var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){if(key===undefined){return this.localeData()}else{return this.locale(key)}});function localeData(){return this._locale}function startOf(units){units=normalizeUnits(units);switch(units){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}if(units==="week"){this.weekday(0)}if(units==="isoWeek"){this.isoWeekday(1)}if(units==="quarter"){this.month(Math.floor(this.month()/3)*3)}return this}function endOf(units){units=normalizeUnits(units);if(units===undefined||units==="millisecond"){return this}return this.startOf(units).add(1,units==="isoWeek"?"week":units).subtract(1,"ms")}function to_type__valueOf(){return+this._d-(this._offset||0)*6e4}function unix(){return Math.floor(+this/1e3)}function toDate(){return this._offset?new Date(+this):this._d}function toArray(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()]}function toObject(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()}}function moment_valid__isValid(){return valid__isValid(this)}function parsingFlags(){return extend({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow;
}addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100});addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100});function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter)}addWeekYearFormatToken("gggg","weekYear");addWeekYearFormatToken("ggggg","weekYear");addWeekYearFormatToken("GGGG","isoWeekYear");addWeekYearFormatToken("GGGGG","isoWeekYear");addUnitAlias("weekYear","gg");addUnitAlias("isoWeekYear","GG");addRegexToken("G",matchSigned);addRegexToken("g",matchSigned);addRegexToken("GG",match1to2,match2);addRegexToken("gg",match1to2,match2);addRegexToken("GGGG",match1to4,match4);addRegexToken("gggg",match1to4,match4);addRegexToken("GGGGG",match1to6,match6);addRegexToken("ggggg",match1to6,match6);addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(input,week,config,token){week[token.substr(0,2)]=toInt(input)});addWeekParseToken(["gg","GG"],function(input,week,config,token){week[token]=utils_hooks__hooks.parseTwoDigitYear(input)});function weeksInYear(year,dow,doy){return weekOfYear(local__createLocal([year,11,31+dow-doy]),dow,doy).week}function getSetWeekYear(input){var year=weekOfYear(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return input==null?year:this.add(input-year,"y")}function getSetISOWeekYear(input){var year=weekOfYear(this,1,4).year;return input==null?year:this.add(input-year,"y")}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getWeeksInYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)}addFormatToken("Q",0,0,"quarter");addUnitAlias("quarter","Q");addRegexToken("Q",match1);addParseToken("Q",function(input,array){array[MONTH]=(toInt(input)-1)*3});function getSetQuarter(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3)}addFormatToken("D",["DD",2],"Do","date");addUnitAlias("date","D");addRegexToken("D",match1to2);addRegexToken("DD",match1to2,match2);addRegexToken("Do",function(isStrict,locale){return isStrict?locale._ordinalParse:locale._ordinalParseLenient});addParseToken(["D","DD"],DATE);addParseToken("Do",function(input,array){array[DATE]=toInt(input.match(match1to2)[0],10)});var getSetDayOfMonth=makeGetSet("Date",true);addFormatToken("d",0,"do","day");addFormatToken("dd",0,0,function(format){return this.localeData().weekdaysMin(this,format)});addFormatToken("ddd",0,0,function(format){return this.localeData().weekdaysShort(this,format)});addFormatToken("dddd",0,0,function(format){return this.localeData().weekdays(this,format)});addFormatToken("e",0,0,"weekday");addFormatToken("E",0,0,"isoWeekday");addUnitAlias("day","d");addUnitAlias("weekday","e");addUnitAlias("isoWeekday","E");addRegexToken("d",match1to2);addRegexToken("e",match1to2);addRegexToken("E",match1to2);addRegexToken("dd",matchWord);addRegexToken("ddd",matchWord);addRegexToken("dddd",matchWord);addWeekParseToken(["dd","ddd","dddd"],function(input,week,config){var weekday=config._locale.weekdaysParse(input);if(weekday!=null){week.d=weekday}else{getParsingFlags(config).invalidWeekday=input}});addWeekParseToken(["d","e","E"],function(input,week,config,token){week[token]=toInt(input)});function parseWeekday(input,locale){if(typeof input!=="string"){return input}if(!isNaN(input)){return parseInt(input,10)}input=locale.weekdaysParse(input);if(typeof input==="number"){return input}return null}var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function localeWeekdays(m){return this._weekdays[m.day()]}var defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function localeWeekdaysShort(m){return this._weekdaysShort[m.day()]}var defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function localeWeekdaysMin(m){return this._weekdaysMin[m.day()]}function localeWeekdaysParse(weekdayName){var i,mom,regex;this._weekdaysParse=this._weekdaysParse||[];for(i=0;i<7;i++){if(!this._weekdaysParse[i]){mom=local__createLocal([2e3,1]).day(i);regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,"");this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")}if(this._weekdaysParse[i].test(weekdayName)){return i}}}function getSetDayOfWeek(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.localeData());return this.add(input-day,"d")}else{return day}}function getSetLocaleDayOfWeek(input){var weekday=(this.day()+7-this.localeData()._week.dow)%7;return input==null?weekday:this.add(input-weekday,"d")}function getSetISODayOfWeek(input){return input==null?this.day()||7:this.day(this.day()%7?input:input-7)}addFormatToken("H",["HH",2],0,"hour");addFormatToken("h",["hh",2],0,function(){return this.hours()%12||12});function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase)})}meridiem("a",true);meridiem("A",false);addUnitAlias("hour","h");function matchMeridiem(isStrict,locale){return locale._meridiemParse}addRegexToken("a",matchMeridiem);addRegexToken("A",matchMeridiem);addRegexToken("H",match1to2);addRegexToken("h",match1to2);addRegexToken("HH",match1to2,match2);addRegexToken("hh",match1to2,match2);addParseToken(["H","HH"],HOUR);addParseToken(["a","A"],function(input,array,config){config._isPm=config._locale.isPM(input);config._meridiem=input});addParseToken(["h","hh"],function(input,array,config){array[HOUR]=toInt(input);getParsingFlags(config).bigHour=true});function localeIsPM(input){return(input+"").toLowerCase().charAt(0)==="p"}var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i;function localeMeridiem(hours,minutes,isLower){if(hours>11){return isLower?"pm":"PM"}else{return isLower?"am":"AM"}}var getSetHour=makeGetSet("Hours",true);addFormatToken("m",["mm",2],0,"minute");addUnitAlias("minute","m");addRegexToken("m",match1to2);addRegexToken("mm",match1to2,match2);addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",false);addFormatToken("s",["ss",2],0,"second");addUnitAlias("second","s");addRegexToken("s",match1to2);addRegexToken("ss",match1to2,match2);addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",false);addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)});addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)});addFormatToken(0,["SSS",3],0,"millisecond");addFormatToken(0,["SSSS",4],0,function(){return this.millisecond()*10});addFormatToken(0,["SSSSS",5],0,function(){return this.millisecond()*100});addFormatToken(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});addFormatToken(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});addFormatToken(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});addFormatToken(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});addUnitAlias("millisecond","ms");addRegexToken("S",match1to3,match1);addRegexToken("SS",match1to3,match2);addRegexToken("SSS",match1to3,match3);var token;for(token="SSSS";token.length<=9;token+="S"){addRegexToken(token,matchUnsigned)}function parseMs(input,array){array[MILLISECOND]=toInt(("0."+input)*1e3)}for(token="S";token.length<=9;token+="S"){addParseToken(token,parseMs)}var getSetMillisecond=makeGetSet("Milliseconds",false);addFormatToken("z",0,0,"zoneAbbr");addFormatToken("zz",0,0,"zoneName");function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}var momentPrototype__proto=Moment.prototype;momentPrototype__proto.add=add_subtract__add;momentPrototype__proto.calendar=moment_calendar__calendar;momentPrototype__proto.clone=clone;momentPrototype__proto.diff=diff;momentPrototype__proto.endOf=endOf;momentPrototype__proto.format=format;momentPrototype__proto.from=from;momentPrototype__proto.fromNow=fromNow;momentPrototype__proto.to=to;momentPrototype__proto.toNow=toNow;momentPrototype__proto.get=getSet;momentPrototype__proto.invalidAt=invalidAt;momentPrototype__proto.isAfter=isAfter;momentPrototype__proto.isBefore=isBefore;momentPrototype__proto.isBetween=isBetween;momentPrototype__proto.isSame=isSame;momentPrototype__proto.isValid=moment_valid__isValid;momentPrototype__proto.lang=lang;momentPrototype__proto.locale=locale;momentPrototype__proto.localeData=localeData;momentPrototype__proto.max=prototypeMax;momentPrototype__proto.min=prototypeMin;momentPrototype__proto.parsingFlags=parsingFlags;momentPrototype__proto.set=getSet;momentPrototype__proto.startOf=startOf;momentPrototype__proto.subtract=add_subtract__subtract;momentPrototype__proto.toArray=toArray;momentPrototype__proto.toObject=toObject;momentPrototype__proto.toDate=toDate;momentPrototype__proto.toISOString=moment_format__toISOString;momentPrototype__proto.toJSON=moment_format__toISOString;momentPrototype__proto.toString=toString;momentPrototype__proto.unix=unix;momentPrototype__proto.valueOf=to_type__valueOf;momentPrototype__proto.year=getSetYear;momentPrototype__proto.isLeapYear=getIsLeapYear;momentPrototype__proto.weekYear=getSetWeekYear;momentPrototype__proto.isoWeekYear=getSetISOWeekYear;momentPrototype__proto.quarter=momentPrototype__proto.quarters=getSetQuarter;momentPrototype__proto.month=getSetMonth;momentPrototype__proto.daysInMonth=getDaysInMonth;momentPrototype__proto.week=momentPrototype__proto.weeks=getSetWeek;momentPrototype__proto.isoWeek=momentPrototype__proto.isoWeeks=getSetISOWeek;momentPrototype__proto.weeksInYear=getWeeksInYear;momentPrototype__proto.isoWeeksInYear=getISOWeeksInYear;momentPrototype__proto.date=getSetDayOfMonth;momentPrototype__proto.day=momentPrototype__proto.days=getSetDayOfWeek;momentPrototype__proto.weekday=getSetLocaleDayOfWeek;momentPrototype__proto.isoWeekday=getSetISODayOfWeek;momentPrototype__proto.dayOfYear=getSetDayOfYear;momentPrototype__proto.hour=momentPrototype__proto.hours=getSetHour;momentPrototype__proto.minute=momentPrototype__proto.minutes=getSetMinute;momentPrototype__proto.second=momentPrototype__proto.seconds=getSetSecond;momentPrototype__proto.millisecond=momentPrototype__proto.milliseconds=getSetMillisecond;momentPrototype__proto.utcOffset=getSetOffset;momentPrototype__proto.utc=setOffsetToUTC;momentPrototype__proto.local=setOffsetToLocal;momentPrototype__proto.parseZone=setOffsetToParsedOffset;momentPrototype__proto.hasAlignedHourOffset=hasAlignedHourOffset;momentPrototype__proto.isDST=isDaylightSavingTime;momentPrototype__proto.isDSTShifted=isDaylightSavingTimeShifted;momentPrototype__proto.isLocal=isLocal;momentPrototype__proto.isUtcOffset=isUtcOffset;momentPrototype__proto.isUtc=isUtc;momentPrototype__proto.isUTC=isUtc;momentPrototype__proto.zoneAbbr=getZoneAbbr;momentPrototype__proto.zoneName=getZoneName;momentPrototype__proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth);momentPrototype__proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth);momentPrototype__proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear);momentPrototype__proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",getSetZone);var momentPrototype=momentPrototype__proto;function moment__createUnix(input){return local__createLocal(input*1e3)}function moment__createInZone(){return local__createLocal.apply(null,arguments).parseZone()}var defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function locale_calendar__calendar(key,mom,now){var output=this._calendar[key];return typeof output==="function"?output.call(mom,now):output}var defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function longDateFormat(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];if(format||!formatUpper){return format}this._longDateFormat[key]=formatUpper.replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)});return this._longDateFormat[key]}var defaultInvalidDate="Invalid date";function invalidDate(){return this._invalidDate}var defaultOrdinal="%d";var defaultOrdinalParse=/\d{1,2}/;function ordinal(number){return this._ordinal.replace("%d",number)}function preParsePostFormat(string){return string}var defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function relative__relativeTime(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return typeof output==="function"?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)}function pastFuture(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return typeof format==="function"?format(output):format.replace(/%s/i,output)}function locale_set__set(config){var prop,i;for(i in config){prop=config[i];if(typeof prop==="function"){this[i]=prop}else{this["_"+i]=prop}}this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}var prototype__proto=Locale.prototype;prototype__proto._calendar=defaultCalendar;prototype__proto.calendar=locale_calendar__calendar;prototype__proto._longDateFormat=defaultLongDateFormat;prototype__proto.longDateFormat=longDateFormat;prototype__proto._invalidDate=defaultInvalidDate;prototype__proto.invalidDate=invalidDate;prototype__proto._ordinal=defaultOrdinal;prototype__proto.ordinal=ordinal;prototype__proto._ordinalParse=defaultOrdinalParse;prototype__proto.preparse=preParsePostFormat;prototype__proto.postformat=preParsePostFormat;prototype__proto._relativeTime=defaultRelativeTime;prototype__proto.relativeTime=relative__relativeTime;prototype__proto.pastFuture=pastFuture;prototype__proto.set=locale_set__set;prototype__proto.months=localeMonths;prototype__proto._months=defaultLocaleMonths;prototype__proto.monthsShort=localeMonthsShort;prototype__proto._monthsShort=defaultLocaleMonthsShort;prototype__proto.monthsParse=localeMonthsParse;prototype__proto.week=localeWeek;prototype__proto._week=defaultLocaleWeek;prototype__proto.firstDayOfYear=localeFirstDayOfYear;prototype__proto.firstDayOfWeek=localeFirstDayOfWeek;prototype__proto.weekdays=localeWeekdays;prototype__proto._weekdays=defaultLocaleWeekdays;prototype__proto.weekdaysMin=localeWeekdaysMin;prototype__proto._weekdaysMin=defaultLocaleWeekdaysMin;prototype__proto.weekdaysShort=localeWeekdaysShort;prototype__proto._weekdaysShort=defaultLocaleWeekdaysShort;prototype__proto.weekdaysParse=localeWeekdaysParse;prototype__proto.isPM=localeIsPM;prototype__proto._meridiemParse=defaultLocaleMeridiemParse;prototype__proto.meridiem=localeMeridiem;function lists__get(format,index,field,setter){var locale=locale_locales__getLocale();var utc=create_utc__createUTC().set(setter,index);return locale[field](utc,format)}function list(format,index,field,count,setter){if(typeof format==="number"){index=format;format=undefined}format=format||"";if(index!=null){return lists__get(format,index,field,setter)}var i;var out=[];for(i=0;i<count;i++){out[i]=lists__get(format,i,field,setter)}return out}function lists__listMonths(format,index){return list(format,index,"months",12,"month")}function lists__listMonthsShort(format,index){return list(format,index,"monthsShort",12,"month")}function lists__listWeekdays(format,index){return list(format,index,"weekdays",7,"day")}function lists__listWeekdaysShort(format,index){return list(format,index,"weekdaysShort",7,"day")}function lists__listWeekdaysMin(format,index){return list(format,index,"weekdaysMin",7,"day")}locale_locales__getSetGlobalLocale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=toInt(number%100/10)===1?"th":b===1?"st":b===2?"nd":b===3?"rd":"th";return number+output}});utils_hooks__hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",locale_locales__getSetGlobalLocale);utils_hooks__hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",locale_locales__getLocale);var mathAbs=Math.abs;function duration_abs__abs(){var data=this._data;this._milliseconds=mathAbs(this._milliseconds);this._days=mathAbs(this._days);this._months=mathAbs(this._months);data.milliseconds=mathAbs(data.milliseconds);data.seconds=mathAbs(data.seconds);data.minutes=mathAbs(data.minutes);data.hours=mathAbs(data.hours);data.months=mathAbs(data.months);data.years=mathAbs(data.years);return this}function duration_add_subtract__addSubtract(duration,input,value,direction){var other=create__createDuration(input,value);duration._milliseconds+=direction*other._milliseconds;duration._days+=direction*other._days;duration._months+=direction*other._months;return duration._bubble()}function duration_add_subtract__add(input,value){return duration_add_subtract__addSubtract(this,input,value,1)}function duration_add_subtract__subtract(input,value){return duration_add_subtract__addSubtract(this,input,value,-1)}function absCeil(number){if(number<0){return Math.floor(number)}else{return Math.ceil(number)}}function bubble(){var milliseconds=this._milliseconds;var days=this._days;var months=this._months;var data=this._data;var seconds,minutes,hours,years,monthsFromDays;if(!(milliseconds>=0&&days>=0&&months>=0||milliseconds<=0&&days<=0&&months<=0)){milliseconds+=absCeil(monthsToDays(months)+days)*864e5;days=0;months=0}data.milliseconds=milliseconds%1e3;seconds=absFloor(milliseconds/1e3);data.seconds=seconds%60;minutes=absFloor(seconds/60);data.minutes=minutes%60;hours=absFloor(minutes/60);data.hours=hours%24;days+=absFloor(hours/24);monthsFromDays=absFloor(daysToMonths(days));months+=monthsFromDays;days-=absCeil(monthsToDays(monthsFromDays));years=absFloor(months/12);months%=12;data.days=days;data.months=months;data.years=years;return this}function daysToMonths(days){return days*4800/146097}function monthsToDays(months){return months*146097/4800}function as(units){var days;var months;var milliseconds=this._milliseconds;units=normalizeUnits(units);if(units==="month"||units==="year"){days=this._days+milliseconds/864e5;months=this._months+daysToMonths(days);return units==="month"?months:months/12}else{days=this._days+Math.round(monthsToDays(this._months));switch(units){case"week":return days/7+milliseconds/6048e5;case"day":return days+milliseconds/864e5;case"hour":return days*24+milliseconds/36e5;case"minute":return days*1440+milliseconds/6e4;case"second":return days*86400+milliseconds/1e3;case"millisecond":return Math.floor(days*864e5)+milliseconds;default:throw new Error("Unknown unit "+units)}}}function duration_as__valueOf(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+toInt(this._months/12)*31536e6}function makeAs(alias){return function(){return this.as(alias)}}var asMilliseconds=makeAs("ms");var asSeconds=makeAs("s");var asMinutes=makeAs("m");var asHours=makeAs("h");var asDays=makeAs("d");var asWeeks=makeAs("w");var asMonths=makeAs("M");var asYears=makeAs("y");function duration_get__get(units){units=normalizeUnits(units);return this[units+"s"]()}function makeGetter(name){return function(){return this._data[name]}}var milliseconds=makeGetter("milliseconds");var seconds=makeGetter("seconds");var minutes=makeGetter("minutes");var hours=makeGetter("hours");var days=makeGetter("days");var months=makeGetter("months");var years=makeGetter("years");function weeks(){return absFloor(this.days()/7)}var round=Math.round;var thresholds={s:45,m:45,h:22,d:26,M:11};function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function duration_humanize__relativeTime(posNegDuration,withoutSuffix,locale){var duration=create__createDuration(posNegDuration).abs();var seconds=round(duration.as("s"));var minutes=round(duration.as("m"));var hours=round(duration.as("h"));var days=round(duration.as("d"));var months=round(duration.as("M"));var years=round(duration.as("y"));var a=seconds<thresholds.s&&["s",seconds]||minutes===1&&["m"]||minutes<thresholds.m&&["mm",minutes]||hours===1&&["h"]||hours<thresholds.h&&["hh",hours]||days===1&&["d"]||days<thresholds.d&&["dd",days]||months===1&&["M"]||months<thresholds.M&&["MM",months]||years===1&&["y"]||["yy",years];a[2]=withoutSuffix;a[3]=+posNegDuration>0;a[4]=locale;return substituteTimeAgo.apply(null,a)}function duration_humanize__getSetRelativeTimeThreshold(threshold,limit){if(thresholds[threshold]===undefined){return false}if(limit===undefined){return thresholds[threshold]}thresholds[threshold]=limit;return true}function humanize(withSuffix){var locale=this.localeData();var output=duration_humanize__relativeTime(this,!withSuffix,locale);if(withSuffix){output=locale.pastFuture(+this,output)}return locale.postformat(output)}var iso_string__abs=Math.abs;function iso_string__toISOString(){var seconds=iso_string__abs(this._milliseconds)/1e3;var days=iso_string__abs(this._days);var months=iso_string__abs(this._months);var minutes,hours,years;minutes=absFloor(seconds/60);hours=absFloor(minutes/60);seconds%=60;minutes%=60;years=absFloor(months/12);months%=12;var Y=years;var M=months;var D=days;var h=hours;var m=minutes;var s=seconds;var total=this.asSeconds();if(!total){return"P0D"}return(total<0?"-":"")+"P"+(Y?Y+"Y":"")+(M?M+"M":"")+(D?D+"D":"")+(h||m||s?"T":"")+(h?h+"H":"")+(m?m+"M":"")+(s?s+"S":"")}var duration_prototype__proto=Duration.prototype;duration_prototype__proto.abs=duration_abs__abs;duration_prototype__proto.add=duration_add_subtract__add;duration_prototype__proto.subtract=duration_add_subtract__subtract;duration_prototype__proto.as=as;duration_prototype__proto.asMilliseconds=asMilliseconds;duration_prototype__proto.asSeconds=asSeconds;duration_prototype__proto.asMinutes=asMinutes;duration_prototype__proto.asHours=asHours;duration_prototype__proto.asDays=asDays;duration_prototype__proto.asWeeks=asWeeks;duration_prototype__proto.asMonths=asMonths;duration_prototype__proto.asYears=asYears;duration_prototype__proto.valueOf=duration_as__valueOf;duration_prototype__proto._bubble=bubble;duration_prototype__proto.get=duration_get__get;duration_prototype__proto.milliseconds=milliseconds;duration_prototype__proto.seconds=seconds;duration_prototype__proto.minutes=minutes;duration_prototype__proto.hours=hours;duration_prototype__proto.days=days;duration_prototype__proto.weeks=weeks;duration_prototype__proto.months=months;duration_prototype__proto.years=years;duration_prototype__proto.humanize=humanize;duration_prototype__proto.toISOString=iso_string__toISOString;duration_prototype__proto.toString=iso_string__toISOString;duration_prototype__proto.toJSON=iso_string__toISOString;duration_prototype__proto.locale=locale;duration_prototype__proto.localeData=localeData;duration_prototype__proto.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",iso_string__toISOString);duration_prototype__proto.lang=lang;addFormatToken("X",0,0,"unix");addFormatToken("x",0,0,"valueOf");addRegexToken("x",matchSigned);addRegexToken("X",matchTimestamp);addParseToken("X",function(input,array,config){config._d=new Date(parseFloat(input,10)*1e3)});addParseToken("x",function(input,array,config){config._d=new Date(toInt(input))});utils_hooks__hooks.version="2.10.6";setHookCallback(local__createLocal);utils_hooks__hooks.fn=momentPrototype;utils_hooks__hooks.min=min;utils_hooks__hooks.max=max;utils_hooks__hooks.utc=create_utc__createUTC;utils_hooks__hooks.unix=moment__createUnix;utils_hooks__hooks.months=lists__listMonths;utils_hooks__hooks.isDate=isDate;utils_hooks__hooks.locale=locale_locales__getSetGlobalLocale;utils_hooks__hooks.invalid=valid__createInvalid;utils_hooks__hooks.duration=create__createDuration;utils_hooks__hooks.isMoment=isMoment;utils_hooks__hooks.weekdays=lists__listWeekdays;utils_hooks__hooks.parseZone=moment__createInZone;utils_hooks__hooks.localeData=locale_locales__getLocale;utils_hooks__hooks.isDuration=isDuration;utils_hooks__hooks.monthsShort=lists__listMonthsShort;utils_hooks__hooks.weekdaysMin=lists__listWeekdaysMin;utils_hooks__hooks.defineLocale=defineLocale;utils_hooks__hooks.weekdaysShort=lists__listWeekdaysShort;utils_hooks__hooks.normalizeUnits=normalizeUnits;utils_hooks__hooks.relativeTimeThreshold=duration_humanize__getSetRelativeTimeThreshold;var _moment=utils_hooks__hooks;return _moment})},{});require.register("node_modules/page/index",function(require,module,exports){"use strict";var pathtoRegexp=require("path-to-regexp");module.exports=page;var clickEvent="undefined"!==typeof document&&document.ontouchstart?"touchstart":"click";var location="undefined"!==typeof window&&(window.history.location||window.location);var dispatch=true;var decodeURLComponents=true;var base="";var running;var hashbang=false;var prevContext;function page(path,fn){if("function"===typeof path){return page("*",path)}if("function"===typeof fn){var route=new Route(path);for(var i=1;i<arguments.length;++i){page.callbacks.push(route.middleware(arguments[i]))}}else if("string"===typeof path){page["string"===typeof fn?"redirect":"show"](path,fn)}else{page.start(path)}}page.callbacks=[];page.exits=[];page.current="";page.len=0;page.base=function(path){if(0===arguments.length)return base;base=path};page.start=function(options){options=options||{};if(running)return;running=true;if(false===options.dispatch)dispatch=false;if(false===options.decodeURLComponents)decodeURLComponents=false;if(false!==options.popstate)window.addEventListener("popstate",onpopstate,false);if(false!==options.click){document.addEventListener(clickEvent,onclick,false)}if(true===options.hashbang)hashbang=true;if(!dispatch)return;var url=hashbang&&~location.hash.indexOf("#!")?location.hash.substr(2)+location.search:location.pathname+location.search+location.hash;page.replace(url,null,true,dispatch)};page.stop=function(){if(!running)return;page.current="";page.len=0;running=false;document.removeEventListener(clickEvent,onclick,false);window.removeEventListener("popstate",onpopstate,false)};page.show=function(path,state,dispatch,push){var ctx=new Context(path,state);page.current=ctx.path;if(false!==dispatch)page.dispatch(ctx);if(false!==ctx.handled&&false!==push)ctx.pushState();return ctx};page.back=function(path,state){if(page.len>0){history.back();page.len--}else if(path){setTimeout(function(){page.show(path,state)})}else{setTimeout(function(){page.show(base,state)})}};page.redirect=function(from,to){if("string"===typeof from&&"string"===typeof to){page(from,function(e){setTimeout(function(){page.replace(to)},0)})}if("string"===typeof from&&"undefined"===typeof to){setTimeout(function(){page.replace(from)},0)}};page.replace=function(path,state,init,dispatch){var ctx=new Context(path,state);page.current=ctx.path;ctx.init=init;ctx.save();if(false!==dispatch)page.dispatch(ctx);return ctx};page.dispatch=function(ctx){var prev=prevContext,i=0,j=0;prevContext=ctx;function nextExit(){var fn=page.exits[j++];if(!fn)return nextEnter();fn(prev,nextExit)}function nextEnter(){var fn=page.callbacks[i++];if(ctx.path!==page.current){ctx.handled=false;return}if(!fn)return unhandled(ctx);fn(ctx,nextEnter)}if(prev){nextExit()}else{nextEnter()}};function unhandled(ctx){if(ctx.handled)return;var current;if(hashbang){current=base+location.hash.replace("#!","")}else{current=location.pathname+location.search}if(current===ctx.canonicalPath)return;page.stop();ctx.handled=false;location.href=ctx.canonicalPath}page.exit=function(path,fn){if(typeof path==="function"){return page.exit("*",path)}var route=new Route(path);for(var i=1;i<arguments.length;++i){page.exits.push(route.middleware(arguments[i]))}};function decodeURLEncodedURIComponent(val){if(typeof val!=="string"){return val}return decodeURLComponents?decodeURIComponent(val.replace(/\+/g," ")):val}function Context(path,state){if("/"===path[0]&&0!==path.indexOf(base))path=base+(hashbang?"#!":"")+path;var i=path.indexOf("?");this.canonicalPath=path;this.path=path.replace(base,"")||"/";if(hashbang)this.path=this.path.replace("#!","")||"/";this.title=document.title;this.state=state||{};this.state.path=path;this.querystring=~i?decodeURLEncodedURIComponent(path.slice(i+1)):"";this.pathname=decodeURLEncodedURIComponent(~i?path.slice(0,i):path);this.params={};this.hash="";if(!hashbang){if(!~this.path.indexOf("#"))return;var parts=this.path.split("#");this.path=parts[0];this.hash=decodeURLEncodedURIComponent(parts[1])||"";this.querystring=this.querystring.split("#")[0]}}page.Context=Context;Context.prototype.pushState=function(){page.len++;history.pushState(this.state,this.title,hashbang&&this.path!=="/"?"#!"+this.path:this.canonicalPath)};Context.prototype.save=function(){history.replaceState(this.state,this.title,hashbang&&this.path!=="/"?"#!"+this.path:this.canonicalPath)};function Route(path,options){options=options||{};this.path=path==="*"?"(.*)":path;this.method="GET";this.regexp=pathtoRegexp(this.path,this.keys=[],options.sensitive,options.strict)}page.Route=Route;Route.prototype.middleware=function(fn){var self=this;return function(ctx,next){if(self.match(ctx.path,ctx.params))return fn(ctx,next);next()}};Route.prototype.match=function(path,params){var keys=this.keys,qsIndex=path.indexOf("?"),pathname=~qsIndex?path.slice(0,qsIndex):path,m=this.regexp.exec(decodeURIComponent(pathname));if(!m)return false;for(var i=1,len=m.length;i<len;++i){var key=keys[i-1];var val=decodeURLEncodedURIComponent(m[i]);if(val!==undefined||!hasOwnProperty.call(params,key.name)){params[key.name]=val}}return true};var onpopstate=function(){var loaded=false;if("undefined"===typeof window){return}if(document.readyState==="complete"){loaded=true}else{window.addEventListener("load",function(){setTimeout(function(){loaded=true},0)})}return function onpopstate(e){if(!loaded)return;if(e.state){var path=e.state.path;page.replace(path,e.state)}else{page.show(location.pathname+location.hash,undefined,undefined,false)}}}();function onclick(e){if(1!==which(e))return;if(e.metaKey||e.ctrlKey||e.shiftKey)return;if(e.defaultPrevented)return;var el=e.target;while(el&&"A"!==el.nodeName)el=el.parentNode;if(!el||"A"!==el.nodeName)return;if(el.hasAttribute("download")||el.getAttribute("rel")==="external")return;var link=el.getAttribute("href");if(!hashbang&&el.pathname===location.pathname&&(el.hash||"#"===link))return;if(link&&link.indexOf("mailto:")>-1)return;if(el.target)return;if(!sameOrigin(el.href))return;var path=el.pathname+el.search+(el.hash||"");if(typeof process!=="undefined"&&path.match(/^\/[a-zA-Z]:\//)){path=path.replace(/^\/[a-zA-Z]:\//,"/")}var orig=path;if(path.indexOf(base)===0){path=path.substr(base.length)}if(hashbang)path=path.replace("#!","");if(base&&orig===path)return;e.preventDefault();page.show(orig)}function which(e){e=e||window.event;return null===e.which?e.button:e.which}function sameOrigin(href){var origin=location.protocol+"//"+location.hostname;if(location.port)origin+=":"+location.port;return href&&0===href.indexOf(origin)}page.sameOrigin=sameOrigin},{"path-to-regexp":"node_modules/page/node_modules/path-to-regexp/index"});require.register("node_modules/page/node_modules/path-to-regexp/index",function(require,module,exports){var isarray=require("isarray");module.exports=pathToRegexp;module.exports.parse=parse;module.exports.compile=compile;module.exports.tokensToFunction=tokensToFunction;module.exports.tokensToRegExp=tokensToRegExp;var PATH_REGEXP=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function parse(str){var tokens=[];var key=0;var index=0;var path="";var res;while((res=PATH_REGEXP.exec(str))!=null){var m=res[0];var escaped=res[1];var offset=res.index;path+=str.slice(index,offset);index=offset+m.length;if(escaped){path+=escaped[1];continue;
}if(path){tokens.push(path);path=""}var prefix=res[2];var name=res[3];var capture=res[4];var group=res[5];var suffix=res[6];var asterisk=res[7];var repeat=suffix==="+"||suffix==="*";var optional=suffix==="?"||suffix==="*";var delimiter=prefix||"/";var pattern=capture||group||(asterisk?".*":"[^"+delimiter+"]+?");tokens.push({name:name||key++,prefix:prefix||"",delimiter:delimiter,optional:optional,repeat:repeat,pattern:escapeGroup(pattern)})}if(index<str.length){path+=str.substr(index)}if(path){tokens.push(path)}return tokens}function compile(str){return tokensToFunction(parse(str))}function tokensToFunction(tokens){var matches=new Array(tokens.length);for(var i=0;i<tokens.length;i++){if(typeof tokens[i]==="object"){matches[i]=new RegExp("^"+tokens[i].pattern+"$")}}return function(obj){var path="";var data=obj||{};for(var i=0;i<tokens.length;i++){var token=tokens[i];if(typeof token==="string"){path+=token;continue}var value=data[token.name];var segment;if(value==null){if(token.optional){continue}else{throw new TypeError('Expected "'+token.name+'" to be defined')}}if(isarray(value)){if(!token.repeat){throw new TypeError('Expected "'+token.name+'" to not repeat, but received "'+value+'"')}if(value.length===0){if(token.optional){continue}else{throw new TypeError('Expected "'+token.name+'" to not be empty')}}for(var j=0;j<value.length;j++){segment=encodeURIComponent(value[j]);if(!matches[i].test(segment)){throw new TypeError('Expected all "'+token.name+'" to match "'+token.pattern+'", but received "'+segment+'"')}path+=(j===0?token.prefix:token.delimiter)+segment}continue}segment=encodeURIComponent(value);if(!matches[i].test(segment)){throw new TypeError('Expected "'+token.name+'" to match "'+token.pattern+'", but received "'+segment+'"')}path+=token.prefix+segment}return path}}function escapeString(str){return str.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function escapeGroup(group){return group.replace(/([=!:$\/()])/g,"\\$1")}function attachKeys(re,keys){re.keys=keys;return re}function flags(options){return options.sensitive?"":"i"}function regexpToRegexp(path,keys){var groups=path.source.match(/\((?!\?)/g);if(groups){for(var i=0;i<groups.length;i++){keys.push({name:i,prefix:null,delimiter:null,optional:false,repeat:false,pattern:null})}}return attachKeys(path,keys)}function arrayToRegexp(path,keys,options){var parts=[];for(var i=0;i<path.length;i++){parts.push(pathToRegexp(path[i],keys,options).source)}var regexp=new RegExp("(?:"+parts.join("|")+")",flags(options));return attachKeys(regexp,keys)}function stringToRegexp(path,keys,options){var tokens=parse(path);var re=tokensToRegExp(tokens,options);for(var i=0;i<tokens.length;i++){if(typeof tokens[i]!=="string"){keys.push(tokens[i])}}return attachKeys(re,keys)}function tokensToRegExp(tokens,options){options=options||{};var strict=options.strict;var end=options.end!==false;var route="";var lastToken=tokens[tokens.length-1];var endsWithSlash=typeof lastToken==="string"&&/\/$/.test(lastToken);for(var i=0;i<tokens.length;i++){var token=tokens[i];if(typeof token==="string"){route+=escapeString(token)}else{var prefix=escapeString(token.prefix);var capture=token.pattern;if(token.repeat){capture+="(?:"+prefix+capture+")*"}if(token.optional){if(prefix){capture="(?:"+prefix+"("+capture+"))?"}else{capture="("+capture+")?"}}else{capture=prefix+"("+capture+")"}route+=capture}}if(!strict){route=(endsWithSlash?route.slice(0,-2):route)+"(?:\\/(?=$))?"}if(end){route+="$"}else{route+=strict&&endsWithSlash?"":"(?=\\/|$)"}return new RegExp("^"+route,flags(options))}function pathToRegexp(path,keys,options){keys=keys||[];if(!isarray(keys)){options=keys;keys=[]}else if(!options){options={}}if(path instanceof RegExp){return regexpToRegexp(path,keys,options)}if(isarray(path)){return arrayToRegexp(path,keys,options)}return stringToRegexp(path,keys,options)}},{isarray:"node_modules/page/node_modules/path-to-regexp/node_modules/isarray/index"});require.register("node_modules/page/node_modules/path-to-regexp/node_modules/isarray/index",function(require,module,exports){module.exports=Array.isArray||function(arr){return Object.prototype.toString.call(arr)=="[object Array]"}},{});require.register("node_modules/watchjs/src/watch",function(require,module,exports){"use strict";(function(factory){if(typeof exports==="object"){module.exports=factory()}else if(typeof define==="function"&&define.amd){define(factory)}else{window.WatchJS=factory();window.watch=window.WatchJS.watch;window.unwatch=window.WatchJS.unwatch;window.callWatchers=window.WatchJS.callWatchers}})(function(){var WatchJS={noMore:false},defineWatcher,unwatchOne,callWatchers;var isFunction=function(functionToCheck){var getType={};return functionToCheck&&getType.toString.call(functionToCheck)=="[object Function]"};var isInt=function(x){return x%1===0};var isArray=function(obj){return Object.prototype.toString.call(obj)==="[object Array]"};var isModernBrowser=function(){return Object.defineProperty||Object.prototype.__defineGetter__};var defineGetAndSet=function(obj,propName,getter,setter){try{Object.defineProperty(obj,propName,{get:getter,set:setter,enumerable:true,configurable:true})}catch(error){try{Object.prototype.__defineGetter__.call(obj,propName,getter);Object.prototype.__defineSetter__.call(obj,propName,setter)}catch(error2){throw"watchJS error: browser not supported :/"}}};var defineProp=function(obj,propName,value){try{Object.defineProperty(obj,propName,{enumerable:false,configurable:true,writable:false,value:value})}catch(error){obj[propName]=value}};var watch=function(){if(isFunction(arguments[1])){watchAll.apply(this,arguments)}else if(isArray(arguments[1])){watchMany.apply(this,arguments)}else{watchOne.apply(this,arguments)}};var watchAll=function(obj,watcher,level){if(obj instanceof String||!(obj instanceof Object)&&!isArray(obj)){return}var props=[];if(isArray(obj)){for(var prop=0;prop<obj.length;prop++){props.push(prop)}}else{for(var prop2 in obj){props.push(prop2)}}watchMany(obj,props,watcher,level)};var watchMany=function(obj,props,watcher,level){for(var prop in props){watchOne(obj,props[prop],watcher,level)}};var watchOne=function(obj,prop,watcher,level){if(isFunction(obj[prop])){return}if(obj[prop]!=null&&(level===undefined||level>0)){if(level!==undefined){level--}watchAll(obj[prop],watcher,level)}defineWatcher(obj,prop,watcher)};var unwatch=function(){if(isFunction(arguments[1])){unwatchAll.apply(this,arguments)}else if(isArray(arguments[1])){unwatchMany.apply(this,arguments)}else{unwatchOne.apply(this,arguments)}};var unwatchAll=function(obj,watcher){if(obj instanceof String||!(obj instanceof Object)&&!isArray(obj)){return}var props=[];if(isArray(obj)){for(var prop=0;prop<obj.length;prop++){props.push(prop)}}else{for(var prop2 in obj){props.push(prop2)}}unwatchMany(obj,props,watcher)};var unwatchMany=function(obj,props,watcher){for(var prop2 in props){unwatchOne(obj,props[prop2],watcher)}};if(isModernBrowser()){defineWatcher=function(obj,prop,watcher){var val=obj[prop];watchFunctions(obj,prop);if(!obj.watchers){defineProp(obj,"watchers",{})}if(!obj.watchers[prop]){obj.watchers[prop]=[]}obj.watchers[prop].push(watcher);var getter=function(){return val};var setter=function(newval){var oldval=val;val=newval;if(obj[prop]){watchAll(obj[prop],watcher)}watchFunctions(obj,prop);if(!WatchJS.noMore){if(JSON.stringify(oldval)!==JSON.stringify(newval)){callWatchers(obj,prop,"set",newval,oldval);WatchJS.noMore=false}}};defineGetAndSet(obj,prop,getter,setter)};callWatchers=function(obj,prop,action,newval,oldval){for(var wr in obj.watchers[prop]){if(isInt(wr)){obj.watchers[prop][wr].call(obj,prop,action,newval,oldval)}}};var methodNames=["pop","push","reverse","shift","sort","slice","unshift"];var defineArrayMethodWatcher=function(obj,prop,original,methodName){defineProp(obj[prop],methodName,function(){var response=original.apply(obj[prop],arguments);watchOne(obj,obj[prop]);if(methodName!=="slice"){callWatchers(obj,prop,methodName,arguments)}return response})};var watchFunctions=function(obj,prop){if(!obj[prop]||obj[prop]instanceof String||!isArray(obj[prop])){return}for(var i=methodNames.length,methodName;i--;){methodName=methodNames[i];defineArrayMethodWatcher(obj,prop,obj[prop][methodName],methodName)}};unwatchOne=function(obj,prop,watcher){for(var i in obj.watchers[prop]){var w=obj.watchers[prop][i];if(w==watcher){obj.watchers[prop].splice(i,1)}}}}else{var subjects=[];defineWatcher=function(obj,prop,watcher){subjects.push({obj:obj,prop:prop,serialized:JSON.stringify(obj[prop]),watcher:watcher})};unwatchOne=function(obj,prop,watcher){for(var i in subjects){var subj=subjects[i];if(subj.obj==obj&&subj.prop==prop&&subj.watcher==watcher){subjects.splice(i,1)}}};callWatchers=function(obj,prop,action,value){for(var i in subjects){var subj=subjects[i];if(subj.obj==obj&&subj.prop==prop){subj.watcher.call(obj,prop,action,value)}}};var loop=function(){for(var i in subjects){var subj=subjects[i];var newSer=JSON.stringify(subj.obj[subj.prop]);if(newSer!=subj.serialized){subj.watcher.call(subj.obj,subj.prop,subj.obj[subj.prop],JSON.parse(subj.serialized));subj.serialized=newSer}}};setInterval(loop,50)}WatchJS.watch=watch;WatchJS.unwatch=unwatch;WatchJS.callWatchers=callWatchers;return WatchJS})},{});require.register("src/frontend/scripts/api/loopcast/loopcast",function(require,module,exports){var api_url,on_error;api_url="/api/v1/";on_error=function(method,callback){return function(error){console.error("error calling "+method);console.error(error);return callback(error)}};module.exports={genres:{all:function(callback){var request;request=$.get(api_url+"genres");request.error(on_error("genres",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})}},stream:{get_password:function(room_id,callback){var data,on_status_code,request;on_status_code={401:function(response){return callback("unauthorized, need log in!")}};data={room_id:room_id};request=$.post(api_url+"stream/get_password",data,on_status_code);request.error(on_error("stream/get_password",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})}},upload:{policy_and_signature:function(file_name,callback){var data,on_status_code,request;on_status_code={401:function(response){return callback("unauthorized, need log in!")}};data={file_name:file_name};request=$.post(api_url+"upload/policy_and_signature",data,on_status_code);request.error(on_error("upload/policy_and_signature",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})}},rooms:{is_available:function(title,callback){var data,on_status_code,request;on_status_code={401:function(response){return callback("unauthorized, need log in!")}};data={title:title};request=$.post(api_url+"rooms/is_available",data,on_status_code);request.error(on_error("rooms/is_available",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},info:function(room_id,callback){var request;request=$.get(api_url+("rooms/"+room_id+"/info"));request.error(on_error("rooms/"+room_id+"/info",callback));return request.done(function(response){return callback(null,response)})},stats:function(room_id,callback){var request;request=$.get(api_url+("rooms/"+room_id+"/stats"));request.error(on_error("rooms/"+room_id+"/stats",callback));return request.done(function(response){return callback(null,response)})},create:function(data,callback){var on_status_code,request;on_status_code={401:function(response){return callback("unauthorized, need log in!")}};request=$.post(api_url+"rooms/create",data,on_status_code);request.error(on_error("rooms/create",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},play:function(room_id,callback){var request;request=$.put(api_url+("rooms/"+room_id+"/play"));request.error(on_error("rooms/"+room_id+"/play PUT",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},visit:function(room_id,callback){var request;request=$.put(api_url+("rooms/"+room_id+"/visit"));request.error(on_error("rooms/"+room_id+"/visit PUT",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},update:function(id,data,callback){var request;request=$.put(api_url+("rooms/"+id),data);request.error(on_error("rooms/"+id+" PUT",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},"delete":function(id,callback){var on_status_code,request;on_status_code={401:function(response){return callback("unauthorized, need log in!")}};request=$["delete"](api_url+("rooms/"+id));request.error(on_error("rooms/"+id+" DELETE",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},like:function(room_id,callback){var request;request=$.put(api_url+("rooms/"+room_id+"/like"),{});request.error(on_error("rooms/"+room_id+"/like",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},dislike:function(room_id,callback){var request;request=$.put(api_url+("rooms/"+room_id+"/unlike"),{});request.error(on_error("rooms/"+room_id+"/unlike",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},start_stream:function(room_id,notify,callback){var data,on_status_code,request;on_status_code={401:function(response){return callback("unauthorized, need log in!")}};data={room_id:room_id,notify:notify};request=$.post(api_url+"stream/start",data,on_status_code);request.error(on_error("stream/start",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},stop_stream:function(room_id,callback){var data,on_status_code,request;on_status_code={401:function(response){return callback("unauthorized, need log in!")},412:function(response){return callback("Room not found or user not owner!")}};data={room_id:room_id};request=$.post(api_url+"stream/stop",data,on_status_code);request.error(on_error("stream/stop",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},start_recording:function(room_id,callback){var data,on_status_code,request;on_status_code={401:function(response){return callback("unauthorized, need log in!")},412:function(response){return callback("Room not found or user not owner!")}};data={room_id:room_id};request=$.post(api_url+"tape/start",data,on_status_code);request.error(on_error("tape/start",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},stop_recording:function(room_id,callback){var data,on_status_code,request;on_status_code={401:function(response){return callback("unauthorized, need log in!")}};data={room_id:room_id};request=$.post(api_url+"tape/stop",data,on_status_code);request.error(on_error("tape/stop",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})}},tapes:{get:function(tape_id,callback){var request;request=$.get(api_url+("tape/"+tape_id));request.error(on_error("tape/"+tape_id,callback));return request.done(function(response){return callback(null,response)})},update:function(id,data,callback){var request;request=$.put(api_url+("tape/"+id),data);request.error(on_error("tape/"+id+" PUT",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},"delete":function(id,callback){var on_status_code,request;on_status_code={401:function(response){return callback("unauthorized, need log in!")}};request=$["delete"](api_url+("tape/"+id));request.error(on_error("tape/"+id+" DELETE",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},play:function(tape_id,callback){var request;request=$.put(api_url+("tape/"+tape_id+"/play"));request.error(on_error("tape/"+tape_id+"/play PUT",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},like:function(tape_id,callback){var request;request=$.put(api_url+("tape/"+tape_id+"/like"),{});request.error(on_error("tape/"+tape_id+"/like",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},dislike:function(tape_id,callback){var request;request=$.put(api_url+("tape/"+tape_id+"/unlike"),{});request.error(on_error("tape/"+tape_id+"/unlike",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},comment:function(data,callback){var on_status_code,request;on_status_code={400:function(){return callback("bad request")},401:function(){return callback("unauthorized")},500:function(){return callback("server error")}};request=$.post(api_url+"tape/comment",data,on_status_code);request.error(on_error("tape/comment",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},comments:function(tape_id,callback){var on_status_code,request;on_status_code={400:function(){return callback("bad request")},401:function(){return callback("unauthorized")},500:function(){return callback("server error")}};request=$.get(api_url+"tape/comments/"+tape_id,{},on_status_code);request.error(on_error("tape/comments",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})}},chat:{message:function(data,callback){var on_status_code,request;on_status_code={400:function(){return callback("bad request")},401:function(){return callback("unauthorized")},500:function(){return callback("server error")}};request=$.post(api_url+"chat/message",data,on_status_code);request.error(on_error("chat/message",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},messages:function(room_id,callback){var on_status_code,request;on_status_code={400:function(){return callback("bad request")},401:function(){return callback("unauthorized")},500:function(){return callback("server error")}};request=$.get(api_url+"chat/messages/"+room_id,{},on_status_code);request.error(on_error("chat/messages",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},people:function(room_id,callback){var request;request=$.get(api_url+("chat/"+room_id+"/people"));request.error(on_error("chat/"+room_id+"/people",callback));return request.done(function(response){return callback(null,response)})},enter:function(data,callback){var request;request=$.post(api_url+("chat/"+data.room_id+"/enter"),{user:data.user});request.error(on_error("chat/"+data.room_id+"/enter",callback));return request.done(function(response){return callback(null,response)})}},user:{info:function(user_id,callback){var request;if(user_id==null){log("[Loopcast API] user_id not valid",user_id);return}request=$.get(api_url+("user/"+user_id+"/info"));request.error(on_error("user/"+user_id+"/info",callback));return request.done(function(response){return callback(null,response)})},edit:function(data,callback){var on_status_code,request;on_status_code={401:function(response){return callback("unauthorized, need log in!")}};request=$.post(api_url+"user/edit",data,on_status_code);request.error(on_error("user/edit",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},edit_username:function(username,callback){var data,on_status_code,request;data={username:username};on_status_code={401:function(response){return callback("unauthorized, need log in!")}};request=$.post(api_url+"user/edit/username",data,on_status_code);request.error(on_error("user/edit/username",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},is_available:function(username,callback){var request;request=$.get(api_url+("user/"+username+"/is_available"));request.error(on_error("user/"+username+"/is_available",callback));return request.done(function(response){return callback(null,response)})},socket_id:function(socket_id,callback){var request;if(socket_id.substring(0,1)==="/"){socket_id=socket_id.substring(1)}request=$.put(api_url+("user/socket_id/"+socket_id));request.error(on_error("user/socket_id/"+socket_id,function(){return typeof callback==="function"?callback(true):void 0}));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},status:function(data,callback){var on_status_code,request;on_status_code={401:function(response){return callback("unauthorized, need log in!")}};request=$.post(api_url+"user/status",data,on_status_code);request.error(on_error("user/status",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},follow:function(user_id,callback){var request;request=$.put(api_url+("user/"+user_id+"/follow"));request.error(on_error("user/"+user_id+"/follow",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},appcast_version:function(data,callback){var on_status_code,request;on_status_code={401:function(response){return callback("unauthorized, need log in!")}};request=$.post(api_url+"user/appcast_version",data,on_status_code);request.error(on_error("user/appcast_version",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},unfollow:function(user_id,callback){var request;request=$.put(api_url+("user/"+user_id+"/unfollow"));request.error(on_error("user/"+user_id+"/unfollow",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},following:function(callback){var request;request=$.post(api_url+"user/following");request.error(on_error("user/following",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})},is_following:function(ids,callback){var data,on_status_code,request;on_status_code={401:function(response){return callback("unauthorized, need log in!")}};data={ids:[].concat(ids)};request=$.post(api_url+"user/is_following",data,on_status_code);request.error(on_error("user/is_following",callback));return request.done(function(response){return typeof callback==="function"?callback(null,response):void 0})}}}},{});require.register("src/frontend/scripts/app",function(require,module,exports){var App,ConfirmUsername,L,app,appcast,cloudinary,is_confirm_username,is_login_page,login,navigation,views,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};is_login_page=require("app/utils/is_login_page");is_confirm_username=require("app/utils/is_confirm_username");require("./globals");require("./vendors");window.strip_tags=require("lib/tools/strings/strip_tags");if(!is_login_page()){views=require("./controllers/views");navigation=require("./controllers/navigation");appcast=require("./controllers/appcast");cloudinary=require("./controllers/cloudinary");L=require("app/api/loopcast/loopcast")}App=function(){App.prototype.window=null;App.prototype.settings=null;App.prototype.local=null;App.prototype.session=null;App.prototype.main_view_binded_counter=0;function App(){this.on_views_binded=__bind(this.on_views_binded,this);this.after_render=__bind(this.after_render,this);this.before_load=__bind(this.before_load,this);happens(this)}App.prototype.start=function(){this.local=require("app/controllers/local_connection");this.session=require("app/controllers/storage");this.window=require("app/controllers/window");this.socket=require("app/controllers/socket");this.user=require("./controllers/user");this.rooms=require("./controllers/rooms");this.body=$("body");this.settings=require("app/utils/settings");this.settings.bind(this.body);navigation.on("before_load",this.before_load);navigation.on("after_render",this.after_render);views.on("binded",this.on_views_binded);views.bind("body");if(this.settings.browser_unsupported){return location.href="/oldie"}};App.prototype.before_load=function(){if(navigation.main_refresh()){this.emit("loading:show")}return views.unbind(navigation.content_selector)};App.prototype.after_render=function(){views.bind("#content");return this.user.check_guest_owner()};App.prototype.on_views_binded=function(scope){var v,_this=this;if(!scope.main){return}this.player=view.get_by_dom("#player");if($(".request_preloading").length>0){v=view.get_by_dom(".request_preloading");if(v){return v.on("ready",function(){v.off("ready");v=null;return _this.emit("loading:hide")})}else{return this.emit("loading:hide")}}else{return this.emit("loading:hide")}};App.prototype.login=function(user_data){var url;log("--------> login called from outside",user_data);if(this.settings.after_login_url.length>0){url=this.settings.after_login_url;this.settings.after_login_url=""}else if(navigation.prev_url.length>0&&navigation.prev_url!=="/"){url=navigation.prev_url}else{url="/"+user_data.username}this.user.login(user_data);if(this.settings.action!=null){switch(this.settings.action.type){case"follow":this.user.follow(this.settings.action.user_id);break;case"like":app.player.like();break;case"message":log("[Message to send]",this.settings.action);L.chat.message(this.settings.action.data,function(error,response){})}this.settings.action=null}return navigation.go(url)};App.prototype.logout=function(){var _this=this;return this.user.logout(function(){var url;_this.settings.after_logout_url="/";log("[App] logout callback. next url",_this.settings.after_logout_url);if(_this.settings.after_logout_url.length>0){url=_this.settings.after_logout_url;_this.settings.after_logout_url="";return navigation.go(url)}})};return App}();if(is_login_page()){if(is_confirm_username()){ConfirmUsername=require("app/controllers/confirm_username");$(function(){var confirm;return confirm=new ConfirmUsername})}else{login=require("app/controllers/login");$(function(){return login.start()})}}else{app=new App;$(function(){return app.start()});module.exports=window.app=app}},{"app/utils/is_login_page":"src/frontend/scripts/utils/is_login_page","app/utils/is_confirm_username":"src/frontend/scripts/utils/is_confirm_username","./globals":"src/frontend/scripts/globals","./vendors":"src/frontend/scripts/vendors","lib/tools/strings/strip_tags":"src/lib/tools/strings/strip_tags","./controllers/views":"src/frontend/scripts/controllers/views","./controllers/navigation":"src/frontend/scripts/controllers/navigation","./controllers/appcast":"src/frontend/scripts/controllers/appcast","./controllers/cloudinary":"src/frontend/scripts/controllers/cloudinary","app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","app/controllers/local_connection":"src/frontend/scripts/controllers/local_connection","app/controllers/storage":"src/frontend/scripts/controllers/storage","app/controllers/window":"src/frontend/scripts/controllers/window","app/controllers/socket":"src/frontend/scripts/controllers/socket","./controllers/user":"src/frontend/scripts/controllers/user","./controllers/rooms":"src/frontend/scripts/controllers/rooms","app/utils/settings":"src/frontend/scripts/utils/settings","app/controllers/confirm_username":"src/frontend/scripts/controllers/confirm_username","app/controllers/login":"src/frontend/scripts/controllers/login"});require.register("src/frontend/scripts/controllers/appcast",function(require,module,exports){var L,WebSocket,appcast,aware,counter,socket_options,v,_;_=require("lodash");aware=require("aware");v=require("app/vendors");L=require("app/api/loopcast/loopcast");appcast=aware({});WebSocket=window.WebSocket||null;appcast.messages={};appcast.vu={};counter={limit:0,silence:0};socket_options={reconnectInterval:100,maxReconnectInterval:1500};appcast.set("connected",false);appcast.set("stream:vu",0);appcast.connect=function(){var messages_socket,vu_socket;if(!app.settings.use_appcast){return}if(appcast.get("connected")){console.error("Appcast already connected");return}if(!WebSocket){return console.info("+ socket controller wont connect")}messages_socket="ws://127.0.0.1:51234/loopcast/messages";appcast.messages=new v.ReconnectingWebsocket(messages_socket,null,socket_options);appcast.messages.onopen=function(){console.info("- socket controller connection opened");appcast.set("connected",true);if(appcast.get("selected_device")){appcast.select_device(appcast.get("selected_device"))}appcast.get_devices();return appcast.messages.send(JSON.stringify(["version"]))};appcast.messages.onclose=function(){console.info("- AppCast CLOSED");return delay(100,function(){appcast.set("stream:vu",[0,0]);return appcast.set("connected",false)})};appcast.messages.onmessage=function(e){var args,error,from_json,json,method;json=e.data;try{from_json=JSON.parse(json)}catch(_error){error=_error;console.error("- socket controller error parsing json");console.error(error);return error}method=from_json[0];args=from_json[1];if("error"===method){return console.log("error",args)}if(typeof appcast.callbacks[method]==="function"){return appcast.callbacks[method](args)}else{return console.log(" + socket controller has no callback for:",method)}};vu_socket="ws://127.0.0.1:51234/loopcast/vu";appcast.vu=new v.ReconnectingWebsocket(vu_socket,null,socket_options);appcast.vu.onopen=function(){console.info("- socket VU connection opened");return appcast.set("vu:connected",true)};appcast.vu.onclose=function(){console.info("- socket VU connection closed");appcast.set("vu:connected",false);return appcast.set("stream:vu",0)};return appcast.vu.onmessage=function(e){var reader;reader=new FileReader;reader.onload=function(e){var buffer;buffer=new Float32Array(e.target.result);if(!appcast.get("connected")){return}appcast.set("stream:vu",buffer);if(buffer[0]>=.99||buffer[1]>=.99){counter.limit++}else{counter.limit=0}if(buffer[0]===0||buffer[1]===0){counter.silence++}else{counter.silence=0}appcast.set("vu:clipping",counter.limit>=4);return appcast.set("vu:silent",counter.silence>=6)};return reader.readAsArrayBuffer(e.data)}};appcast.disconnect=function(){appcast.messages.close();return appcast.vu.close()};appcast.get_devices=function(){return appcast.messages.send(JSON.stringify(["get_input_devices"]))};appcast.start_stream=function(username,room_slug,password,device_name){var payload;if(appcast.get("stream:starting")){return console.error("waiting stream to start, cant start again")}if(appcast.get("stream:online")){return console.error("stream is already online, cant start again")}if(!device_name){device_name=appcast.get("selected_device")}payload={device_name:device_name,mount_point:"loopcast-staging/"+username+"_"+room_slug,password:password,port:"80",server:"inbound-a.cdn.audiopump.co"};if(window.is_beta){payload.mount_point="loopcast/"+username+"_"+room_slug;payload.server="inbound-a.cdn.audiopump.co"}console.log("stream with payload ->",payload);appcast.set("stream:starting",true);return appcast.messages.send(JSON.stringify(["start_stream",payload]))};appcast.select_device=function(device_name){var e,payload;appcast.set("selected_device",device_name);appcast.set("stream:vu",0);payload={device_name:device_name};try{return appcast.messages.send(JSON.stringify(["start_audio_device",payload]))}catch(_error){e=_error;return console.error(e)}};appcast.stop_stream=function(){appcast.set("stream:streaming",false);appcast.set("stream:starting",false);appcast.set("stream:stopping",true);appcast.set("stream:vu",0);return appcast.messages.send(JSON.stringify(["stop_stream"]))};appcast.get_version=function(){
return appcast.messages.send(JSON.stringify(["version"]))};appcast.check=function(){var e,error,success;success=function(){console.log("SUCCESS");return console.log(arguments)};error=function(){console.log("ERROR");return console.log(arguments)};try{return $.get("http://127.0.0.1:51234/").done(done).error(error)}catch(_error){e=_error;return console.warn("CATHCED THE ERROR!")}};appcast.callbacks={input_devices:function(args){appcast.set("input_devices",args.devices);if(args.active){return appcast.set("selected_device",args.active)}},audio_device_started:function(args){if(args!=null&&args.error!=null){console.error("- audio_device_started error:",args.error)}},stream_started:function(args){if(args!=null&&args.error!=null){console.error("- stream_started error:",args.error);appcast.set("stream:error",args.error);Intercom("trackEvent","appcast-connection-error");mixpanel.track("Appcast - Connection Error");return}console.info("APPCAST REPLIED: STREAM STARTED!");appcast.set("stream:online",true);appcast.set("stream:starting",null);return appcast.set("stream:error",null)},buffer_status:function(args){if(args!=null&&args.error!=null){console.log("error on buffer status");return}if(args.filled>1){if(appcast.get("buffer:filled")){if(appcast.get("buffer:filled")<args.filled){appcast.set("status","buffering")}}}return appcast.set("buffer:filled",args.filled)},stream_status:function(args){if(args!=null&&args.error!=null){console.log("error on buffer status");return}return appcast.set("status",args.status)},stream_stopped:function(){appcast.set("stream:online",false);appcast.set("stream:streaming",false);appcast.set("stream:recording",false);appcast.set("stream:stopping",null);return appcast.set("stream:vu",0)},version_response:function(data){data.build=Number(data.build);appcast.set("build",data.build);return L.user.appcast_version(data,function(error,callback){if(error){return console.error(error)}})}};module.exports=window.appcast=appcast;appcast.on("status",function(status){return console.info("NEW APPCAST STATUS: "+status)})},{lodash:"node_modules/lodash/index",aware:"node_modules/aware/index","app/vendors":"src/frontend/scripts/vendors","app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast"});require.register("src/frontend/scripts/controllers/cloudinary",function(require,module,exports){var Cloudinary;Cloudinary=function(){var instance;instance=null;Cloudinary.prototype.config={cloud_name:"",api_key:""};function Cloudinary(){if(Cloudinary.instance){console.error("You can't instantiate this Cloudinary twice");return}Cloudinary.instance=this}Cloudinary.prototype.set_config=function(data){if(this.config.cloud_name!==data.cloud_name||this.config.api_key!==data.api_key){this.config=data;return $.cloudinary.config({cloud_name:this.config.cloud_name,api_key:this.config.api_key})}};return Cloudinary}();module.exports=new Cloudinary},{});require.register("src/frontend/scripts/controllers/confirm_username",function(require,module,exports){var ConfirmUsername,api,_,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};api=require("api/loopcast/loopcast");_=require("lodash");module.exports=ConfirmUsername=function(){function ConfirmUsername(){this.submit=__bind(this.submit,this);this.checkUsername=__bind(this.checkUsername,this);var $btn,_this=this;this.input=$(".username");$btn=$("#complete");this.submitting=false;$btn.click(function(e){e.preventDefault();_this.submitting=true;return _this.checkUsername(e)});this.input.on("keyup",_.debounce(this.checkUsername,300))}ConfirmUsername.prototype.checkUsername=function(event){var username,_this=this;username=this.input.val();if(username.length===0){$(".error-box").removeClass("error");return}if(username===window.user.username){window.complete_login();return}return api.user.is_available(username,function(error,response){if(event.keyCode===13){_this.submitting=true}if(!response.available){$(".error-box").addClass("error")}else{$(".error-box").removeClass("error");_this.submit(username)}return _this.submitting=false})};ConfirmUsername.prototype.submit=function(username){if(this.submitting){return api.user.is_available(username,function(error,response){if(error){console.error("username not available");return}if(response.available){return api.user.edit_username(username,function(error,response){if(error){console.error("error updating username");return}window.user.username=username;return window.complete_login()})}})}};return ConfirmUsername}()},{"api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast",lodash:"node_modules/lodash/index"});require.register("src/frontend/scripts/controllers/gui",function(require,module,exports){var GUI,WatchJS,watch,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};WatchJS=require("watchjs");watch=WatchJS.watch;module.exports=GUI=function(){GUI.prototype.opened=false;GUI.prototype.use_keys=false;GUI.prototype.use_click=true;GUI.prototype.toggle_key=68;function GUI(){this.refresh=__bind(this.refresh,this);this.toggle=__bind(this.toggle,this);this.on_key_pressed=__bind(this.on_key_pressed,this);var html;html=require("client_templates/debug/gui");$("body").append(html());this.dom=$("#gui");this.content=this.dom.find(".content");if(this.use_click){this.dom.addClass("clickable").on("click",this.toggle)}if(this.use_keys){$(window).on("keyup",this.on_key_pressed)}}GUI.prototype.on_key_pressed=function(e){if(e.keyCode===this.toggle_key){return this.toggle()}};GUI.prototype.toggle=function(){if(this.opened){return this.close()}else{return this.open()}};GUI.prototype.close=function(){if(!this.opened){return}this.opened=false;return this.dom.addClass("closed")};GUI.prototype.open=function(){if(this.opened){return}this.opened=true;return this.dom.removeClass("closed")};GUI.prototype.watch=function(obj){this.obj=jQuery.extend(true,{},obj);watch(this.obj,this.refresh);return this.refresh()};GUI.prototype.refresh=function(){var html;html=this.print(JSON.stringify(this.obj,void 0,4));return this.content.html(html)};GUI.prototype.print=function(obj){var json;json=obj.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(match){var cls;cls="number";if(/^"/.test(match)){if(/:$/.test(match)){cls="key"}else{cls="string"}}else if(/true|false/.test(match)){cls="boolean"}else if(/null/.test(match)){cls="null"}return'<span class="'+cls+'">'+match+"</span>"})};return GUI}()},{watchjs:"node_modules/watchjs/src/watch","client_templates/debug/gui":"src/frontend/templates/debug/gui"});require.register("src/frontend/scripts/controllers/local_connection",function(require,module,exports){var app,connection;app=require("app/app");connection=new LocalConnection("beta.loopcast.fm");connection.listen();connection.addCallback("login",function(user){console.info(" + location connection, user logged in:",user);return app.login(user)});connection.addCallback("logout",function(){console.info(" + location connection, user logged out");return app.logout()});module.exports=connection},{"app/app":"src/frontend/scripts/app"});require.register("src/frontend/scripts/controllers/login",function(require,module,exports){var Login,Opacity,login;Opacity=require("app/utils/opacity");Login=function(){function Login(){}Login.prototype.start=function(){var ref;log("start",$(".social").length);this.body=$("body").addClass("body_login");this.loading=$("#loading");this.hide_loading();ref=this;return $(".social").on("click",function(e){var href;e.preventDefault();e.stopPropagation();ref.show_loading();href=$(this).attr("href");location.href=href;return false})};Login.prototype.show_loading=function(){this.body.addClass("loading").removeClass("loaded");return Opacity.show(this.loading,100)};Login.prototype.hide_loading=function(){this.body.removeClass("loading").addClass("loaded");return Opacity.hide(this.loading)};return Login}();login=new Login;module.exports=login},{"app/utils/opacity":"src/frontend/scripts/utils/opacity"});require.register("src/frontend/scripts/controllers/navigation",function(require,module,exports){var Navigation,happens,page,settings,url_parser,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};settings=require("app/utils/settings");happens=require("happens");url_parser=require("app/utils/url_parser");page=require("page");Navigation=function(){var instance;instance=null;Navigation.prototype.silent=false;Navigation.prototype.first_time=true;Navigation.prototype.custom_class="";Navigation.prototype.DEFAULT_SELECTOR="#content .inner_content";Navigation.prototype.lock_live=false;Navigation.prototype.locked_live_url="";Navigation.prototype.prev_url="";Navigation.prototype.mobile_style=true;function Navigation(){this.on_content_ready=__bind(this.on_content_ready,this);this.url_changed=__bind(this.url_changed,this);var ref;if(Navigation.instance){console.error("You can't instantiate this Navigation twice");return}Navigation.instance=this;happens(this);this.content_selector=this.DEFAULT_SELECTOR;this.content_div=$(this.content_selector);page("*",this.url_changed);page();ref=this;$("body").on("click","a",function(e){var el,href;el=$(this);href=el.attr("href");if(href==="#"){return e.preventDefault()}else if(el.data("nav-load")&&app.settings.theme==="desktop"){ref.content_selector=el.data("nav-load");return ref.custom_class="loading_on_top "+el.data("nav-custom-class")}})}Navigation.prototype.set_lock_live=function(lock,url){this.lock_live=lock;return this.locked_live_url=url};Navigation.prototype.url_changed=function(req,next){var _this=this;req.url=req.path.replace("/#","");if(!url_parser.is_internal_page(req.url)){next();return}if(req.url.indexOf("/download")===0){return next()}if(this.first_time){this.first_time=false;this.prev_url=req.url;return}if(this.silent){this.silent=false;return}if(this.prev_url===req.url){return}if(this.lock_live){app.emit("exit_modal:request_open");app.on("exit_modal:answered",function(answer){app.off("exit_modal:answered");if(!answer){_this.go_silent(_this.locked_live_url);return next()}else{return _this.load_url(req)}})}else{this.load_url(req)}return this.prev_url=req.url};Navigation.prototype.load_url=function(req){var div,_this=this;this.emit("dropdown:request_close");div=$("<div>");if(this.custom_class.length>0){app.body.addClass(this.custom_class);delay(1,function(){return app.body.addClass("loading_visible")})}delay(10,function(){return _this.emit("before_load")});return div.load(req.url,function(){document.title=div.find("title").html();_this.prev_url=req.url;_this.emit("on_load");_this.emit("before_destroy");if(app.body.scrollTop()>0){app.body.animate({scrollTop:0})}return delay(200,function(){var new_content;new_content=div.find(_this.content_selector).children();if(app.settings.theme==="mobile"){return _this.mobile_append(new_content,_this.on_content_ready)}else{return _this.normal_append(new_content,_this.on_content_ready)}})})};Navigation.prototype.on_content_ready=function(){var _this=this;this.emit("after_render");return delay(200,function(){_this.content_selector=_this.DEFAULT_SELECTOR;app.body.removeClass("loading_visible");return delay(300,function(){app.body.removeClass(_this.custom_class);return _this.custom_class=""})})};Navigation.prototype.mobile_append=function(new_content,callback){var ref;new_content.addClass("moving");this.content_div=$(this.content_selector);ref=this;this.content_div.append(new_content);delay(100,callback);return delay(400,function(){new_content.addClass("moved");return delay(400,function(){$($(".dynamic_wrapper")[0]).remove();new_content.removeClass("moving moved");return ref.emit("content:ready")})})};Navigation.prototype.normal_append=function(new_content,callback){this.content_div=$(this.content_selector);this.content_div.children().remove();this.content_div.append(new_content);this.emit("content:ready");return callback()};Navigation.prototype.go=function(url){if(window.opener!=null){location.href=url;return true}page(url);return false};Navigation.prototype.go_silent=function(url,title){this.prev_url=url;return page.replace(url,null,null,false)};Navigation.prototype.main_refresh=function(){return this.DEFAULT_SELECTOR===this.content_selector};return Navigation}();module.exports=new Navigation},{"app/utils/settings":"src/frontend/scripts/utils/settings",happens:"node_modules/happens/index","app/utils/url_parser":"src/frontend/scripts/utils/url_parser",page:"node_modules/page/index"});require.register("src/frontend/scripts/controllers/notify",function(require,module,exports){var style_html;style_html=function(class_icon){var str;str="<div>\n  <span class='close-notify'>X</span>\n  <span class='icon "+class_icon+"'></span>\n  <span data-notify-text/>\n</div>";return str};$.notify.defaults({autoHideDelay:2e4,clickToHide:false,showAnimation:"fadeIn",hideAnimation:"fadeOut"});$.notify.addStyle("loopcast_info",{html:style_html("ss-info")});$.notify.addStyle("loopcast_success",{html:style_html("ss-check")});$.notify.addStyle("loopcast_error",{html:style_html("ss-alert")});$.notify.addStyle("guest_room_logged",{html:"<div><span class='close-notify'>X</span><span data-notify-text/></div>"});$.notify.addStyle("guest_room_unlogged",{html:"<div><span class='close-notify'>X</span><span data-notify-text/></div>"});$(document).on("click",".close-notify",function(){return $(this).trigger("notify-hide")});module.exports={info:function(msg){return $.notify(msg,{style:"loopcast_info"})},success:function(msg){return $.notify(msg,{style:"loopcast_success"})},error:function(msg){return $.notify(msg,{style:"loopcast_error"})},guest_room_logged:function(msg){return $.notify(msg,{style:"loopcast_success"})},guest_room_unlogged:function(msg){$.notify(msg,{style:"loopcast_success"});return delay(10,function(){return view.bind(".notifyjs-corner")})}}},{});require.register("src/frontend/scripts/controllers/rooms",function(require,module,exports){var RoomsController,api,happens,socket,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};happens=require("happens");socket=require("app/controllers/socket");api=require("app/api/loopcast/loopcast");RoomsController=function(){var instance;instance=null;RoomsController.prototype.data=null;RoomsController.prototype.socket_id=false;RoomsController.prototype.infos={};function RoomsController(){this.on_room_update=__bind(this.on_room_update,this);if(RoomsController.instance){console.error("You can't instantiate this UserController twice");return}RoomsController.instance=this;happens(this)}RoomsController.prototype.info=function(id,type,callback){var on_load,ref;ref=this;if(this.infos[id]==null){socket.rooms.subscribe(id);socket.on(id,this.on_room_update)}on_load=function(error,response){ref.infos[id]={type:type,data:response};return callback(ref.infos[id])};if(type==="room"){return api.rooms.info(id,on_load)}else{return api.tapes.get(id,on_load)}};RoomsController.prototype.on_room_update=function(data){if(this.infos[data._id]==null){return}return this.emit("update",data)};return RoomsController}();module.exports=new RoomsController},{happens:"node_modules/happens/index","app/controllers/socket":"src/frontend/scripts/controllers/socket","app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast"});require.register("src/frontend/scripts/controllers/socket",function(require,module,exports){var L,connection,socket;L=require("api/loopcast/loopcast");connection=io();socket=happens({});connection.on("uid",function(socket_id){var User;socket.id=socket_id;User=require("./user");User.set_socket_id(socket.id);if(User.is_logged()){log("socket id of the logged user",socket_id);return L.user.socket_id(socket.id,function(error,response){})}else{return User.on("user:logged",function(){return L.user.socket_id(socket.id)})}});socket.subscribe=function(channel){return connection.emit("subscribe",channel)};socket.unsubscribe=function(channel){connection.removeAllListeners(channel);return connection.emit("unsubscribe",channel)};socket.rooms={};socket.rooms.subscribe=function(channel,callback){return connection.emit("subscribe-room",channel,callback)};socket.rooms.unsubscribe=function(channel){connection.removeAllListeners(channel);return connection.emit("unsubscribe-room",channel)};socket.on=function(channel,funk){return connection.on(channel,funk)};socket.off=function(channel,funk){return connection.removeListener(channel,funk)};module.exports=socket},{"api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","./user":"src/frontend/scripts/controllers/user"});require.register("src/frontend/scripts/controllers/storage",function(require,module,exports){var Session;Session={};Session.set=function(key,value){return $.jStorage.set(key,value)};Session.get=function(key,_default){var value;if(_default==null){_default=false}value=$.jStorage.get(key,_default);return value};Session["delete"]=function(key){log("[Session] delete",key);return $.jStorage.deleteKey(key)};module.exports=Session},{});require.register("src/frontend/scripts/controllers/user",function(require,module,exports){var UserController,api,happens,navigation,notify,socket,transform,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};transform=require("lib/cloudinary/transform");happens=require("happens");navigation=require("app/controllers/navigation");notify=require("app/controllers/notify");socket=require("app/controllers/socket");api=require("app/api/loopcast/loopcast");UserController=function(){var instance;instance=null;UserController.prototype.data=null;UserController.prototype.is_owner=false;UserController.prototype.socket_id=false;UserController.prototype.infos={};function UserController(){this.on_upload_error=__bind(this.on_upload_error,this);this.on_upload_finished=__bind(this.on_upload_finished,this);this.on_user_followed=__bind(this.on_user_followed,this);this.set_socket_id=__bind(this.set_socket_id,this);this.on_views_binded=__bind(this.on_views_binded,this);if(UserController.instance){console.error("You can't instantiate this UserController twice");return}UserController.instance=this;happens(this);window.user=this;this.fetch_from_session();view.on("binded",this.on_views_binded)}UserController.prototype.on_views_binded=function(scope){var _this=this;if(!scope.main){return}view.off("binded",this.on_views_binded);app.on("appcast:input_device",this.set_preferred_input);return api.user.status({},function(error,response){var callback;log("[User] checking status from the server",error,response.logged);if(error||response.logged===false){callback=function(){};return _this.logout(callback,true)}else if(_this.is_logged()){return _this._dispatch_login()}else{return _this._dispatch_logout()}})};UserController.prototype.set_socket_id=function(socket_id){this.socket_id=socket_id;return this.emit("socket:connected")};UserController.prototype.login=function(data){this.data={_id:data._id,avatar:data.avatar,email:data.email,created_at:data.created_at,images:transform.all(data.avatar),name:data.name,username:data.username};log("[UserController] user:logged",this.data,data);this._dispatch_login();this.write_to_session();return notify.info("You've successfully logged in.")};UserController.prototype.logout=function(callback,disable_notify){var _this=this;if(disable_notify==null){disable_notify=false}log("[UserController] logout");if(!this.is_logged()){if(typeof callback==="function"){callback({error:{code:"node_logged"}})}}log("[User] trying to logout...");return $.post("/api/v1/user/logout",{},function(data){log("[User] logout ~ success",data);if(typeof Intercom==="function"){Intercom("shutdown")}mixpanel.track("User Logged out");_this.delete_session();_this._dispatch_logout();if(!disable_notify){notify.info("You've successfully logged out.")}return typeof callback==="function"?callback():void 0})};UserController.prototype.is_me=function(id){if(!this.is_logged()){return false}return id===this.data._id};UserController.prototype.owner_id=function(){var _ref;return(_ref=document.getElementById("owner_id"))!=null?_ref.value:void 0};UserController.prototype.check_guest_owner=function(){var owner_id;owner_id=this.owner_id();if(owner_id!=null&&this.is_logged()&&this.data._id===owner_id){app.body.addClass("is_owner").removeClass("is_guest");this.is_owner=true}else{app.body.removeClass("is_owner").addClass("is_guest");this.is_owner=false}return this.is_owner};UserController.prototype.create_images=function(){this.data.images=transform.all(this.data.avatar);return this.write_to_session()};UserController.prototype.name_updated=function(data){this.data.username=data.username;this.data.name=data.name;this.emit("name:updated",this.data);return this.write_to_session()};UserController.prototype.check_following=function(ids,callback){return api.user.is_following(ids,function(error,response){return callback(response)})};UserController.prototype.follow=function(user_id){var ref;if(this.data==null){return}ref=this;return api.user.follow(user_id,function(error,result){ref.data.following[user_id]=true;ref.emit("user:followed",user_id);if(error){return console.error("error following #{@user_id}")}})};UserController.prototype.unfollow=function(user_id){var ref;ref=this;return api.user.unfollow(user_id,function(error,result){ref.data.following[user_id]=false;ref.emit("user:unfollowed",user_id);if(error){return console.error("error following #{@user_id}")}})};UserController.prototype.on_user_followed=function(data){return notify.info(data.name+" is following you!")};UserController.prototype.on_upload_finished=function(data){};UserController.prototype.on_upload_error=function(data){};UserController.prototype._dispatch_login=function(){var _this=this;this.create_images();log("[====== USER LOGGED =======]");log(""+this.data.username+" / "+this.data.name);log(this.data);log("[==========================]");socket.subscribe(this.data._id);window.ga("set","userId",this.data._id);socket.on(this.data._id,function(data){if(data.type==="like"){_this.on_user_followed(data);return}if(data.type==="upload:finished"){_this.on_upload_finished(data);return}if(data.type==="upload:error"){_this.on_upload_error(data)}});window.intercomSettings.name=this.data.name;window.intercomSettings.email=this.data.email;window.intercomSettings.widget={activator:"#IntercomDefaultWidget"};window.Intercom("boot",window.intercomSettings);delay(500,function(){return window.Intercom("update",window.intercomSettings)});this.check_guest_owner();app.body.addClass("logged").removeClass("not_logged");this.emit("user:logged",this.data);return api.user.following(function(error,result){var item,_i,_len;if(_this.data===null){return}_this.data.following={};for(_i=0,_len=result.length;_i<_len;_i++){item=result[_i];_this.data.following[item]=true}return _this.emit("following:loaded")})};UserController.prototype.is_following=function(id){var output;output=this.data!=null&&this.data.following!=null&&this.data.following[id]!=null&&this.data.following[id];return output};UserController.prototype._dispatch_logout=function(){log("[====== USER NOT LOGGED =======]");log("[==========================]");this.check_guest_owner();app.body.removeClass("logged").addClass("not_logged");return this.emit("user:unlogged")};UserController.prototype.has_informations=function(){if(this.data&&(this.data.bio!=null||this.data.location!=null)){return true}return false};UserController.prototype.is_logged=function(){if(this.data===null){return false}return this.data};UserController.prototype.get_social_info_from_url=function(s){var social,title;if(s.indexOf("facebook.com")>-1){social="facebook";title="facebook"}else if(s.indexOf("google")>-1){social="google";title="google"}else if(s.indexOf("tumblr")>-1){social="tumblr";title="tumblr"}else if(s.indexOf("twitter.com")>-1){social="twitter";title="twitter"}else if(s.indexOf("vimeo.com")>-1){social="vimeo";title="vimeo"}else if(s.indexOf("youtube.com")>-1){social="youtube";title="youtube"}else if(s.indexOf("spotify.com")>-1){social="spotify";title="spotify"}else if(s.indexOf("soundcloud.com")>-1){social="soundcloud";title="soundcloud"}else{social="generic";title="user link"}return{social:social,title:title,value:s}};UserController.prototype.string_to_social_data=function(data){var item,output,_i,_len;data=data.split(",");output=[];for(_i=0,_len=data.length;_i<_len;_i++){item=data[_i];output.push(this.get_social_info_from_url(item))}return output};UserController.prototype.social_data_to_string=function(data){var item,output,_i,_len;output=[];for(_i=0,_len=data.length;_i<_len;_i++){item=data[_i];output.push(item.value)}return output.join(",")};UserController.prototype.get_info=function(){var data;if(this.data){data={_id:this.data._id,socket_id:this.socket_id,info:{username:this.data.username,name:this.data.name,avatar:this.data.images.chat_sidebar}}}else{data={_id:this.socket_id,socket_id:this.socket_id,info:{username:"guest",name:"Guest"}}}return data};UserController.prototype.info_by_id=function(id,callback){var _this=this;if(this.infos[id]!=null){return callback(this.infos[id])}else{return api.user.info(id,function(error,response){if(!error&&response.length>0){_this.infos[id]=response[0];return callback(_this.infos[id])}else{return log("[User controller info_by_id()] error.",id,error)}})}};UserController.prototype.fetch_from_session=function(){this.data=app.session.get("user",null);if(this.data&&this.data.images==null){return this.create_images()}};UserController.prototype.set_preferred_input=function(input){return app.session.set("input",input)};UserController.prototype.get_preferred_input=function(){return app.session.get("input",false)};UserController.prototype.write_to_session=function(){app.session.set("user",this.data);return this.emit("user:updated",this.data)};UserController.prototype.delete_session=function(){if(this.data._id){socket.unsubscribe(this.data._id)}this.data=null;return app.session["delete"]("user")};return UserController}();module.exports=new UserController},{"lib/cloudinary/transform":"src/lib/cloudinary/transform",happens:"node_modules/happens/index","app/controllers/navigation":"src/frontend/scripts/controllers/navigation","app/controllers/notify":"src/frontend/scripts/controllers/notify","app/controllers/socket":"src/frontend/scripts/controllers/socket","app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast"});require.register("src/frontend/scripts/controllers/views",function(require,module,exports){var View,happens,happens_destroy,view,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};happens=require("happens");happens_destroy=require("app/utils/happens_destroy");View=function(){var UNIQUE_ID;function View(){this.get_by_dom=__bind(this.get_by_dom,this);this.get_by_uid=__bind(this.get_by_uid,this);this.get=__bind(this.get,this)}UNIQUE_ID=0;View.prototype.hash_model={};View.prototype.uid_map={};View.prototype.get=function(id,index){if(index==null){index=0}if(this.hash_model[id]==null){return false}return this.hash_model[id][index]};View.prototype.get_by_uid=function(uid){var index,name;if(this.uid_map[uid]!=null){name=this.uid_map[uid].name;index=this.uid_map[uid].index;return this.get(name,index)}return false};View.prototype.get_by_dom=function(selector){return this.get_by_uid($(selector).data("uid"))};View.prototype.bind=function(scope,tolog){var _this=this;if(scope==null){scope="body"}if(tolog==null){tolog=false}return $(scope).find("[data-view]").each(function(index,item){var $item,name,names,view_name,_i,_len;$item=$(item);view_name=$item.data("view");$item.removeAttr("data-view");if(view_name.substring(0,1)==="["){names=view_name.substring(1,view_name.length-1).split(",")}else{names=[view_name]}for(_i=0,_len=names.length;_i<_len;_i++){name=names[_i];_this._add_view($item,name)}return $item.removeAttr("data-view")}).promise().done(function(){var data;data={scope:scope,main:scope==="body"||scope==="#content"};return _this.emit("binded",data)})};View.prototype.unbind=function(scope){var _this=this;if(scope==null){scope="body"}log("[VIEW] unbind",scope);return $(scope).find("[data-uid]").each(function(index,item){var $item,id,v;$item=$(item);id=$item.data("uid");v=view.get_by_uid(id);if(v){return _this.destroy_view(v)}}).promise().done(function(){var data;data={scope:scope,main:scope==="body"||scope==="#content"};return _this.emit("unbinded",data)})};View.prototype.destroy_view=function(v){happens_destroy(v);if(typeof v.destroy==="function"){v.destroy()}v.view_name=null;return view.on_view_destroyed(v.uid)};View.prototype._add_view=function($item,view_name){var e,l,view,_base;try{view=require("app/views/"+view_name)}catch(_error){e=_error;console.warn("e ->",e.message,view_name);console.error("app/views/"+view+" not found for ",$item)}view=new view($item);if((_base=this.hash_model)[view_name]==null){_base[view_name]=[]}l=this.hash_model[view_name].length;this.hash_model[view_name][l]=view;view.uid=UNIQUE_ID;view.view_name=view_name;$item.attr("data-uid",UNIQUE_ID);this.uid_map[UNIQUE_ID]={name:view_name,index:this.hash_model[view_name].length-1};return UNIQUE_ID++};View.prototype.on_view_destroyed=function(uid){var i,index,item,name,_i,_len,_ref,_results;if(this.uid_map[uid]!=null){name=this.uid_map[uid].name;index=this.uid_map[uid].index;if(this.hash_model[name][index]!=null){delete this.uid_map[uid];this.hash_model[name].splice(index,1);_ref=this.hash_model[name];_results=[];for(i=_i=0,_len=_ref.length;_i<_len;i=++_i){item=_ref[i];_results.push(this.uid_map[item.uid].index=i)}return _results}}};return View}();view=new View;happens(view);module.exports=window.view=view},{happens:"node_modules/happens/index","app/utils/happens_destroy":"src/frontend/scripts/utils/happens_destroy"});require.register("src/frontend/scripts/controllers/window",function(require,module,exports){var happens,on_resize,on_scroll,settings,win;happens=require("happens");settings=require("app/utils/settings");win={obj:Object,w:0,h:0,y:0};module.exports=happens(win);win.obj=$(window);win.obj.on("resize",on_resize=function(){win.w=win.obj.width();win.h=win.obj.height();settings.theme="desktop";if(win.w<settings.threshold_theme){settings.theme="mobile"}return win.emit("resize")});delay(100,on_resize);$("body").on("click",function(e){return win.emit("body:clicked",e)});win.obj.on("scroll",on_scroll=function(){var d,y;y=Math.max(0,win.obj.scrollTop());d=y>win.y?"down":"up";win.y=y;return win.emit("scroll",{y:win.y,direction:d})});win.obj.on("blur focus",function(e){var prevType;prevType=win.obj.data("prevType");if(prevType!==e.type){switch(e.type){case"blur":win.emit("blur");break;case"focus":win.emit("focus")}}return win.obj.data("prevType",e.type)});delay(100,on_scroll)},{happens:"node_modules/happens/index","app/utils/settings":"src/frontend/scripts/utils/settings"});require.register("src/frontend/scripts/globals",function(require,module,exports){window.delay=require("./globals/delay");window.interval=require("./globals/interval");window.log=function(){};window.mover=require("./globals/mover");window.slugify=function(str){return str.split(" ").join("-")};window.happens=require("happens");window.api={loopcast:require("./api/loopcast/loopcast")};module.exports=window},{"./globals/delay":"src/frontend/scripts/globals/delay","./globals/interval":"src/frontend/scripts/globals/interval","./globals/mover":"src/frontend/scripts/globals/mover",happens:"node_modules/happens/index","./api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast"});require.register("src/frontend/scripts/globals/delay",function(require,module,exports){module.exports=function(delay,funk){return setTimeout(funk,delay)}},{});require.register("src/frontend/scripts/globals/interval",function(require,module,exports){module.exports=function(interval,funk){return setInterval(funk,interval)}},{});require.register("src/frontend/scripts/globals/log",function(require,module,exports){module.exports=function(){log.history=log.history||[];
log.history.push(arguments);if(typeof console!=="undefined"&&console!==null){return console.log(Array.prototype.slice.call(arguments))}}},{});require.register("src/frontend/scripts/globals/mover",function(require,module,exports){module.exports={scroll_to:function(el,with_topbar,speed){var y;if(with_topbar==null){with_topbar=false}if(speed==null){speed=300}y=el.position().top;log("[Mover] scroll_to",y);return this.scroll_to_y(y,with_topbar,speed)},scroll_to_y:function(y,with_topbar,speed){if(with_topbar==null){with_topbar=true}if(speed==null){speed=300}if(with_topbar){y-=app.settings.header_height}log("[mover] scroll_to_y",y);y+=20;return $("html, body").animate({scrollTop:y},speed)}}},{});require.register("src/frontend/scripts/utils/browser",function(require,module,exports){var BrowserDetect;BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";return this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(data){var dataProp,dataString,i;i=0;while(i<data.length){dataString=data[i].string;dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!==-1){return data[i].identity}}else{if(dataProp){return data[i].identity}}i++}},searchVersion:function(dataString){var index;index=dataString.indexOf(this.versionSearchString);if(index===-1){return}return parseFloat(dataString.substring(index+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();module.exports=BrowserDetect},{});require.register("src/frontend/scripts/utils/get_host",function(require,module,exports){module.exports=function(){var arr,url;url=window.location.href;arr=url.split("/");return arr[0]+"//"+arr[2]}},{});require.register("src/frontend/scripts/utils/happens_destroy",function(require,module,exports){module.exports=function(obj){if(obj.emit!=null){obj.on=null;obj.once=null;obj.off=null;obj.emit=null;obj.__listeners=null;return obj.__init=null}}},{});require.register("src/frontend/scripts/utils/io/get_coords",function(require,module,exports){module.exports=function(event){var data,el,offset;el=$(event.currentTarget);offset=el.offset();data={x:offset.left,y:offset.top,w:el.width(),h:el.height()};log("[Coords]","offset: ",data.x,data.y);return data}},{});require.register("src/frontend/scripts/utils/is_confirm_username",function(require,module,exports){module.exports=function(){return location.href.indexOf("login/successful")>0}},{});require.register("src/frontend/scripts/utils/is_login_page",function(require,module,exports){module.exports=function(){return location.href.indexOf("login")>0}},{});require.register("src/frontend/scripts/utils/login_popup",function(require,module,exports){var popup;popup=require("app/utils/popup");module.exports=function(){return popup({url:"/login",title:"Log In ~ Loopcast",w:450,h:470})}},{"app/utils/popup":"src/frontend/scripts/utils/popup"});require.register("src/frontend/scripts/utils/opacity",function(require,module,exports){var Opacity;Opacity={show:function(el,time){if(time==null){time=500}return el.fadeIn(time)},hide:function(el,time){if(time==null){time=500}return el.fadeOut(time)},get_time:function(time){return time/1e3+"s"}};module.exports=Opacity},{});require.register("src/frontend/scripts/utils/popup",function(require,module,exports){module.exports=function(data){var left,params,top;left=app.window.w/2-data.w/2;top=app.window.h/2-data.h/2;params="toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+data.w+", height="+data.h+", top="+top+", left="+left;return window.open(data.url,data.title,params).focus()}},{});require.register("src/frontend/scripts/utils/preload",function(require,module,exports){module.exports=function(images,callback){var count,images_loaded,item,load,loaded,_i,_len,_results;count=0;images_loaded=[];load=function(src,callback){var img;img=new Image;img.onload=callback;img.src=src;return images_loaded.push(img)};loaded=function(){count++;if(count===images.length){return callback(images_loaded)}};_results=[];for(_i=0,_len=images.length;_i<_len;_i++){item=images[_i];_results.push(load(item,loaded))}return _results}},{});require.register("src/frontend/scripts/utils/progress_dragger",function(require,module,exports){var ProgressDragger,happens,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};happens=require("happens");module.exports=ProgressDragger=function(){ProgressDragger.prototype.moving=false;function ProgressDragger(dom){var evts;this.dom=dom;this.on_mouse_up=__bind(this.on_mouse_up,this);this.on_mouse_move=__bind(this.on_mouse_move,this);this.on_mouse_down=__bind(this.on_mouse_down,this);happens(this);this.handler=this.dom.find("span");evts=app.settings.events_map;this.dom.on(evts.down,this.on_mouse_down);app.window.obj.on(evts.move,this.on_mouse_move);app.window.obj.on(evts.up,this.on_mouse_up)}ProgressDragger.prototype.get_x=function(e){if(e.pageX){return e.pageX}return e.originalEvent.touches[0].pageX};ProgressDragger.prototype.on_mouse_down=function(e){this.dom=$(e.currentTarget);this.x_dom=this.dom.offset().left;this.size=this.dom.width();this.x_start=this.get_x(e);this.dragging=true;return this.emit("drag:started")};ProgressDragger.prototype.on_mouse_move=function(e){var total,x;if(!this.dragging){return}x=this.get_x(e);total=x-this.x_dom;this.perc=Math.min(100,Math.max(0,100*total/this.size));this.moving=true;this.emit("drag",this.perc);log("[ProgressDragger] on_mouse_move",this.perc);return e.preventDefault()};ProgressDragger.prototype.on_mouse_up=function(e){if(!this.dragging){return}log("[ProgressDragger] on_mouse_up",this.perc);this.emit("drag:ended",this.perc);if(!this.moving){this.emit("click",e)}this.dragging=false;return this.moving=false};ProgressDragger.prototype.destroy=function(){this.dom.off(evts.down,this.on_mouse_down);app.window.obj.off(evts.move,this.on_mouse_move);app.window.obj.on(evts.up,this.on_mouse_up);return this.dom=null};return ProgressDragger}()},{happens:"node_modules/happens/index"});require.register("src/frontend/scripts/utils/rooms/normalize_info",function(require,module,exports){var moment;moment=require("moment");module.exports=function(data,is_live){var obj;obj={original_data:data,data:{}};if(is_live){obj.data={_id:data.room._id,started_at:data.room.status.live.started_at,slug:data.room.info.slug,cover_url:data.room.info.cover_url,title:data.room.info.title,about:data.room.info.about,user:data.user,liked:data.liked,is_live:true,url:data.room.info.url}}else{obj.data={_id:data.tape._id,started_at:moment(),slug:data.tape.slug,cover_url:data.tape.cover_url,title:data.tape.title,about:data.tape.about,user:data.tape.user,liked:data.liked,is_live:false,url:data.tape.s3.location}}return obj}},{moment:"node_modules/moment/moment"});require.register("src/frontend/scripts/utils/rooms/people_list",function(require,module,exports){var PeopleList,happens;happens=require("happens");module.exports=PeopleList=function(){PeopleList.prototype.list={};PeopleList.prototype.ids={};PeopleList.prototype.total=0;function PeopleList(){this.list={};this.ids={};happens(this);window.people_list=this}PeopleList.prototype.add=function(data){var user;user=data.user;log("[PeopleList] ######## ADD",user.socket_id,data,user.name);if(this.ids[user.id]!=null||user.socket_id==null){return false}this.total++;this.list[user.socket_id]=user;if(user.id!=null){this.ids[user.id]=user.socket_id}this.emit("listener:added",{item:user,total:this.total});return true};PeopleList.prototype.remove=function(data){var obj,socket_id;socket_id=data.user.socket_id;log("[PeopleList] ########## THE REMOVE",data,socket_id,this.list);if(this.list[socket_id]!=null){this.total--;obj=this.list[socket_id];this.list[socket_id]=null;delete this.list[socket_id];this.remove_id_by_socket_id(socket_id);this.emit("listener:removed",{item:obj,total:this.total});return true}return false};PeopleList.prototype.remove_id_by_socket_id=function(socket_id){var i,item,_ref,_results;_ref=this.ids;_results=[];for(i in _ref){item=_ref[i];if(item===socket_id){this.ids[i]=null;_results.push(delete this.ids[i])}else{_results.push(void 0)}}return _results};PeopleList.prototype.destroy=function(){this.list={};this.ids={};delete this.list;delete this.ids;return this.total=0};return PeopleList}()},{happens:"node_modules/happens/index"});require.register("src/frontend/scripts/utils/rooms/tape/send_message",function(require,module,exports){var L;L=require("app/api/loopcast/loopcast");module.exports=function(tape_id,message,payload){var data;if(payload==null){payload={}}if(app.settings.touch_device){document.activeElement.blur()}data={tape_id:tape_id,message:message,payload:payload};return L.tapes.comment(data,function(error,response){if(error){console.error("sending message: ",error)}})}},{"app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast"});require.register("src/frontend/scripts/utils/rooms/update_room_link_by_username",function(require,module,exports){module.exports=function(url,new_name){var temp;temp=url.split("/");temp[1]=new_name;return temp.join("/")}},{});require.register("src/frontend/scripts/utils/settings",function(require,module,exports){var BrowserDetect,detectIE,has3d,is_ie,platform,ratio,settings;BrowserDetect=require("app/utils/browser");detectIE=function(){var edge,msie,rv,trident,ua;ua=window.navigator.userAgent;msie=ua.indexOf("MSIE ");if(msie>0){return parseInt(ua.substring(msie+5,ua.indexOf(".",msie)),10)}trident=ua.indexOf("Trident/");if(trident>0){rv=ua.indexOf("rv:");return parseInt(ua.substring(rv+3,ua.indexOf(".",rv)),10)}edge=ua.indexOf("Edge/");if(edge>0){return parseInt(ua.substring(edge+5,ua.indexOf(".",edge)),10)}return false};settings={browser:{id:BrowserDetect.browser,version:BrowserDetect.version,OS:BrowserDetect.OS,chrome:navigator.userAgent.toLowerCase().indexOf("chrome")>-1,firefox:/Firefox/i.test(navigator.userAgent),ie8:false,device_ratio:window.devicePixelRatio,handheld:false,tablet:false,mobile:false,desktop:false,device:false,debug:false,css_cover_supported:Modernizr.backgroundsize,min_size:{w:900,h:400}},webp:false};is_ie=detectIE();if(is_ie){settings.browser.id="Explorer";settings.browser.version=is_ie}settings.theme="desktop";settings.threshold_theme=700;settings.browser_unsupported=settings.browser.id==="Explorer"&&settings.browser.version<10;settings.browser.retina=settings.browser.device_ratio===2;if(settings.browser.chrome&&settings.browser.version>=30){settings.webp=true}if(settings.browser.id==="Explorer"){settings.browser.ie=true;if(settings.browser.version===8){settings.browser.ie8=true}if(settings.browser.version===9){settings.browser.ie9=true}}settings.video_active=settings.browser.id!=="Explorer";if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){settings.browser.handheld=true;ratio=$(window).width()/$(window).height();settings.browser.orientation=ratio>1?"landscape":"portrait";if($(window).width()<610||settings.browser.orientation==="landscape"&&ratio>2.1){settings.browser.mobile=true;settings.browser.tablet=false}else{settings.browser.mobile=false;settings.browser.tablet=true}}settings.browser.device=settings.browser.tablet||settings.browser.mobile;if(settings.browser.tablet===false&&settings.browser.mobile===false){settings.browser.desktop=true}settings.browser.windows_phone=false;if(settings.browser.mobile&&settings.browser.id==="Explorer"){settings.browser.windows_phone=true}settings.touch_device=settings.browser.handheld;settings.events_map={down:"mousedown",up:"mouseup",move:"mousemove"};if(settings.browser.device){if(settings.browser.windows_phone){settings.events_map={down:"MSPointerDown",up:"MSPointerUp",move:"MSPointerMove"}}else{settings.events_map={down:"touchstart",up:"touchend",move:"touchmove"}}}if(settings.browser.desktop){platform="desktop"}else if(settings.browser.tablet){platform="tablet"}else{platform="mobile"}settings.after_login_url="";settings.after_logout_url="";settings.browser_class=settings.browser.id+"_"+settings.browser.version;has3d=function(){var el,t,transforms;el=document.createElement("p");has3d=void 0;transforms={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(el,null);for(t in transforms){if(el.style[t]!==undefined){el.style[t]="translate3d(1px,1px,1px)";has3d=window.getComputedStyle(el).getPropertyValue(transforms[t])}}document.body.removeChild(el);return has3d!==undefined&&has3d.length>0&&has3d!=="none"};settings.bind=function(body){var klasses;klasses=[];klasses.push(settings.browser_class);klasses.push(settings.browser.OS.replace("/","_"));klasses.push(settings.browser.id);if(settings.touch_device){klasses.push("touch_device")}else{klasses.push("no_touch_device")}if(settings.browser.css_cover_supported){klasses.push("css_cover_supported")}body.addClass(klasses.join(" ").toLowerCase());return settings.header_height=$("header").height()};settings.use_appcast=true;module.exports=settings},{"app/utils/browser":"src/frontend/scripts/utils/browser"});require.register("src/frontend/scripts/utils/string",function(require,module,exports){module.exports={is_empty:function(str){var s;if(!str){return true}s=str.replace(/\s+/g,"");return s.length<=0},trim:function(str){return str.replace(/(\r\n|\n|\r)/gm,"")},line_breaks_to_br:function(str){return str.replace(/(?:\r\n|\r|\n)/g,"<br />")},cut_text:function(str,max){if(str.length>max-3){return str.substring(0,max-3)+"..."}else{return str}}}},{});require.register("src/frontend/scripts/utils/time/livestamp",function(require,module,exports){var $livestamps,init,livestampGlobal,livestampLocal,moment,paused,prep,run,updateInterval;moment=require("moment");updateInterval=1e3;paused=false;$livestamps=$([]);init=function(){livestampGlobal.resume()};prep=function($el,timestamp){var newData,oldData;oldData=$el.data("livestampdata");if(typeof timestamp==="number"){timestamp*=1e3}$el.removeAttr("data-livestamp").removeData("livestamp");timestamp=moment(timestamp);if(moment.isMoment(timestamp)&&!isNaN(+timestamp)){newData=$.extend({},{original:$el.contents()},oldData);newData.moment=moment(timestamp);$el.data("livestampdata",newData).empty();$livestamps.push($el[0])}};run=function(){if(paused){return}livestampGlobal.update();setTimeout(run,updateInterval)};livestampGlobal={update:function(){var toRemove;$("[data-livestamp]").each(function(){var $this;$this=$(this);prep($this,$this.data("livestamp"))});toRemove=[];$livestamps.each(function(){var $this,data,e,from,to;$this=$(this);data=$this.data("livestampdata");if(data===void 0){toRemove.push(this)}else if(moment.isMoment(data.moment)){from=$this.html();to=data.moment.fromNow();if(from!==to){e=$.Event("change.livestamp");$this.trigger(e,[from,to]);if(!e.isDefaultPrevented()){$this.html(to)}}}});$livestamps=$livestamps.not(toRemove)},pause:function(){paused=true},resume:function(){paused=false;run()},interval:function(interval){if(interval===void 0){return updateInterval}updateInterval=interval}};livestampLocal={add:function($el,timestamp){if(typeof timestamp==="number"){timestamp*=1e3}timestamp=moment(timestamp);if(moment.isMoment(timestamp)&&!isNaN(+timestamp)){$el.each(function(){prep($(this),timestamp)});livestampGlobal.update()}return $el},destroy:function($el){$livestamps=$livestamps.not($el);$el.each(function(){var $this,data;$this=$(this);data=$this.data("livestampdata");if(data===void 0){return $el}$this.html(data.original?data.original:"").removeData("livestampdata")});return $el},isLivestamp:function($el){return $el.data("livestampdata")!==void 0}};$.livestamp=livestampGlobal;$(init);$.fn.livestamp=function(method,options){if(!livestampLocal[method]){options=method;method="add"}return livestampLocal[method](this,options)};module.exports=function(){}},{moment:"node_modules/moment/moment"});require.register("src/frontend/scripts/utils/time/now_to_seconds",function(require,module,exports){var moment;moment=require("moment");module.exports=function(start_time){var now,s,started;now=moment().utc();started=moment(start_time);s=now.diff(started,"seconds");s=Math.max(0,s);return s}},{moment:"node_modules/moment/moment"});require.register("src/frontend/scripts/utils/time/time_to_string",function(require,module,exports){var moment;moment=require("moment");module.exports=function(seconds){var hours,minutes,sec_num;sec_num=parseInt(seconds,10);hours=Math.floor(sec_num/3600);minutes=Math.floor((sec_num-hours*3600)/60);seconds=sec_num-hours*3600-minutes*60;if(hours<10){hours="0"+hours}if(minutes<10){minutes="0"+minutes}if(seconds<10){seconds="0"+seconds}return{str:""+hours+":"+minutes+":"+seconds,seconds:sec_num}}},{moment:"node_modules/moment/moment"});require.register("src/frontend/scripts/utils/url_parser",function(require,module,exports){var UrlParser;UrlParser={is_file:function(url){var temp;temp=url.split(".");return temp[temp.length-1].length<4},get_pathname:function(url){var find,re;find=location.origin;re=new RegExp(find,"g");return url.replace(re,"")},is_url:function(s){var regexp;regexp=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return regexp.test(s)},is_internal_page:function(url){if(url.indexOf("http")===0){return false}return true},make_absolute:function(url){if(url.indexOf("http")!==0){url="http://"+location.host+url}return url}};module.exports=UrlParser},{});require.register("src/frontend/scripts/vendors",function(require,module,exports){var vendors;vendors={Modernizr:require("../vendors/modernizr.custom.js"),LocalConnection:require("../vendors/LocalConnection.js"),ReconnectingWebsocket:require("../vendors/reconnecting-websocket.js"),JqueryUiWidget:require("../vendors/jquery.ui.widget.js"),IframeTransport:require("../vendors/jquery.iframe-transport.js"),FileUpload:require("../vendors/jquery.fileupload.js"),Cloudinary:require("../vendors/jquery.cloudinary.js"),Jstorage:require("../vendors/jstorage.js"),Parallax:require("../vendors/parallax.min.js"),NotifyJs:require("../vendors/notify.min.js"),JPutDel:require("../vendors/jquery.put.delete.js"),AutoLink:require("../vendors/autolink-min.js"),Waveform:require("../vendors/waveform.js")};module.exports=vendors},{"../vendors/modernizr.custom.js":"src/frontend/vendors/modernizr.custom","../vendors/LocalConnection.js":"src/frontend/vendors/LocalConnection","../vendors/reconnecting-websocket.js":"src/frontend/vendors/reconnecting-websocket","../vendors/jquery.ui.widget.js":"src/frontend/vendors/jquery.ui.widget","../vendors/jquery.iframe-transport.js":"src/frontend/vendors/jquery.iframe-transport","../vendors/jquery.fileupload.js":"src/frontend/vendors/jquery.fileupload","../vendors/jquery.cloudinary.js":"src/frontend/vendors/jquery.cloudinary","../vendors/jstorage.js":"src/frontend/vendors/jstorage","../vendors/parallax.min.js":"src/frontend/vendors/parallax.min","../vendors/notify.min.js":"src/frontend/vendors/notify.min","../vendors/jquery.put.delete.js":"src/frontend/vendors/jquery.put.delete","../vendors/autolink-min.js":"src/frontend/vendors/autolink-min","../vendors/waveform.js":"src/frontend/vendors/waveform"});require.register("src/frontend/scripts/views/buttons/notify",function(require,module,exports){module.exports=function(dom){return dom.click(function(){if(dom.find("input").attr("checked")){return dom.find("input").removeAttr("checked")}else{console.log("input ->",dom.find("input"));dom.find("input").attr("checked","checked");return dom.find("input")[0].checked=true}})}},{});require.register("src/frontend/scripts/views/buttons/share",function(require,module,exports){var Share,Url,get_host,transform,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};Url=require("app/utils/url_parser");transform=require("lib/cloudinary/transform");get_host=require("app/utils/get_host");module.exports=Share=function(){Share.prototype.opened=false;Share.prototype.handler=null;Share.prototype.black_box=null;Share.prototype.input=null;Share.prototype.copy_btn=null;function Share(dom){var html,ref;this.dom=dom;this.share_on_google=__bind(this.share_on_google,this);this.share_on_twitter=__bind(this.share_on_twitter,this);this.share_on_facebook=__bind(this.share_on_facebook,this);this.open=__bind(this.open,this);this.close=__bind(this.close,this);this.toggle=__bind(this.toggle,this);this.on_copy_clicked=__bind(this.on_copy_clicked,this);this.on_share_opened=__bind(this.on_share_opened,this);ref=this;this.normal_type=this.dom.data("type")==null;if(this.normal_type){html=require("client_templates/buttons/share");this.dom.append(html())}this.handler=this.dom.find(".ss-action");this.black_box=this.dom.find(".share_box");this.input=this.dom.find("input");this.copy_btn=this.dom.find(".button");this.facebook_link=this.dom.find(".share_popup_facebook, .share_fb");this.twitter_link=this.dom.find(".share_popup_twitter, .share_twitter");this.google_link=this.dom.find(".share_popup_google, .share_google");this.handler.on("click",this.toggle);this.dom.on("click",function(e){return e.stopPropagation()});this.input.on("click",this.select);this.copy_btn.on("click",this.on_copy_clicked);app.on("share:opened",this.on_share_opened);app.window.on("body:clicked",this.close);app.window.on("scroll",this.close);this.facebook_link.on("click",this.share_on_facebook);this.twitter_link.on("click",this.share_on_twitter);this.google_link.on("click",this.share_on_google);if(this.dom.data("permalink")!=null){this.update_with_data({link:Url.make_absolute(this.dom.data("permalink")),title:this.dom.data("title"),summary:this.dom.data("summary"),image:this.dom.data("image")})}}Share.prototype.update_with_data=function(data){this.data=data;this.data.link=Url.make_absolute(this.data.link);this.data.image=Url.make_absolute(transform.explore_thumb(this.data.image));return this.update_link(this.data.link)};Share.prototype.on_share_opened=function(uid){if(uid!==this.uid){return this.close()}};Share.prototype.on_copy_clicked=function(){var text;this.input[0].select();if(app.settings.browser.OS==="Mac"){text="Press CMD + C to copy the link"}else{text="Press Ctrl + C to copy the link"}return false};Share.prototype.toggle=function(e){if(this.opened){this.close()}else{this.open()}return e.preventDefault()};Share.prototype.close=function(){if(!this.opened){return}this.opened=false;return this.dom.removeClass("opened")};Share.prototype.open=function(){var diff,h,top,y,_this=this;if(this.opened){return}this.opened=true;app.emit("share:opened",this.uid);top=this.handler.offset().top;y=app.window.y;h=this.black_box.height();diff=top-y;if(diff<h+100){this.dom.addClass("on_bottom")}else{this.dom.removeClass("on_bottom")}this.dom.addClass("opened");return delay(1,function(){var o,w1;o=_this.black_box.offset();w1=_this.black_box.width();if(o.left+w1>app.window.w-20){return _this.dom.addClass("on_right")}else if(o.left<0){_this.dom.addClass("on_left");return _this.black_box.css({"margin-left":o.left})}})};Share.prototype.update_link=function(link){if(link.indexOf("http")<0){link=get_host()+link}this.data.link=link;return this.input.val(this.data.link)};Share.prototype.destroy=function(){this.handler.off("click",this.toggle);this.dom.off("click");this.input.off("click",this.select);this.copy_btn.off("click",this.on_copy_clicked);app.off("share:opened",this.on_share_opened);app.window.off("body:clicked",this.close);app.window.off("scroll",this.close);this.facebook_link.off("click",this.share_on_facebook);this.twitter_link.off("click",this.share_on_twitter);return this.google_link.off("click",this.share_on_google)};Share.prototype.share_on_facebook=function(){log("data shared on facebook",this.data);FB.ui({method:"feed",link:this.data.link,caption:this.data.title,description:this.data.summary,picture:this.data.image},function(response){return log(response)});return false};Share.prototype.share_on_twitter=function(){this.open_popup("http://twitter.com/share?text="+this.data.title+"&amp;url="+this.data.link+"&amp;hashtags=loopcast");return false};Share.prototype.share_on_google=function(){this.open_popup("https://plus.google.com/share?url="+this.data.link);return false};Share.prototype.open_popup=function(url){var h,left,top,w;w=548;h=325;left=screen.width/2-w/2;top=screen.height/2-h/2;window.open(url,"sharer","toolbar=0,status=0,width="+w+",height="+h+",top="+top+",left="+left);return false};return Share}()},{"app/utils/url_parser":"src/frontend/scripts/utils/url_parser","lib/cloudinary/transform":"src/lib/cloudinary/transform","app/utils/get_host":"src/frontend/scripts/utils/get_host","client_templates/buttons/share":"src/frontend/templates/buttons/share"});require.register("src/frontend/scripts/views/buttons/start_stop",function(require,module,exports){var StartStop,happens,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};happens=require("happens");module.exports=StartStop=function(){StartStop.prototype.started=false;StartStop.prototype.first_click=true;function StartStop(dom){this.dom=dom;this.toggle=__bind(this.toggle,this);happens(this);this.dom.addClass("start_stop");this.dom.on("click",this.toggle);if(this.dom.data("width")==="fixed"){this.lock_width()}}StartStop.prototype.lock_width=function(){var start_button,stop_button,w;start_button=this.dom.find(".start");stop_button=this.dom.find(".stop");w=Math.max(start_button.width(),stop_button.width())+2;start_button.width(w);return stop_button.width(w)};StartStop.prototype.toggle=function(){if(this.started){this.stop()}else{this.start()}return this.first_click=false};StartStop.prototype.stop=function(){if(!this.started){return}this.started=false;this.dom.removeClass("started");return this.emit("change","stop")};StartStop.prototype.start=function(){if(this.started){return}this.started=true;this.dom.addClass("started");return this.emit("change","start")};return StartStop}()},{happens:"node_modules/happens/index"});require.register("src/frontend/scripts/views/chat/collapsable_content",function(require,module,exports){var CollapsableContent,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};module.exports=CollapsableContent=function(){CollapsableContent.prototype.expanded=false;CollapsableContent.prototype.max_length=100;function CollapsableContent(dom){this.dom=dom;this.check_length=__bind(this.check_length,this);this.collapse=__bind(this.collapse,this);this.expand=__bind(this.expand,this);this.toggle=__bind(this.toggle,this);this.content=this.dom.find(".collapsable_content");this.original_height=this.dom.outerHeight();this.read_more=this.dom.find(".read_more");app.on("set:updated",this.check_length);if(this.read_more.length>0){this.check_length();this.read_more.on("click",this.toggle);app.window.on("scroll",this.collapse)}}CollapsableContent.prototype.toggle=function(){if(this.expanded){return this.collapse()}else{return this.expand()}};CollapsableContent.prototype.expand=function(){var h;if(this.expanded){return}this.expanded=true;h=this.content.height()+40;return this.dom.addClass("expanded").animate({height:h})};CollapsableContent.prototype.collapse=function(){if(!this.expanded){return}this.expanded=false;return this.dom.removeClass("expanded").animate({height:this.original_height})};CollapsableContent.prototype.check_length=function(){var _this=this;return delay(1,function(){var l;l=_this.content.text().length;if(l>_this.max_length){return _this.dom.addClass("read_more_visible")}else{return _this.dom.removeClass("read_more_visible")}})};CollapsableContent.prototype.destroy=function(){if(this.read_more.length>0){this.read_more.off("click",this.toggle);app.window.off("scroll",this.collapse);return app.off("set:updated",this.check_length)}};return CollapsableContent}()},{});require.register("src/frontend/scripts/views/chat/description",function(require,module,exports){var Description,EditableText,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};EditableText=require("app/views/components/editables/editable_text");module.exports=Description=function(_super){__extends(Description,_super);function Description(){_ref=Description.__super__.constructor.apply(this,arguments);return _ref}Description.prototype.max_length=100;Description.prototype.expanded=false;return Description}(EditableText)},{"app/views/components/editables/editable_text":"src/frontend/scripts/views/components/editables/editable_text"});require.register("src/frontend/scripts/views/chat/messages",function(require,module,exports){var ChatView,Messages,api,autolink,transform,user,_ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};transform=require("lib/cloudinary/transform");ChatView=require("app/views/room/chat_view");user=require("app/controllers/user");api=require("app/api/loopcast/loopcast");require("app/utils/time/livestamp");autolink=require("lib/tools/strings/autolink");module.exports=Messages=function(_super){__extends(Messages,_super);function Messages(){this.on_message=__bind(this.on_message,this);this.on_people_out=__bind(this.on_people_out,this);this.on_people_over=__bind(this.on_people_over,this);this.on_window_enter=__bind(this.on_window_enter,this);this.on_window_exit=__bind(this.on_window_exit,this);this.on_room_created=__bind(this.on_room_created,this);_ref=Messages.__super__.constructor.apply(this,arguments);return _ref}Messages.prototype.first_message=true;Messages.prototype.current_title="";Messages.prototype.onfocused=false;Messages.prototype.unread_messages=0;Messages.prototype.users={};Messages.prototype.on_room_created=function(room_id,owner_id){var _this=this;this.room_id=room_id;this.owner_id=owner_id;Messages.__super__.on_room_created.call(this,this.room_id,this.owner_id);this.tmpl=require("client_templates/chat/chat_message");this.chat=$(".chat_content");this.popup=view.get_by_dom(".chat_user_popup");api.chat.messages(this.room_id,function(error,response){var m,_i,_len,_results;log("[Messages] old messages",response);if(error){return}response=response.reverse();_results=[];for(_i=0,_len=response.length;_i<_len;_i++){m=response[_i];_results.push(_this.on_message(m))}return _results});app.window.on("blur",this.on_window_exit);return app.window.on("focus",this.on_window_enter)};Messages.prototype.on_window_exit=function(){
this.onfocused=true;this.unread_messages=0;this.current_title=document.title;if(this.current_title.length<=0){return this.current_title="Loopcast"}};Messages.prototype.on_window_enter=function(){this.onfocused=false;return document.title=this.current_title};Messages.prototype.increment_title=function(){this.unread_messages++;return document.title="("+this.unread_messages+") "+this.current_title};Messages.prototype.on_people_over=function(e){var t,user_data;t=$(e.currentTarget);user=t.data("username");if(this.users[user]!=null){user_data=this.users[user];return this.popup.show(user_data,t)}};Messages.prototype.on_people_out=function(e){return this.popup.hide()};Messages.prototype.on_message=function(data){var h,html,obj,_ref1;if(this.users[data.username]==null){this.users[data.username]={avatar:data.avatar,id:data.username,images:transform.all(data.avatar),name:data.name,url:"/"+data.username,username:data.username};if(!data.occupation){this.users[data.username].occupation=["Occupation"]}}if(this.first_message){this.dom.removeClass("no_chat_yet");this.first_message=false}obj={message:autolink(data.message),time:data.time,user:{url:"/"+data.username,name:data.name,thumb:transform.chat_thumb(data.avatar),author:this.owner_id===data._id,username:data.username}};if((_ref1=data.payload)!=null?_ref1.like:void 0){obj.like=true}html=this.tmpl(obj);if(this.onfocused){this.increment_title()}h=$(html);this.dom.append(h);delay(10,function(){return h.addClass("show")});return this.chat.scrollTop(this.chat[0].scrollHeight)};Messages.prototype.destroy=function(){if(this.room_created){app.window.off("blur",this.on_window_exit);app.window.off("focus",this.on_window_enter)}return Messages.__super__.destroy.call(this)};return Messages}(ChatView)},{"lib/cloudinary/transform":"src/lib/cloudinary/transform","app/views/room/chat_view":"src/frontend/scripts/views/room/chat_view","app/controllers/user":"src/frontend/scripts/controllers/user","app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","app/utils/time/livestamp":"src/frontend/scripts/utils/time/livestamp","lib/tools/strings/autolink":"src/lib/tools/strings/autolink","client_templates/chat/chat_message":"src/frontend/templates/chat/chat_message"});require.register("src/frontend/scripts/views/chat/people",function(require,module,exports){var ChatView,L,People,get_coords,transform,user,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};L=require("../../api/loopcast/loopcast");transform=require("lib/cloudinary/transform");ChatView=require("app/views/room/chat_view");user=require("app/controllers/user");get_coords=require("app/utils/io/get_coords");module.exports=People=function(_super){__extends(People,_super);People.prototype.listeners_map=[];function People(dom){this.dom=dom;this.on_listener_removed=__bind(this.on_listener_removed,this);this.on_listener_added=__bind(this.on_listener_added,this);this.on_mouse_out=__bind(this.on_mouse_out,this);this.on_mouse_over=__bind(this.on_mouse_over,this);this.on_room_created=__bind(this.on_room_created,this);People.__super__.constructor.call(this,this.dom);this.listeners_map=[]}People.prototype.on_room_created=function(room_id,owner_id){this.room_id=room_id;this.owner_id=owner_id;People.__super__.on_room_created.call(this,this.room_id,this.owner_id);this.popup=view.get_by_dom(".chat_user_popup");this.tmpl=require("client_templates/chat/chat_listener");this.counter=this.dom.find(".number");this.listeners_wrapper=this.dom.find(".users");this.dom.on("mouseover",".img_wrapper",this.on_mouse_over);return this.dom.on("mouseout",".img_wrapper",this.on_mouse_out)};People.prototype.on_mouse_over=function(e){var c,el,id,listener_id;el=$(e.currentTarget);listener_id=el.data("id");if(this.listeners_map[listener_id]!=null){id=this.listeners_map[listener_id].id;c=get_coords(e);return this.popup.show(id,c)}};People.prototype.on_mouse_out=function(e){return this.popup.hide()};People.prototype.on_listener_added=function(data){return this._on_listener_added(data.item,data.total)};People.prototype._on_listener_added=function(listener,total){listener.images=transform.all(listener.avatar);if(this.listeners_map[listener.socket_id]!=null){return}log("[People] on_listener_added",listener);this.listeners_map[listener.socket_id]=listener;this.listeners_wrapper.append(this.tmpl(listener));return this.update_counter(total)};People.prototype.on_listener_removed=function(data){var listener;listener=data.item;this.listeners_wrapper.find("#listener_"+listener.socket_id).remove();this.listeners_map[listener.socket_id]=null;return this.update_counter(data.total)};People.prototype.update_counter=function(total){return this.counter.html("("+total+")")};People.prototype.destroy=function(){this.listeners_map=[];if(this.is_room_created){this.dom.off("mouseover",".img_wrapper",this.on_mouse_over);this.dom.off("mouseout",".img_wrapper",this.on_mouse_out)}return People.__super__.destroy.call(this)};return People}(ChatView)},{"../../api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","lib/cloudinary/transform":"src/lib/cloudinary/transform","app/views/room/chat_view":"src/frontend/scripts/views/room/chat_view","app/controllers/user":"src/frontend/scripts/controllers/user","app/utils/io/get_coords":"src/frontend/scripts/utils/io/get_coords","client_templates/chat/chat_listener":"src/frontend/templates/chat/chat_listener"});require.register("src/frontend/scripts/views/chat/people_popup",function(require,module,exports){var ChatView,L,PeoplePopup,transform,user,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};L=require("../../api/loopcast/loopcast");transform=require("lib/cloudinary/transform");ChatView=require("app/views/room/chat_view");user=require("app/controllers/user");module.exports=PeoplePopup=function(_super){__extends(PeoplePopup,_super);PeoplePopup.prototype.tmpl=null;PeoplePopup.prototype.cancel_hide=false;PeoplePopup.prototype.visible=false;PeoplePopup.prototype.follow_button=null;PeoplePopup.prototype.current_id=null;function PeoplePopup(dom){this.dom=dom;this.on_views_binded=__bind(this.on_views_binded,this);this.on_mouseout=__bind(this.on_mouseout,this);this.on_mouseover=__bind(this.on_mouseover,this);this.tmpl=require("client_templates/chat/people_popup");this.dom.on("mouseenter",this.on_mouseover);this.dom.on("mouseleave",this.on_mouseout);view.on("binded",this.on_views_binded);PeoplePopup.__super__.constructor.call(this,this.dom)}PeoplePopup.prototype.on_mouseover=function(){return this.cancel_hide=true};PeoplePopup.prototype.on_mouseout=function(){this.cancel_hide=false;return this.hide()};PeoplePopup.prototype.show=function(id,coords,callback){var _this=this;if(callback==null){callback=function(){}}if(this.current_id===id){log("[ddd] return 1");return}this.current_id=id;return user.info_by_id(id,function(response){var data,h,is_guest,w;data={avatar:response.info.avatar,id:response._id,name:response.info.name,username:response.info.username,likes:response.likes,occupation:response.info.occupation,images:transform.all(response.info.avatar),url:"/"+response.info.username};log("[Popup] show",data,user.is_me(data.id));_this.cancel_hide=true;_this.visible=true;h=user.is_me(data.id)?170:230;w=220;log("[ddd] return 2");callback();_this.dom.show().css({opacity:1,left:coords.x-w/2+coords.w/2,top:coords.y-h}).find(".outer_inner").html(_this.tmpl(data));if(!_this.follow_button){view.bind("body")}else{is_guest=data.name==="Guest";_this.follow_button.set_user_id(data.id,is_guest)}return delay(300,function(){return _this.cancel_hide=false})})};PeoplePopup.prototype.on_views_binded=function(data){this.follow_button=view.get_by_dom(".popup_follow_button");if(this.follow_button){return view.off("binded",this.on_views_binded)}};PeoplePopup.prototype.hide=function(callback){var _this=this;if(callback==null){callback=function(){}}return delay(200,function(){if(!_this.cancel_hide){return _this._hide(callback)}})};PeoplePopup.prototype._hide=function(callback){var _this=this;if(callback==null){callback=function(){}}this.visible=false;this.dom.css("opacity",0);return delay(200,function(){if(!_this.visible){_this.dom.hide();_this.current_id=null;return callback()}})};PeoplePopup.prototype.destroy=function(){PeoplePopup.__super__.destroy.call(this);this.dom.off("mouseover",this.on_mouseover);return this.dom.off("mouseout",this.on_mouseout)};return PeoplePopup}(ChatView)},{"../../api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","lib/cloudinary/transform":"src/lib/cloudinary/transform","app/views/room/chat_view":"src/frontend/scripts/views/room/chat_view","app/controllers/user":"src/frontend/scripts/controllers/user","client_templates/chat/people_popup":"src/frontend/templates/chat/people_popup"});require.register("src/frontend/scripts/views/chat/tags_viewer",function(require,module,exports){var TagsViewer,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};module.exports=TagsViewer=function(){function TagsViewer(dom){this.dom=dom;this.destroy=__bind(this.destroy,this);this.close=__bind(this.close,this);this.open=__bind(this.open,this);this.tags=this.dom.find("list");this.parent=this.dom.parent();this.dom.on("mouseenter",this.open);this.dom.on("mouseleave",this.close)}TagsViewer.prototype.open=function(){return this.parent.addClass("tags_visible")};TagsViewer.prototype.close=function(){return this.parent.removeClass("tags_visible")};TagsViewer.prototype.destroy=function(){this.dom.off("mouseenter",this.open);return this.dom.off("mouseleave",this.close)};return TagsViewer}()},{});require.register("src/frontend/scripts/views/chat/textarea",function(require,module,exports){var ChatView,L,StringUtils,Textarea,login_popup,user,_ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};login_popup=require("app/utils/login_popup");L=require("app/api/loopcast/loopcast");user=require("app/controllers/user");ChatView=require("app/views/room/chat_view");StringUtils=require("app/utils/string");module.exports=Textarea=function(_super){__extends(Textarea,_super);function Textarea(){this.on_key_up=__bind(this.on_key_up,this);this.like_cliked=__bind(this.like_cliked,this);this.on_room_created=__bind(this.on_room_created,this);_ref=Textarea.__super__.constructor.apply(this,arguments);return _ref}Textarea.prototype.already_liked=false;Textarea.prototype.liked=false;Textarea.prototype.on_room_created=function(room_id,owner_id){var _this=this;this.room_id=room_id;this.owner_id=owner_id;Textarea.__super__.on_room_created.call(this,this.room_id,this.owner_id);this.dom.on("keyup",this.on_key_up);if(app.settings.browser.mobile){this.dom.on("blur",function(e){if(e.relatedTarget===null){return _this.enter_pressed()}})}this.heart=this.dom.parent().find(".ss-heart");this.heart.on("click",this.like_cliked);if(app.settings.room_to_like){app.settings.room_to_like=null;this.like_cliked()}if(app.settings.message_to_send){if(user.is_logged()){this.send_message(app.settings.message_to_send)}app.settings.message_to_send=null}return this.check_room_liked()};Textarea.prototype.check_room_liked=function(){var _this=this;if(user.is_logged()){return L.rooms.info(this.room_id,function(error,response){if(response.liked){_this.heart.addClass("liked");return _this.liked=true}else{_this.heart.removeClass("liked");return _this.liked=false}})}};Textarea.prototype.like_cliked=function(){var _this=this;if(user.is_logged()){this.liked=!this.liked;if(this.liked){if(!this.already_liked){this.send_message("Liked this session",{like:this.liked});this.already_liked=true}this.heart.addClass("liked");return L.rooms.like(this.room_id,function(error,response){})}else{this.heart.removeClass("liked");return L.rooms.dislike(this.room_id,function(error,response){})}}else{app.settings.room_to_like=true;app.settings.after_login_url=location.pathname;return login_popup()}};Textarea.prototype.on_key_up=function(e){if(e.keyCode!==13){return}return this.enter_pressed()};Textarea.prototype.enter_pressed=function(){var message;message=StringUtils.trim(this.dom.val());log("[Textarea] enter_pressed",message);this.dom.val("");if(user.is_logged()){return this.send_message(message)}else{app.settings.message_to_send=message;app.settings.after_login_url=location.pathname;return login_popup()}};Textarea.prototype.send_message=function(message,payload){var data;if(payload==null){payload={}}if(app.settings.touch_device){document.activeElement.blur()}data={room_id:this.room_id,message:message,payload:payload};return L.chat.message(data,function(error,response){if(error){console.error("sending message: ",error)}})};Textarea.prototype.destroy=function(){return this.dom.off("keyup")};return Textarea}(ChatView)},{"app/utils/login_popup":"src/frontend/scripts/utils/login_popup","app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","app/controllers/user":"src/frontend/scripts/controllers/user","app/views/room/chat_view":"src/frontend/scripts/views/room/chat_view","app/utils/string":"src/frontend/scripts/utils/string"});require.register("src/frontend/scripts/views/components/audio/audio",function(require,module,exports){var AudioElement,happens,notify,now_to_seconds,time_to_string,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};time_to_string=require("app/utils/time/time_to_string");now_to_seconds=require("app/utils/time/now_to_seconds");happens=require("happens");notify=require("app/controllers/notify");module.exports=AudioElement=function(){AudioElement.prototype.timer_interval=null;AudioElement.prototype.loading_interval=null;AudioElement.prototype.info_loading_showed=false;AudioElement.prototype.is_playing=false;AudioElement.prototype.duration=0;AudioElement.prototype.last_time="";AudioElement.prototype.snapping=false;AudioElement.prototype.mobile_played=false;AudioElement.prototype.data={id:"",src:"",start_time:"",is_recorded:false};function AudioElement(dom){this.dom=dom;this.check_time=__bind(this.check_time,this);this.check_playing=__bind(this.check_playing,this);this.on_started=__bind(this.on_started,this);this.on_ended=__bind(this.on_ended,this);this.on_paused=__bind(this.on_paused,this);this.on_loaded_metadata=__bind(this.on_loaded_metadata,this);happens(this);this.dom[0].addEventListener("loadedmetadata",this.on_loaded_metadata);this.dom[0].addEventListener("playing",this.on_started);this.dom[0].addEventListener("pause",this.on_paused);this.dom[0].addEventListener("ended",this.on_ended)}AudioElement.prototype.set_data=function(data){this.data=data;if(this.src!==this.data.src){return this.set_src(this.data.src)}else if(this.mobile_played&&this.is_playing){return this.on_started()}};AudioElement.prototype.set_src=function(src){var _this=this;if(src!==this.src){this.info_loading_showed=false}this.src=src;this.dom.attr("src","");return delay(1,function(){return _this.dom.attr("src",_this.src)})};AudioElement.prototype.on_loaded_metadata=function(){if(this.data.is_recorded){this.duration=this.dom[0].duration}else{}return this.emit("loaded",this.duration)};AudioElement.prototype.on_paused=function(){this.is_playing=false;this.emit("paused");return clearInterval(this.timer_interval)};AudioElement.prototype.on_ended=function(){this.is_playing=false;this.emit("ended");return clearInterval(this.timer_interval)};AudioElement.prototype.on_started=function(){this.is_playing=true;this.emit("started");this.check_time();if(this.timer_interval){clearInterval(this.timer_interval)}return this.timer_interval=setInterval(this.check_time,500)};AudioElement.prototype.mobile_play=function(src){this.src=src;this.dom.attr("src",this.src);this.mobile_played=true;return this.play()};AudioElement.prototype.play=function(){this.dom[0].play();this.emit("played");clearTimeout(this.loading_interval);return this.loading_interval=setTimeout(this.check_playing,3e3)};AudioElement.prototype.check_playing=function(){if(!this.is_playing){return this.problems_with_playing()}else{}};AudioElement.prototype.problems_with_playing=function(){var _this=this;if(!this.info_loading_showed){this.info_loading_showed=true}$("audio").attr("src","");return delay(150,function(){_this.set_src(_this.src);return _this.play()})};AudioElement.prototype.get_time_from_perc=function(perc){var currentTime,time;currentTime=this.duration*perc;time=time_to_string(currentTime);return time};AudioElement.prototype.pause=function(){this.dom[0].pause();return clearTimeout(this.loading_interval)};AudioElement.prototype.toggle=function(){if(this.is_playing){return this.pause()}else{return this.play()}};AudioElement.prototype.snap_to=function(perc){if(!this.data.is_recorded){return}this.snapping=true;this.dom[0].currentTime=this.duration*perc;if(!this.is_playing){return this.play()}};AudioElement.prototype.destroy=function(){this.dom[0].removeEventListener("loadedmetadata",this.on_loaded_metadata);this.dom[0].removeEventListener("playing",this.on_started);this.dom[0].removeEventListener("pause",this.on_paused);this.dom[0].removeEventListener("ended",this.on_ended);return this.dom=null};AudioElement.prototype.check_time=function(){var data,seconds,time;if(this.data.is_recorded){time=time_to_string(this.dom[0].currentTime);data={time:time,perc:Math.min(100,this.dom[0].currentTime/this.duration*100)}}else{seconds=now_to_seconds(this.data.start_time);time=time_to_string(seconds);data={time:time}}if(this.snapping&&this.last_time!==time){this.snapping=false;this.emit("snapped")}this.last_time=time;return this.emit("progress",data)};return AudioElement}()},{"app/utils/time/time_to_string":"src/frontend/scripts/utils/time/time_to_string","app/utils/time/now_to_seconds":"src/frontend/scripts/utils/time/now_to_seconds",happens:"node_modules/happens/index","app/controllers/notify":"src/frontend/scripts/controllers/notify"});require.register("src/frontend/scripts/views/components/audio/player",function(require,module,exports){var Player,ProgressDragger,api,login_popup,normalize_info,notify,string_utils,time_to_string,transform,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};time_to_string=require("app/utils/time/time_to_string");api=require("api/loopcast/loopcast");transform=require("lib/cloudinary/transform");notify=require("app/controllers/notify");string_utils=require("app/utils/string");ProgressDragger=require("app/utils/progress_dragger");normalize_info=require("app/utils/rooms/normalize_info");login_popup=require("app/utils/login_popup");module.exports=Player=function(){Player.prototype.is_playing=false;Player.prototype.loading_visible=false;Player.prototype.like_lock=false;Player.prototype.is_recorded=false;Player.prototype.last_time="";Player.prototype.data_rooms={};Player.prototype.is_dragging=false;Player.prototype.last_audio_started=null;Player.prototype.requested_rooms={};Player.prototype.current_room_id=null;Player.prototype.timeout_follow_popup=null;function Player(dom){var _this=this;this.dom=dom;this.close_fullscreen=__bind(this.close_fullscreen,this);this.open_fullscreen=__bind(this.open_fullscreen,this);this.open=__bind(this.open,this);this.on_progress_click=__bind(this.on_progress_click,this);this.on_progress_ended=__bind(this.on_progress_ended,this);this.on_progress_started=__bind(this.on_progress_started,this);this.on_progress_dragger=__bind(this.on_progress_dragger,this);this.on_progress=__bind(this.on_progress,this);this.on_snapped=__bind(this.on_snapped,this);this.on_audio_ended=__bind(this.on_audio_ended,this);this.on_audio_stopped=__bind(this.on_audio_stopped,this);this.on_audio_started=__bind(this.on_audio_started,this);this.on_play_clicked=__bind(this.on_play_clicked,this);this.on_loaded=__bind(this.on_loaded,this);this.on_like_clicked=__bind(this.on_like_clicked,this);this.on_views_binded=__bind(this.on_views_binded,this);this.on_resize=__bind(this.on_resize,this);this.thumb=this.dom.find(".player_icon img");this.title=this.dom.find(".player_title");this.author=this.dom.find(".player_author");this.time=this.dom.find(".player_time");this.time_tot=this.dom.find(".player_total_time");this.play_btn=this.dom.find(".ss-play");this.like_btn=this.dom.find(".ss-heart");this.progress=this.dom.find(".player_progress span");this.progress_parent=this.dom.find(".player_progress");this.dragger=new ProgressDragger(this.progress_parent);this.dragger.on("drag",this.on_progress_dragger);this.dragger.on("drag:started",this.on_progress_started);this.dragger.on("drag:ended",this.on_progress_ended);this.play_btn.on("click",this.on_play_clicked);this.like_btn.on("click",this.on_like_clicked);this.progress_parent.find(".hitarea").on(app.settings.events_map.up,this.on_progress_click);this.dom.find(".open_fullscreen").on("click",this.open_fullscreen);this.dom.find(".close_fullscreen").on("click",this.close_fullscreen);view.on("binded",this.on_views_binded);app.window.on("resize",this.on_resize);$(window).bind("keypress",function(e){if(e.target.nodeName==="INPUT"){return true}if(e.target.nodeName==="TEXTAREA"){return true}if(e.keyCode===32){_this.play_btn.click();return false}})}Player.prototype.on_resize=function(){return this.close_fullscreen()};Player.prototype.on_views_binded=function(scope){if(!scope.main){return}this.share=view.get_by_dom(this.dom.find(".share_wrapper"));this.audio=view.get_by_dom(this.dom.find("audio"));this.follow_popup=view.get_by_dom(this.dom.find(".follow_player_popup"));this.audio.on("started",this.on_audio_started);this.audio.on("paused",this.on_audio_stopped);this.audio.on("ended",this.on_audio_ended);this.audio.on("progress",this.on_progress);this.audio.on("snapped",this.on_snapped);this.audio.on("loaded",this.on_loaded);return view.off("binded",this.on_views_binded)};Player.prototype.on_like_clicked=function(){if(!user.is_logged()){app.settings.after_login_url=location.pathname;app.settings.action={type:"like",room_id:this.data.data._id,is_live:this.data.data.is_live};return login_popup()}if(this.like_lock){return false}this.like_lock=true;if(this.like_btn.hasClass("liked")){this.unlike()}else{this.like()}return false};Player.prototype.unlike=function(){var type,_this=this;type=this.data.data.is_live?"rooms":"tapes";return api[type].dislike(this.data.data._id,function(error,response){_this.like_lock=false;if(error){notify.error("There was an error. Please try later.");return}return _this.like_btn.removeClass("liked")})};Player.prototype.like=function(){var type,_this=this;type=this.data.data.is_live?"rooms":"tapes";return api[type].like(this.data.data._id,function(error,response){_this.like_lock=false;if(error){notify.error("There was an error. Please try later.");return}return _this.like_btn.addClass("liked")})};Player.prototype.on_loaded=function(duration){var time;if(duration>0){time=time_to_string(parseInt(duration));return this.time_tot.html(time.str)}};Player.prototype.on_play_clicked=function(){this.audio.toggle();return false};Player.prototype.get_audio_data=function(data){var audio_data,obj;audio_data={};obj=data.data;audio_data={id:obj._id,is_recorded:!obj.is_live,start_time:obj.started_at,src:obj.url};return audio_data};Player.prototype.general_play=function(room_id,source_src,is_tape){if(is_tape){return this.play(room_id,source_src)}else{return this.play_live(room_id,source_src)}};Player.prototype.play_live=function(room_id,src){if(src==null){src=null}return this.play(room_id,src,true)};Player.prototype.play=function(room_id,src,is_live){var _this=this;if(src==null){src=null}if(is_live==null){is_live=false}if(this.current_room_id===room_id){if(this.audio.is_playing){return}return this.on_play_clicked()}if(this.data_rooms[room_id]==null){this.fetch_room(room_id,is_live,function(){return _this._play(room_id)})}else{this._play(room_id)}if(app.settings.browser.mobile&&src!=null){return this.audio.mobile_play(src)}};Player.prototype._play=function(room_id){var type;this.last_audio_started=null;this.current_room_id=room_id;this.open();type=this.data_rooms[room_id].data.is_live?"rooms":"tapes";api[type].play(room_id,function(error,response){});this.data=this.data_rooms[room_id];this.update_info(this.data);this.audio.set_data(this.get_audio_data(this.data));return this.reset_progress()};Player.prototype.fetch_room=function(room_id,is_live,callback){var kallback,on_response,_this=this;app.emit("audio:loading",room_id);kallback=callback;if(this.data_rooms[room_id]!=null){return typeof kallback==="function"?kallback():void 0}else{if(this.requested_rooms[room_id]!=null){return}this.requested_rooms[room_id]=true;on_response=function(error,response){if(response){_this.data_rooms[room_id]=normalize_info(response,is_live);return typeof kallback==="function"?kallback():void 0}else{_this.requested_rooms[room_id]=null;return _this.on_error()}};if(is_live){return api.rooms.info(room_id,on_response)}else{return api.tapes.get(room_id,on_response)}}};Player.prototype.on_error=function(){notify.error("There was an error.");return app.emit("audio:paused")};Player.prototype.stop=function(){return this.audio.pause()};Player.prototype.on_room_offline=function(){this.stop();if(this.dom.hasClass("is_live")){return this.dom.removeClass("is_live")}};Player.prototype.on_room_live=function(){return this.dom.addClass("is_live")};Player.prototype.update_info=function(data){var obj,room_link,title,_this=this;obj=data.data;if(obj.is_live){room_link="/"+obj.user.info.username+"/"+obj.slug}else{room_link="/"+obj.user.info.username+"/r/"+obj.slug}this.thumb.attr("src",transform.player_thumb(obj.cover_url));title=string_utils.cut_text(obj.title,36);this.title.html(title);this.author.html("By "+obj.user.info.name);this.author.attr("title",obj.user.info.name);this.title.attr("title",obj.title);this.author.attr("href","/"+obj.user.info.username);this.title.attr("href",room_link);this.thumb.parent().attr("href",room_link);this.thumb.parent().attr("title",obj.title);this.share.update_with_data({link:room_link,title:obj.title,summary:obj.about,image:obj.cover_url});if(obj.is_live){this.dom.addClass("is_live")}else{this.dom.removeClass("is_live")}if(obj.liked){this.like_btn.addClass("liked")}else{this.like_btn.removeClass("liked")}this.follow_popup.hide();clearTimeout(this.timeout_follow_popup);return this.timeout_follow_popup=setTimeout(function(){if(_this.audio.is_playing){return _this.follow_popup.show(obj)}},3e4)};Player.prototype.on_audio_started=function(){this.play_btn.addClass("ss-pause").removeClass("ss-play");this.hide_loading();if(this.data!=null){this.last_audio_started=this.data.data._id;return app.emit("audio:started",this.data.data._id)}};Player.prototype.on_audio_stopped=function(){this.last_audio_started=null;this.play_btn.removeClass("ss-pause").addClass("ss-play");if(this.data!=null){return app.emit("audio:paused",this.data.data._id)}};Player.prototype.on_audio_ended=function(){app.emit("audio:ended",this.data.data._id);this.on_audio_stopped();return this.reset_progress()};Player.prototype.reset_progress=function(){var _this=this;this.progress.hide();delay(1,function(){return _this.on_progress({perc:0,time:{str:"00:00:00"}})});return delay(100,function(){return _this.progress.show()})};Player.prototype.on_snapped=function(){return this.hide_loading()};Player.prototype.on_progress=function(data){if(this.is_dragging){return}this.hide_loading();this.time.html(data.time.str);return this.progress.css("width",data.perc+"%")};Player.prototype.on_progress_dragger=function(perc){var time;this.progress.css("width",perc+"%");time=this.audio.get_time_from_perc(perc/100);return this.time.html(time.str)};Player.prototype.on_progress_started=function(){this.progress.addClass("dragging");return this.is_dragging=true};Player.prototype.on_progress_ended=function(perc){var _this=this;this.progress.removeClass("dragging");return delay(10,function(){return _this.is_dragging=false})};Player.prototype.on_progress_click=function(e){var perc,w,x;if(!this.audio.data.is_recorded){return}x=e.offsetX!=null?e.offsetX:e.originalEvent.layerX;w=$(e.currentTarget).width();perc=x/w;this.show_loading();return this.audio.snap_to(perc)};Player.prototype.close=function(){app.body.removeClass("player_visible");return this.dom.removeClass("visible")};Player.prototype.open=function(){var _this=this;app.body.addClass("player_visible");this.dom.show();this.show_loading();return delay(1,function(){return _this.dom.addClass("visible")})};Player.prototype.show_loading=function(){if(!this.loading_visible){this.dom.addClass("loading");return this.loading_visible=true}};Player.prototype.hide_loading=function(){if(this.loading_visible){this.dom.removeClass("loading");return this.loading_visible=false}};Player.prototype.open_fullscreen=function(){return this.dom.addClass("fullscreen")};Player.prototype.close_fullscreen=function(){return this.dom.removeClass("fullscreen")};return Player}()},{"app/utils/time/time_to_string":"src/frontend/scripts/utils/time/time_to_string","api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","lib/cloudinary/transform":"src/lib/cloudinary/transform","app/controllers/notify":"src/frontend/scripts/controllers/notify","app/utils/string":"src/frontend/scripts/utils/string","app/utils/progress_dragger":"src/frontend/scripts/utils/progress_dragger","app/utils/rooms/normalize_info":"src/frontend/scripts/utils/rooms/normalize_info","app/utils/login_popup":"src/frontend/scripts/utils/login_popup"});require.register("src/frontend/scripts/views/components/audio/player_preview",function(require,module,exports){var L;L=require("api/loopcast/loopcast");module.exports=function(dom){var data,handler,icon,init,is_playing,is_tape,on_loading,on_play,on_stop,ref,room_id,room_info,source,source_src,toggle;is_playing=false;handler=dom.find(".circle_icon, .loading_spin, .tape_play");icon=dom.find(".circle_icon, .tape_play");data=null;room_id=dom.data("room-id");is_tape=!dom.data("is-live");room_info=null;source_src=null;source=dom.find(".source_src");if(dom.data("audio-url")!=null){source_src=dom.data("audio-url")}else if(source.length>0){source_src=source.attr("value")}if(!room_id){return}if(handler.length<=0){handler=dom.find(".image .ss-pause, .loading_spin, .ss-play");if(handler.length<=0){return}}ref=this;dom.addClass("player_preview");on_play=function(_room_id){if(_room_id===room_id){is_playing=true;dom.addClass("playing");dom.removeClass("preloading");return icon.addClass("ss-pause").removeClass("ss-play")}else{return on_stop()}};on_stop=function(){is_playing=false;dom.removeClass("playing");dom.removeClass("preloading");return icon.removeClass("ss-pause").addClass("ss-play")};on_loading=function(_room_id){if(_room_id===room_id){return dom.addClass("preloading")}else{return dom.removeClass("preloading")}};toggle=function(e){e.stopPropagation();e.preventDefault();if(is_playing){return app.player.stop()}else{return app.player.general_play(room_id,source_src,is_tape)}};init=function(){handler.on("click",toggle);app.on("audio:started",on_play);app.on("audio:paused",on_stop);app.on("audio:loading",on_loading);if(app.player.current_room_id===room_id&&app.player.audio.is_playing){return on_play(room_id)}};return delay(2,init)}},{"api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast"});require.register("src/frontend/scripts/views/components/audio/progress_bar",function(require,module,exports){
var ProgressBar,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};module.exports=ProgressBar=function(){function ProgressBar(dom){this.dom=dom;this.on_views_binded=__bind(this.on_views_binded,this);view.once("binded",this.on_views_binded)}ProgressBar.prototype.on_views_binded=function(){this.parent=view.get_by_dom("#player");return this.audio=this.parent.audio};return ProgressBar}()},{});require.register("src/frontend/scripts/views/components/audio/tape_progress",function(require,module,exports){var TapeProgress,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};module.exports=TapeProgress=function(){TapeProgress.prototype.tape_id=null;TapeProgress.prototype.source_src=null;function TapeProgress(dom){this.dom=dom;this.on_progress=__bind(this.on_progress,this);this.on_end=__bind(this.on_end,this);this.on_stop=__bind(this.on_stop,this);this.on_play=__bind(this.on_play,this);this.on_progress_click=__bind(this.on_progress_click,this);this.tape_id=this.dom.data("tape-id");this.source=this.dom.data("source");this.progress=this.dom.find(".progress");this.progress_parent=this.dom.find(".inner");this.progress_parent.on("click",this.on_progress_click);app.on("audio:started",this.on_play);app.on("audio:paused",this.on_stop);app.on("audio:ended",this.on_end)}TapeProgress.prototype.on_progress_click=function(e){var perc,w,x,_this=this;x=e.offsetX;w=$(e.currentTarget).width();perc=x/w;log("[TapeProgress] on_progress_click()",perc);if(!app.player.audio.is_playing){app.player.play(this.tape_id,this.source_src);return app.player.audio.once("started",function(){return app.player.audio.snap_to(perc)})}else{return app.player.audio.snap_to(perc)}};TapeProgress.prototype.on_play=function(_tape_id){if(_tape_id===this.tape_id){return app.player.audio.on("progress",this.on_progress)}else{return this.on_stop()}};TapeProgress.prototype.on_stop=function(){return app.player.audio.off("progress",this.on_progress)};TapeProgress.prototype.on_end=function(){return this.progress.css("width",0)};TapeProgress.prototype.on_progress=function(data){return this.progress.css("width",data.perc+"%")};TapeProgress.prototype.destroy=function(){app.off("audio:started",this.on_play);app.off("audio:paused",this.on_stop);return app.off("audio:ended",this.on_end)};return TapeProgress}()},{});require.register("src/frontend/scripts/views/components/click_trigger",function(require,module,exports){var ClickTrigger,HoverTrigger,navigation,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};navigation=require("app/controllers/navigation");HoverTrigger=require("app/views/components/hover_trigger");module.exports=ClickTrigger=function(_super){__extends(ClickTrigger,_super);function ClickTrigger(){_ref=ClickTrigger.__super__.constructor.apply(this,arguments);return _ref}ClickTrigger.prototype.set_listeners=function(){this.dom.on("click",this.toggle);app.window.on("body:clicked",this.close);return navigation.on("after_render",this.close)};ClickTrigger.prototype.destroy=function(){ClickTrigger.__super__.destroy.call(this);this.dom.off("click",this.toggle);app.window.off("body:clicked",this.close);return navigation.off("after_render",this.close)};return ClickTrigger}(HoverTrigger)},{"app/controllers/navigation":"src/frontend/scripts/controllers/navigation","app/views/components/hover_trigger":"src/frontend/scripts/views/components/hover_trigger"});require.register("src/frontend/scripts/views/components/collapsable_box",function(require,module,exports){module.exports=function(dom){var collapse,expand,init,max,original_h,update;max=187;original_h=0;init=function(){app.on("info_box:updated",update);dom.find(".show_more").on("click",expand);dom.find(".show_less").on("click",collapse);delay(1e3,update);return delay(1300,function(){return dom.parents(".profile_bio").addClass("ready")})};update=function(){original_h=dom.height();log("[Update] original_h",original_h);if(original_h>max){dom.addClass("collapsable");return dom.height(max)}else{dom.removeClass("collapsable").removeClass("expanded");return dom.height("auto")}};expand=function(){return dom.height(original_h+50).addClass("expanded")};collapse=function(){return dom.height(max).removeClass("expanded")};return init()}},{});require.register("src/frontend/scripts/views/components/editables/editable_profile_tags",function(require,module,exports){var EditableProfileTags,EditableText,user,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};EditableText=require("./editable_text");user=require("app/controllers/user");module.exports=EditableProfileTags=function(_super){__extends(EditableProfileTags,_super);function EditableProfileTags(dom){this.dom=dom;this.close_read_mode=__bind(this.close_read_mode,this);this.open_edit_mode=__bind(this.open_edit_mode,this);this.on_binded=__bind(this.on_binded,this);this.on_ready=__bind(this.on_ready,this);EditableProfileTags.__super__.constructor.call(this,this.dom);this.dom.addClass("editable_profile_tags");this.text=this.dom.find(".text.values");this.empty_text=this.dom.find(".text.empty")}EditableProfileTags.prototype.on_ready=function(html){this.dom.append(html);view.once("binded",this.on_binded);return view.bind(this.dom)};EditableProfileTags.prototype.on_binded=function(){var t,_this=this;this.tags=view.get_by_dom(this.dom.find(".tags_wrapper"));t=this.text.html();if(t.length>0){this.data=t.split(", ");this.tags.add_tags(this.data);this.default_state=false}else{this.empty_text.show();this.default_state=true}this.text.on("click",this.open_edit_mode);this.empty_text.on("click",this.open_edit_mode);return this.tags.on("change",function(data){_this.data=data;if(_this.data.length>1||_this.data[0].length>0){return _this.default_state=false}else{return _this.default_state=true}})};EditableProfileTags.prototype.open_edit_mode=function(e){if(!user.check_guest_owner()){return}if(e!=null){e.stopPropagation()}this.empty_text.hide();this.dom.addClass("edit_mode");return app.window.on("body:clicked",this.close_read_mode)};EditableProfileTags.prototype.close_read_mode=function(){var list;this.dom.removeClass("edit_mode");list=this.tags.get_tags();if(list.length===0||list[0].length===0){this.empty_text.show();this.text.html("")}else{this.text.html(list.join(", "))}this.emit("changed",this.get_current_value());return app.window.off("body:clicked",this.close_read_mode)};EditableProfileTags.prototype.get_template=function(callback){return $.get("/api/v1/occupations",function(data){var tmpl;tmpl=require("client_templates/components/editables/editable_profile_tags");return callback(tmpl({values:data}))})};EditableProfileTags.prototype.get_current_value=function(){if(this.default_state){return[]}else{return this.data}};EditableProfileTags.prototype.destroy=function(){this.text.off("click",this.open_edit_mode);this.empty_text.off("click",this.open_edit_mode);return EditableProfileTags.__super__.destroy.call(this)};return EditableProfileTags}(EditableText)},{"./editable_text":"src/frontend/scripts/views/components/editables/editable_text","app/controllers/user":"src/frontend/scripts/controllers/user","client_templates/components/editables/editable_profile_tags":"src/frontend/templates/components/editables/editable_profile_tags"});require.register("src/frontend/scripts/views/components/editables/editable_select",function(require,module,exports){var EditableSelect,EditableText,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};EditableText=require("./editable_text");module.exports=EditableSelect=function(_super){__extends(EditableSelect,_super);EditableSelect.prototype.default_text=String;function EditableSelect(dom){this.dom=dom;this.close_read_mode=__bind(this.close_read_mode,this);this.on_ready=__bind(this.on_ready,this);EditableSelect.__super__.constructor.call(this,this.dom);this.dom.addClass("editable_select");this.current_value=this.dom.data("text");this.default_state=this.dom.data("default-selected")}EditableSelect.prototype.on_ready=function(html){var ref;this.dom.append(html);this.text=this.dom.find(".text");this.select=this.dom.find("select");this.default_text=this.text.html();this.select.find(".default_value").html(this.default_text);ref=this;this.select.on("change",function(e){var t,v;t=this.options[e.target.selectedIndex].text;v=this.options[e.target.selectedIndex].value;ref.default_state=v.length<=0;return ref.update_text(t)});if(!this.default_state){return this.update_text(this.current_value,true)}};EditableSelect.prototype.update_text=function(str,silent){if(silent==null){silent=false}this.text.text(str);this.dom.data("text",str);this.dom.data("default-selected",this.default_state);if(!silent){return this.emit("changed",{value:str,default_state:this.default_state})}};EditableSelect.prototype.get_current_value=function(){if(this.default_state){return""}else{return this.text.text()}};EditableSelect.prototype.get_template=function(callback){return $.get("/api/v1/occupations",function(data){var tmpl;tmpl=require("client_templates/components/editables/editable_select");return callback(tmpl({values:data}))})};EditableSelect.prototype.close_read_mode=function(){};EditableSelect.prototype.destroy=function(){this.select.off("change");this.select=null;return EditableSelect.__super__.destroy.call(this)};return EditableSelect}(EditableText)},{"./editable_text":"src/frontend/scripts/views/components/editables/editable_text","client_templates/components/editables/editable_select":"src/frontend/templates/components/editables/editable_select"});require.register("src/frontend/scripts/views/components/editables/editable_tags",function(require,module,exports){var EditableTags,L,notify,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};require("happens");require("vendors/jquery.autocomplete.min.js");require("vendors/jquery.tagsinput.js");notify=require("app/controllers/notify");L=require("../../../api/loopcast/loopcast");module.exports=EditableTags=function(){EditableTags.prototype.current_data=[];EditableTags.prototype.ready=false;EditableTags.prototype.tags={};EditableTags.prototype.tagcount=0;EditableTags.prototype.max_count=5;function EditableTags(dom){var _this=this;this.dom=dom;this.on_remove_tag=__bind(this.on_remove_tag,this);this.on_add_tag=__bind(this.on_add_tag,this);this.on_focusout=__bind(this.on_focusout,this);happens(this);L.genres.all(function(error,list){_this.dom.tagsInput({width:"auto",height:"auto",onAddTag:_this.on_add_tag,onRemoveTag:_this.on_remove_tag,autocomplete_url:list,defaultText:"Add new",autocomplete:{width:200}});return delay(10,function(){_this.ready=true;_this.emit("ready");_this.input=_this.dom.next().find("input");return _this.input.on("focusout",_this.on_focusout)})})}EditableTags.prototype.populate_tags=function(list){};EditableTags.prototype.on_focusout=function(){var t;t=this.input.val();if(t.length>0){return this.add_tags([t])}};EditableTags.prototype.on_add_tag=function(tag){this.tagcount++;log("[EditableTags] on add tag",this.tagcount);if(this.tagcount>this.max_count){this.dom.removeTag(tag);log("[EditableTags] Limit reached. Tag removed");notify.error("You can add 5 tags maximum");return}this.tags[tag]=true;return this.emit("change",this.get_tags())};EditableTags.prototype.on_remove_tag=function(tag){this.tagcount--;log("[EditableTags] on remove tag",this.tagcount);this.tags[tag]=false;return this.emit("change",this.get_tags())};EditableTags.prototype.get_tags=function(as_string){if(as_string==null){as_string=false}if(as_string){return this.dom.val()}else{return this.dom.val().split(",")}};EditableTags.prototype.set_tags=function(tags){var tag;for(tag in this.tags){this.dom.removeTag(tag)}return this.add_tags(tags)};EditableTags.prototype.reset_tags=function(){var tag,_results;_results=[];for(tag in this.tags){_results.push(this.dom.removeTag(tag))}return _results};EditableTags.prototype.add_tags=function(tags){var t,_i,_len,_results;_results=[];for(_i=0,_len=tags.length;_i<_len;_i++){t=tags[_i];_results.push(this.dom.addTag(t+"",{focus:true,unique:true}))}return _results};EditableTags.prototype.destroy=function(){this.input.off("focusout",this.on_focusout);this.dom.destroy_tagsinput();this.on=null;this.off=null;this.once=null;this.emit=null;this.on_add_tag=null;this.on_remove_tag=null;return this.dom=null};return EditableTags}()},{happens:"node_modules/happens/index","vendors/jquery.autocomplete.min.js":"src/frontend/vendors/jquery.autocomplete.min","vendors/jquery.tagsinput.js":"src/frontend/vendors/jquery.tagsinput","app/controllers/notify":"src/frontend/scripts/controllers/notify","../../../api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast"});require.register("src/frontend/scripts/views/components/editables/editable_text",function(require,module,exports){var EditableText,autolink,happens,replace_all,user,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};happens=require("happens");user=require("app/controllers/user");autolink=require("lib/tools/strings/autolink");replace_all=require("lib/tools/strings/replace_all");module.exports=EditableText=function(){EditableText.prototype.default_state=true;EditableText.prototype.default_text="";function EditableText(dom){this.dom=dom;this.close_read_mode=__bind(this.close_read_mode,this);this.open_edit_mode=__bind(this.open_edit_mode,this);this.on_ready=__bind(this.on_ready,this);happens(this);this.dom.addClass("editable_text");this.dom.on("click",function(e){return e.stopPropagation()});this.is_freestyle=this.dom.data("freestyle")!=null;this.get_template(this.on_ready)}EditableText.prototype.on_ready=function(html){var style,text;text=this.dom.text();this.dom.append(html);this.input=this.dom.find("input");this.input.val(text);this.text_el=this.dom.find(".text");style={"font-weight":this.text_el.css("font-weight"),"letter-spacing":this.text_el.css("letter-spacing"),"line-height":this.text_el.css("line-height"),color:this.text_el.css("color")};if(!this.is_freestyle){style["font-size"]="36px";style["padding"]="4px 10px 10px"}this.input.css(style);return this.text_el.on("click",this.open_edit_mode)};EditableText.prototype.set_text=function(text){this.text_el.text(text);return this.input.val(text)};EditableText.prototype.get_template=function(callback){var tmpl;tmpl=require("client_templates/components/editables/editable_text");return callback(tmpl())};EditableText.prototype.open_edit_mode=function(e){var _this=this;if(!user.check_guest_owner()){return}if($(".room_live").length>0){return}if(e!=null){e.stopPropagation()}log("open_edit_mode");this.dom.addClass("edit_mode");this.input.focus().select();this.input.on("keyup",function(e){if(e.keyCode===13){return _this.close_read_mode()}});return app.window.on("body:clicked",this.close_read_mode)};EditableText.prototype.close_read_mode=function(){var val;log("close_edit_mode");val=this.input.val();this.emit("changed",val);this.text_el.html(autolink(val));this.dom.removeClass("edit_mode");this.input.off("keyup");return app.window.off("body:clicked",this.close_read_mode)};EditableText.prototype.destroy=function(){};return EditableText}()},{happens:"node_modules/happens/index","app/controllers/user":"src/frontend/scripts/controllers/user","lib/tools/strings/autolink":"src/lib/tools/strings/autolink","lib/tools/strings/replace_all":"src/lib/tools/strings/replace_all","client_templates/components/editables/editable_text":"src/frontend/templates/components/editables/editable_text"});require.register("src/frontend/scripts/views/components/editables/social_links",function(require,module,exports){var SocialLinks,Url,happens,user_controller,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};happens=require("happens");user_controller=require("app/controllers/user");Url=require("app/utils/url_parser");module.exports=SocialLinks=function(){SocialLinks.prototype.default_state=true;SocialLinks.prototype.default_text="";SocialLinks.prototype.data=[];SocialLinks.prototype.template_input=null;SocialLinks.prototype.read_template="";function SocialLinks(dom){var data;this.dom=dom;this.add_new=__bind(this.add_new,this);happens(this);this.dom.addClass("social_links");this.dom_read_mode=$(".social_read_mode");this.dom.on("click",function(e){return e.stopPropagation()});this.read_template=require("client_templates/components/editables/social_link_read_mode");this.write_template=require("client_templates/components/editables/social_links");data=this.dom.data("links");if(data.length>0){this.data=user_controller.string_to_social_data(data)}this.build_write_mode_from_data();this.build_read_mode_from_data();this.new_link_btn=this.dom.find(".add_new_link");this.template_input=this.dom.find("input").clone().val("");this.new_link_btn.on("click",this.add_new)}SocialLinks.prototype.close_read_mode=function(){var data,item,links,_i,_len;links=this.dom.find("input");this.data=[];for(_i=0,_len=links.length;_i<_len;_i++){item=links[_i];if(Url.is_url(item.value)){data=user_controller.get_social_info_from_url(item.value);this.data.push(data)}}return this.build_read_mode_from_data()};SocialLinks.prototype.build_read_mode_from_data=function(){var html,item,_i,_len,_ref;html="";_ref=this.data;for(_i=0,_len=_ref.length;_i<_len;_i++){item=_ref[_i];html+=this.read_template(item)}return this.dom_read_mode.html(html)};SocialLinks.prototype.build_write_mode_from_data=function(){var html;html=this.write_template({links:this.data});return this.dom.html(html)};SocialLinks.prototype.get_current_value=function(){return user_controller.social_data_to_string(this.data)};SocialLinks.prototype.add_new=function(){this.new_link_btn.before(this.template_input.clone());return false};SocialLinks.prototype.get_template=function(callback){var tmpl;tmpl=require("client_templates/components/editables/social_links");return callback(tmpl())};SocialLinks.prototype.destroy=function(){return this.new_link_btn.off("click",this.add_new)};return SocialLinks}()},{happens:"node_modules/happens/index","app/controllers/user":"src/frontend/scripts/controllers/user","app/utils/url_parser":"src/frontend/scripts/utils/url_parser","client_templates/components/editables/social_link_read_mode":"src/frontend/templates/components/editables/social_link_read_mode","client_templates/components/editables/social_links":"src/frontend/templates/components/editables/social_links"});require.register("src/frontend/scripts/views/components/fixed_bar",function(require,module,exports){module.exports=function(dom){var fixed,h,links,obj,submenu;h=dom.height();fixed=false;app.window.on("scroll",function(data){var y;y=data.y;if(y>=h&&!fixed){fixed=true;return dom.addClass("fixed")}else if(y<h&&fixed){fixed=false;return dom.removeClass("fixed")}});obj=$("[data-submenu]");if(obj.length>0){submenu=obj.data("submenu");$("."+submenu).addClass("selected")}links=dom.find("li");return links.find("a").on("click",function(){links.removeClass("selected");return $(this).parent().addClass("selected")})}},{});require.register("src/frontend/scripts/views/components/follow_player",function(require,module,exports){var FollowPlayer,tmpl,transform,user,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};tmpl=require("client_templates/components/follow_player");transform=require("lib/cloudinary/transform");user=require("app/controllers/user");module.exports=FollowPlayer=function(){FollowPlayer.prototype.data=null;function FollowPlayer(dom){this.dom=dom;this.hide=__bind(this.hide,this);this.on_user_followed=__bind(this.on_user_followed,this);this.dom.find(".close_follow_player").on("click",this.hide);user.on("user:followed",this.on_user_followed)}FollowPlayer.prototype.on_user_followed=function(user_id){if(this.data!=null&&user_id===this.data.user._id){return this.hide()}};FollowPlayer.prototype.show=function(data){var _this=this;if(user.is_me(data.user._id)){log("[FollowPlayer] returning. it's me!",data.user._id);return}if(user.is_following(data.user._id)){log("[FollowPlayer] returning. already following!",data.user._id);return}log("[FollowPlayer] show",data);this.dom.addClass("show_1");this.data=data;delay(10,function(){_this.dom.addClass("show_2");return _this.dom.find(".inner").empty().append(tmpl({url:"/"+data.user.info.username,image:transform.avatar(data.user.info.avatar),name:data.user.info.name,occupation:data.user.info.occupation[0],user_id:data.user._id}))});return delay(10,function(){log("[VIEWS] --- binding");return view.bind(_this.dom.find(".inner"))})};FollowPlayer.prototype.hide=function(){var _this=this;this.dom.removeClass("show_2");return delay(300,function(){return _this.dom.removeClass("show_1")})};return FollowPlayer}()},{"client_templates/components/follow_player":"src/frontend/templates/components/follow_player","lib/cloudinary/transform":"src/lib/cloudinary/transform","app/controllers/user":"src/frontend/scripts/controllers/user"});require.register("src/frontend/scripts/views/components/fullscreen",function(require,module,exports){var Fullscreen,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};module.exports=Fullscreen=function(){Fullscreen.prototype.factor=1;Fullscreen.prototype.min_height=500;function Fullscreen(dom){this.dom=dom;this.on_resize=__bind(this.on_resize,this);this.dom.addClass("fullscreen");if(this.dom.data("factor")){this.factor=this.dom.data("factor")}app.window.on("resize",this.on_resize);this.on_resize()}Fullscreen.prototype.on_resize=function(){var h;h=(app.window.h-app.settings.header_height)*this.factor;h=Math.max(this.min_height,h);return this.dom.css({width:"100%",height:h})};Fullscreen.prototype.destroy=function(){this.on_resize=function(){};return app.window.off("resize",this.on_resize)};return Fullscreen}()},{});require.register("src/frontend/scripts/views/components/help/balloon",function(require,module,exports){var Balloon,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};module.exports=Balloon=function(){Balloon.prototype.visible=false;Balloon.prototype.orientation="left";Balloon.prototype.width=0;Balloon.prototype.dom_offset=0;function Balloon(dom){this.dom=dom;this.hide=__bind(this.hide,this);this.on_resize=__bind(this.on_resize,this);this.on_views_binded=__bind(this.on_views_binded,this);this.on_checkbox_changed=__bind(this.on_checkbox_changed,this);this.target=$(this.dom.data("target"));if(this.dom.data("orientation")){this.orientation=this.dom.data("orientation")}if(this.dom.data("offset")){this.dom_offset=this.dom.data("offset")}if(this.dom.data("offset-top")){this.dom_offset_top=this.dom.data("offset-top")}else{this.dom_offset_top=0}this.dom.addClass("orientation_"+this.orientation);view.on("binded",this.on_views_binded);this.dom.find(".button").on("click",this.hide);this.checkbox=this.dom.find("input");this.checkbox.on("change",this.on_checkbox_changed)}Balloon.prototype.on_checkbox_changed=function(){return app.session.set("hide:help",this.checkbox.is(":checked"))};Balloon.prototype.on_views_binded=function(scope){if(!scope.main){return}view.off("binded",this.on_views_binded);return this.dom.appendTo($("body"))};Balloon.prototype.on_resize=function(){var data,p,_this=this;this.offset=this.dom.outerHeight()+this.target.outerHeight()-10+this.dom_offset_top;this.width=this.dom.width();p=this.target.offset();data={top:p.top-this.offset};if(this.orientation==="left"){data.left=p.left}else if(this.orientation==="bottom"){data.top=p.top+this.target.outerHeight()+20;data.left=p.left+this.target.outerWidth()/2-this.dom.outerWidth()/2}else{data.left=p.left-this.width}data.left+=this.dom_offset;log("[Balloon] resize","top",data.top,"left",data.left,"orientation",this.orientation,"t top",p.top,"t left",p.left,"width",this.width,"dom offset",this.dom_offset);if(data.left<0){return delay(500,function(){return _this.on_resize()})}else{return this.dom.css(data)}};Balloon.prototype.show=function(){var _this=this;this.visible=true;app.window.on("resize",this.on_resize);this.dom.addClass("to_show");return delay(10,function(){_this.on_resize();return _this.dom.addClass("show")})};Balloon.prototype.hide=function(){this.visible=false;this.dom.removeClass("to_show").removeClass("show");return app.window.off("resize",this.on_resize)};Balloon.prototype.toggle=function(){if(this.visible){return this.hide()}else{return this.show()}};Balloon.prototype.destroy=function(){if(this.visible){app.window.off("resize",this.on_resize)}this.dom.find(".button").off("click",this.hide);return this.dom.remove()};return Balloon}()},{});require.register("src/frontend/scripts/views/components/hover",function(require,module,exports){var Hover,happens,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};happens=require("happens");module.exports=Hover=function(){function Hover(dom){this.dom=dom;this.on_mouse_leave=__bind(this.on_mouse_leave,this);this.on_mouse_over=__bind(this.on_mouse_over,this);if(app.settings.touch_device){return}happens(this);this.dom.on("mouseover",this.on_mouse_over);this.dom.on("mouseleave",this.on_mouse_leave);this.dom.addClass("hover_object")}Hover.prototype.on_mouse_over=function(){return this.dom.addClass("hovered")};Hover.prototype.on_mouse_leave=function(){return this.dom.removeClass("hovered")};Hover.prototype.destroy=function(){this.dom.off("mouseover",this.on_mouse_over);return this.dom.off("mouseleave",this.on_mouse_leave)};return Hover}()},{happens:"node_modules/happens/index"});require.register("src/frontend/scripts/views/components/hover_trigger",function(require,module,exports){var HoverTrigger,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};module.exports=HoverTrigger=function(){HoverTrigger.prototype.opened=false;HoverTrigger.prototype.klass="hovered";function HoverTrigger(dom){this.dom=dom;this.on_dropdown_closed=__bind(this.on_dropdown_closed,this);this.on_dropdown_opened=__bind(this.on_dropdown_opened,this);this.close=__bind(this.close,this);this.open=__bind(this.open,this);this.toggle=__bind(this.toggle,this);this.target=$(this.dom.data("target"));if(this.target.length<=0){log("[HoverTrigger] error. target not found",this.dom.data("target"));return}this.dom.addClass("hover_dropdown_trigger");app.on("dropdown:opened",this.on_dropdown_opened);app.on("dropdown:closed",this.on_dropdown_closed);app.window.on("scroll",this.close);this.set_listeners()}HoverTrigger.prototype.set_listeners=function(){if(app.settings.touch_device){return this.dom.on("click",this.toggle)}else{this.dom.on("mouseover",this.open);return this.target.on("mouseleave",this.close)}};HoverTrigger.prototype.toggle=function(e){if(this.opened){this.close()}else{this.open()}e.stopPropagation();return e.preventDefault()};HoverTrigger.prototype.open=function(){if(this.opened){return}this.opened=true;this.dom.addClass(this.klass);this.target.addClass(this.klass);return app.emit("dropdown:opened",this.uid)};HoverTrigger.prototype.close=function(){if(!this.opened){return}this.opened=false;this.dom.removeClass(this.klass);this.target.removeClass(this.klass);return app.emit("dropdown:closed",this.uid)};HoverTrigger.prototype.on_dropdown_opened=function(data){if(data!==this.uid){return this.close()}};HoverTrigger.prototype.on_dropdown_closed=function(data){};HoverTrigger.prototype.destroy=function(){if(app.settings.touch_device){this.dom.off("click",this.toggle)}else{this.dom.off("mouseover",this.open);this.target.off("mouseleave",this.close)}app.window.off("scroll",this.close);app.off("dropdown:opened",this.on_dropdown_opened);return app.off("dropdown:closed",this.on_dropdown_closed)};return HoverTrigger}()},{});require.register("src/frontend/scripts/views/components/image_uploader",function(require,module,exports){var Cloudinary,ImageUploader;require("happens");Cloudinary=require("app/controllers/cloudinary");module.exports=ImageUploader=function(){function ImageUploader(dom){var api_key,cloud_name,form,is_own_event,kill,on_upload_complete,on_upload_fail,on_upload_progress,on_upload_start,progress,ref,unsigned_id;happens(this);api_key=dom.find(".api_key").val();cloud_name=dom.find(".cloud_name").val();unsigned_id=dom.find(".unsigned_id").val();Cloudinary.set_config({cloud_name:cloud_name,api_key:api_key});progress=dom.find(".progress");ref=this;kill=function(e){e.preventDefault();return e.stopPropagation()};dom.on({dragover:kill,drop:kill,dragenter:kill,dragleave:kill});on_upload_start=function(e,data){log("[Cloudinary] on_upload_start",e,data);progress.removeClass("hide");return ref.emit("started",data)};on_upload_progress=function(e,data){var percent;percent=data.loaded/data.total*100;log("[Cloudinary] on_upload_progress",percent+"%");progress.css("width",""+percent+"%");return ref.emit("progress",progress)};on_upload_complete=function(e,data){log("[ImageUploader] on_upload_complete",e,data);progress.addClass("hide");return ref.emit("completed",data)};on_upload_fail=function(e,data){log("[Cloudinary] on_upload_fail",e);return ref.emit("error",e)};is_own_event=function(e){return e.currentTarget};form=dom.find("form");form.append($.cloudinary.unsigned_upload_tag(unsigned_id,{cloud_name:cloud_name},{cloudinary_field:unsigned_id}).on("cloudinarydone",on_upload_complete).on("fileuploadstart",on_upload_start).on("fileuploadprogress",on_upload_progress).on("fileuploadfail",on_upload_fail))}return ImageUploader}()},{happens:"node_modules/happens/index","app/controllers/cloudinary":"src/frontend/scripts/controllers/cloudinary"});require.register("src/frontend/scripts/views/components/logged_link",function(require,module,exports){var login_popup,user_controller;user_controller=require("app/controllers/user");login_popup=require("app/utils/login_popup");module.exports=function(dom){var on_click,on_user_logged,on_user_unlogged,original_url;original_url=dom.attr("href");on_click=function(){app.settings.after_login_url=original_url;login_popup();return false};on_user_logged=function(data){dom.attr("href",original_url);return dom.off("click",on_click)};on_user_unlogged=function(data){dom.attr("href","#");return dom.on("click",on_click)};user_controller.on("user:logged",on_user_logged);user_controller.on("user:unlogged",on_user_unlogged);if(user_controller.is_logged()){return on_user_logged()}else{return on_user_unlogged()}}},{"app/controllers/user":"src/frontend/scripts/controllers/user","app/utils/login_popup":"src/frontend/scripts/utils/login_popup"});require.register("src/frontend/scripts/views/components/login_popup_handler",function(require,module,exports){var login_popup;login_popup=require("app/utils/login_popup");module.exports=function(dom){return dom.on("click",function(){login_popup();return false})}},{"app/utils/login_popup":"src/frontend/scripts/utils/login_popup"});require.register("src/frontend/scripts/views/components/login_popup_js",function(require,module,exports){module.exports=function(dom){return dom.on("click",function(){FB.login(function(response){if(response.authResponse){log("Welcome!  Fetching your information.... ");return FB.api("/me",function(response){return log("Good to see you, "+response.name+".")})}else{return console.log("User cancelled login or did not fully authorize.")}});return false})}},{});require.register("src/frontend/scripts/views/components/logout_link",function(require,module,exports){
var user_controller;user_controller=require("app/controllers/user");module.exports=function(dom){return dom.on("click",function(e){e.preventDefault();e.stopPropagation();app.logout(function(error){if(error){return console.error(error)}});return log("[LogoutLink] logout succedeed.")})}},{"app/controllers/user":"src/frontend/scripts/controllers/user"});require.register("src/frontend/scripts/views/components/mobile/dropdown_trigger",function(require,module,exports){var DropdownTrigger,navigation,user_controller,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};navigation=require("app/controllers/navigation");user_controller=require("app/controllers/user");module.exports=DropdownTrigger=function(){DropdownTrigger.prototype.opened=false;function DropdownTrigger(dom){this.dom=dom;this.close=__bind(this.close,this);this.toggle=__bind(this.toggle,this);this.on_user_unlogged=__bind(this.on_user_unlogged,this);this.on_user_logged=__bind(this.on_user_logged,this);this.on_mobile_dropdown_opened=__bind(this.on_mobile_dropdown_opened,this);this.dom.on("click",this.toggle);this.dropdown=$(this.dom.data("dropdown"));this.dropdown.on("click",this.close);user_controller.on("user:logged",this.on_user_logged);user_controller.on("user:unlogged",this.on_user_unlogged);navigation.on("dropdown:request_close",this.close);app.on("mobile_dropdown:opened",this.on_mobile_dropdown_opened)}DropdownTrigger.prototype.on_mobile_dropdown_opened=function(uid){if(uid!==this.uid){return this.close()}};DropdownTrigger.prototype.on_user_logged=function(){return this.close()};DropdownTrigger.prototype.on_user_unlogged=function(){return this.close()};DropdownTrigger.prototype.toggle=function(){if(this.opened){return this.close()}else{return this.open()}};DropdownTrigger.prototype.close=function(){var _this=this;if(!this.opened){return}this.opened=false;app.emit("mobile_dropdown:closed",this.uid);app.body.removeClass("mobile_dropdown_opened_2");return delay(200,function(){app.body.removeClass("mobile_dropdown_opened");_this.dom.removeClass("mobile_opened");return _this.dropdown.removeClass("mobile_opened")})};DropdownTrigger.prototype.open=function(){var _this=this;if(this.opened){return}this.opened=true;app.emit("mobile_dropdown:opened",this.uid);this.dom.addClass("mobile_opened");this.dropdown.addClass("mobile_opened");app.body.addClass("mobile_dropdown_opened");return delay(1,function(){return app.body.addClass("mobile_dropdown_opened_2")})};DropdownTrigger.prototype.destroy=function(){this.dom.off("click",this.toggle);this.dropdown.off("click",this.close);user_controller.off("user:logged",this.on_user_logged);user_controller.off("user:unlogged",this.on_user_unlogged);navigation.off("dropdown:request_close",this.close);return app.off("mobile_dropdown:opened",this.on_mobile_dropdown_opened)};return DropdownTrigger}()},{"app/controllers/navigation":"src/frontend/scripts/controllers/navigation","app/controllers/user":"src/frontend/scripts/controllers/user"});require.register("src/frontend/scripts/views/components/mobile/more_menu",function(require,module,exports){var user_controller;user_controller=require("app/controllers/user");module.exports=function(dom){return user_controller.on("user:logged",function(){return dom.find(".profile_link").attr("href","/"+user_controller.data.username).attr("title",user_controller.data.name)})}},{"app/controllers/user":"src/frontend/scripts/controllers/user"});require.register("src/frontend/scripts/views/components/mobile/search_input",function(require,module,exports){var Search,SearchInput,navigation,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};navigation=require("app/controllers/navigation");Search=require("app/views/components/search_input");module.exports=SearchInput=function(_super){__extends(SearchInput,_super);function SearchInput(dom){this.dom=dom;this.on_clicked=__bind(this.on_clicked,this);this.dom.on("click",this.on_clicked);SearchInput.__super__.constructor.call(this,this.dom)}SearchInput.prototype.on_clicked=function(e){e.preventDefault();return e.stopPropagation()};SearchInput.prototype.go_search=function(str){navigation.emit("dropdown:request_close");return SearchInput.__super__.go_search.call(this,str)};SearchInput.prototype.destroy=function(){this.dom.off("click",this.on_clicked);return SearchInput.__super__.destroy.call(this)};return SearchInput}(Search)},{"app/controllers/navigation":"src/frontend/scripts/controllers/navigation","app/views/components/search_input":"src/frontend/scripts/views/components/search_input"});require.register("src/frontend/scripts/views/components/modal_handler",function(require,module,exports){var ModalHandler,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};module.exports=ModalHandler=function(){function ModalHandler(dom){this.dom=dom;this.on_ready=__bind(this.on_ready,this);view.once("binded",this.on_ready)}ModalHandler.prototype.on_ready=function(){var modal_target;modal_target=view.get_by_dom(this.dom.data("modal"));return this.dom.on("click",function(){return modal_target.open()})};return ModalHandler}()},{});require.register("src/frontend/scripts/views/components/player",function(require,module,exports){var appcast;appcast=require("app/controllers/appcast");module.exports=function(dom){var audio,check_stream,start_audio,stop_audio,stream,vu;audio=dom.find("audio");vu=dom.find(".vu");stream=audio.data("src");audio.hide();appcast.on("connected",function(status){if(status){return dom.find(".status").html("... waiting stream to start ...")}else{return dom.find(".status").html("... waiting AppCast to start ...")}});appcast.on("stream:error",function(error){if(!error){return}return dom.find(".status").html("... "+error+" ...")});check_stream=function(){return $.get(stream,function(error,response){if(error){delay(100,check_stream);return console.error("- error loading streaming")}return console.warn("+ all good!")})};start_audio=function(){audio.attr("src",audio.data("src"));return audio.show()};stop_audio=function(){audio.stop();return audio.hide()};appcast.on("stream:online",function(status){if(status){return start_audio()}else{return stop_audio()}});return appcast.on("stream:vu",function(meter){vu.find(".meter_left").width(meter[0]*1e3);return vu.find(".meter_right").width(meter[1]*1e3)})}},{"app/controllers/appcast":"src/frontend/scripts/controllers/appcast"});require.register("src/frontend/scripts/views/components/redirect_hp",function(require,module,exports){var navigation,user;navigation=require("app/controllers/navigation");user=require("app/controllers/user");module.exports=function(dom){user.logout(null,true);return navigation.go("/")}},{"app/controllers/navigation":"src/frontend/scripts/controllers/navigation","app/controllers/user":"src/frontend/scripts/controllers/user"});require.register("src/frontend/scripts/views/components/refresh",function(require,module,exports){module.exports=function(dom){return delay(1e3,function(){return app.window.obj.resize()})}},{});require.register("src/frontend/scripts/views/components/room_social_links",function(require,module,exports){var user;user=require("app/controllers/user");module.exports=function(dom){var html,item,l,links,tmpl,_i,_len;links=dom.data("links");if(links.length<=0){return}l=user.string_to_social_data(links);log("links",links,l);tmpl=require("client_templates/components/editables/social_link_read_mode");html="";for(_i=0,_len=l.length;_i<_len;_i++){item=l[_i];html+=tmpl(item)}return dom.append(html)}},{"app/controllers/user":"src/frontend/scripts/controllers/user","client_templates/components/editables/social_link_read_mode":"src/frontend/templates/components/editables/social_link_read_mode"});require.register("src/frontend/scripts/views/components/scroll_handler",function(require,module,exports){var ScrollHandler;module.exports=ScrollHandler=function(){function ScrollHandler(dom){var target;this.dom=dom;target=$(this.dom.data("target"));if(target.length<=0){return}this.dom.addClass("scroll_handler");this.dom.on("click",function(){return mover.scroll_to(target)});({destroy:function(){return this.dom.off("click")}})}return ScrollHandler}()},{});require.register("src/frontend/scripts/views/components/search_input",function(require,module,exports){var SearchInput,navigation,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};navigation=require("app/controllers/navigation");module.exports=SearchInput=function(){function SearchInput(dom){this.dom=dom;this.on_keypress=__bind(this.on_keypress,this);this.dom.on("keypress",this.on_keypress)}SearchInput.prototype.on_keypress=function(e){var str,type;if(e.keyCode===13){str=this.dom.val();if(str.length>0){type=location.href.indexOf("people")>0?"people":"sets";this.go_search(str,type)}return false}};SearchInput.prototype.go_search=function(str,type){if(type==null){type="sets"}switch(type){case"sets":return navigation.go("/explore?search="+str);case"people":return navigation.go("/explore/people?search="+str)}};SearchInput.prototype.destroy=function(){return this.dom.off("keypress",this.on_keypress)};return SearchInput}()},{"app/controllers/navigation":"src/frontend/scripts/controllers/navigation"});require.register("src/frontend/scripts/views/components/select",function(require,module,exports){var Select,happens,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};happens=require("happens");module.exports=Select=function(){Select.prototype.handler=null;Select.prototype.select=null;Select.prototype.first_value=null;function Select(dom){var ref;this.dom=dom;this.set_value=__bind(this.set_value,this);happens(this);this.dom.addClass("select_wrapper");this.handler=this.dom.find(".handler .text");this.select=this.dom.find("select");this.first_value=this.handler.html();ref=this;this.select.on("change",this.set_value)}Select.prototype._set_value=function(val){this.select.val(val);return this.set_value()};Select.prototype.set_value=function(){var str;str=this.select.val();if(str.length>0){this.handler.html(this.select.val())}else{this.handler.html(this.first_value)}return this.emit("changed",this.select.val())};Select.prototype.destroy=function(){this.select.off("change",this.set_value);return this.first_value=null};return Select}()},{happens:"node_modules/happens/index"});require.register("src/frontend/scripts/views/components/settings",function(require,module,exports){var navigation;navigation=require("app/controllers/navigation");module.exports=function(dom){return dom.find("a").on("click",function(e){var el,target,url;e.stopPropagation();el=$(this);url=el.attr("href");target=el.attr("target");if(target==null){navigation.go(url);return false}return true})}},{"app/controllers/navigation":"src/frontend/scripts/controllers/navigation"});require.register("src/frontend/scripts/views/components/sharing/facebook_send",function(require,module,exports){module.exports=function(dom){dom.on("click",function(){var url;url=dom.data("link")!=null?dom.data("link"):location.href;return FB.ui({method:"send",name:dom.data("text"),link:url})});if(window.fb_ready){return fb_parse()}else{return $(window).on("fb:ready",fb_parse)}}},{});require.register("src/frontend/scripts/views/components/stream_controls",function(require,module,exports){var user_controller;user_controller=require("app/controllers/user");module.exports=function(dom){user_controller.on("user:logged",function(user){if("/"+user.username===ways.pathname()){return $(".controls").show()}});return user_controller.on("user:unlogged",function(){return $(".controls").hide()})}},{"app/controllers/user":"src/frontend/scripts/controllers/user"});require.register("src/frontend/scripts/views/components/user_set",function(require,module,exports){var api,navigation,notify,transform_url,user_controller;api=require("app/api/loopcast/loopcast");notify=require("app/controllers/notify");navigation=require("app/controllers/navigation");user_controller=require("app/controllers/user");transform_url=require("app/utils/rooms/update_room_link_by_username");module.exports=function(dom){var edit_modal,init,room_id,room_url,settings_handler,type,_cancel_delete,_confirm_delete,_download,_get_into_the_room,_on_name_updated,_on_views_binded,_set_public,_to_delete;settings_handler=null;edit_modal=null;type=dom.data("type")!=null?"rooms":"tapes";room_id=dom.data("room-id");room_url=dom.find(".session_title a").attr("href");init=function(){dom.find(".download_button").on("click",_download);dom.find(".delete_button").on("click",_to_delete);dom.find(".confirm_delete").on("click",_confirm_delete);dom.find(".cancel_delete").on("click",_cancel_delete);dom.find(".set_public").on("click",_set_public);dom.find(".public_screen .bg").on("click",_get_into_the_room);user_controller.on("name:updated",_on_name_updated);return view.once("binded",_on_views_binded)};_on_name_updated=function(data){var str;log("name updated",data,dom.find(".share_wrapper"),dom.find(".share_wrapper").data("permalink"));str=document.title.split(" | ");str[0]=data.name;document.title=str.join(" | ");room_url=transform_url(room_url,data.username);dom.find(".room_url").each(function(){return $(this).attr("href",room_url)});dom.find(".share_wrapper").data("permalink",room_url);return dom.find(".session_author").text(data.name)};_on_views_binded=function(){return settings_handler=view.get_by_dom(dom.find(".settings_button"))};_download=function(){return log("[Set] download")};_get_into_the_room=function(){log("[Set] _get_into_the_room",room_url);return navigation.go(room_url)};_to_delete=function(){dom.addClass("to_delete");return settings_handler.close()};_cancel_delete=function(){return dom.removeClass("to_delete")};_confirm_delete=function(){log("[UserSet] trying to delete ",room_id);return api[type]["delete"](room_id,function(error,response){if(error){log("[UserSet] delete",room_id,error);notify.error("There was an error. Try later.");return}dom.slideUp(function(){dom.remove();return delay(1,function(){return app.emit("room:deleted",room_id)})});if(type==="rooms"){return notify.info("The room has been deleted.")}else{return notify.info("The recording has been deleted.")}})};_set_public=function(){var _this=this;return api.tapes.update(room_id,{"public":true},function(error,response){if(error){log("[PublishModal] error",error);return notify.error("There was an error. Try later.")}else{notify.info("Recording is now public");return dom.addClass("public").removeClass("to_publish")}})};return init()}},{"app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","app/controllers/notify":"src/frontend/scripts/controllers/notify","app/controllers/navigation":"src/frontend/scripts/controllers/navigation","app/controllers/user":"src/frontend/scripts/controllers/user","app/utils/rooms/update_room_link_by_username":"src/frontend/scripts/utils/rooms/update_room_link_by_username"});require.register("src/frontend/scripts/views/dashboard/appcast_instructions",function(require,module,exports){var appcast;appcast=require("../../controllers/appcast");module.exports=function(dom){return appcast.on("connected",function(is_connected){if(is_connected){return dom.hide()}else{return dom.show()}})}},{"../../controllers/appcast":"src/frontend/scripts/controllers/appcast"});require.register("src/frontend/scripts/views/dashboard/button_with_timer",function(require,module,exports){var ButtonWithTimer,L,RoomView,happens,moment,notify,now_to_seconds,time_to_string,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};L=require("app/api/loopcast/loopcast");RoomView=require("app/views/room/room_view");notify=require("app/controllers/notify");happens=require("happens");moment=require("moment");time_to_string=require("app/utils/time/time_to_string");now_to_seconds=require("app/utils/time/now_to_seconds");module.exports=ButtonWithTimer=function(_super){__extends(ButtonWithTimer,_super);ButtonWithTimer.prototype.active=false;ButtonWithTimer.prototype.waiting=false;ButtonWithTimer.prototype.interval=null;ButtonWithTimer.prototype.enabled=false;ButtonWithTimer.prototype.room=null;function ButtonWithTimer(dom){this.dom=dom;this.tick=__bind(this.tick,this);this.on_error=__bind(this.on_error,this);this.on_button_clicked=__bind(this.on_button_clicked,this);this.on_input_device_changed=__bind(this.on_input_device_changed,this);this.on_room_status_changed=__bind(this.on_room_status_changed,this);this.on_room_created=__bind(this.on_room_created,this);happens(this);this.text=this.dom.find("a");ButtonWithTimer.__super__.constructor.call(this,this.dom);this.set_enabled(this.enabled)}ButtonWithTimer.prototype.wait=function(){this.waiting=true;return this.text.html("...")};ButtonWithTimer.prototype.on_room_created=function(room_id,owner_id){this.room_id=room_id;this.owner_id=owner_id;ButtonWithTimer.__super__.on_room_created.call(this,this.room_id,this.owner_id);if(!this.is_room_owner){return}this.text.on("click",this.on_button_clicked);this.input_device=view.get_by_dom(".dashboard_bar .input_select");app.on("appcast:input_device",this.on_input_device_changed);this.set_enabled(this.input_device.is_active());this.room=view.get_by_dom(".createroom");this.room.on("status:changed",this.on_room_status_changed);if(this.room.current_status!=null){this.check_room_status()}return this.timer=this.dom.find(".right_part")};ButtonWithTimer.prototype.check_room_status=function(){};ButtonWithTimer.prototype.on_room_status_changed=function(data){};ButtonWithTimer.prototype.on_input_device_changed=function(data){return this.set_enabled(data.length>0)};ButtonWithTimer.prototype.on_button_clicked=function(){if(this.waiting){return}if(!this.enabled){return}if(!this.active){return this.start()}else{return this.stop()}};ButtonWithTimer.prototype.set_enabled=function(enabled){this.enabled=enabled;if(this.enabled){return this.dom.removeClass("disabled").addClass("enabled")}else{return this.dom.addClass("disabled").removeClass("enabled")}};ButtonWithTimer.prototype.set_active=function(active){if(!this.enabled){return}if(active===this.active){return}this.waiting=false;this.active=active;this.emit("changed",this.active);if(this.active){this.text.html(this.active_text);return this.start_timer()}else{this.text.html(this.inactive_text);return this.stop_timer()}};ButtonWithTimer.prototype.on_error=function(error,origin){if(origin==null){origin="stream:error"}this.waiting=false;if(!error){return}return notify.error("An error occurred, please get in touch using the support icon in the bottom right")};ButtonWithTimer.prototype.start_timer=function(){var _this=this;return L.rooms.info(this.room_id,function(error,response){var started_at;if(error){return}started_at=response.room.status[_this.type].started_at;_this.start_time=moment(started_at);return _this.interval=setInterval(_this.tick,1e3)})};ButtonWithTimer.prototype.stop_timer=function(){return clearInterval(this.interval)};ButtonWithTimer.prototype.tick=function(){var seconds,time;seconds=now_to_seconds(this.start_time);time=time_to_string(seconds);return this.timer.html(time.str)};ButtonWithTimer.prototype.destroy=function(){var _ref;ButtonWithTimer.__super__.destroy.call(this);if(this.is_room_owner){app.off("appcast:input_device",this.on_input_device_changed);return(_ref=this.room)!=null?typeof _ref.off==="function"?_ref.off("status:changed",this.on_room_status_changed):void 0:void 0}};return ButtonWithTimer}(RoomView)},{"app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","app/views/room/room_view":"src/frontend/scripts/views/room/room_view","app/controllers/notify":"src/frontend/scripts/controllers/notify",happens:"node_modules/happens/index",moment:"node_modules/moment/moment","app/utils/time/time_to_string":"src/frontend/scripts/utils/time/time_to_string","app/utils/time/now_to_seconds":"src/frontend/scripts/utils/time/now_to_seconds"});require.register("src/frontend/scripts/views/dashboard/go_live",function(require,module,exports){var ButtonWithTimer,GoLive,L,appcast,happens,notify,user,_ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};ButtonWithTimer=require("app/views/dashboard/button_with_timer");L=require("../../api/loopcast/loopcast");appcast=require("../../controllers/appcast");notify=require("app/controllers/notify");happens=require("happens");user=require("app/controllers/user");module.exports=GoLive=function(_super){__extends(GoLive,_super);function GoLive(){this.on_room_status_changed=__bind(this.on_room_status_changed,this);this.on_room_created=__bind(this.on_room_created,this);_ref=GoLive.__super__.constructor.apply(this,arguments);return _ref}GoLive.prototype.active_text="GO OFFLINE";GoLive.prototype.inactive_text="GO LIVE";GoLive.prototype.type="live";GoLive.prototype.on_room_created=function(room_id,owner_id){this.room_id=room_id;this.owner_id=owner_id;GoLive.__super__.on_room_created.call(this,this.room_id,this.owner_id);if(!this.is_room_owner){return}appcast.on("stream:error",this.on_error);if($(".room_live").length>0){this.set_enabled(true);this.set_active(true);return appcast.set("stream:streaming",true)}};GoLive.prototype.check_room_status=function(){return this.set_active(this.room.current_status.room.status.is_live)};GoLive.prototype.start=function(){var checked,room_slug,username,_this=this;if(!appcast.get("selected_device")){notify.info("Select your input source");return}this.wait();username=$("#owner_username").val();room_slug=$("#room_slug").val();checked=$("input.notify_checkbox")[0].checked;return L.rooms.start_stream(this.room_id,checked,function(error,result){var password;if(error){_this.on_error(error);window._gaq.push(["_trackEvent","AppCast Start Streaming","Failed",""]);return}appcast.set("stream:streaming",true);if(!appcast.get("stream:recording")){if(!result.password){console.error("error fetching password in order to stream");console.log("maybe already recording?");console.log(result);return}password=result.password;appcast.start_stream(username,room_slug,password);return appcast.on("stream:online",function(status){if(!status){return}appcast.off("stream:online",_this.waiting_stream,_this.set_active(true));return window._gaq.push(["_trackEvent","AppCast Start Streaming","Successful",""])})}else{appcast.off("stream:online",_this.waiting_stream,_this.set_active(true));return window._gaq.push(["_trackEvent","AppCast Start Streaming","Successful",""])}})};GoLive.prototype.stop=function(){var _this=this;if(!appcast.get("stream:streaming")){notify.info("- cant stop stream if not streaming");return}this.wait();if(!appcast.get("stream:recording")){appcast.stop_stream()}appcast.set("stream:streaming",false);return L.rooms.stop_stream(this.room_id,function(error,callback){if(error){_this.on_error(error,"stop_stream");window._gaq.push(["_trackEvent","AppCast Stop Streaming","Failed",""]);return}_this.set_active(false);return window._gaq.push(["_trackEvent","AppCast Stop Streaming","Successful",""])})};GoLive.prototype.while_streaming=function(status){var str;if(!status){str="streaming went offline while streaming"}else{str="streaming went online while streaming"}return notify.info(str)};GoLive.prototype.on_room_status_changed=function(data){return this.set_active(data.room.status.is_live)};GoLive.prototype.destroy=function(){appcast.off("stream:error",this.on_error);return GoLive.__super__.destroy.call(this)};return GoLive}(ButtonWithTimer)},{"app/views/dashboard/button_with_timer":"src/frontend/scripts/views/dashboard/button_with_timer","../../api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","../../controllers/appcast":"src/frontend/scripts/controllers/appcast","app/controllers/notify":"src/frontend/scripts/controllers/notify",happens:"node_modules/happens/index","app/controllers/user":"src/frontend/scripts/controllers/user"});require.register("src/frontend/scripts/views/dashboard/help_button",function(require,module,exports){var HelpButton,RoomView,_ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};RoomView=require("app/views/room/room_view");module.exports=HelpButton=function(_super){__extends(HelpButton,_super);function HelpButton(){this._hide_popup=__bind(this._hide_popup,this);this.hide_popup=__bind(this.hide_popup,this);this.show_popup=__bind(this.show_popup,this);this.on_room_created=__bind(this.on_room_created,this);_ref=HelpButton.__super__.constructor.apply(this,arguments);return _ref}HelpButton.prototype.on_room_created=function(room_id,owner_id){this.room_id=room_id;this.owner_id=owner_id;HelpButton.__super__.on_room_created.call(this,this.room_id,this.owner_id);if(!this.is_room_owner){return}this.balloon=view.get_by_dom("#help_balloon");this.dom.on("mouseover",this.show_popup);this.dom.on("mouseout",this.hide_popup);this.balloon.dom.on("mouseover",this.show_popup);return this.balloon.dom.on("mouseout",this.hide_popup)};HelpButton.prototype.show_popup=function(){clearInterval(this.interval);return this.balloon.show()};HelpButton.prototype.hide_popup=function(){clearInterval(this.interval);return this.interval=setInterval(this._hide_popup,500)};HelpButton.prototype._hide_popup=function(){return this.balloon.hide()};HelpButton.prototype.destroy=function(){HelpButton.__super__.destroy.call(this);if(this.is_room_owner){this.dom.off("mouseover",this.show_popup);this.dom.off("mouseout",this.hide_popup);this.balloon.dom.off("mouseover",this.show_popup);this.balloon.dom.off("mouseout",this.hide_popup);return view.destroy_view(this.balloon)}};return HelpButton}(RoomView)},{"app/views/room/room_view":"src/frontend/scripts/views/room/room_view"});require.register("src/frontend/scripts/views/dashboard/input_devices",function(require,module,exports){var InputDevices,Select,appcast,happens,user_controller,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};appcast=require("app/controllers/appcast");happens=require("happens");user_controller=require("app/controllers/user");Select=require("../components/select");module.exports=InputDevices=function(_super){__extends(InputDevices,_super);InputDevices.prototype.current_device="";InputDevices.prototype.devices=[];InputDevices.prototype.first_time=true;function InputDevices(dom){this.dom=dom;this.on_change=__bind(this.on_change,this);this.on_get_input_devices=__bind(this.on_get_input_devices,this);InputDevices.__super__.constructor.call(this,this.dom);this.dom.on("mouseenter",this.on_mouse_enter);appcast.on("input_devices",this.on_get_input_devices);this.on("changed",this.on_change);this.first_time=true}InputDevices.prototype.on_mouse_enter=function(){return appcast.get_devices()};InputDevices.prototype.on_get_input_devices=function(devices){var d,device,selected,str,_i,_len;if(this.devices.length!==devices.length){str="<option value=''>Select your input device</option>";for(_i=0,_len=devices.length;_i<_len;_i++){device=devices[_i];selected=this.current_device===device?"selected":"";str+="<option value='"+device+"' "+selected+">"+device+"</option>"}this.dom.find("select").html(str);if(this.dom.find("select").is(":focus")){this.dom.find("select").blur()}this.devices=devices}if(this.first_time){this.first_time=false;d=user_controller.get_preferred_input();if(d){this._set_value(d);return appcast.select_device(d)}}};InputDevices.prototype.on_change=function(device){if(device===this.current_device){return}app.emit("appcast:input_device",device);this.current_device=device;if(device.length>0){return appcast.select_device(this.dom.find("select").val())}};InputDevices.prototype.is_active=function(){return this.current_device.length>0};InputDevices.prototype.destroy=function(){this.first_time=true;this.devices=null;this.current_device=null;if(typeof this.off==="function"){this.off("changed",this.on_change)}this.dom.off("mouseenter",this.on_mouse_enter);appcast.off("input_devices",this.on_get_input_devices);return InputDevices.__super__.destroy.call(this)};return InputDevices}(Select)},{"app/controllers/appcast":"src/frontend/scripts/controllers/appcast",happens:"node_modules/happens/index","app/controllers/user":"src/frontend/scripts/controllers/user","../components/select":"src/frontend/scripts/views/components/select"});require.register("src/frontend/scripts/views/dashboard/meter",function(require,module,exports){var MAX_WIDTH,Meter,RoomView,VOL_FLOOR,animation_id,appcast,current_volume,data,draw,frame_counter,notify,user,waveform,_,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};notify=require("app/controllers/notify");appcast=require("app/controllers/appcast");RoomView=require("app/views/room/room_view");user=require("app/controllers/user");_=require("lodash");waveform=null;data=[];MAX_WIDTH=338;VOL_FLOOR=.03;frame_counter=0;animation_id=null;current_volume=null;draw=function(){frame_counter++;frame_counter=frame_counter%2;if(frame_counter%3){animation_id=window.requestAnimationFrame(draw);return}data.push(Math.max(current_volume,VOL_FLOOR));data=data.slice(-MAX_WIDTH);waveform.update({data:data});return animation_id=window.requestAnimationFrame(draw)};module.exports=Meter=function(_super){__extends(Meter,_super);Meter.prototype.disabled=true;Meter.prototype.current_block_index=-1;Meter.prototype.blocks=[];Meter.prototype.gain=5;Meter.prototype.size_block=0;Meter.prototype.no_sound=true;function Meter(dom){var clipping,ctx,gradient,i,_i;this.dom=dom;this.set_volume=__bind(this.set_volume,this);this.activate=__bind(this.activate,this);this.on_room_created=__bind(this.on_room_created,this);Meter.__super__.constructor.call(this,this.dom);this.dom.width(MAX_WIDTH);this.dom.height(31);data=[];for(i=_i=0;0<=MAX_WIDTH?_i<MAX_WIDTH:_i>MAX_WIDTH;i=0<=MAX_WIDTH?++_i:--_i){data.push(VOL_FLOOR)}waveform=window.waveform=new Waveform({container:this.dom[0],data:[1,.2,.5],width:MAX_WIDTH,height:31,innerColor:"#dedede",interpolate:false});ctx=waveform.context;gradient=ctx.createLinearGradient(0,0,0,waveform.height);gradient.addColorStop(.2,"#fff");gradient.addColorStop(.49,"#999");gradient.addColorStop(.51,"#999");gradient.addColorStop(.8,"#fff");waveform.innerColor=gradient;waveform.update({data:data});clipping=function(){return notify.info("Your volume is too loud! Adjust your gain to avoid the red blinking")};clipping=_.throttle(clipping,1e4,{trailing:false});appcast.on("vu:clipping",function(is_clipping){if(is_clipping){
$(".meter_wrapper").addClass("red");return clipping()}else{return $(".meter_wrapper").removeClass("red")}});appcast.on("vu:silent",function(is_silent){if(is_silent){}else{}})}Meter.prototype.on_room_created=function(room_id,owner_id){var _this=this;this.room_id=room_id;this.owner_id=owner_id;Meter.__super__.on_room_created.call(this,this.room_id,this.owner_id);if(!this.is_room_owner){this.dom.remove();return}delay(5e3,function(){return clearInterval(_this.interval)});return appcast.on("stream:vu",this.set_volume)};Meter.prototype.deactivate=function(){if(this.current_block_index<0){}};Meter.prototype.activate=function(perc){animation_id=window.requestAnimationFrame(draw);if(!perc){return}return appcast.off("stream:vu",this.activate)};Meter.prototype.set_volume=function(perc){current_volume=Math.max(perc[0],VOL_FLOOR);return;frame_counter++;frame_counter=frame_counter%3;if(frame_counter%3){}};Meter.prototype.destroy=function(){Meter.__super__.destroy.call(this);window.cancelAnimationFrame(animation_id);if(this.is_room_owner){appcast.off("stream:vu",this.set_volume)}return appcast.disconnect()};return Meter}(RoomView)},{"app/controllers/notify":"src/frontend/scripts/controllers/notify","app/controllers/appcast":"src/frontend/scripts/controllers/appcast","app/views/room/room_view":"src/frontend/scripts/views/room/room_view","app/controllers/user":"src/frontend/scripts/controllers/user",lodash:"node_modules/lodash/index"});require.register("src/frontend/scripts/views/dashboard/record",function(require,module,exports){var ButtonWithTimer,L,Record,appcast,notify,user,_ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};ButtonWithTimer=require("app/views/dashboard/button_with_timer");L=require("../../api/loopcast/loopcast");appcast=require("../../controllers/appcast");notify=require("app/controllers/notify");user=require("app/controllers/user");module.exports=Record=function(_super){__extends(Record,_super);function Record(){this.on_room_status_changed=__bind(this.on_room_status_changed,this);this.start_recording=__bind(this.start_recording,this);this.start=__bind(this.start,this);this.delayed_recording=__bind(this.delayed_recording,this);this.on_room_created=__bind(this.on_room_created,this);_ref=Record.__super__.constructor.apply(this,arguments);return _ref}Record.prototype.active_text="STOP REC";Record.prototype.inactive_text="RECORD";Record.prototype.type="recording";Record.prototype.tape_id=null;Record.prototype.on_room_created=function(room_id,owner_id){this.room_id=room_id;this.owner_id=owner_id;Record.__super__.on_room_created.call(this,this.room_id,this.owner_id);if(!this.is_room_owner){return}if($(".room_recording").length>0){this.set_enabled(true);this.set_active(true);return appcast.set("stream:recording",true)}};Record.prototype.check_room_status=function(){return this.set_active(this.room.current_status.room.status.is_recording)};Record.prototype.delayed_recording=function(){var _this=this;appcast.off("stream:online",this.delayed_recording);return delay(2e3,function(){return _this.start_recording(true)})};Record.prototype.start=function(){var room_slug,username,_this=this;if(!appcast.get("selected_device")){notify.info("Select your input source");return}this.wait();if(appcast.get("stream:streaming")){return this.start_recording(false)}else{username=$("#owner_username").val();room_slug=$("#room_slug").val();console.info("getting password!");return L.stream.get_password(this.room_id,function(error,data){appcast.start_stream(username,room_slug,data.password);return appcast.on("stream:online",_this.delayed_recording)})}};Record.prototype.stop=function(){var ref;this.wait();ref=this;appcast.set("stream:recording",false);return L.rooms.stop_recording(this.room_id,function(error,response){if(response.error){notify.error("There was a problem recording your tape, please contact the support");console.error("ERROR ON STOP RECORDING!!!");console.log(response)}ref.tape_id=response.room.recording;ref.set_active(false);if(!appcast.get("stream:streaming")){appcast.stop_stream()}if(error){window._gaq.push(["_trackEvent","AppCast Stop Recording","Failed",""]);return}return window._gaq.push(["_trackEvent","AppCast Stop Recording","Successful",""])})};Record.prototype.start_recording=function(from_external_event){var ref;if(from_external_event==null){from_external_event=true}if(from_external_event){appcast.off("stream:online",this.start_recording)}ref=this;appcast.set("stream:recording",true);return L.rooms.start_recording(this.room_id,function(error,response){if(error){ref.on_error(error);window._gaq.push(["_trackEvent","AppCast Start Recording","Failed",""]);return}ref.set_active(true);return window._gaq.push(["_trackEvent","AppCast Start Recording","Successful",""])})};Record.prototype.destroy=function(){if(this.is_room_owner){this.text.off("click",this.on_button_clicked)}return Record.__super__.destroy.call(this)};Record.prototype.on_room_status_changed=function(data){return this.set_active(data.room.status.is_recording)};return Record}(ButtonWithTimer)},{"app/views/dashboard/button_with_timer":"src/frontend/scripts/views/dashboard/button_with_timer","../../api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","../../controllers/appcast":"src/frontend/scripts/controllers/appcast","app/controllers/notify":"src/frontend/scripts/controllers/notify","app/controllers/user":"src/frontend/scripts/controllers/user"});require.register("src/frontend/scripts/views/explore",function(require,module,exports){var Explore,Isotope,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};Isotope=require("isotope-layout");module.exports=Explore=function(){Explore.prototype.isotope=null;function Explore(dom){this.dom=dom;this.on_genre_click=__bind(this.on_genre_click,this);this.on_views_binded=__bind(this.on_views_binded,this);view.on("binded",this.on_views_binded)}Explore.prototype.on_views_binded=function(scope){var container_isotope,current_genre,_this=this;if(!scope.main){return}this.dom.removeClass("no_result_explore");container_isotope=this.dom.find(".rooms_grid")[0];if(this.isotope){this.isotope.destroy()}if(this.dom.find(".room_cell").length<=0){this.dom.addClass("no_result_explore");return}if($("input[name=current_genre]").length>0){current_genre=$("input[name=current_genre]").val()}this.isotope=new Isotope(container_isotope,{itemSelector:".item",gutter:30,layoutMode:"masonry",masonry:{columnWidth:210,gutter:30}});this.filters=this.dom.find(".genres_list a");this.filters.removeClass("selected");this.dom.find('.genres_list a[data-genre-id="'+current_genre+'"]').addClass("selected");return delay(1e3,function(){return $(window).resize()})};Explore.prototype.on_genre_click=function(e){};Explore.prototype.destroy=function(){return view.off("binded",this.on_views_binded)};return Explore}()},{"isotope-layout":"node_modules/isotope-layout/js/isotope"});require.register("src/frontend/scripts/views/explore/mobile_filter",function(require,module,exports){var MobileFilter,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};module.exports=MobileFilter=function(){MobileFilter.prototype.opened=false;function MobileFilter(dom){this.dom=dom;this.close=__bind(this.close,this);this.toggle=__bind(this.toggle,this);this.dom.on("click",this.toggle);this.list=$(".genres_list");this.content=$(".rooms_grid");this.list.on("click","a",this.close)}MobileFilter.prototype.toggle=function(){if(this.opened){return this.close()}else{return this.open()}};MobileFilter.prototype.close=function(){this.opened=false;this.dom.removeClass("mobile_opened");this.list.removeClass("mobile_opened");this.content.removeClass("loading_visible_2");return this.content.removeClass("loading_visible_1")};MobileFilter.prototype.open=function(){var _this=this;this.opened=true;this.dom.addClass("mobile_opened");this.list.addClass("mobile_opened");this.content.addClass("loading_visible_1");return delay(1,function(){return _this.content.addClass("loading_visible_2")})};return MobileFilter}()},{});require.register("src/frontend/scripts/views/header",function(require,module,exports){var Header,navigation,user_controller,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};navigation=require("app/controllers/navigation");user_controller=require("app/controllers/user");module.exports=Header=function(){Header.prototype.current_page="";Header.prototype.current_mobile_page="";Header.prototype.user_logged=false;function Header(dom){this.dom=dom;this.on_user_unlogged=__bind(this.on_user_unlogged,this);this.on_user_updated=__bind(this.on_user_updated,this);this.on_user_logged=__bind(this.on_user_logged,this);this.show_mobile_menu=__bind(this.show_mobile_menu,this);this.hide_mobile_menu=__bind(this.hide_mobile_menu,this);this.check_menu=__bind(this.check_menu,this);user_controller.on("user:logged",this.on_user_logged);user_controller.on("user:unlogged",this.on_user_unlogged);user_controller.on("user:updated",this.on_user_updated);navigation.on("content:ready",this.check_menu);this.check_menu()}Header.prototype.check_menu=function(){this.check_desktop_menu();this.check_mobile_menu();return this.check_fixed_menu()};Header.prototype.check_desktop_menu=function(){var obj,page;obj=$("[data-menu]");if(obj.length>0){page=obj.data("menu");if(this.current_page.length>0){$("."+this.current_page+"_item").removeClass("selected");app.body.removeClass(""+this.current_page+"_page")}$("."+page+"_item").addClass("selected");app.body.addClass(""+page+"_page");return this.current_page=page}};Header.prototype.check_mobile_menu=function(){var obj,page,ref,_this=this;$(".mobile_header a").removeClass("selected");obj=$("[data-menu-mobile]");if(obj.length>0){page=obj.data("menu-mobile");$("."+page+"_item").addClass("selected")}ref=this;this.mobile_visible=true;this.mobile_header=$(".mobile_header");this.mobile_timeout=null;return app.window.on("scroll",function(data){if(_this.mobile_visible&&data.direction==="down"&&!app.body.hasClass("mobile_dropdown_opened")&&data.y>80){clearTimeout(_this.mobile_timeout);return _this.mobile_timeout=setTimeout(_this.hide_mobile_menu,100)}else if(data.direction==="up"){clearTimeout(_this.mobile_timeout);return _this.mobile_timeout=setTimeout(_this.show_mobile_menu,10)}})};Header.prototype.hide_mobile_menu=function(){this.mobile_header.addClass("hide");return this.mobile_visible=false};Header.prototype.show_mobile_menu=function(){this.mobile_header.removeClass("hide");return this.mobile_visible=true};Header.prototype.check_fixed_menu=function(){var obj;obj=$("[data-menu-fixed]");if(obj.length>0){if(obj.data("menu-fixed")===false){return app.body.addClass("unfixed")}}else{return app.body.removeClass("unfixed")}};Header.prototype.on_user_logged=function(data){var html,tmpl,wrapper;if(this.user_logged){return}this.user_logged=true;wrapper=this.dom.find(".user_logged");tmpl=require("client_templates/shared/header_user_logged");html=tmpl(data);wrapper.empty().append(html);view.bind(wrapper);this.dom.find(".myprofile_link").off("click").on("click",function(){return navigation.go("/"+user_controller.data.username)});return this.dom.find(".feedback_link").off("click").on("click",function(e){return e.stopPropagation()})};Header.prototype.on_user_updated=function(data){return this.dom.find(".top_bar_icon").attr("src",data.images.top_bar)};Header.prototype.on_user_unlogged=function(data){if(!this.user_logged){return}return this.user_logged=false};return Header}()},{"app/controllers/navigation":"src/frontend/scripts/controllers/navigation","app/controllers/user":"src/frontend/scripts/controllers/user","client_templates/shared/header_user_logged":"src/frontend/templates/shared/header_user_logged"});require.register("src/frontend/scripts/views/homepage",function(require,module,exports){var Happens,NewHomePage,preload;Happens=require("happens");preload=require("app/utils/preload");module.exports=NewHomePage=function(){function NewHomePage(dom){var elements,images,search_input,_this=this;this.dom=dom;Happens(this);this.header=$("header");this.header.addClass("top");search_input=this.header.find(".search_box input");search_input.focus(function(){return $(this).addClass("focus")});search_input.blur(function(){return $(this).removeClass("focus")});$(window).scroll(function(){var top;top=$(window).scrollTop();if(top>0){return _this.header.removeClass("top")}else{return _this.header.addClass("top")}});this.dom.addClass("request_preloading");elements=[];images=[];this.dom.find(".parallax-container").each(function(){elements.push($(this));return images.push($(this).data("image-parallax"))});preload(images,function(images_loaded){var el,i,_i,_len;for(i=_i=0,_len=elements.length;_i<_len;i=++_i){el=elements[i];el.parallax({imageSrc:images_loaded[i].src,bleed:10,parallax:"scroll",naturalWidth:images_loaded[i].width,naturalheight:images_loaded[i].height})}return _this.ready()})}NewHomePage.prototype.ready=function(){var _this=this;delay(100,function(){return app.window.obj.trigger("resize")});return delay(200,function(){return _this.emit("ready")})};NewHomePage.prototype.destroy=function(){var p;p=$(".parallax-mirror");p.addClass("hide");return delay(300,function(){return p.remove()})};return NewHomePage}()},{happens:"node_modules/happens/index","app/utils/preload":"src/frontend/scripts/utils/preload"});require.register("src/frontend/scripts/views/loading",function(require,module,exports){var Loading,Opacity,navigation;navigation=require("app/controllers/navigation");Opacity=require("app/utils/opacity");module.exports=Loading=function(){Loading.prototype.first_time=true;function Loading(dom){var _this=this;this.dom=dom;app.on("loading:show",function(){app.body.addClass("loading").removeClass("loaded");return Opacity.show(_this.dom,100)});app.on("loading:hide",function(){if(_this.first_time){app.body.addClass("first_loaded");_this.first_time=false}app.body.removeClass("loading").addClass("loaded");return Opacity.hide(_this.dom)})}return Loading}()},{"app/controllers/navigation":"src/frontend/scripts/controllers/navigation","app/utils/opacity":"src/frontend/scripts/utils/opacity"});require.register("src/frontend/scripts/views/logged_view",function(require,module,exports){var LoggedView,user_controller,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};user_controller=require("app/controllers/user");module.exports=LoggedView=function(){function LoggedView(){this.destroy=__bind(this.destroy,this);this.on_user_unlogged=__bind(this.on_user_unlogged,this);this.on_user_logged=__bind(this.on_user_logged,this);this.on_user_updated=__bind(this.on_user_updated,this);this.on_views_binded=__bind(this.on_views_binded,this);view.on("binded",this.on_views_binded)}LoggedView.prototype.on_views_binded=function(scope){var user;if(!scope.main){return}view.off("binded",this.on_views_binded);user_controller.on("user:logged",this.on_user_logged);user_controller.on("user:unlogged",this.on_user_unlogged);user_controller.on("user:updated",this.on_user_updated);user=user_controller.data;if(user){return this.on_user_logged(user)}else{return this.on_user_unlogged()}};LoggedView.prototype.on_user_updated=function(user_data){this.user_data=user_data};LoggedView.prototype.on_user_logged=function(user_data){this.user_data=user_data};LoggedView.prototype.on_user_unlogged=function(){};LoggedView.prototype.destroy=function(){user_controller.off("user:logged",this.on_user_logged);user_controller.off("user:unlogged",this.on_user_unlogged);return user_controller.off("user:updated",this.on_user_updated)};return LoggedView}()},{"app/controllers/user":"src/frontend/scripts/controllers/user"});require.register("src/frontend/scripts/views/login",function(require,module,exports){var Login,Navigation,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};Navigation=require("app/controllers/navigation");module.exports=Login=function(){function Login(dom){this.dom=dom;this._google_login=__bind(this._google_login,this);this._soundcloud_login=__bind(this._soundcloud_login,this);this._facebook_login=__bind(this._facebook_login,this);if(window.opener==null){app.body.removeClass("login_page");Navigation.go("/")}$("#player").hide();this.username=this.dom.find(".username");this.password=this.dom.find(".password");this.dom.find(".facebook").on("click",this._facebook_login);this.dom.find(".soundcloud").on("click",this._soundcloud_login);this.dom.find(".google").on("click",this._google_login)}Login.prototype._facebook_login=function(){return log("[Login] _facebook_login")};Login.prototype._soundcloud_login=function(){return log("[Login] _soundcloud_login")};Login.prototype._google_login=function(){return log("[Login] _google_login")};return Login}()},{"app/controllers/navigation":"src/frontend/scripts/controllers/navigation"});require.register("src/frontend/scripts/views/modals/exit_modal",function(require,module,exports){var ExitModal,L,Modal,notify,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};L=require("api/loopcast/loopcast");Modal=require("app/views/modals/modal");notify=require("app/controllers/notify");module.exports=ExitModal=function(_super){__extends(ExitModal,_super);function ExitModal(dom){this.dom=dom;this.stay_clicked=__bind(this.stay_clicked,this);this.dismiss_clicked=__bind(this.dismiss_clicked,this);ExitModal.__super__.constructor.call(this,this.dom);this.dismiss_btn=this.dom.find(".dismiss_label");this.stay_btn=this.dom.find(".ok_label");this.dismiss_btn.on("click",this.dismiss_clicked);this.stay_btn.on("click",this.stay_clicked);app.on("exit_modal:request_open",this.open)}ExitModal.prototype.dismiss_clicked=function(){app.emit("exit_modal:answered",true);return this.close()};ExitModal.prototype.stay_clicked=function(){app.emit("exit_modal:answered",false);return this.close()};ExitModal.prototype.destroy=function(){this.dismiss_btn.off("click",this.dismiss_clicked);this.stay_btn.off("click",this.stay_clicked);app.off("exit_modal:request_open",this.open);return ExitModal.__super__.destroy.call(this)};return ExitModal}(Modal)},{"api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","app/views/modals/modal":"src/frontend/scripts/views/modals/modal","app/controllers/notify":"src/frontend/scripts/controllers/notify"});require.register("src/frontend/scripts/views/modals/modal",function(require,module,exports){var Modal,happens,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};happens=require("happens");module.exports=Modal=function(){Modal.prototype.opened=false;function Modal(dom){this.dom=dom;this.close=__bind(this.close,this);this.open=__bind(this.open,this);happens(this);this.overlay=$(".md_overlay");this.dom=this.dom.remove();this.overlay.before(this.dom)}Modal.prototype.open=function(){var _this=this;log("[Modal] open");if(this.opened){return}this.opened=true;this.dom.addClass("md_visible");delay(10,function(){return _this.dom.addClass("md_show")});if(this.dom.data("modal-close")!=null&&this.dom.data("modal-close")!==false){this.close_on_click_outside()}else{this.disable_close_on_click_outside()}return this.emit("opened")};Modal.prototype.close_on_click_outside=function(){return this.overlay.off("click").on("click",this.close)};Modal.prototype.disable_close_on_click_outside=function(){return this.overlay.off("click")};Modal.prototype.close=function(){var _this=this;if(!this.opened){log("[Modal] it's already closed!");return}this.opened=false;this.dom.removeClass("md_show");return delay(400,function(){var _ref;if((_ref=_this.dom)!=null){_ref.removeClass("md_visible")}_this.hide_loading();if(_this.emit!=null){return _this.emit("closed")}})};Modal.prototype.show_loading=function(){return this.dom.addClass("loading")};Modal.prototype.hide_loading=function(){var _ref;return(_ref=this.dom)!=null?_ref.removeClass("loading"):void 0};Modal.prototype.destroy=function(){log("[Modal] remove");this.dom.remove();this.dom=null;this.on=null;this.off=null;return this.once=null};return Modal}()},{happens:"node_modules/happens/index"});require.register("src/frontend/scripts/views/modals/publish_modal",function(require,module,exports){var L,Modal,PublishModal,notify,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};L=require("api/loopcast/loopcast");Modal=require("app/views/modals/modal");notify=require("app/controllers/notify");module.exports=PublishModal=function(_super){__extends(PublishModal,_super);function PublishModal(dom){this.dom=dom;this.publish=__bind(this.publish,this);this.open_with_id=__bind(this.open_with_id,this);PublishModal.__super__.constructor.call(this,this.dom);this.dismiss_btn=this.dom.find(".dismiss_label");this.publish_btn=this.dom.find(".publish_label");this.dismiss_btn.on("click",this.close);this.publish_btn.on("click",this.publish)}PublishModal.prototype.open_with_id=function(id){this.id=id;return this.open()};PublishModal.prototype.publish=function(){var _this=this;this.show_loading();log("[PublishModal] publish "+this.id+" ....");return L.tapes.update(this.id,{"public":true},function(error,response){_this.hide_loading();_this.close();if(error){log("[PublishModal] error",error);return notify.error("There was an error. Try later.")}else{notify.info("The recording was published to your profile!");return _this.emit("room:published",_this.id)}})};PublishModal.prototype.destroy=function(){this.dismiss_btn.off("click",this.close);this.publish_btn.off("click",this.publish);this.id=null;return PublishModal.__super__.destroy.call(this)};return PublishModal}(Modal)},{"api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","app/views/modals/modal":"src/frontend/scripts/views/modals/modal","app/controllers/notify":"src/frontend/scripts/controllers/notify"});require.register("src/frontend/scripts/views/modals/room_modal",function(require,module,exports){var L,Modal,RoomModal,notify,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};Modal=require("./modal");L=require("app/api/loopcast/loopcast");notify=require("app/controllers/notify");module.exports=RoomModal=function(_super){__extends(RoomModal,_super);RoomModal.prototype.cover_uploaded="";RoomModal.prototype.timeout_title=null;RoomModal.prototype.current_data=null;function RoomModal(dom){this.dom=dom;this.close=__bind(this.close,this);this._submit=__bind(this._submit,this);this._check_room_name=__bind(this._check_room_name,this);this._on_description_changed=__bind(this._on_description_changed,this);this._on_location_changed=__bind(this._on_location_changed,this);this._on_genre_changed=__bind(this._on_genre_changed,this);this._on_title_changed=__bind(this._on_title_changed,this);this._on_cover_changed=__bind(this._on_cover_changed,this);this._on_cover_upload_started=__bind(this._on_cover_upload_started,this);this.on_views_binded=__bind(this.on_views_binded,this);RoomModal.__super__.constructor.call(this,this.dom);this.title=this.dom.find(".roomname");this.location=this.dom.find(".location");this.location_label=this.dom.find(".location_label");this.description=this.dom.find(".description");this.message=this.dom.find(".message");this.submit=this.dom.find(".submit_button");view.once("binded",this.on_views_binded)}RoomModal.prototype.on_views_binded=function(scope){if(!scope.main){return}this.room_image_uploader=view.get_by_dom(this.dom.find(".room_image"));this.genre=view.get_by_dom(this.dom.find(".genre"));this.room_image_uploader.on("started",this._on_cover_upload_started);this.room_image_uploader.on("completed",this._on_cover_changed);this.title.on("keyup",this._on_title_changed);this.location.on("keyup",this._on_location_changed);this.description.on("keyup",this._on_description_changed);this.genre.on("change",this._on_genre_changed);return this.submit.on("click",this._submit)};RoomModal.prototype.lock=function(){log("[RoomModal] lock");this.dom.addClass("lock");return this.locked=true};RoomModal.prototype.unlock=function(){log("[RoomModal] unlock");this.dom.removeClass("lock");return this.locked=false};RoomModal.prototype._on_cover_upload_started=function(){log("[Room modal] _on_cover_upload_started");return this.lock()};RoomModal.prototype._on_cover_changed=function(data){this.cover_uploaded=data.result.secure_url;this.unlock();return this.emit("input:changed",{name:"cover",value:data.result})};RoomModal.prototype._on_title_changed=function(){if(this.title.val().length>0){this.title.removeClass("required");this.unlock()}else{this.title.addClass("required");this.lock()}return this.emit("input:changed",{name:"title",value:this.title.val()})};RoomModal.prototype._on_genre_changed=function(data){return this.emit("input:changed",{name:"genre",value:data.join(", ")})};RoomModal.prototype._on_location_changed=function(){return this.emit("input:changed",{name:"location",value:this.location.val()})};RoomModal.prototype._on_description_changed=function(){return this.emit("input:changed",{name:"description",value:this.description.val()})};RoomModal.prototype._check_room_name=function(){if(this.dom.hasClass("edit_modal")){}};RoomModal.prototype._submit=function(){var data;console.log("locked ->",this.locked);if(this.locked){return}if(!this.title.val()){this.title.addClass("required").focus();console.log(1);return}data={title:this.title.val(),genres:this.genre.get_tags(true),location:this.location.val(),about:this.description.val(),cover:this.cover_uploaded};if(this.is_tape()){data["public"]=this.current_data["public"];data.cover_url=data.cover;if(data.cover_url.length<=0){data.cover_url=this.current_data.cover_url}delete data.cover}console.log(3);return this.emit("submit",data)};RoomModal.prototype.is_tape=function(){return this.current_data!=null&&!this.current_data.is_live};RoomModal.prototype.show_message=function(msg){return this.message.html(msg).show()};RoomModal.prototype.hide_message=function(){return this.message.hide()};RoomModal.prototype.open_with_data=function(data){log("[RoomModal] open_with_data",data,data.genres,data.genres.length);this.current_data=data;this.dom.addClass("edit_modal");this.room_name_available=true;this.title.removeClass("required");this.title.val(data.title);this.genre.add_tags(data.genres);this.location.val(data.location);this.description.val(data.about);this.open();return false};RoomModal.prototype.close=function(){RoomModal.__super__.close.call(this);return this.genre.reset_tags()};RoomModal.prototype.set_type=function(type){var labels;log("[RoomModal] set_type",type);labels={tape:{title:"Edit your recording",title_placeholder:"Enter name of your recording",desc_placeholder:"Describe your recording"},room:{title:"Edit your room",title_placeholder:"Enter room name",desc_placeholder:"Describe your room"}};this.dom.find(".title").html(labels[type].title);this.dom.find(".roomname").attr("placeholder",labels[type].title_placeholder);return this.dom.find(".description").attr("placeholder",labels[type].desc_placeholder)};RoomModal.prototype.destroy=function(){this.title.off("keyup",this._on_title_changed);this.location.off("keyup",this._on_location_changed);this.description.off("keyup",this._on_description_changed);this.genre.off("change",this._on_genre_changed);this.submit.off("click",this._submit);this.room_image_uploader.off("started",this._on_cover_upload_started);this.genre=null;return RoomModal.__super__.destroy.call(this)};return RoomModal}(Modal)},{"./modal":"src/frontend/scripts/views/modals/modal","app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","app/controllers/notify":"src/frontend/scripts/controllers/notify"});require.register("src/frontend/scripts/views/profile",function(require,module,exports){var Cloudinary,LoggedView,Profile,StringUtils,api,autolink,happens,link_to_text,navigation,notify,replace_all,transform,user_controller,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};require("app/utils/time/livestamp");Cloudinary=require("app/controllers/cloudinary");transform=require("lib/cloudinary/transform");notify=require("app/controllers/notify");user_controller=require("app/controllers/user");LoggedView=require("app/views/logged_view");api=require("app/api/loopcast/loopcast");happens=require("happens");StringUtils=require("app/utils/string");navigation=require("app/controllers/navigation");autolink=require("lib/tools/strings/autolink");replace_all=require("lib/tools/strings/replace_all");link_to_text=require("lib/tools/strings/link_to_text");module.exports=Profile=function(_super){__extends(Profile,_super);Profile.prototype.elements=null;Profile.prototype.form_bio=null;Profile.prototype.cover_url="";Profile.prototype.user_logged=false;function Profile(dom){var _this=this;this.dom=dom;this.on_user_unlogged=__bind(this.on_user_unlogged,this);this.check_visibility_editables=__bind(this.check_visibility_editables,this);this.on_avatar_uploaded=__bind(this.on_avatar_uploaded,this);this.on_cover_uploaded=__bind(this.on_cover_uploaded,this);this.on_occupation_changed=__bind(this.on_occupation_changed,this);this.on_genre_changed=__bind(this.on_genre_changed,this);this.on_name_changed_error=__bind(this.on_name_changed_error,this);this.on_name_changed=__bind(this.on_name_changed,this);this.on_user_logged=__bind(this.on_user_logged,this);this.on_views_binded=__bind(this.on_views_binded,this);Profile.__super__.constructor.call(this);happens(this);log("[=== PAGE OWNER: "+user_controller.owner_id()+" ===]");$("#room_modal").data("modal-close",true);delay(100,function(){return _this.emit("ready")})}Profile.prototype.on_views_binded=function(scope){if(!scope.main){return}this.elements={location:this.dom.find(".profile_bio .location"),location_input:this.dom.find(".location_input"),about:this.dom.find(".bio"),about_input:this.dom.find(".bio_input"),name:view.get_by_dom(this.dom.find(".cover h1.name")),occupation:view.get_by_dom(this.dom.find(".cover h3.type")),genre:view.get_by_dom(this.dom.find(".cover .genres")),links:view.get_by_dom(this.dom.find(".social_links"))};this.check_informations();this.modal=view.get_by_dom($("#room_modal"));return Profile.__super__.on_views_binded.call(this,scope)};Profile.prototype.manage_form=function(){var ref,_this=this;this.form_bio=this.dom.find(".profile_form");this.form_bio.on("submit",function(e){return e.preventDefault()});this.form_bio.find("input").keyup(function(e){if(e.keyCode===13){return _this.save_data()}});ref=this;return this.dom.find("[data-profile]").on("click",function(){var value;value=$(this).data("profile");switch(value){case"set-write-mode":return ref.write_mode();case"set-read-mode":return ref.save_data()}})};Profile.prototype.on_user_logged=function(user_data){
this.user_data=user_data;if(this.user_logged||this.elements==null){return}this.user_logged=true;log("[Profile] on_user_logged",this.user_data);Profile.__super__.on_user_logged.call(this,this.user_data);this.dom.addClass("user_logged");this.check_visibility_editables();this.check_informations();user_controller.check_guest_owner();if(!user_controller.is_owner){log("[Profile] returning because the user is not owner");return}this.manage_form();this.elements.name.on("changed",this.on_name_changed);this.elements.genre.on("changed",this.on_genre_changed);this.elements.occupation.on("changed",this.on_occupation_changed);this.change_cover_uploader=view.get_by_dom(this.dom.find(".change_cover"));this.change_cover_uploader.on("completed",this.on_cover_uploaded);this.change_picture_uploader=view.get_by_dom(this.dom.find(".profile_image"));return this.change_picture_uploader.on("completed",this.on_avatar_uploaded)};Profile.prototype.on_name_changed=function(new_name){var ref;if(new_name===user_controller.data.name){return}log("[Profile] on_name_changed",new_name);if(new_name.length>0){ref=this;return this.send_to_server({name:new_name},this.on_name_changed_success,this.on_name_changed_error)}else{return this.elements.name.set_text(user_controller.data.name)}};Profile.prototype.on_name_changed_success=function(response){log("on_name_changed response",response);notify.info("You changed your name");navigation.go_silent("/"+response["info.username"]);return user_controller.name_updated({username:response["info.username"],name:response["info.name"]})};Profile.prototype.on_name_changed_error=function(){notify.error("Username already taken");return this.elements.name.set_text(user_controller.data.name)};Profile.prototype.on_genre_changed=function(data){log("[Genre] changed",data);return this.send_to_server({genres:data})};Profile.prototype.on_occupation_changed=function(data){log("[occupation] changed",data);if(data.default_state){return}return this.send_to_server({occupation:data.value})};Profile.prototype.on_cover_uploaded=function(data){var cover;log("[Cover uploader]",data.result.secure_url,data);cover=transform.cover(data.result.secure_url);this.dom.find(".cover_image").css({"background-image":"url("+cover+")"});return this.send_to_server({cover:data.result.secure_url})};Profile.prototype.on_avatar_uploaded=function(data){var avatar;user_controller.data.avatar=data.result.secure_url;user_controller.create_images();avatar=user_controller.data.images.avatar;this.dom.find("img").attr("src",avatar);return this.send_to_server({avatar:data.result.secure_url})};Profile.prototype.check_visibility_editables=function(){user_controller.check_guest_owner();if(user_controller.is_owner){this.elements.occupation.dom.show();return this.elements.genre.dom.show()}else{if(this.elements.occupation.default_state){this.elements.occupation.dom.hide()}if(this.elements.genre.default_state){return this.elements.genre.dom.hide()}}};Profile.prototype.on_user_unlogged=function(user_data){var _ref,_ref1,_this=this;this.user_data=user_data;Profile.__super__.on_user_unlogged.call(this,this.user_data);this.dom.removeClass("user_logged");if((_ref=this.change_cover_uploader)!=null){_ref.off("completed")}if((_ref1=this.change_picture_uploader)!=null){_ref1.off("completed")}return delay(1,function(){return _this.check_visibility_editables()})};Profile.prototype.write_mode=function(){return app.body.addClass("write_mode")};Profile.prototype.save_data=function(){var data;this.elements.links.close_read_mode();data={location:this.elements.location_input.val().trim(),about:StringUtils.line_breaks_to_br(this.elements.about_input.val().trim()),social:this.elements.links.get_current_value()};this.elements.location.html(data.location);if(data.location.length<=0){this.elements.location.addClass("empty")}else{this.elements.location.removeClass("empty")}log("[SAVE DATE]",data.location,data.location.length);this.elements.about.html(autolink(data.about));app.emit("info_box:updated");this.send_to_server(data);app.body.removeClass("write_mode");return this.check_informations()};Profile.prototype.check_informations=function(){var b,l,str;l=this.elements.location.html().length;b=this.elements.about.html().length;log("check_informations");if(l>0||b>0){this.dom.removeClass("no_information_yet");log("inside",user_controller.is_owner)}else{this.dom.addClass("no_information_yet");if(user_controller.is_owner){this.write_mode()}}if(b>0){str=link_to_text(this.elements.about.html());return this.elements.about_input.val(str)}};Profile.prototype.send_to_server=function(data,callback,on_error){var _this=this;log("[Profile] saving",data);return api.user.edit(data,function(error,response){if(error){log("---> Error Profile edit user",error.statusText);if(typeof on_error==="function"){on_error()}return}log("[Profile] fields updated",response);user_controller.write_to_session();return typeof callback==="function"?callback(response):void 0})};Profile.prototype.destroy=function(){Profile.__super__.destroy.call(this);app.body.removeClass("write_mode");if(this.modal){view.destroy_view(this.modal)}if(user_controller.is_owner){this.change_cover_uploader.off("completed",this.on_cover_uploaded);return this.change_picture_uploader.off("completed",this.on_avatar_uploaded)}};return Profile}(LoggedView)},{"app/utils/time/livestamp":"src/frontend/scripts/utils/time/livestamp","app/controllers/cloudinary":"src/frontend/scripts/controllers/cloudinary","lib/cloudinary/transform":"src/lib/cloudinary/transform","app/controllers/notify":"src/frontend/scripts/controllers/notify","app/controllers/user":"src/frontend/scripts/controllers/user","app/views/logged_view":"src/frontend/scripts/views/logged_view","app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast",happens:"node_modules/happens/index","app/utils/string":"src/frontend/scripts/utils/string","app/controllers/navigation":"src/frontend/scripts/controllers/navigation","lib/tools/strings/autolink":"src/lib/tools/strings/autolink","lib/tools/strings/replace_all":"src/lib/tools/strings/replace_all","lib/tools/strings/link_to_text":"src/lib/tools/strings/link_to_text"});require.register("src/frontend/scripts/views/profile/follow_button",function(require,module,exports){var FollowButton,L,login_popup,user,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};user=require("app/controllers/user");L=require("app/api/loopcast/loopcast");login_popup=require("app/utils/login_popup");module.exports=FollowButton=function(){FollowButton.prototype.is_following=false;FollowButton.prototype.user_id=-1;FollowButton.prototype.is_guest=false;function FollowButton(dom){var id,me;this.dom=dom;this.on_user_follow=__bind(this.on_user_follow,this);this.on_user_unfollow=__bind(this.on_user_unfollow,this);this.toggle=__bind(this.toggle,this);this.on_user_following_loaded=__bind(this.on_user_following_loaded,this);id=this.dom.data("user-id");if(id){this.user_id=id}this.dom.on("click",this.toggle);me=this;user.on("user:followed",this.on_user_follow);user.on("user:unfollowed",this.on_user_unfollow);if(user.data!=null&&user.data.following!=null){this.check_following()}else{user.on("following:loaded",this.on_user_following_loaded)}if(user.is_me(this.user_id)){this.dom.hide();return}}FollowButton.prototype.on_user_following_loaded=function(){user.off("following:loaded",this.on_user_following_loaded);return this.check_following()};FollowButton.prototype.check_following=function(){if(user.is_me(this.user_id)||this.is_guest){return this.dom.hide()}else{this.dom.show();if(user.is_following(this.user_id)){return this.on_user_follow(this.user_id)}else{return this.on_user_unfollow(this.user_id)}}};FollowButton.prototype.toggle=function(){if(user.is_logged()){return this._toggle()}else{app.settings.after_login_url=location.pathname;app.settings.action={type:"follow",user_id:this.user_id};return login_popup()}};FollowButton.prototype._toggle=function(){if(this.is_following){this.unfollow()}else{this.follow()}return false};FollowButton.prototype.set_user_id=function(user_id,is_guest){var prev_id;if(is_guest==null){is_guest=false}prev_id=this.user_id;this.user_id=user_id;this.is_guest=is_guest;if(prev_id!==this.user_id){return this.check_following()}};FollowButton.prototype.on_user_unfollow=function(user_id){if(user_id!==this.user_id){return}log("[Follow] on_user_unfollow",user_id,this.user_id);return this.set_state(false)};FollowButton.prototype.on_user_follow=function(user_id){if(user_id!==this.user_id){return}log("[Follow] on_user_follow",user_id,this.user_id);return this.set_state(true)};FollowButton.prototype.unfollow=function(){user.unfollow(this.user_id);return this.set_state(false)};FollowButton.prototype.follow=function(){user.follow(this.user_id);return this.set_state(true)};FollowButton.prototype.set_state=function(state){if(this.is_following===state){return}if(state){this.dom.addClass("following").html("Unfollow")}else{this.dom.removeClass("following").html("Follow")}return this.is_following=state};FollowButton.prototype.destroy=function(){return this.dom.off("click",this.toggle)};return FollowButton}()},{"app/controllers/user":"src/frontend/scripts/controllers/user","app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","app/utils/login_popup":"src/frontend/scripts/utils/login_popup"});require.register("src/frontend/scripts/views/profile/live_set",function(require,module,exports){var LiveSet,moment,time_to_string,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};time_to_string=require("app/utils/time/time_to_string");moment=require("moment");module.exports=LiveSet=function(){LiveSet.prototype.interval=null;function LiveSet(dom){var now,now_converted;this.dom=dom;this.update=__bind(this.update,this);now=moment();this.started_at=this.dom.data("room-started-at");now_converted=moment(now,"ddd MMM DD YYYY HH:mm:ss [GMT]ZZ");log("now",now);this.time=this.dom.find(".time");log("[LiveSet]",this.started_at);this.interval=setInterval(this.update,1e3)}LiveSet.prototype.update=function(){var time;time=time_to_string(this.started_at);return this.time.html(time)};LiveSet.prototype.destroy=function(){if(this.interval){return clearInterval(this.interval)}};return LiveSet}()},{"app/utils/time/time_to_string":"src/frontend/scripts/utils/time/time_to_string",moment:"node_modules/moment/moment"});require.register("src/frontend/scripts/views/profile/sets",function(require,module,exports){module.exports=function(dom){var counter,_check_rooms,_init;counter=null;_init=function(){counter=dom.find(".session_text");return app.on("room:deleted",_check_rooms)};_check_rooms=function(){var sets_left;sets_left=dom.find(".recorded_sessions .session.outline_box").length;log("[Sets] _check_rooms",sets_left);counter.html(sets_left);if(sets_left<=0){dom.addClass("no_recorded_sessions");if(dom.find(".session.outline_box").length<=0){return dom.addClass("no_sessions")}}};return _init()}},{});require.register("src/frontend/scripts/views/room",function(require,module,exports){var Cloudinary,L,LoggedView,PeopleList,Room,RoomModal,Strings,api,happens,is_live,navigation,notify,socket,transform,user_controller,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};L=require("api/loopcast/loopcast");navigation=require("app/controllers/navigation");socket=require("app/controllers/socket");Strings=require("app/utils/string");user_controller=require("app/controllers/user");notify=require("app/controllers/notify");LoggedView=require("app/views/logged_view");happens=require("happens");api=require("app/api/loopcast/loopcast");Cloudinary=require("app/controllers/cloudinary");transform=require("lib/cloudinary/transform");RoomModal=require("app/views/modals/room_modal");PeopleList=require("app/utils/rooms/people_list");is_live=null;module.exports=Room=function(_super){__extends(Room,_super);Room.prototype.room_created=false;Room.prototype.publish_modal=null;Room.prototype.exit_modal=null;Room.prototype.sidebar_right=null;Room.prototype.current_status=null;function Room(dom){this.dom=dom;this.on_message=__bind(this.on_message,this);this.on_unlike_room=__bind(this.on_unlike_room,this);this.on_like_room=__bind(this.on_like_room,this);this.on_user_unlogged=__bind(this.on_user_unlogged,this);this.on_user_logged=__bind(this.on_user_logged,this);this.on_title_changed=__bind(this.on_title_changed,this);this.on_description_changed=__bind(this.on_description_changed,this);this.on_cover_uploaded=__bind(this.on_cover_uploaded,this);this.show_guest_popup=__bind(this.show_guest_popup,this);this.on_player_fetched_room=__bind(this.on_player_fetched_room,this);this._on_record_changed=__bind(this._on_record_changed,this);this._on_live_changed=__bind(this._on_live_changed,this);this.on_room_published=__bind(this.on_room_published,this);this.get_people=__bind(this.get_people,this);this.broadcast_enter=__bind(this.broadcast_enter,this);this.room_went_offline=__bind(this.room_went_offline,this);this.check_status=__bind(this.check_status,this);this.on_status_changed=__bind(this.on_status_changed,this);this.on_live_changed=__bind(this.on_live_changed,this);this.on_modal_submit=__bind(this.on_modal_submit,this);this.on_input_changed=__bind(this.on_input_changed,this);this.on_views_binded=__bind(this.on_views_binded,this);Room.__super__.constructor.call(this,this.dom);happens(this);this.people_list=new PeopleList;this.elements={title:this.dom.find(".cover .name"),genre:this.dom.find(".cover .genres"),location:this.dom.find(".cover .location"),cover:this.dom.find(".cover .cover_image"),description:this.dom.find(".chat_header p"),listeners:$(".stat_listeners .number")};if(Strings.is_empty(this.elements.title.html())){this.elements.title.addClass("hidden")}}Room.prototype.on_views_binded=function(scope){Room.__super__.on_views_binded.call(this,scope);if(!scope.main){return}this.modal=view.get_by_dom("#room_modal");this.modal.on("input:changed",this.on_input_changed);this.modal.on("submit",this.on_modal_submit);this.title_input=view.get_by_dom(this.dom.find("h1.name"));this.desc_input=view.get_by_dom(this.dom.find("#description_room"));this.sidebar_right=view.get_by_dom(".sidebar_right");if(this.is_create_page()){this.modal.open();return this.dom.addClass("page_create")}else{return this.on_room_created()}};Room.prototype.on_input_changed=function(data){switch(data.name){case"title":case"description":if(data.name==="title"){this.title_input.set_text(data.value)}else{this.desc_input.set_text(data.value)}if(data.value.length>0){return this.elements[data.name].removeClass("hidden")}else{return this.elements[data.name].addClass("hidden")}break;case"cover":return this.elements[data.name].css({"background-image":"url("+data.value.secure_url+")"})}};Room.prototype.on_modal_submit=function(data){var m,ref;this.modal.hide_message();this.modal.show_loading();m=this.modal;ref=this;return L.rooms.create(data,function(error,room){var _this=this;if(error!=null){notify.error(error.responseJSON.message);m.hide_loading();return false}return delay(1e3,function(){var hidden;hidden="<input type='hidden' id='room_id' value='"+room._id+"'>";$("body").append(hidden);hidden="<input type='hidden' id='room_slug' value='"+room.info.slug+"'>";$("body").append(hidden);navigation.go_silent("/"+room.info.user+"/"+room.info.slug);m.close();$(".create_room_item").removeClass("selected");return ref.on_room_created(room)})})};Room.prototype.on_room_created=function(data){var _this=this;this.owner_id=document.getElementById("owner_id").value;this.room_id=document.getElementById("room_id").value;this.room_created=true;this.dom.removeClass("page_create").addClass("room_ready");if(!socket.id){socket.rooms.subscribe(this.room_id,this.get_people)}else{socket.rooms.subscribe(this.room_id);this.get_people()}socket.on(this.room_id,function(data){if(data.type==="like"){return _this.on_like_room(data)}if(data.type==="unlike"){return _this.on_unlike_room(data)}if(data.type==="message"){return _this.on_message(data)}if(data.type==="listener:added"){return _this.people_list.add(data)}if(data.type==="listener:removed"){return _this.people_list.remove(data)}if(data.type==="status"){return _this.on_status_changed(data)}if(data.type==="listeners"){_this.elements.listeners.html(data.listeners)}});this.publish_modal=view.get_by_dom("#publish_modal");this.confirm_exit_modal=view.get_by_dom("#confirm_exit_modal");this.publish_modal.on("room:published",this.on_room_published);this.live_button=view.get_by_dom("#go_live_button");this.live_button.on("changed",this._on_live_changed);this.record_button=view.get_by_dom("#record_button");this.record_button.on("changed",this._on_record_changed);this.emit("room:created",data);if(data){this.dom.find(".chat_header.v_center").html(data.about);this.update_genres(data.info.genres)}if(user_controller.check_guest_owner()){this.manage_edit();app.on("room:go_offline",this.room_went_offline)}if(this.dom.hasClass("room_live")){delay(1e3,function(){return _this.on_room_live()})}L.rooms.visit(this.room_id,function(error,response){});if(user_controller.socket_id!==false){this.broadcast_enter()}else{user_controller.once("socket:connected",this.broadcast_enter)}this.check_status();return this.share_view=view.get_by_dom("#share_dashboard")};Room.prototype.on_live_changed=function(data){if(data.is_live!=null&&data.is_live===false){if(!user_controller.check_guest_owner()){return this._on_live_stop()}}};Room.prototype.on_status_changed=function(data){if(data.is_recording){Intercom("trackEvent","recording-successful");Intercom("trackEvent","appcast-successful");mixpanel.track("AppCast - Recording Successful")}if(data.is_live===is_live){return}is_live=data.is_live;if(data.is_live!=null){if(data.is_live===true){this.on_room_live();if(user_controller.check_guest_owner()){return this.show_guest_popup()}}else{return this._on_live_stop()}}};Room.prototype.check_status=function(){var _this=this;return L.rooms.info(this.room_id,function(error,data){_this.emit("status:changed",data);return _this.current_status=data})};Room.prototype.room_went_offline=function(){this.on_room_offline();this.live_button.set_active(false);return notify.error("Oops, something went wrong while you were streaming ( or recording ) and your session went offline")};Room.prototype.broadcast_enter=function(){var data;data={room_id:this.room_id,user:user_controller.get_info()};return L.chat.enter(data,function(error,response){})};Room.prototype.get_people=function(){var _this=this;return L.chat.people(this.room_id,function(error,response){var message,socket_id,user,user_by_socket,_i,_len,_ref,_results;user_by_socket=function(socket_id){var user,_i,_len,_ref;_ref=response.users;for(_i=0,_len=_ref.length;_i<_len;_i++){user=_ref[_i];if(user.socket_id===socket_id){user={id:user._id,socket_id:socket_id,username:user.info.username,name:user.info.name,occupation:user.info.occupation,avatar:user.info.avatar,likes:user.likes,url:"/"+user.info.username};return user}}return null};_ref=response.sockets;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){socket_id=_ref[_i];if(!(user=user_by_socket(socket_id))){if(socket_id===socket.id&&user!=null){user={id:user_controller.data._id,socket_id:socket_id,username:user_controller.data.username,name:user_controller.data.name,occupation:user_controller.data.occupation,avatar:user_controller.data.avatar,likes:0,url:"/"+user_controller.data.username}}else{user={socket_id:socket_id,name:"Guest",occupation:"Guest",avatar:"https://deerfieldsbakery.com/dev/images/items/cookies/Cookies-Decorated-Chocolate-Happy-Face_MD.jpg",likes:0,url:"#"}}}message={type:"listener:added",method:"added",user:user};_results.push(_this.people_list.add(message))}return _results})};Room.prototype.update_genres=function(genres){var g,list,_i,_len,_results;this.tags_wrapper=this.dom.find(".tags");list=this.tags_wrapper.find(".list");if(genres.length>0){this.tags_wrapper.removeClass("no_tags");_results=[];for(_i=0,_len=genres.length;_i<_len;_i++){g=genres[_i];_results.push(list.append('<a class="tag" title="'+g+'" href="/explore?genres='+g+'">'+g+"</a>"))}return _results}};Room.prototype.on_room_published=function(room_id){if(room_id===this.room_id){return this.dom.addClass("room_public")}};Room.prototype._on_live_changed=function(data){if(data){return this.on_room_live()}else{return this.on_room_offline()}};Room.prototype._on_record_changed=function(data){if(data){return this.dom.addClass("room_recording")}else{return this.dom.removeClass("room_recording")}};Room.prototype.on_room_offline=function(){this.dom.removeClass("room_live");app.player.on_room_offline();return navigation.set_lock_live(false,"")};Room.prototype._on_live_stop=function(){var _this=this;if(user_controller.check_guest_owner()){notify.info("Your stream has stopped.")}else{notify.info("The user has ended the stream")}this.on_room_offline();return delay(100,function(){if($("audio").attr("src")){_this._src=$("audio").attr("src");return $("audio").attr("src","")}})};Room.prototype.on_room_live=function(){var _this=this;return delay(500,function(){_this.dom.addClass("room_live");if(!user_controller.check_guest_owner()){if(!app.player.audio.is_playing){app.player.fetch_room(_this.room_id,true,_this.on_player_fetched_room)}else{_this.on_player_already_playing()}}else{app.player.stop();navigation.set_lock_live(true,location.pathname);Intercom("trackEvent","live-successful");Intercom("trackEvent","appcast-successful");mixpanel.track("AppCast - Live Successful")}if(!_this.dom.hasClass("show_play_button")){return _this.on_player_not_playing()}})};Room.prototype.on_player_fetched_room=function(){if(this._src){$("audio").attr("src",this._src);this._src=null}if(app.settings.theme!=="mobile"){app.player.play(this.room_id);app.player.on_room_live()}app.off("audio:started",this.show_guest_popup);return app.on("audio:started",this.show_guest_popup)};Room.prototype.on_player_already_playing=function(){if(this.dom.hasClass("room_live")){return this.dom.addClass("show_play_button")}};Room.prototype.on_player_not_playing=function(){return this.dom.addClass("hide_play_button")};Room.prototype.show_guest_popup=function(){var message;if(app.settings.theme!=="mobile"){if(user_controller.check_guest_owner()){message="You are now live! Use the sharing icon or Facebook send button below to invite some listeners"}else{message="You are now listening live on Loopcast"}if(user_controller.is_logged()){return notify.guest_room_logged(message)}else{return notify.guest_room_unlogged(message)}}};Room.prototype.manage_edit=function(){appcast.connect();this.description=view.get_by_dom("#description_room");this.title=view.get_by_dom(this.dom.find(".name"));this.change_cover_uploader=view.get_by_dom(this.dom.find(".change_cover"));this.description.on("changed",this.on_description_changed);this.title.on("changed",this.on_title_changed);return this.change_cover_uploader.on("completed",this.on_cover_uploaded)};Room.prototype.on_cover_uploaded=function(data){var cover;cover=transform.cover(data.result.url);this.dom.find(".cover_image").css({"background-image":"url("+cover+")"});return this.save_data({cover_url:data.result.url})};Room.prototype.on_description_changed=function(value){var _this=this;return this.save_data({about:value},function(response){})};Room.prototype.on_title_changed=function(value){var _this=this;return this.save_data({title:value},function(error,response){var new_link;if(!error){new_link="/"+user_controller.data.username+"/"+response["info.slug"];_this.share_view.update_link(new_link);return navigation.go_silent(new_link)}})};Room.prototype.save_data=function(data,callback){if(callback==null){callback=function(){}}return api.rooms.update(this.room_id,data,callback)};Room.prototype.on_user_logged=function(data){var img;img=this.dom.find(".author_chat_thumb");if(img.data("original")==null){img.data("original",img[0].src)}return img[0].src=user_controller.data.images.chat_thumb};Room.prototype.on_user_unlogged=function(data){};Room.prototype.on_like_room=function(data){return this.sidebar_right.on_like()};Room.prototype.on_unlike_room=function(data){return this.sidebar_right.on_unlike()};Room.prototype.on_message=function(message){return this.emit("message",message)};Room.prototype.is_guest=function(){var guest,u;u=user_controller.data;return guest=location.pathname.indexOf("/"+u.username)!==0};Room.prototype.is_create_page=function(){return location.pathname==="/rooms/create"};Room.prototype.destroy=function(){navigation.set_lock_live(false,"");this.share_view=null;if(this.room_created){socket.rooms.unsubscribe(this.room_id)}if(user_controller.check_guest_owner()&&this.description!=null){this.description.off("changed",this.on_description_changed);this.title.off("changed",this.on_title_changed);this.change_cover_uploader.off("completed",this.on_cover_uploaded);app.off("room:go_offline",this.room_went_offline)}if(this.publish_modal){this.publish_modal.off("room:published",this.on_room_published);view.destroy_view(this.publish_modal);view.destroy_view(this.confirm_exit_modal);this.publish_modal=null;this.confirm_exit_modal=null}if(this.live_button){this.live_button.off("changed",this._on_live_changed)}view.destroy_view(this.modal);this.modal=null;this.people_list.destroy();this.people_list=null;app.off("audio:started",this.show_guest_popup);return Room.__super__.destroy.call(this)};return Room}(LoggedView)},{"api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","app/controllers/navigation":"src/frontend/scripts/controllers/navigation","app/controllers/socket":"src/frontend/scripts/controllers/socket","app/utils/string":"src/frontend/scripts/utils/string","app/controllers/user":"src/frontend/scripts/controllers/user","app/controllers/notify":"src/frontend/scripts/controllers/notify","app/views/logged_view":"src/frontend/scripts/views/logged_view",happens:"node_modules/happens/index","app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","app/controllers/cloudinary":"src/frontend/scripts/controllers/cloudinary","lib/cloudinary/transform":"src/lib/cloudinary/transform","app/views/modals/room_modal":"src/frontend/scripts/views/modals/room_modal","app/utils/rooms/people_list":"src/frontend/scripts/utils/rooms/people_list"});require.register("src/frontend/scripts/views/room/chat_view",function(require,module,exports){var ChatView,RoomView,_ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};RoomView=require("app/views/room/room_view");module.exports=ChatView=function(_super){__extends(ChatView,_super);function ChatView(){this.on_message=__bind(this.on_message,this);this.on_listener_removed=__bind(this.on_listener_removed,this);this.on_listener_added=__bind(this.on_listener_added,this);this.on_room_created=__bind(this.on_room_created,this);_ref=ChatView.__super__.constructor.apply(this,arguments);return _ref}ChatView.prototype.on_room_created=function(room_id,owner_id){this.room_id=room_id;this.owner_id=owner_id;ChatView.__super__.on_room_created.call(this,this.room_id,this.owner_id);return this.room.on("message",this.on_message)};ChatView.prototype.on_listener_added=function(listener){};ChatView.prototype.on_listener_removed=function(listener){};ChatView.prototype.on_message=function(message){};ChatView.prototype.destroy=function(){ChatView.__super__.destroy.call(this);if(this.room_created&&this.room!=null&&this.room.off!=null){return this.room.off("message",this.on_message)}};return ChatView}(RoomView)},{"app/views/room/room_view":"src/frontend/scripts/views/room/room_view"});require.register("src/frontend/scripts/views/room/dashboard",function(require,module,exports){var Dashboard,L,RoomView,appcast,notify,user,_ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};appcast=require("app/controllers/appcast");notify=require("app/controllers/notify");RoomView=require("app/views/room/room_view");user=require("app/controllers/user");L=require("api/loopcast/loopcast");module.exports=Dashboard=function(_super){__extends(Dashboard,_super);function Dashboard(){this.on_appcast_not_running=__bind(this.on_appcast_not_running,this);this.on_appcast_running=__bind(this.on_appcast_running,this);this.check_appcast_running=__bind(this.check_appcast_running,this);this.on_appcast_connected=__bind(this.on_appcast_connected,this);this.on_record_changed=__bind(this.on_record_changed,this);this.on_live_changed=__bind(this.on_live_changed,this);this.toggle_not_running_balloon=__bind(this.toggle_not_running_balloon,this);this.on_device_changed=__bind(this.on_device_changed,this);this.on_room_created=__bind(this.on_room_created,this);_ref=Dashboard.__super__.constructor.apply(this,arguments);return _ref}Dashboard.prototype.volume={left:null,right:null};Dashboard.prototype.balloons=[];Dashboard.prototype.live_button=null;Dashboard.prototype.record_button=null;Dashboard.prototype.publish_modal=null;Dashboard.prototype.appcast_is_running=false;Dashboard.prototype.timeout=null;Dashboard.prototype.on_room_created=function(room_id,owner_id){var ref;this.room_id=room_id;this.owner_id=owner_id;Dashboard.__super__.on_room_created.call(this,this.room_id,this.owner_id);if(!this.is_room_owner){this.dom.find(".centered").remove();return}this.publish_modal=view.get_by_dom("#publish_modal");this.live_button=view.get_by_dom(this.dom.find("#go_live_button"));this.record_button=view.get_by_dom(this.dom.find("#record_button"));this.live_button.on("changed",this.on_live_changed);this.record_button.on("changed",this.on_record_changed);this.share=view.get_by_dom(this.dom.find("#share_dashboard"));this.room_view=view.get_by_dom(".createroom");ref=this;L.rooms.info(room_id,function(error,response){return ref.share.update_with_data({link:"/"+response.room.info.user+"/"+response.room.info.slug,title:response.room.info.title,summary:response.room.info.about,image:response.room.info.cover_url})});this.balloons={appcast:view.get_by_dom("#appcast_not_running_balloon"),record:view.get_by_dom("#record_balloon"),live_instructions:view.get_by_dom("#go_live_instructions"),dashboard_help:view.get_by_dom("#dashboard_help_balloon"),notify_followers:view.get_by_dom("#notify_followers_instructions")};this.device_change_count=0;this.prepare_notify_followers_balloon();this.appcast_not_running_message=this.dom.find(".appcast_not_running_message");this.meter=view.get_by_dom(this.dom.find(".meter_wrapper"));this.on_appcast_connected();this.appcast_not_running_message.on("click",this.toggle_not_running_balloon);appcast.on("status",this.on_status);appcast.on("connected",this.on_appcast_connected);app.on("appcast:input_device",this.on_device_changed);return this.manage_download_button()};Dashboard.prototype.manage_download_button=function(){var download;download=$("#download_appcast");if(app.settings.browser.OS==="Mac"){download.attr("href",download.data("mac"));return $("li.win").hide()}else{download.attr("href",download.data("win"));return $("li.osx").hide()}};Dashboard.prototype.on_device_changed=function(){this.device_change_count++;if(app.session.get("hide:dashboard_help")&&this.device_change_count>=2){this.balloons.dashboard_help.hide();if(!app.session.get("hide:help")){
return this.balloons.live_instructions.show()}}};Dashboard.prototype.toggle_not_running_balloon=function(){return this.balloons.appcast.toggle()};Dashboard.prototype.on_live_changed=function(data){};Dashboard.prototype.on_record_changed=function(data){if(!data&&$(".room_public").length<=0){return this.publish_modal.open_with_id(this.record_button.tape_id)}};Dashboard.prototype.on_appcast_connected=function(is_connected){if(is_connected==null){is_connected=false}this.appcast_is_running=is_connected;clearTimeout(this.timeout);return this.timeout=setTimeout(this.check_appcast_running,100)};Dashboard.prototype.on_status=function(status){if(status==="buffering"){notify.info("The connection is slow at the moment. Please make sure you have      no other uploads happening at the same time")}if(status==="reconnecting"){notify.info("Connection lost. Trying to reconnect...")}if(status==="stopped"){if($(".room_live").length>0){app.emit("room:go_offline")}}if(status==="error"){notify.error("There was a problem while streaming, is the internet connection OK?")}return console.log("got status ->",status)};Dashboard.prototype.check_appcast_running=function(){if(this.appcast_is_running){return this.on_appcast_running()}else{return this.on_appcast_not_running()}};Dashboard.prototype.on_appcast_running=function(){this.dom.addClass("appcast_running").removeClass("appcast_not_running");this.meter.activate();this.balloons.appcast.hide();if(!app.session.get("hide:dashboard_help")){this.balloons.dashboard_help.show();return app.session.set("hide:dashboard_help",true)}};Dashboard.prototype.on_appcast_not_running=function(){this.dom.removeClass("appcast_running").addClass("appcast_not_running");this.meter.deactivate();this.balloons.appcast.show();if($(".room_live").length>0){return app.emit("room:go_offline")}};Dashboard.prototype.prepare_notify_followers_balloon=function(){var _this=this;this.notify=view.get_by_dom("#notify_followers");return this.notify.mouseover(function(){if(!app.session.get("hide:notify_balloon")){_this.balloons.notify_followers.show()}return app.session.set("hide:notify_balloon",true)})};Dashboard.prototype.destroy=function(){var item;Dashboard.__super__.destroy.call(this);this.publish_modal=null;this.room_view=null;if(this.is_room_owner){for(item in this.balloons){view.destroy_view(this.balloons[item])}if(this.appcast_not_running_message.length>0){this.appcast_not_running_message.off("click",this.toggle_not_running_balloon)}if(this.live_button){this.live_button.off("click");this.record_button.off("click");this.live_button.off("changed",this.on_live_changed);this.record_button.off("changed",this.on_record_changed)}appcast.off("connected",this.on_appcast_connected);return app.off("appcast:input_device",this.on_device_changed)}};return Dashboard}(RoomView)},{"app/controllers/appcast":"src/frontend/scripts/controllers/appcast","app/controllers/notify":"src/frontend/scripts/controllers/notify","app/views/room/room_view":"src/frontend/scripts/views/room/room_view","app/controllers/user":"src/frontend/scripts/controllers/user","api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast"});require.register("src/frontend/scripts/views/room/popup_trigger",function(require,module,exports){var PopupTrigger,get_coords,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};get_coords=require("app/utils/io/get_coords");module.exports=PopupTrigger=function(){function PopupTrigger(dom){this.dom=dom;this._on_people_out=__bind(this._on_people_out,this);this._on_people_over=__bind(this._on_people_over,this);this._on_views_binded=__bind(this._on_views_binded,this);view.on("binded",this._on_views_binded);this.id=this.dom.data("user-id");this.position=this.dom.data("position")}PopupTrigger.prototype._on_views_binded=function(scope){if(!scope.main){return}view.off("binded",this._on_views_binded);this.popup=view.get_by_dom(".chat_user_popup");this.dom.on("mouseover",this._on_people_over);return this.dom.on("mouseout",this._on_people_out)};PopupTrigger.prototype._on_people_over=function(e){var coords;if(app.settings.browser.mobile){return}coords=get_coords(e);return this.popup.show(this.id,coords,this.position)};PopupTrigger.prototype._on_people_out=function(){if(app.settings.browser.mobile){return}return this.popup.hide()};PopupTrigger.prototype.destroy=function(){this.popup=null;this.dom.on("mouseover",this._on_people_over);return this.dom.on("mouseout",this._on_people_out)};return PopupTrigger}()},{"app/utils/io/get_coords":"src/frontend/scripts/utils/io/get_coords"});require.register("src/frontend/scripts/views/room/room_view",function(require,module,exports){var RoomView,user,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};user=require("app/controllers/user");module.exports=RoomView=function(){RoomView.prototype.room_created=false;RoomView.prototype.room_subscribe_id=String;RoomView.prototype.is_room_owner=false;function RoomView(dom){this.dom=dom;this.on_room_created=__bind(this.on_room_created,this);this.on_listener_removed=__bind(this.on_listener_removed,this);this.on_listener_added=__bind(this.on_listener_added,this);this.on_views_binded=__bind(this.on_views_binded,this);view.on("binded",this.on_views_binded)}RoomView.prototype.on_views_binded=function(scope){var _this=this;if(!scope.main){return}return delay(2,function(){_this.room=view.get_by_dom(".createroom");if(!_this.room){console.error("problem finding view for .createroom");return}return _this._on_views_binded()})};RoomView.prototype._on_views_binded=function(){var r,ref,_this=this;if(this.room&&this.room.is_create_page()){ref=this;this.room.once("room:created",function(data){return ref.on_room_created(data._id,user.owner_id())})}else{r=document.getElementById("room_id");this.on_room_created(r.value,user.owner_id())}return view.off("binded",this.on_views_binded)};RoomView.prototype.on_listener_added=function(data){};RoomView.prototype.on_listener_removed=function(data){};RoomView.prototype.on_room_created=function(room_id,owner_id){this.room_id=room_id;this.owner_id=owner_id;this.room_created=true;this.is_room_owner=user.check_guest_owner();this.room.people_list.on("listener:added",this.on_listener_added);return this.room.people_list.on("listener:removed",this.on_listener_removed)};RoomView.prototype.destroy=function(){var _ref,_ref1;if(this.room_created){if((_ref=this.room.people_list)!=null){_ref.off("listener:added",this.on_listener_added)}return(_ref1=this.room.people_list)!=null?_ref1.off("listener:removed",this.on_listener_removed):void 0}};return RoomView}()},{"app/controllers/user":"src/frontend/scripts/controllers/user"});require.register("src/frontend/scripts/views/room/sidebar_right",function(require,module,exports){var L,RoomView,SidebarRight,_ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};L=require("api/loopcast/loopcast");RoomView=require("./room_view");module.exports=SidebarRight=function(_super){__extends(SidebarRight,_super);function SidebarRight(){this.on_listener_removed=__bind(this.on_listener_removed,this);this.on_listener_added=__bind(this.on_listener_added,this);this.on_unlike=__bind(this.on_unlike,this);this.on_like=__bind(this.on_like,this);this.on_room_created=__bind(this.on_room_created,this);_ref=SidebarRight.__super__.constructor.apply(this,arguments);return _ref}SidebarRight.prototype.stats={visits:0,likes:0,listeners:0};SidebarRight.prototype.likes=null;SidebarRight.prototype.visits=null;SidebarRight.prototype.listeners=null;SidebarRight.prototype.on_room_created=function(room_id,owner_id){var ref;this.room_id=room_id;this.owner_id=owner_id;SidebarRight.__super__.on_room_created.call(this,this.room_id,this.owner_id);this.visits=this.dom.find(".stat_visits .number");this.likes=this.dom.find(".stat_likes .number");this.listeners=this.dom.find(".stat_listeners .number");ref=this;return L.rooms.stats(this.room_id,function(e,stats){stats.visits=Math.max(0,parseInt(stats.visits));stats.likes=Math.max(0,parseInt(stats.likes));stats.listeners=Math.max(0,parseInt(stats.listeners));stats.listeners=0;ref.visits.html(stats.visits);ref.likes.html(stats.likes);ref.listeners.html(stats.listeners);ref.stats.visits=stats.visits;ref.stats.likes=stats.likes;ref.stats.listeners=stats.listeners;return ref.dom.removeClass("not_loaded")})};SidebarRight.prototype.on_like=function(data){return this.likes.html(++this.stats.likes)};SidebarRight.prototype.on_unlike=function(data){return this.likes.html(--this.stats.likes)};SidebarRight.prototype.on_listener_added=function(data){return this.update_listeners(data.total)};SidebarRight.prototype.on_listener_removed=function(data){return this.update_listeners(data.total)};SidebarRight.prototype.update_listeners=function(total){if(isNaN(total)||Number(total)<0){total=0}return this.stats.listeners=total};return SidebarRight}(RoomView)},{"api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","./room_view":"src/frontend/scripts/views/room/room_view"});require.register("src/frontend/scripts/views/room/tape/edit_modal_opener",function(require,module,exports){var EditModalOpener,api,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};api=require("app/api/loopcast/loopcast");module.exports=EditModalOpener=function(){EditModalOpener.prototype.edit_modal=null;EditModalOpener.prototype.id=null;EditModalOpener.prototype.type="tape";function EditModalOpener(dom){this.dom=dom;this.on_edit_modal_submit=__bind(this.on_edit_modal_submit,this);this.open_edit_modal=__bind(this.open_edit_modal,this);this.on_views_binded=__bind(this.on_views_binded,this);view.on("binded",this.on_views_binded);this.id=this.dom.data("id");if(this.dom.data("type")!=null){this.type=this.dom.data("type")}}EditModalOpener.prototype.on_views_binded=function(scope){if(!scope.main){return}view.off("binded",this.on_views_binded);this.edit_modal=view.get_by_dom($("#room_modal"));return this.dom.on("click",this.open_edit_modal)};EditModalOpener.prototype.open_edit_modal=function(){var _this=this;this.edit_modal.on("submit",this.on_edit_modal_submit);this.edit_modal.dom.data("modal-close",true);this.edit_modal.set_type(this.type);return app.rooms.info(this.id,this.type,function(response){var data;data=_this.normalize_data(response);return _this.edit_modal.open_with_data(data)})};EditModalOpener.prototype.normalize_data=function(data){var output,room,tape;if(data.type==="room"){room=data.data.room;output={is_live:true,title:room.info.title,genres:room.info.genres,about:room.info.about,location:room.info.location,"public":true,cover_url:room.info.cover_url}}else{tape=data.data.tape;output={is_live:false,title:tape.title,genres:tape.genres,about:tape.about,location:tape.location,"public":tape["public"],cover_url:tape.cover_url}}return output};EditModalOpener.prototype.normalize_data_for_update=function(data){var output;data.genres=data.genres.split(",");if(this.type==="tape"){output=data}else{output={title:data.title,location:data.location,about:data.about,cover_url:data.cover,genres:data.genres,is_public:true}}return output};EditModalOpener.prototype.on_edit_modal_submit=function(data){var key,to_submit,_this=this;to_submit=this.normalize_data_for_update(data);key=this.type==="room"?"rooms":"tapes";api[key].update(this.id,to_submit,function(error,response){});this.edit_modal.hide_message();this.edit_modal.show_loading();this.edit_modal.close();return this.edit_modal.off("submit",this.on_edit_modal_submit)};EditModalOpener.prototype.destroy=function(){var _base;if(this.edit_modal!=null){this.dom.off("click",this.open_edit_modal);return typeof(_base=this.edit_modal).off==="function"?_base.off("submit",this.on_edit_modal_submit):void 0}};return EditModalOpener}()},{"app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast"});require.register("src/frontend/scripts/views/room/tape/like_button",function(require,module,exports){var L,LikeButton,LoggedView,StringUtils,login_popup,send_message,user,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};send_message=require("app/utils/rooms/tape/send_message");login_popup=require("app/utils/login_popup");StringUtils=require("app/utils/string");L=require("app/api/loopcast/loopcast");user=require("app/controllers/user");LoggedView=require("app/views/logged_view");module.exports=LikeButton=function(_super){__extends(LikeButton,_super);LikeButton.prototype.tape_id=null;LikeButton.prototype.liked=false;LikeButton.prototype.num_likes=0;LikeButton.prototype.already_liked=false;LikeButton.prototype.logged=false;function LikeButton(dom){this.dom=dom;this.on_user_unlogged=__bind(this.on_user_unlogged,this);this.on_user_logged=__bind(this.on_user_logged,this);this.toggle_like=__bind(this.toggle_like,this);this.on_unlike=__bind(this.on_unlike,this);this.on_like=__bind(this.on_like,this);this.on_views_binded=__bind(this.on_views_binded,this);LikeButton.__super__.constructor.call(this);this.tape_id=this.dom.data("tape-id");this.counter=this.dom.find(".label");this.icon=this.dom.find(".icon");this.icon.on("click",this.toggle_like)}LikeButton.prototype.on_views_binded=function(scope){LikeButton.__super__.on_views_binded.call(this,scope);this.tape_view=view.get_by_dom("div.tape_view");this.tape_view.on("like",this.on_like);return this.tape_view.on("unlike",this.on_unlike)};LikeButton.prototype.on_like=function(data){log("[LikeButton] on_like",data);return this.counter.html(data.counter_likes)};LikeButton.prototype.on_unlike=function(data){return this.counter.html(data.counter_likes)};LikeButton.prototype.like=function(){var _this=this;if(this.liked){return}this.liked=true;this.dom.addClass("liked");send_message(this.tape_id,"Liked this session",{like:this.liked});return L.tapes.like(this.tape_id,function(error,response){return log("[LikeButton] like response",error,response)})};LikeButton.prototype.unlike=function(){var _this=this;if(!this.liked){return}this._unlike();this.num_likes=Math.max(0,this.num_likes-1);this.counter.html(this.num_likes);return L.tapes.dislike(this.tape_id,function(error,response){return log("[LikeButton] like response",error,response)})};LikeButton.prototype._unlike=function(){this.liked=false;return this.dom.removeClass("liked")};LikeButton.prototype.toggle_like=function(e){if(user.is_logged()){if(this.liked){return this.unlike()}else{return this.like()}}else{app.settings.action={type:"like_tape",data:{tape_id:this.tape_id,message:"Liked this session"}};app.settings.room_to_like=true;app.settings.after_login_url=location.pathname;return login_popup()}};LikeButton.prototype.on_user_logged=function(user_data){var _this=this;this.user_data=user_data;if(this.logged){return}this.logged=true;log("[LikeButton] on_user_logged",this.user_data);return L.tapes.get(this.tape_id,function(error,response){log("[LikeButton] getting tape info",response);if(!error&&response.liked){_this.liked=true;_this.already_liked=true;return _this.dom.addClass("liked")}})};LikeButton.prototype.on_user_unlogged=function(){if(!this.logged){return}log("[LikeButton] on_user_unlogged");this.logged=false;this.liked=false;return this.dom.removeClass("liked")};LikeButton.prototype.destroy=function(){var _ref,_ref1;if((_ref=this.tape_view)!=null){if(typeof _ref.off==="function"){_ref.off("like",this.on_like)}}if((_ref1=this.tape_view)!=null){if(typeof _ref1.off==="function"){_ref1.off("unlike",this.on_unlike)}}return LikeButton.__super__.destroy.call(this)};return LikeButton}(LoggedView)},{"app/utils/rooms/tape/send_message":"src/frontend/scripts/utils/rooms/tape/send_message","app/utils/login_popup":"src/frontend/scripts/utils/login_popup","app/utils/string":"src/frontend/scripts/utils/string","app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","app/controllers/user":"src/frontend/scripts/controllers/user","app/views/logged_view":"src/frontend/scripts/views/logged_view"});require.register("src/frontend/scripts/views/room/tape/list_favourites",function(require,module,exports){var ListFavourites,get_coords,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};get_coords=require("app/utils/io/get_coords");module.exports=ListFavourites=function(){ListFavourites.prototype.lock=false;ListFavourites.prototype.request=null;function ListFavourites(dom){this.dom=dom;this._on_people_out=__bind(this._on_people_out,this);this._on_people_over=__bind(this._on_people_over,this);this._on_views_binded=__bind(this._on_views_binded,this);view.on("binded",this._on_views_binded)}ListFavourites.prototype._on_views_binded=function(scope){if(!scope.main){return}view.off("binded",this._on_views_binded);this.popup=view.get_by_dom(".chat_user_popup");log("[ListFavourites]",this.popup);this.dom.on("mousemove",".chat_user_thumb",this._on_people_over);return this.dom.on("mouseout",".chat_user_thumb",this._on_people_out)};ListFavourites.prototype._on_people_over=function(e){var coords,id,_this=this;coords=get_coords(e);id=$(e.currentTarget).data("user-id");if(this.lock){log("[ddd]lock active, return");return}log("[ddd]show");return this.popup.show(id,coords,function(){log("[ddd]set lock true");return _this.lock=true})};ListFavourites.prototype._on_people_out=function(){var _this=this;log("[ddd]hide");return this.popup.hide(function(){log("[ddd]set lock false");return _this.lock=false})};ListFavourites.prototype.destroy=function(){this.popup=null;this.dom.on("mousemove",this._on_people_over);return this.dom.on("mouseout",this._on_people_out)};return ListFavourites}()},{"app/utils/io/get_coords":"src/frontend/scripts/utils/io/get_coords"});require.register("src/frontend/scripts/views/room/tape/messages",function(require,module,exports){var Messages,api,autolink,get_coords,transform,user,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};require("app/utils/time/livestamp");get_coords=require("app/utils/io/get_coords");transform=require("lib/cloudinary/transform");user=require("app/controllers/user");api=require("app/api/loopcast/loopcast");autolink=require("lib/tools/strings/autolink");module.exports=Messages=function(){Messages.prototype.tape_id=null;Messages.prototype.users={};function Messages(dom){var _this=this;this.dom=dom;this.on_message=__bind(this.on_message,this);this._on_people_out=__bind(this._on_people_out,this);this._on_people_over=__bind(this._on_people_over,this);this.on_views_binded=__bind(this.on_views_binded,this);this.tape_id=this.dom.data("tape-id");this.tmpl=require("client_templates/chat/tape_message");api.tapes.comments(this.tape_id,function(error,response){var m,_i,_len,_results;log("[Messages] old messages",response);if(error){return}response=response.reverse();_results=[];for(_i=0,_len=response.length;_i<_len;_i++){m=response[_i];_results.push(_this.on_message(m))}return _results});view.on("binded",this.on_views_binded)}Messages.prototype.on_views_binded=function(scope){if(!scope.main){return}view.off("binded",this.on_views_binded);this.tape_view=view.get_by_dom("div.tape_view");this.tape_view.on("message",this.on_message);if(this.popup==null){this.popup=view.get_by_dom(".chat_user_popup")}this.dom.on("mouseover",".chat_user_thumb",this._on_people_over);return this.dom.on("mouseout",".chat_user_thumb",this._on_people_out)};Messages.prototype._on_people_over=function(e){var coords,id;id=$(e.currentTarget).data("user-id");log("[On People over]",id);coords=get_coords(e);return this.popup.show(id,coords)};Messages.prototype._on_people_out=function(){return this.popup.hide()};Messages.prototype.on_message=function(data){var h,html,obj,_ref;if(this.users[data.username]==null){this.users[data.username]={avatar:data.avatar,id:data.username,images:transform.all(data.avatar),name:data.name,url:"/"+data.username,username:data.username};if(!data.occupation){this.users[data.username].occupation=["Occupation"]}}obj={message:autolink(data.message),time:data.time,user:{url:"/"+data.username,name:data.name,thumb:transform.avatar(data.avatar),author:this.owner_id===data._id,username:data.username,id:data._id}};if((_ref=data.payload)!=null?_ref.like:void 0){obj.like=true}html=this.tmpl(obj);h=$(html);this.dom.prepend(h);return delay(10,function(){return h.addClass("show")})};Messages.prototype.destroy=function(){var _ref;if((_ref=this.tape_view)!=null){if(typeof _ref.off==="function"){_ref.off("message",this.on_message)}}return this.tape_view=null};return Messages}()},{"app/utils/time/livestamp":"src/frontend/scripts/utils/time/livestamp","app/utils/io/get_coords":"src/frontend/scripts/utils/io/get_coords","lib/cloudinary/transform":"src/lib/cloudinary/transform","app/controllers/user":"src/frontend/scripts/controllers/user","app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","lib/tools/strings/autolink":"src/lib/tools/strings/autolink","client_templates/chat/tape_message":"src/frontend/templates/chat/tape_message"});require.register("src/frontend/scripts/views/room/tape/my_profile_image",function(require,module,exports){var LoggedView,MyProfileImage,get_coords,transform,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};LoggedView=require("app/views/logged_view");transform=require("lib/cloudinary/transform");get_coords=require("app/utils/io/get_coords");module.exports=MyProfileImage=function(_super){__extends(MyProfileImage,_super);MyProfileImage.prototype.original_src=null;MyProfileImage.prototype.user_logged=false;function MyProfileImage(dom){this.dom=dom;this._on_people_out=__bind(this._on_people_out,this);this._on_people_over=__bind(this._on_people_over,this);this.on_user_unlogged=__bind(this.on_user_unlogged,this);this.on_user_logged=__bind(this.on_user_logged,this);MyProfileImage.__super__.constructor.call(this,this.dom);this.image=this.dom.find("img");this.original_src=this.image.attr("src")}MyProfileImage.prototype.on_user_logged=function(user_data){this.user_data=user_data;if(this.user_logged){return}this.user_logged=true;log("[MyProfileImage] on_user_logged",this.user_data);this.image.attr("src",transform.avatar(this.user_data.avatar));if(this.popup==null){this.popup=view.get_by_dom(".chat_user_popup")}this.dom.on("mouseover",this._on_people_over);return this.dom.on("mouseout",this._on_people_out)};MyProfileImage.prototype.on_user_unlogged=function(){if(!this.user_logged){return}this.user_logged=false;log("[MyProfileImage] on_user_unlogged");this.image.attr("src",this.original_src);this.dom.off("mouseover",this._on_people_over);return this.dom.off("mouseout",this._on_people_out)};MyProfileImage.prototype._on_people_over=function(e){var coords;coords=get_coords(e);return this.popup.show(this.user_data._id,coords)};MyProfileImage.prototype._on_people_out=function(){return this.popup.hide()};MyProfileImage.prototype.destroy=function(){this.popup=null;if(this.user_logged){this.dom.on("mouseover",this._on_people_over);return this.dom.on("mouseout",this._on_people_out)}};return MyProfileImage}(LoggedView)},{"app/views/logged_view":"src/frontend/scripts/views/logged_view","lib/cloudinary/transform":"src/lib/cloudinary/transform","app/utils/io/get_coords":"src/frontend/scripts/utils/io/get_coords"});require.register("src/frontend/scripts/views/room/tape/sidebar",function(require,module,exports){var Sidebar,tmpl,transform,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};tmpl=require("templates/rooms/tapes/sidebar_favorite");transform=require("lib/cloudinary/transform");module.exports=Sidebar=function(){Sidebar.prototype.people={};function Sidebar(dom){this.dom=dom;this.on_like_unlike=__bind(this.on_like_unlike,this);this.on_views_binded=__bind(this.on_views_binded,this);view.on("binded",this.on_views_binded);this.list=this.dom.find(".list_likes");this.counter=this.dom.find("h3 .number")}Sidebar.prototype.on_views_binded=function(scope){if(!scope.main){return}view.off("binded",this.on_views_binded);this.tape_view=view.get_by_dom("div.tape_view");this.tape_view.on("like",this.on_like_unlike);this.tape_view.on("unlike",this.on_like_unlike);this.like_button=view.get_by_dom(".no_favourites .like_counter");return log("[Like Button] ---->",this.like_button)};Sidebar.prototype.on_like_unlike=function(data){log("[Sidebar] on like/unlike",data.counter_likes,data);if(data.type==="like"){this.on_like(data)}else{this.on_unlike(data)}if(data.counter_likes>0){this.dom.addClass("favourited")}else{this.dom.removeClass("favourited");this.like_button._unlike()}return this.counter.html(data.counter_likes)};Sidebar.prototype.on_like=function(data){var el;data.thumb=transform.avatar(data.avatar);el=this.dom.find("[data-username="+data.username+"]");if(el.length<=0){this.list.append(tmpl(data))}return log("---> like",data,el.length)};Sidebar.prototype.on_unlike=function(data){var el;el=this.dom.find("[data-username="+data.username+"]");if(el.length>0){el.remove()}return log("---> unlike",data,el.length)};Sidebar.prototype.destroy=function(){var _ref,_ref1;if((_ref=this.tape_view)!=null){if(typeof _ref.off==="function"){_ref.off("like",this.on_like_unlike)}}if((_ref1=this.tape_view)!=null){if(typeof _ref1.off==="function"){_ref1.off("unlike",this.on_like_unlike)}}return this.tape_view=null};return Sidebar}()},{"templates/rooms/tapes/sidebar_favorite":"src/frontend/templates/rooms/tapes/sidebar_favorite","lib/cloudinary/transform":"src/lib/cloudinary/transform"});require.register("src/frontend/scripts/views/room/tape/textarea",function(require,module,exports){var L,StringUtils,Textarea,login_popup,send_message,user,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};send_message=require("app/utils/rooms/tape/send_message");login_popup=require("app/utils/login_popup");StringUtils=require("app/utils/string");L=require("app/api/loopcast/loopcast");user=require("app/controllers/user");module.exports=Textarea=function(){Textarea.prototype.tape_id=null;function Textarea(dom){this.dom=dom;this.post_comment=__bind(this.post_comment,this);this.tape_id=this.dom.data("tape-id");this.textarea=this.dom.find(".chat_user_text");this.submit_button=this.dom.find(".post_comment");this.submit_button.on("click",this.post_comment)}Textarea.prototype.post_comment=function(){var message;message=StringUtils.trim(this.textarea.val());log("[Textarea] enter_pressed",message);this.textarea.val("");if(user.is_logged()){return send_message(this.tape_id,message)}else{app.settings.action={type:"message",data:{room_id:this.tape_id,message:message,payload:{}}};app.settings.after_login_url=location.pathname;return login_popup()}};return Textarea}()},{"app/utils/rooms/tape/send_message":"src/frontend/scripts/utils/rooms/tape/send_message","app/utils/login_popup":"src/frontend/scripts/utils/login_popup","app/utils/string":"src/frontend/scripts/utils/string","app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast","app/controllers/user":"src/frontend/scripts/controllers/user"});require.register("src/frontend/scripts/views/room/tape/user_set",function(require,module,exports){var UserSet,tags_list,transform,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};tags_list=require("templates/components/tags_list");transform=require("lib/cloudinary/transform");module.exports=UserSet=function(){function UserSet(dom){this.dom=dom;this.on_update=__bind(this.on_update,this);this.on_views_binded=__bind(this.on_views_binded,this);this.id=this.dom.data("room-id");view.on("binded",this.on_views_binded);this.elements={title:this.dom.find(".session_title a"),genres:this.dom.find(".genres"),location:this.dom.find(".location .text"),cover:this.dom.find(".image")}}UserSet.prototype.on_views_binded=function(scope){if(!scope.main){return}view.off("binded",this.on_views_binded);return app.rooms.on("update",this.on_update)};UserSet.prototype.on_update=function(data){if(data._id!==this.id){return}if(data.data==null){data.data=data.room}this.elements.title.html(data.data.title);this.elements.genres.html(tags_list({tags:data.data.genres}));this.elements.location.html(data.data.location);if(data.data.cover_url.indexOf("/upload")>=0){return this.elements.cover.css("background-image","url("+transform.cover_thumb(data.data.cover_url)+")")}};return UserSet}()},{"templates/components/tags_list":"src/frontend/templates/components/tags_list","lib/cloudinary/transform":"src/lib/cloudinary/transform"});require.register("src/frontend/scripts/views/room/tape_view",function(require,module,exports){var L,LoggedView,TapeView,happens,socket,tags_list,transform,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};require("app/utils/time/livestamp");socket=require("app/controllers/socket");happens=require("happens");LoggedView=require("app/views/logged_view");tags_list=require("templates/components/tags_list");transform=require("lib/cloudinary/transform");L=require("app/api/loopcast/loopcast");module.exports=TapeView=function(_super){__extends(TapeView,_super);TapeView.prototype.tape_id=null;TapeView.prototype.elements={};TapeView.prototype.counter_likes=0;function TapeView(dom){var _this=this;this.dom=dom;this.on_socket_message=__bind(this.on_socket_message,this);this.on_views_binded=__bind(this.on_views_binded,this);this.on_update=__bind(this.on_update,this);happens(this);this.tape_id=this.dom.data("tape-id");this.elements.title=this.dom.find(".tape_title");this.elements.author=this.dom.find(".tape_author");this.elements.about=this.dom.find(".tape_description .text");this.elements.genres=this.dom.find(".tags");this.elements.cover={desktop:this.dom.find(".cover_image.for_desktop"),mobile:this.dom.find(".cover_image.for_mobile")};app.body.addClass("tape_view");view.on("binded",this.on_views_binded);L.tapes.get(this.tape_id,function(error,response){_this.counter_likes=response.tape.likes;return log("[TapeView] getting tape info",_this.counter_likes)})}TapeView.prototype.on_update=function(data){log("[TapeView] on_update",data);this.elements.title.html(data.data.title);this.elements.about.html(data.data.about);this.elements.genres.html(tags_list({tags:data.data.genres}));this.elements.cover.desktop.css("background-image","url("+transform.cover(data.data.cover_url)+")");this.elements.cover.mobile.css("background-image","url("+transform.cover_mobile(data.data.cover_url)+")");return app.emit("set:updated")};TapeView.prototype.on_views_binded=function(scope){if(!scope.main){return}view.off("binded",this.on_views_binded);log("[TapeView] on_views_binded",socket);socket.rooms.subscribe(this.tape_id);return socket.on(this.tape_id,this.on_socket_message)};TapeView.prototype.on_socket_message=function(data){log("[TapeView on socket event]",data.type,data);if(data.type==="message"){return this.emit("message",data)}else if(data.type==="like"){this.counter_likes++;data.counter_likes=this.counter_likes;return this.emit("like",data)}else if(data.type==="unlike"){this.counter_likes--;data.counter_likes=this.counter_likes;return this.emit("unlike",data);
}else if(data.type==="update"){this.emit("update",data);return this.on_update(data)}};TapeView.prototype.destroy=function(){socket.off(this.tape_id,this.on_socket_message);return delay(100,function(){return app.body.removeClass("tape_view")})};return TapeView}(LoggedView)},{"app/utils/time/livestamp":"src/frontend/scripts/utils/time/livestamp","app/controllers/socket":"src/frontend/scripts/controllers/socket",happens:"node_modules/happens/index","app/views/logged_view":"src/frontend/scripts/views/logged_view","templates/components/tags_list":"src/frontend/templates/components/tags_list","lib/cloudinary/transform":"src/lib/cloudinary/transform","app/api/loopcast/loopcast":"src/frontend/scripts/api/loopcast/loopcast"});require.register("src/frontend/scripts/views/upload-box",function(require,module,exports){var Cloudinary,Dropzone,Happens,LoggedView,UploadBox,transform,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};LoggedView=require("app/views/logged_view");Dropzone=require("dropzone");Cloudinary=require("app/controllers/cloudinary");transform=require("lib/cloudinary/transform");Happens=require("happens");module.exports=UploadBox=function(){function UploadBox(dom){var _this=this;this.dom=dom;this.share_on_google=__bind(this.share_on_google,this);this.share_on_twitter=__bind(this.share_on_twitter,this);this.share_on_facebook=__bind(this.share_on_facebook,this);this.on_views_binded=__bind(this.on_views_binded,this);this.onCoverUploaded=__bind(this.onCoverUploaded,this);this.validateTags=__bind(this.validateTags,this);Happens(this);this.container=this.dom.find(".container");view.once("binded",this.on_views_binded);this.initDropzone();this.dom.find(".publish").on("click",function(e){var tagsValid,titleValid;e.preventDefault();titleValid=_this.validate(_this.title);tagsValid=_this.validateTags();if(titleValid&&tagsValid){return _this.showPage(3)}});this.dom.find("#return-to-upload").click(function(e){return _this.showPage(1)});this.prepareSocialShare()}UploadBox.prototype.initDropzone=function(){var dropzone,_this=this;dropzone=new Dropzone(this.dom.find(".drag-and-drop")[0],{url:"/upload/path",clickable:true,previewsContainer:document.querySelector(".preview-container"),previewTemplate:document.querySelector("#preview-template").innerHTML});dropzone.on("dragenter",function(){return _this.dom.addClass("drag")});dropzone.on("dragleave",function(){return _this.dom.removeClass("drag")});return dropzone.on("addedfile",function(){_this.emit("addedFile");_this.dom.removeClass("drag");return _this.showPage(2)})};UploadBox.prototype.validate=function(elem){if(elem.val()===""){elem.addClass("invalid");return false}else{elem.removeClass("invalid");return true}};UploadBox.prototype.validateTags=function(tags){if(tags===void 0){tags=this.editableTags.get_tags()}if(this.tagsInput===void 0){this.tagsInput=this.dom.find(".tagsinput")}if(tags.length===0||tags[0]===""){this.tagsInput.addClass("invalid");return false}else{this.tagsInput.removeClass("invalid");return true}};UploadBox.prototype.onCoverUploaded=function(data){var cover,img,_this=this;log("[Cover uploader]",data.result.url);cover=transform.upload_mix_cover(data.result.url);img=new Image;img.src=cover;img.onload=function(){return _this.dom.find(".mix-cover").css({"background-image":"url("+cover+")"})};return this.saveData({cover_url:data.result.url})};UploadBox.prototype.on_views_binded=function(scope){var _this=this;if(!scope.main){return}view.off("binded",this.on_views_binded);this.coverUploader=view.get_by_dom(this.dom.find(".mix-cover"));this.coverUploader.on("completed",this.onCoverUploaded);this.editableTags=view.get_by_dom(this.dom.find(".tags_wrapper"));this.editableTags.on("change",this.validateTags);this.title=this.dom.find('input[name="title"]');return this.title.on("keyup",function(){return _this.validate(_this.title)})};UploadBox.prototype.saveData=function(){};UploadBox.prototype.prepareSocialShare=function(){this.data={title:"Temporary title",link:"Temporary link",summary:"Temporary summary"};this.dom.find(".social .twitter").click(this.share_on_twitter);this.dom.find(".social .fb").click(this.share_on_facebook);return this.dom.find(".social .googleplus").click(this.share_on_google)};UploadBox.prototype.share_on_facebook=function(){FB.ui({method:"feed",link:this.data.link,caption:this.data.title,description:this.data.summary,picture:this.data.image},function(response){return log(response)});return false};UploadBox.prototype.share_on_twitter=function(){this.open_popup("http://twitter.com/share?text="+this.data.title+"&amp;url="+this.data.link+"&amp;hashtags=loopcast");return false};UploadBox.prototype.share_on_google=function(){this.open_popup("https://plus.google.com/share?url="+this.data.link);return false};UploadBox.prototype.open_popup=function(url){var h,left,top,w;w=548;h=325;left=screen.width/2-w/2;top=screen.height/2-h/2;window.open(url,"sharer","toolbar=0,status=0,width="+w+",height="+h+",top="+top+",left="+left);return false};UploadBox.prototype.showPage=function(number){return this.container.removeClass("page1-active page2-active page3-active").addClass("page"+number+"-active")};return UploadBox}()},{"app/views/logged_view":"src/frontend/scripts/views/logged_view",dropzone:"node_modules/dropzone/dist/dropzone","app/controllers/cloudinary":"src/frontend/scripts/controllers/cloudinary","lib/cloudinary/transform":"src/lib/cloudinary/transform",happens:"node_modules/happens/index"});require.register("src/frontend/scripts/views/upload-page",function(require,module,exports){var Happens,UploadPage,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};Happens=require("happens");module.exports=UploadPage=function(){function UploadPage(dom){this.dom=dom;this.addUploadBox=__bind(this.addUploadBox,this);this.on_views_binded=__bind(this.on_views_binded,this);Happens(this);this.uploadBoxes=[];view.once("binded",this.on_views_binded);this.sample=this.dom.find("#sample-upload-box");this.addUploadBox()}UploadPage.prototype.on_views_binded=function(scope){var box,elem,_this=this;if(!scope.main){return}view.off("binded",this.on_views_binded);elem=this.dom.find(".new-upload-box");box=view.get_by_dom(elem);if(!box){return}elem.removeClass("new-upload-box");box.on("addedFile",function(){return _this.addUploadBox()});return this.uploadBoxes.push(box)};UploadPage.prototype.addUploadBox=function(){var box,_this=this;box=this.sample.clone().removeAttr("id").addClass("new-upload-box").appendTo(".upload-page");this.replaceSampleDataAttr(box);box.find("[data-sample-view]").each(function(index,element){element=$(element);return _this.replaceSampleDataAttr(element)});delay(2,function(){return box.removeClass("opaque")});view.once("binded",this.on_views_binded);return view.bind()};UploadPage.prototype.replaceSampleDataAttr=function(elem,oldAttr,newAttr){var value;value=elem.attr("data-sample-view");elem.removeAttr("data-sample-view");return elem.attr("data-view",value)};return UploadPage}()},{happens:"node_modules/happens/index"});require.register("src/frontend/scripts/views/upload/form",function(require,module,exports){var done;done=false;module.exports=function($dom){if(done){return}done=true;return $dom.find(".fileupload").eq(0).change(function(e){var filename;filename=$dom.find(".fileupload").val();filename=filename.split("/").pop().split("\\").pop();return api.loopcast.upload.policy_and_signature(filename,function(error,r){var options;console.log("r ->",r);options={url:$(".s3-bucket").val(),type:"POST",autoUpload:true,formData:{key:r.file_name,AWSAccessKeyId:r.credentials.key,acl:"public-read",policy:r.credentials.policy,signature:r.credentials.signature,success_action_status:"201"},progressall:function(e,data){var progress;progress=parseInt(data.loaded/data.total*100,10);console.log("progress ->",progress);console.log("progress ->",progress);return console.log("progress ->",progress)},done:function(e,data){return console.log("testing")}};$(".fileupload").fileupload(options);return console.log("called upload with options ->",options)})})}},{});require.register("src/frontend/templates/buttons/share",function(require,module,exports){module.exports=function anonymous(locals){var buf=[];buf.push('<div class="share_box"><h4>Share</h4><div class="share_row"><input type="text" value="" class="link_input"/><a href="#" title="Copy" class="button yellow_button small_button_2">Copy</a></div><div class="socials"><a href="#" title="Share on Facebook" onClick="_gaq.push([\'_trackEvent\', \'Referral\', \'Click\', \'\']);" class="spritesheet share_popup_facebook">&nbsp;</a><a href="#" title="Share on Twitter" onClick="_gaq.push([\'_trackEvent\', \'Referral\', \'Click\', \'\']);" class="spritesheet share_popup_twitter">&nbsp;</a><a href="#" title="Share on Google Plus" onClick="_gaq.push([\'_trackEvent\', \'Referral\', \'Click\', \'\']);" class="spritesheet share_popup_google">&nbsp;</a></div></div>');return buf.join("")}},{});require.register("src/frontend/templates/chat/chat_listener",function(require,module,exports){module.exports=function anonymous(locals){var buf=[];var locals_=locals||{},socket_id=locals_.socket_id,url=locals_.url,name=locals_.name,images=locals_.images;buf.push("<div"+jade.attrs({id:"listener_"+socket_id+"","data-id":""+socket_id+"","class":["img_wrapper"]},{id:true,"data-id":true})+">");if(url){buf.push("<a"+jade.attrs({href:""+url+"",title:""+name+""},{href:true,title:true})+"><img"+jade.attrs({src:""+images.chat_sidebar+"","data-id":""+socket_id+"",width:"55",height:"55"},{src:true,"data-id":true,width:true,height:true})+"/></a>")}else{buf.push("<img"+jade.attrs({src:""+images.chat_sidebar+"","data-id":""+socket_id+"",width:"55",height:"55"},{src:true,"data-id":true,width:true,height:true})+"/>")}buf.push("</div>");return buf.join("")}},{});require.register("src/frontend/templates/chat/chat_message",function(require,module,exports){module.exports=function anonymous(locals){var buf=[];var locals_=locals||{},user=locals_.user,like=locals_.like,time=locals_.time,message=locals_.message;buf.push('<div class="message"><div class="inner"><a'+jade.attrs({href:""+user.url+"",title:""+user.name+"","data-username":""+user.username+"","class":["img_wrapper_2"]},{href:true,title:true,"data-username":true})+">");if(like){buf.push('<span class="icon ss-heart"></span>')}else{buf.push("<img"+jade.attrs({src:""+user.thumb+""},{src:true})+"/>")}buf.push('</a><div class="text"><h4 class="name"><a'+jade.attrs({href:""+user.url+"",title:""+user.name+""},{href:true,title:true})+">"+jade.escape((jade.interp=user.name)==null?"":jade.interp)+'</a><span class="dash">&nbsp;-&nbsp; </span><span'+jade.attrs({"data-livestamp":""+time+"","class":["time"]},{"data-livestamp":true})+'></span></h4><p class="content">'+((jade.interp=message)==null?"":jade.interp)+"</p></div>");if(user.author){buf.push('<span class="spritesheet headphone"></span>')}buf.push("</div></div>");return buf.join("")}},{});require.register("src/frontend/templates/chat/people_popup",function(require,module,exports){module.exports=function anonymous(locals){var buf=[];var locals_=locals||{},url=locals_.url,name=locals_.name,images=locals_.images,occupation=locals_.occupation,likes=locals_.likes;buf.push('<div class="inner"><a'+jade.attrs({href:""+url+"",title:""+name+"","class":["img_wrapper"]},{href:true,title:true})+"><img"+jade.attrs({src:""+images.chat_sidebar_popup+"",alt:""+name+"",width:"84"},{src:true,alt:true,width:true})+'/></a><h3 class="name"> <a'+jade.attrs({href:""+url+"",title:""+name+""},{href:true,title:true})+">"+jade.escape((jade.interp=name)==null?"":jade.interp)+'</a></h3><p class="occupation">'+jade.escape((jade.interp=occupation)==null?"":jade.interp)+'</p><p class="followers"><span class="number">'+jade.escape((jade.interp=likes)==null?"":jade.interp)+"</span> FOLLOWERS</p></div>");return buf.join("")}},{});require.register("src/frontend/templates/chat/tape_message",function(require,module,exports){module.exports=function anonymous(locals){var buf=[];var locals_=locals||{},like=locals_.like,user=locals_.user,time=locals_.time,message=locals_.message;buf.push('<div class="chat_line padded">');if(like){buf.push("<a"+jade.attrs({href:""+user.url+"","data-user-id":""+user.id+"","class":["chat_user_thumb","like"]},{href:true,"data-user-id":true})+'><span class="icon ss-heart"></span></a>')}else{buf.push("<a"+jade.attrs({href:""+user.url+"","data-user-id":""+user.id+"","class":["chat_user_thumb"]},{href:true,"data-user-id":true})+"><img"+jade.attrs({src:""+user.thumb+""},{src:true})+"/></a>")}buf.push('<div class="chat_user_text"> <h4 class="chat_name"> <a'+jade.attrs({href:""+user.url+""},{href:true})+">"+jade.escape((jade.interp=user.name)==null?"":jade.interp)+' </a><span class="dash">- </span><span'+jade.attrs({"data-livestamp":""+time+"","class":["time"]},{"data-livestamp":true})+"></span></h4><p>"+((jade.interp=message)==null?"":jade.interp)+"</p></div></div>");return buf.join("")}},{});require.register("src/frontend/templates/components/editables/editable_profile_tags",function(require,module,exports){module.exports=function anonymous(locals){var buf=[];buf.push('<span class="icon ss-write"></span><div data-view="components/editables/editable_tags" class="tags_wrapper"><textarea id="genre_input" rows="1" style="width:310px"></textarea></div>');return buf.join("")}},{});require.register("src/frontend/templates/components/editables/editable_select",function(require,module,exports){module.exports=function anonymous(locals){var buf=[];var locals_=locals||{},values=locals_.values;buf.push('<span class="icon ss-write"></span><select class="editable_input"><option value="" class="default_value"></option>');(function(){var $$obj=values;if("number"==typeof $$obj.length){for(var $index=0,$$l=$$obj.length;$index<$$l;$index++){var val=$$obj[$index];buf.push("<option"+jade.attrs({value:""+val+""},{value:true})+">"+jade.escape((jade.interp=val)==null?"":jade.interp)+"</option>")}}else{var $$l=0;for(var $index in $$obj){$$l++;var val=$$obj[$index];buf.push("<option"+jade.attrs({value:""+val+""},{value:true})+">"+jade.escape((jade.interp=val)==null?"":jade.interp)+"</option>")}}}).call(this);buf.push("</select>");return buf.join("")}},{});require.register("src/frontend/templates/components/editables/editable_text",function(require,module,exports){module.exports=function anonymous(locals){var buf=[];buf.push('<span class="icon ss-write"></span><input type="text" class="editable_input"/>');return buf.join("")}},{});require.register("src/frontend/templates/components/editables/social_link_read_mode",function(require,module,exports){module.exports=function anonymous(locals){var buf=[];var locals_=locals||{},value=locals_.value,title=locals_.title,social=locals_.social;buf.push("<a"+jade.attrs({href:""+value+"",title:""+title+"",target:"_blank","class":[""+social+"_link"]},{"class":true,href:true,title:true,target:true})+"><img"+jade.attrs({src:"/images/social_"+social+".png"},{src:true})+"/></a>");return buf.join("")}},{});require.register("src/frontend/templates/components/editables/social_links",function(require,module,exports){module.exports=function anonymous(locals){var buf=[];var locals_=locals||{},links=locals_.links;if(links.length>0){(function(){var $$obj=links;if("number"==typeof $$obj.length){for(var $index=0,$$l=$$obj.length;$index<$$l;$index++){var item=$$obj[$index];buf.push("<input"+jade.attrs({placeholder:"http://",type:"text",value:""+item.value+"","class":["squared_input"]},{placeholder:true,type:true,value:true})+"/>")}}else{var $$l=0;for(var $index in $$obj){$$l++;var item=$$obj[$index];buf.push("<input"+jade.attrs({placeholder:"http://",type:"text",value:""+item.value+"","class":["squared_input"]},{placeholder:true,type:true,value:true})+"/>")}}}).call(this)}else{buf.push('<input placeholder="http://" type="text" class="squared_input"/>')}buf.push('<a href="#" class="button white_button small_button_4 add_new_link">Add new link</a>');return buf.join("")}},{});require.register("src/frontend/templates/components/follow_player",function(require,module,exports){module.exports=function anonymous(locals){var buf=[];var locals_=locals||{},url=locals_.url,name=locals_.name,image=locals_.image,occupation=locals_.occupation,user_id=locals_.user_id;buf.push('<div class="top"><a'+jade.attrs({href:""+url+"",title:""+name+"","class":["image_wrapper"]},{href:true,title:true})+"><img"+jade.attrs({width:"64",height:"64",src:""+image+"",alt:""+name+""},{width:true,height:true,src:true,alt:true})+'/></a><div class="text"><a'+jade.attrs({href:""+url+"",title:""+name+"","class":["room_subtitle","blue"]},{href:true,title:true})+">"+jade.escape((jade.interp=name)==null?"":jade.interp)+'</a><p class="occupation">'+jade.escape((jade.interp=occupation)==null?"":jade.interp)+'</p></div></div><div class="bottom"><p>Enjoying this? Why not follow '+jade.escape((jade.interp=name)==null?"":jade.interp)+" to catch their next mix?</p><a"+jade.attrs({href:"#","data-view":"profile/follow_button","data-user-id":""+user_id+"",onClick:"_gaq.push(['_trackEvent', 'Follow Message', 'Click', '']);","class":["button yellow_button small_button_2 follow_button"]},{href:true,"class":true,"data-view":true,"data-user-id":true,onClick:true})+'> <span class="follow">Follow</span><span class="unfollow">Unfollow</span></a></div>');return buf.join("")}},{});require.register("src/frontend/templates/components/tags_list",function(require,module,exports){module.exports=function anonymous(locals){var buf=[];var locals_=locals||{},tags=locals_.tags;(function(){var $$obj=tags;if("number"==typeof $$obj.length){for(var $index=0,$$l=$$obj.length;$index<$$l;$index++){var item=$$obj[$index];buf.push("<a"+jade.attrs({href:"/explore?genres="+item+"","class":["tag"]},{href:true})+">"+jade.escape((jade.interp=item)==null?"":jade.interp)+"</a>")}}else{var $$l=0;for(var $index in $$obj){$$l++;var item=$$obj[$index];buf.push("<a"+jade.attrs({href:"/explore?genres="+item+"","class":["tag"]},{href:true})+">"+jade.escape((jade.interp=item)==null?"":jade.interp)+"</a>")}}}).call(this);return buf.join("")}},{});require.register("src/frontend/templates/debug/gui",function(require,module,exports){module.exports=function anonymous(locals){var buf=[];buf.push('<div id="gui" class="closed"><span class="icon">D</span><pre class="content"></pre></div>');return buf.join("")}},{});require.register("src/frontend/templates/rooms/tapes/sidebar_favorite",function(require,module,exports){module.exports=function anonymous(locals){var buf=[];var locals_=locals||{},username=locals_.username,id=locals_.id,thumb=locals_.thumb;buf.push("<a"+jade.attrs({href:"/"+username+"","data-username":""+username+"","data-user-id":""+id+"","class":["chat_user_thumb"]},{href:true,"data-username":true,"data-user-id":true})+"><img"+jade.attrs({src:""+thumb+""},{src:true})+"/></a>");return buf.join("")}},{});require.register("src/frontend/templates/shared/header_user_logged",function(require,module,exports){module.exports=function anonymous(locals){var buf=[];var locals_=locals||{},images=locals_.images;buf.push('<div data-view="components/click_trigger" data-target=".user_dropdown" class="thumb_wrapper"><div class="rounded_top_bar">');if(images){buf.push("<img"+jade.attrs({src:""+images.top_bar+"","class":["top_bar_icon"]},{src:true})+"/>")}buf.push('</div><span class="icon ss-dropdown"></span><ul class="user_dropdown hover_dropdown"><li><a href="#" title="My Profile" class="myprofile_link">My Profile</a></li><li><a href="http://loopcast.uservoice.com" target="_blank" title="Feedback" class="feedback_link">Feedback</a></li><li><a href="#" title="Logout" data-view="components/logout_link" class="logout">Logout</a></li></ul></div>');return buf.join("")}},{});require.register("src/frontend/vendors/LocalConnection",function(require,module,exports){window.LocalConnection=function LocalConnection(options){this.name="localconnection";this.id=(new Date).getTime();this.useLocalStorage=false;this.debug=false;this._actions=[];this.init=function(options){try{localStorage.setItem(this.id,this.id);localStorage.removeItem(this.id);this.useLocalStorage=true}catch(e){this.useLocalStorage=false}for(var o in options){this[o]=options[o]}this.clear()};this.listen=function(){if(this.useLocalStorage){if(window.addEventListener){window.addEventListener("storage",this.bind(this,this._check),false)}else{window.attachEvent("onstorage",this.bind(this,this._check))}}else{setInterval(this.bind(this,this._check),100)}};this.send=function(event){var args=Array.prototype.slice.call(arguments,1);return this._write(event,args)};this.addCallback=function(event,func,scope){if(scope==undefined){scope=this}if(this._actions[event]==undefined){this._actions[event]=[]}this._actions[event].push({f:func,s:scope})};this.removeCallback=function(event){for(var e in this._actions){if(e==event){delete this._actions[e];break}}};this._check=function(){var data=this._read();if(data.length>0){for(var e in data){this._receive(data[e].event,data[e].args)}}};this._receive=function(event,args){if(this._actions[event]!=undefined){for(var func in this._actions[event]){if(this._actions[event].hasOwnProperty(func)){this.log('Triggering callback "'+event+'"',this._actions[event]);var callback=this._actions[event][func];callback.f.apply(callback.s,args)}}}};this._write=function(event,args){var events=this._getEvents();var evt={id:this.id,event:event,args:args};events.push(evt);this.log("Sending event",evt);if(this.useLocalStorage){localStorage.setItem(this.name,JSON.stringify(events))}else{document.cookie=this.name+"="+JSON.stringify(events)+"; path=/"}return true};this._read=function(){var events=this._getEvents();if(events==""){return false}var ret=[];for(var e in events){if(events[e].id!=this.id){ret.push({event:events[e].event,args:events[e].args});events.splice(e,1)}}if(this.useLocalStorage){localStorage.setItem(this.name,JSON.stringify(events))}else{document.cookie=this.name+"="+JSON.stringify(events)+"; path=/"}return ret};this._getEvents=function(){return this.useLocalStorage?this._getLocalStorage():this._getCookie()};this._getLocalStorage=function(){var events=localStorage.getItem(this.name);if(events==null){return[]}return JSON.parse(events)};this._getCookie=function(){var ca=document.cookie.split(";");var data;for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1,c.length)}if(c.indexOf(this.name+"=")==0){data=c.substring(this.name.length+1,c.length);break}}data=data||"[]";return JSON.parse(data)};this.clear=function(){if(this.useLocalStorage){localStorage.removeItem(this.name)}else{document.cookie=this.name+"=; path=/"}};this.bind=function(scope,fn){return function(){fn.apply(scope,arguments)}};this.log=function(){if(!this.debug){return}if(console){console.log(Array.prototype.slice.call(arguments))}};this.init(options)}},{});require.register("src/frontend/vendors/autolink-min",function(require,module,exports){(function(){var h=[].slice;String.prototype.autoLink=function(){var b,f,d,a,e,g;a=1<=arguments.length?h.call(arguments,0):[];e=/(^|[\s\n]|<br\/?>)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026\u2019@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi;if(!(0<a.length))return this.replace(e,"$1<a href='$2'>$2</a>");d=a[0];f=function(){var c;c=[];for(b in d)g=d[b],"callback"!==b&&c.push(" "+b+"='"+g+"'");return c}().join("");return this.replace(e,function(c,b,a){c=("function"===typeof d.callback?d.callback(a):void 0)||"<a href='"+a+"'"+f+">"+a+"</a>";return""+b+c})}}).call(this)},{});require.register("src/frontend/vendors/jquery.autocomplete.min",function(require,module,exports){(function($){var isOpera=false;var isMSIE=false;$.fn.extend({autocomplete:function(urlOrData,options){var isUrl=typeof urlOrData=="string";options=$.extend({},$.Autocompleter.defaults,{url:isUrl?urlOrData:null,data:isUrl?null:urlOrData,delay:isUrl?$.Autocompleter.defaults.delay:10,max:options&&!options.scroll?10:150},options);options.highlight=options.highlight||function(value){return value};options.formatMatch=options.formatMatch||options.formatItem;return this.each(function(){new $.Autocompleter(this,options)})},result:function(handler){return this.bind("result",handler)},search:function(handler){return this.trigger("search",[handler])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(options){return this.trigger("setOptions",[options])},unautocomplete:function(){return this.trigger("unautocomplete")}});$.Autocompleter=function(input,options){var KEY={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8};var $input=$(input).attr("autocomplete","off").addClass(options.inputClass);var timeout;var previousValue="";var cache=$.Autocompleter.Cache(options);var hasFocus=0;var lastKeyPressCode;var config={mouseDownOnSelect:false};var select=$.Autocompleter.Select(options,input,selectCurrent,config);var blockSubmit;isOpera&&$(input.form).bind("submit.autocomplete",function(){if(blockSubmit){blockSubmit=false;return false}});$input.bind((isOpera?"keypress":"keydown")+".autocomplete",function(event){hasFocus=1;lastKeyPressCode=event.keyCode;switch(event.keyCode){case KEY.UP:event.preventDefault();if(select.visible()){select.prev()}else{onChange(0,true)}break;case KEY.DOWN:event.preventDefault();if(select.visible()){select.next()}else{onChange(0,true)}break;case KEY.PAGEUP:event.preventDefault();if(select.visible()){select.pageUp()}else{onChange(0,true)}break;case KEY.PAGEDOWN:event.preventDefault();if(select.visible()){select.pageDown()}else{onChange(0,true)}break;case options.multiple&&$.trim(options.multipleSeparator)==","&&KEY.COMMA:case KEY.TAB:case KEY.RETURN:if(selectCurrent()){event.preventDefault();blockSubmit=true;return false}break;case KEY.ESC:select.hide();break;default:clearTimeout(timeout);timeout=setTimeout(onChange,options.delay);break}}).focus(function(){hasFocus++}).blur(function(){hasFocus=0;if(!config.mouseDownOnSelect){hideResults()}}).click(function(){if(hasFocus++>1&&!select.visible()){onChange(0,true)}}).bind("search",function(){var fn=arguments.length>1?arguments[1]:null;function findValueCallback(q,data){var result;if(data&&data.length){for(var i=0;i<data.length;i++){if(data[i].result.toLowerCase()==q.toLowerCase()){result=data[i];break}}}if(typeof fn=="function")fn(result);else $input.trigger("result",result&&[result.data,result.value])}$.each(trimWords($input.val()),function(i,value){request(value,findValueCallback,findValueCallback)})}).bind("flushCache",function(){cache.flush()}).bind("setOptions",function(){$.extend(options,arguments[1]);if("data"in arguments[1])cache.populate()}).bind("unautocomplete",function(){select.unbind();$input.unbind();$(input.form).unbind(".autocomplete")});function selectCurrent(){var selected=select.selected();if(!selected)return false;var v=selected.result;previousValue=v;if(options.multiple){var words=trimWords($input.val());if(words.length>1){var seperator=options.multipleSeparator.length;var cursorAt=$(input).selection().start;var wordAt,progress=0;$.each(words,function(i,word){progress+=word.length;if(cursorAt<=progress){wordAt=i;return false}progress+=seperator});words[wordAt]=v;v=words.join(options.multipleSeparator)}v+=options.multipleSeparator}$input.val(v);hideResultsNow();$input.trigger("result",[selected.data,selected.value]);return true}function onChange(crap,skipPrevCheck){if(lastKeyPressCode==KEY.DEL){select.hide();return}var currentValue=$input.val();if(!skipPrevCheck&&currentValue==previousValue)return;previousValue=currentValue;currentValue=lastWord(currentValue);if(currentValue.length>=options.minChars){$input.addClass(options.loadingClass);if(!options.matchCase)currentValue=currentValue.toLowerCase();request(currentValue,receiveData,hideResultsNow)}else{stopLoading();select.hide()}}function trimWords(value){if(!value)return[""];if(!options.multiple)return[$.trim(value)];return $.map(value.split(options.multipleSeparator),function(word){return $.trim(value).length?$.trim(word):null})}function lastWord(value){if(!options.multiple)return value;var words=trimWords(value);if(words.length==1)return words[0];var cursorAt=$(input).selection().start;if(cursorAt==value.length){words=trimWords(value)}else{words=trimWords(value.replace(value.substring(cursorAt),""))}return words[words.length-1]}function autoFill(q,sValue){if(options.autoFill&&lastWord($input.val()).toLowerCase()==q.toLowerCase()&&lastKeyPressCode!=KEY.BACKSPACE){$input.val($input.val()+sValue.substring(lastWord(previousValue).length));$(input).selection(previousValue.length,previousValue.length+sValue.length)}}function hideResults(){clearTimeout(timeout);timeout=setTimeout(hideResultsNow,200)}function hideResultsNow(){var wasVisible=select.visible();select.hide();clearTimeout(timeout);stopLoading();if(options.mustMatch){$input.search(function(result){if(!result){if(options.multiple){var words=trimWords($input.val()).slice(0,-1);$input.val(words.join(options.multipleSeparator)+(words.length?options.multipleSeparator:""))}else{$input.val("");$input.trigger("result",null)}}})}}function receiveData(q,data){if(data&&data.length&&hasFocus){stopLoading();select.display(data,q);autoFill(q,data[0].value);select.show()}else{hideResultsNow()}}function request(term,success,failure){if(!options.matchCase)term=term.toLowerCase();var data=cache.load(term);if(data&&data.length){success(term,data)}else if(typeof options.url=="string"&&options.url.length>0){var extraParams={timestamp:+new Date};$.each(options.extraParams,function(key,param){extraParams[key]=typeof param=="function"?param():param});$.ajax({mode:"abort",port:"autocomplete"+input.name,dataType:options.dataType,url:options.url,data:$.extend({q:lastWord(term),limit:options.max},extraParams),success:function(data){var parsed=options.parse&&options.parse(data)||parse(data);cache.add(term,parsed);success(term,parsed)}})}else{select.emptyList();failure(term)}}function parse(data){var parsed=[];var rows=data.split("\n");for(var i=0;i<rows.length;i++){var row=$.trim(rows[i]);if(row){row=row.split("|");parsed[parsed.length]={data:row,value:row[0],result:options.formatResult&&options.formatResult(row,row[0])||row[0]}}}return parsed}function stopLoading(){$input.removeClass(options.loadingClass)}};$.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,matchSubset:true,matchContains:false,cacheLength:10,max:100,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(row){return row[0]},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:", ",highlight:function(value,term){return value.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+term.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:true,scrollHeight:180};$.Autocompleter.Cache=function(options){var data={};var length=0;function matchSubset(s,sub){if(!options.matchCase)s=s.toLowerCase();var i=s.indexOf(sub);if(options.matchContains=="word"){i=s.toLowerCase().search("\\b"+sub.toLowerCase())}if(i==-1)return false;return i==0||options.matchContains}function add(q,value){if(length>options.cacheLength){flush()}if(!data[q]){length++}data[q]=value}function populate(){if(!options.data)return false;var stMatchSets={},nullData=0;if(!options.url)options.cacheLength=1;stMatchSets[""]=[];for(var i=0,ol=options.data.length;i<ol;i++){var rawValue=options.data[i];rawValue=typeof rawValue=="string"?[rawValue]:rawValue;var value=options.formatMatch(rawValue,i+1,options.data.length);if(value===false)continue;var firstChar=value.charAt(0).toLowerCase();if(!stMatchSets[firstChar])stMatchSets[firstChar]=[];var row={value:value,data:rawValue,result:options.formatResult&&options.formatResult(rawValue)||value};stMatchSets[firstChar].push(row);if(nullData++<options.max){stMatchSets[""].push(row)}}$.each(stMatchSets,function(i,value){options.cacheLength++;add(i,value)})}setTimeout(populate,25);
function flush(){data={};length=0}return{flush:flush,add:add,populate:populate,load:function(q){if(!options.cacheLength||!length)return null;if(!options.url&&options.matchContains){var csub=[];for(var k in data){if(k.length>0){var c=data[k];$.each(c,function(i,x){if(matchSubset(x.value,q)){csub.push(x)}})}}return csub}else if(data[q]){return data[q]}else if(options.matchSubset){for(var i=q.length-1;i>=options.minChars;i--){var c=data[q.substr(0,i)];if(c){var csub=[];$.each(c,function(i,x){if(matchSubset(x.value,q)){csub[csub.length]=x}});return csub}}}return null}}};$.Autocompleter.Select=function(options,input,select,config){var CLASSES={ACTIVE:"ac_over"};var listItems,active=-1,data,term="",needsInit=true,element,list;function init(){if(!needsInit)return;element=$("<div/>").hide().addClass(options.resultsClass).css("position","absolute").appendTo(document.body);list=$("<ul/>").appendTo(element).mouseover(function(event){if(target(event).nodeName&&target(event).nodeName.toUpperCase()=="LI"){active=$("li",list).removeClass(CLASSES.ACTIVE).index(target(event));$(target(event)).addClass(CLASSES.ACTIVE)}}).click(function(event){$(target(event)).addClass(CLASSES.ACTIVE);select();input.focus();return false}).mousedown(function(){config.mouseDownOnSelect=true}).mouseup(function(){config.mouseDownOnSelect=false});if(options.width>0)element.css("width",options.width);needsInit=false}function target(event){var element=event.target;while(element&&element.tagName!="LI")element=element.parentNode;if(!element)return[];return element}function moveSelect(step){listItems.slice(active,active+1).removeClass(CLASSES.ACTIVE);movePosition(step);var activeItem=listItems.slice(active,active+1).addClass(CLASSES.ACTIVE);if(options.scroll){var offset=0;listItems.slice(0,active).each(function(){offset+=this.offsetHeight});if(offset+activeItem[0].offsetHeight-list.scrollTop()>list[0].clientHeight){list.scrollTop(offset+activeItem[0].offsetHeight-list.innerHeight())}else if(offset<list.scrollTop()){list.scrollTop(offset)}}}function movePosition(step){active+=step;if(active<0){active=listItems.size()-1}else if(active>=listItems.size()){active=0}}function limitNumberOfItems(available){return options.max&&options.max<available?options.max:available}function fillList(){list.empty();var max=limitNumberOfItems(data.length);for(var i=0;i<max;i++){if(!data[i])continue;var formatted=options.formatItem(data[i].data,i+1,max,data[i].value,term);if(formatted===false)continue;var li=$("<li/>").html(options.highlight(formatted,term)).addClass(i%2==0?"ac_even":"ac_odd").appendTo(list)[0];$.data(li,"ac_data",data[i])}listItems=list.find("li");if(options.selectFirst){listItems.slice(0,1).addClass(CLASSES.ACTIVE);active=0}if($.fn.bgiframe)list.bgiframe()}return{display:function(d,q){init();data=d;term=q;fillList()},next:function(){moveSelect(1)},prev:function(){moveSelect(-1)},pageUp:function(){if(active!=0&&active-8<0){moveSelect(-active)}else{moveSelect(-8)}},pageDown:function(){if(active!=listItems.size()-1&&active+8>listItems.size()){moveSelect(listItems.size()-1-active)}else{moveSelect(8)}},hide:function(){element&&element.hide();listItems&&listItems.removeClass(CLASSES.ACTIVE);active=-1},visible:function(){return element&&element.is(":visible")},current:function(){return this.visible()&&(listItems.filter("."+CLASSES.ACTIVE)[0]||options.selectFirst&&listItems[0])},show:function(){var offset=$(input).offset();element.css({width:typeof options.width=="string"||options.width>0?options.width:$(input).width(),top:offset.top+input.offsetHeight,left:offset.left}).show();if(options.scroll){list.scrollTop(0);list.css({maxHeight:options.scrollHeight,overflow:"auto"});if(isMSIE&&typeof document.body.style.maxHeight==="undefined"){var listHeight=0;listItems.each(function(){listHeight+=this.offsetHeight});var scrollbarsVisible=listHeight>options.scrollHeight;list.css("height",scrollbarsVisible?options.scrollHeight:listHeight);if(!scrollbarsVisible){listItems.width(list.width()-parseInt(listItems.css("padding-left"))-parseInt(listItems.css("padding-right")))}}}},selected:function(){var selected=listItems&&listItems.filter("."+CLASSES.ACTIVE).removeClass(CLASSES.ACTIVE);return selected&&selected.length&&$.data(selected[0],"ac_data")},emptyList:function(){list&&list.empty()},unbind:function(){element&&element.remove()}}};$.fn.selection=function(start,end){if(start!==undefined){return this.each(function(){if(this.createTextRange){var selRange=this.createTextRange();if(end===undefined||start==end){selRange.move("character",start);selRange.select()}else{selRange.collapse(true);selRange.moveStart("character",start);selRange.moveEnd("character",end);selRange.select()}}else if(this.setSelectionRange){this.setSelectionRange(start,end)}else if(this.selectionStart){this.selectionStart=start;this.selectionEnd=end}})}var field=this[0];if(field.createTextRange){var range=document.selection.createRange(),orig=field.value,teststring="<->",textLength=range.text.length;range.text=teststring;var caretAt=field.value.indexOf(teststring);field.value=orig;this.selection(caretAt,caretAt+textLength);return{start:caretAt,end:caretAt+textLength}}else if(field.selectionStart!==undefined){return{start:field.selectionStart,end:field.selectionEnd}}}})(jQuery)},{});require.register("src/frontend/vendors/jquery.cloudinary",function(require,module,exports){(function(factory){"use strict";if(typeof define==="function"&&define.amd){define(["jquery","jquery.ui.widget","jquery.iframe-transport","jquery.fileupload"],factory)}else{var $=window.jQuery;factory($);$(function(){if($.fn.cloudinary_fileupload!==undefined){$("input.cloudinary-fileupload[type=file]").cloudinary_fileupload()}})}})(function($){"use strict";var CF_SHARED_CDN="d3jpl91pxevbkh.cloudfront.net";var OLD_AKAMAI_SHARED_CDN="cloudinary-a.akamaihd.net";var AKAMAI_SHARED_CDN="res.cloudinary.com";var SHARED_CDN=AKAMAI_SHARED_CDN;function utf8_encode(argString){if(argString===null||typeof argString==="undefined"){return""}var string=argString+"";var utftext="",start,end,stringl=0;start=end=0;stringl=string.length;for(var n=0;n<stringl;n++){var c1=string.charCodeAt(n);var enc=null;if(c1<128){end++}else if(c1>127&&c1<2048){enc=String.fromCharCode(c1>>6|192,c1&63|128)}else{enc=String.fromCharCode(c1>>12|224,c1>>6&63|128,c1&63|128)}if(enc!==null){if(end>start){utftext+=string.slice(start,end)}utftext+=enc;start=end=n+1}}if(end>start){utftext+=string.slice(start,stringl)}return utftext}function crc32(str){str=utf8_encode(str);var table="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";var crc=0;var x=0;var y=0;crc=crc^-1;for(var i=0,iTop=str.length;i<iTop;i++){y=(crc^str.charCodeAt(i))&255;x="0x"+table.substr(y*9,8);crc=crc>>>8^x}crc=crc^-1;if(crc<0){crc+=4294967296}return crc}function option_consume(options,option_name,default_value){var result=options[option_name];delete options[option_name];return typeof result=="undefined"?default_value:result}function build_array(arg){if(arg===null||typeof arg=="undefined"){return[]}else if($.isArray(arg)){return arg}else{return[arg]}}function present(value){return typeof value!="undefined"&&(""+value).length>0}function process_base_transformations(options){var transformations=build_array(options.transformation);var all_named=true;for(var i=0;i<transformations.length;i++){all_named=all_named&&typeof transformations[i]=="string"}if(all_named){return[]}delete options.transformation;var base_transformations=[];for(var i=0;i<transformations.length;i++){var transformation=transformations[i];if(typeof transformation=="string"){base_transformations.push("t_"+transformation)}else{base_transformations.push(generate_transformation_string($.extend({},transformation)))}}return base_transformations}function process_size(options){var size=option_consume(options,"size");if(size){var split_size=size.split("x");options.width=split_size[0];options.height=split_size[1]}}function process_html_dimensions(options){var width=options.width,height=options.height;var has_layer=options.overlay||options.underlay;var crop=options.crop;var use_as_html_dimensions=!has_layer&&!options.angle&&crop!="fit"&&crop!="limit"&&crop!="lfill";if(use_as_html_dimensions){if(width&&!options.html_width&&width!=="auto"&&parseFloat(width)>=1)options.html_width=width;if(height&&!options.html_height&&parseFloat(height)>=1)options.html_height=height}if(!crop&&!has_layer){delete options.width;delete options.height}}var TRANSFORMATION_PARAM_NAME_MAPPING={angle:"a",background:"b",border:"bo",color:"co",color_space:"cs",crop:"c",default_image:"d",delay:"dl",density:"dn",dpr:"dpr",effect:"e",fetch_format:"f",flags:"fl",gravity:"g",height:"h",opacity:"o",overlay:"l",page:"pg",prefix:"p",quality:"q",radius:"r",transformation:"t",underlay:"u",width:"w",x:"x",y:"y"};var TRANSFORMATION_PARAM_VALUE_MAPPING={angle:function(angle){return build_array(angle).join(".")},background:function(background){return background.replace(/^#/,"rgb:")},border:function(border){if($.isPlainObject(border)){var border_width=""+(border.width||2);var border_color=(border.color||"black").replace(/^#/,"rgb:");border=border_width+"px_solid_"+border_color}return border},color:function(color){return color.replace(/^#/,"rgb:")},dpr:function(dpr){dpr=dpr.toString();if(dpr==="auto"){return"1.0"}else if(dpr.match(/^\d+$/)){return dpr+".0"}else{return dpr}},effect:function(effect){return build_array(effect).join(":")},flags:function(flags){return build_array(flags).join(".")},transformation:function(transformation){return build_array(transformation).join(".")}};function generate_transformation_string(options){var base_transformations=process_base_transformations(options);process_size(options);process_html_dimensions(options);var params=[];for(var param in TRANSFORMATION_PARAM_NAME_MAPPING){var value=option_consume(options,param);if(!present(value))continue;if(TRANSFORMATION_PARAM_VALUE_MAPPING[param]){value=TRANSFORMATION_PARAM_VALUE_MAPPING[param](value)}if(!present(value))continue;params.push(TRANSFORMATION_PARAM_NAME_MAPPING[param]+"_"+value)}params.sort();var raw_transformation=option_consume(options,"raw_transformation");if(present(raw_transformation))params.push(raw_transformation);var transformation=params.join(",");if(present(transformation))base_transformations.push(transformation);return base_transformations.join("/")}function absolutize(url){if(!url.match(/^https?:\//)){var prefix=document.location.protocol+"//"+document.location.host;if(url[0]=="?"){prefix+=document.location.pathname}else if(url[0]!="/"){prefix+=document.location.pathname.replace(/\/[^\/]*$/,"/")}url=prefix+url}return url}function cloudinary_url_prefix(public_id,cloud_name,private_cdn,cdn_subdomain,secure_cdn_subdomain,cname,secure,secure_distribution,protocol){if(cloud_name.match(/^\//)&&!secure){return"/res"+cloud_name}var prefix=secure?"https://":window.location.protocol==="file:"?"file://":"http://";prefix=protocol?protocol+"//":prefix;var shared_domain=!private_cdn;if(secure){if(!secure_distribution||secure_distribution==OLD_AKAMAI_SHARED_CDN){secure_distribution=private_cdn?cloud_name+"-res.cloudinary.com":SHARED_CDN}shared_domain=shared_domain||secure_distribution==SHARED_CDN;if(secure_cdn_subdomain==null&&shared_domain){secure_cdn_subdomain=cdn_subdomain}if(secure_cdn_subdomain){secure_distribution=secure_distribution.replace("res.cloudinary.com","res-"+(crc32(public_id)%5+1)+".cloudinary.com")}prefix+=secure_distribution}else if(cname){var subdomain=cdn_subdomain?"a"+(crc32(public_id)%5+1)+".":"";prefix+=subdomain+cname}else{prefix+=private_cdn?cloud_name+"-res":"res";prefix+=cdn_subdomain?"-"+(crc32(public_id)%5+1):"";prefix+=".cloudinary.com"}if(shared_domain)prefix+="/"+cloud_name;return prefix}function finalize_resource_type(resource_type,type,url_suffix,use_root_path,shorten){var resource_type_and_type=resource_type+"/"+type;if(url_suffix){if(resource_type_and_type=="image/upload"){resource_type_and_type="images"}else if(resource_type_and_type=="raw/upload"){resource_type_and_type="files"}else{throw"URL Suffix only supported for image/upload and raw/upload"}}if(use_root_path){if(resource_type_and_type=="image/upload"||resource_type_and_type=="images"){resource_type_and_type=""}else{throw"Root path only supported for image/upload"}}if(shorten&&resource_type_and_type=="image/upload"){resource_type_and_type="iu"}return resource_type_and_type}function cloudinary_url(public_id,options){options=options||{};var type=option_consume(options,"type","upload");if(type=="fetch"){options.fetch_format=options.fetch_format||option_consume(options,"format")}var transformation=generate_transformation_string(options);var resource_type=option_consume(options,"resource_type","image");var version=option_consume(options,"version");var format=option_consume(options,"format");var cloud_name=option_consume(options,"cloud_name",$.cloudinary.config().cloud_name);if(!cloud_name)throw"Unknown cloud_name";var private_cdn=option_consume(options,"private_cdn",$.cloudinary.config().private_cdn);var secure_distribution=option_consume(options,"secure_distribution",$.cloudinary.config().secure_distribution);var cname=option_consume(options,"cname",$.cloudinary.config().cname);var cdn_subdomain=option_consume(options,"cdn_subdomain",$.cloudinary.config().cdn_subdomain);var secure_cdn_subdomain=option_consume(options,"secure_cdn_subdomain",$.cloudinary.config().secure_cdn_subdomain);var shorten=option_consume(options,"shorten",$.cloudinary.config().shorten);var secure=option_consume(options,"secure",window.location.protocol=="https:");var protocol=option_consume(options,"protocol",$.cloudinary.config().protocol);var trust_public_id=option_consume(options,"trust_public_id");var url_suffix=option_consume(options,"url_suffix");var use_root_path=option_consume(options,"use_root_path",$.cloudinary.config().use_root_path);if(url_suffix&&!private_cdn){throw"URL Suffix only supported in private CDN"}if(type=="fetch"){public_id=absolutize(public_id)}if(public_id.search("/")>=0&&!public_id.match(/^v[0-9]+/)&&!public_id.match(/^https?:\//)&&!present(version)){version=1}if(public_id.match(/^https?:/)){if(type=="upload"||type=="asset")return public_id;public_id=encodeURIComponent(public_id).replace(/%3A/g,":").replace(/%2F/g,"/")}else{public_id=encodeURIComponent(decodeURIComponent(public_id)).replace(/%3A/g,":").replace(/%2F/g,"/");if(url_suffix){if(url_suffix.match(/[\.\/]/))throw"url_suffix should not include . or /";public_id=public_id+"/"+url_suffix}if(format){if(!trust_public_id)public_id=public_id.replace(/\.(jpg|png|gif|webp)$/,"");public_id=public_id+"."+format}}var resource_type_and_type=finalize_resource_type(resource_type,type,url_suffix,use_root_path,shorten);var prefix=cloudinary_url_prefix(public_id,cloud_name,private_cdn,cdn_subdomain,secure_cdn_subdomain,cname,secure,secure_distribution,protocol);var url=[prefix,resource_type_and_type,transformation,version?"v"+version:"",public_id].join("/").replace(/([^:])\/+/g,"$1/");return url}function default_stoppoints(width){return 10*Math.ceil(width/10)}function prepare_html_url(public_id,options){if($.cloudinary.config("dpr")&&!options.dpr){options.dpr=$.cloudinary.config("dpr")}var url=cloudinary_url(public_id,options);var width=option_consume(options,"html_width");var height=option_consume(options,"html_height");if(width)options.width=width;if(height)options.height=height;return url}function get_config(name,options,default_value){var value=options[name]||$.cloudinary.config(name);if(typeof value=="undefined")value=default_value;return value}function closest_above(list,value){var i=list.length-2;while(i>=0&&list[i]>=value){i--}return list[i+1]}var cloudinary_config=null;var responsive_config=null;var responsive_resize_initialized=false;var device_pixel_ratio_cache={};$.cloudinary={CF_SHARED_CDN:CF_SHARED_CDN,OLD_AKAMAI_SHARED_CDN:OLD_AKAMAI_SHARED_CDN,AKAMAI_SHARED_CDN:AKAMAI_SHARED_CDN,SHARED_CDN:SHARED_CDN,config:function(new_config,new_value){if(!cloudinary_config){cloudinary_config={};$('meta[name^="cloudinary_"]').each(function(){cloudinary_config[$(this).attr("name").replace("cloudinary_","")]=$(this).attr("content")})}if(typeof new_value!="undefined"){cloudinary_config[new_config]=new_value}else if(typeof new_config=="string"){return cloudinary_config[new_config]}else if(new_config){cloudinary_config=new_config}return cloudinary_config},url:function(public_id,options){options=$.extend({},options);return cloudinary_url(public_id,options)},url_internal:cloudinary_url,transformation_string:function(options){options=$.extend({},options);return generate_transformation_string(options)},image:function(public_id,options){options=$.extend({},options);var url=prepare_html_url(public_id,options);var img=$("<img/>").data("src-cache",url).attr(options).cloudinary_update(options);return img},facebook_profile_image:function(public_id,options){return $.cloudinary.image(public_id,$.extend({type:"facebook"},options))},twitter_profile_image:function(public_id,options){return $.cloudinary.image(public_id,$.extend({type:"twitter"},options))},twitter_name_profile_image:function(public_id,options){return $.cloudinary.image(public_id,$.extend({type:"twitter_name"},options))},gravatar_image:function(public_id,options){return $.cloudinary.image(public_id,$.extend({type:"gravatar"},options))},fetch_image:function(public_id,options){return $.cloudinary.image(public_id,$.extend({type:"fetch"},options))},sprite_css:function(public_id,options){options=$.extend({type:"sprite"},options);if(!public_id.match(/.css$/))options.format="css";return $.cloudinary.url(public_id,options)},responsive:function(options){responsive_config=$.extend(responsive_config||{},options);$("img.cld-responsive, img.cld-hidpi").cloudinary_update(responsive_config);var responsive_resize=get_config("responsive_resize",responsive_config,true);if(responsive_resize&&!responsive_resize_initialized){responsive_config.resizing=responsive_resize_initialized=true;var timeout=null;$(window).on("resize",function(){var debounce=get_config("responsive_debounce",responsive_config,100);function reset(){if(timeout){clearTimeout(timeout);timeout=null}}function run(){$("img.cld-responsive").cloudinary_update(responsive_config)}function wait(){reset();setTimeout(function(){reset();run()},debounce)}if(debounce){wait()}else{run()}})}},calc_stoppoint:function(element,width){var stoppoints=$(element).data("stoppoints")||$.cloudinary.config().stoppoints||default_stoppoints;if(typeof stoppoints==="function"){return stoppoints(width)}if(typeof stoppoints==="string"){stoppoints=$.map(stoppoints.split(","),function(val){return parseInt(val)})}return closest_above(stoppoints,width)},device_pixel_ratio:function(){var dpr=window.devicePixelRatio||1;var dpr_string=device_pixel_ratio_cache[dpr];if(!dpr_string){var dpr_used=closest_above($.cloudinary.supported_dpr_values,dpr);dpr_string=dpr_used.toString();if(dpr_string.match(/^\d+$/))dpr_string+=".0";device_pixel_ratio_cache[dpr]=dpr_string}return dpr_string},supported_dpr_values:[.75,1,1.3,1.5,2,3]};$.fn.cloudinary=function(options){this.filter("img").each(function(){var img_options=$.extend({width:$(this).attr("width"),height:$(this).attr("height"),src:$(this).attr("src")},$(this).data(),options);var public_id=option_consume(img_options,"source",option_consume(img_options,"src"));var url=prepare_html_url(public_id,img_options);$(this).data("src-cache",url).attr({width:img_options.width,height:img_options.height})}).cloudinary_update(options);return this};$.fn.cloudinary_update=function(options){options=options||{};var responsive_use_stoppoints=get_config("responsive_use_stoppoints",options,"resize");var exact=responsive_use_stoppoints===false||responsive_use_stoppoints=="resize"&&!options.resizing;this.filter("img").each(function(){if(options.responsive){$(this).addClass("cld-responsive")}var attrs={};var src=$(this).data("src-cache")||$(this).data("src");if(!src)return;var responsive=$(this).hasClass("cld-responsive")&&src.match(/\bw_auto\b/);if(responsive){var parents=$(this).parents(),parentsLength=parents.length,container,containerWidth=0,nthParent;for(nthParent=0;nthParent<parentsLength;nthParent+=1){container=parents[nthParent];if(container&&container.clientWidth){containerWidth=container.clientWidth;break}}if(containerWidth==0){return}var requestedWidth=exact?containerWidth:$.cloudinary.calc_stoppoint(this,containerWidth);var currentWidth=$(this).data("width")||0;if(requestedWidth>currentWidth){$(this).data("width",requestedWidth)}else{requestedWidth=currentWidth}src=src.replace(/\bw_auto\b/g,"w_"+requestedWidth);attrs.width=null;attrs.height=null}attrs.src=src.replace(/\bdpr_(1\.0|auto)\b/g,"dpr_"+$.cloudinary.device_pixel_ratio());$(this).attr(attrs)});return this};var webp=null;$.fn.webpify=function(options,webp_options){var that=this;options=options||{};webp_options=webp_options||options;if(!webp){webp=$.Deferred();var webp_canary=new Image;webp_canary.onerror=webp.reject;webp_canary.onload=webp.resolve;webp_canary.src="data:image/webp;base64,UklGRi4AAABXRUJQVlA4TCEAAAAvAUAAEB8wAiMwAgSSNtse/cXjxyCCmrYNWPwmHRH9jwMA"}$(function(){webp.done(function(){$(that).cloudinary($.extend({},webp_options,{format:"webp"}))}).fail(function(){$(that).cloudinary(options)})});return this};$.fn.fetchify=function(options){return this.cloudinary($.extend(options,{type:"fetch"}))};if(!$.fn.fileupload){return}$.cloudinary.delete_by_token=function(delete_token,options){options=options||{};var url=options.url;if(!url){var cloud_name=options.cloud_name||$.cloudinary.config().cloud_name;url="https://api.cloudinary.com/v1_1/"+cloud_name+"/delete_by_token"}var dataType=$.support.xhrFileUpload?"json":"iframe json";return $.ajax({url:url,method:"POST",data:{token:delete_token},headers:{"X-Requested-With":"XMLHttpRequest"},dataType:dataType})};$.fn.cloudinary_fileupload=function(options){var initializing=!this.data("blueimpFileupload");if(initializing){options=$.extend({maxFileSize:2e7,dataType:"json",headers:{"X-Requested-With":"XMLHttpRequest"}},options)}this.fileupload(options);if(initializing){this.bind("fileuploaddone",function(e,data){if(data.result.error)return;data.result.path=["v",data.result.version,"/",data.result.public_id,data.result.format?"."+data.result.format:""].join("");if(data.cloudinaryField&&data.form.length>0){var upload_info=[data.result.resource_type,data.result.type,data.result.path].join("/")+"#"+data.result.signature;var multiple=$(e.target).prop("multiple");var add_field=function(){$("<input></input>").attr({type:"hidden",name:data.cloudinaryField}).val(upload_info).appendTo(data.form)};if(multiple){add_field()}else{var field=$(data.form).find('input[name="'+data.cloudinaryField+'"]');if(field.length>0){field.val(upload_info)}else{add_field()}}}$(e.target).trigger("cloudinarydone",data)});this.bind("fileuploadstart",function(e){$(e.target).trigger("cloudinarystart")});this.bind("fileuploadstop",function(e){$(e.target).trigger("cloudinarystop")});this.bind("fileuploadprogress",function(e,data){$(e.target).trigger("cloudinaryprogress",data)});this.bind("fileuploadprogressall",function(e,data){$(e.target).trigger("cloudinaryprogressall",data)});this.bind("fileuploadfail",function(e,data){$(e.target).trigger("cloudinaryfail",data)});this.bind("fileuploadalways",function(e,data){$(e.target).trigger("cloudinaryalways",data)});if(!this.fileupload("option").url){var cloud_name=options.cloud_name||$.cloudinary.config().cloud_name;var upload_url="https://api.cloudinary.com/v1_1/"+cloud_name+"/upload";this.fileupload("option","url",upload_url)}}return this};$.fn.cloudinary_upload_url=function(remote_url){this.fileupload("option","formData").file=remote_url;this.fileupload("add",{files:[remote_url]});delete this.fileupload("option","formData").file};$.fn.unsigned_cloudinary_upload=function(upload_preset,upload_params,options){options=options||{};upload_params=$.extend({},upload_params)||{};if(upload_params.cloud_name){options.cloud_name=upload_params.cloud_name;delete upload_params.cloud_name}for(var key in upload_params){var value=upload_params[key];if($.isPlainObject(value)){upload_params[key]=$.map(value,function(v,k){return k+"="+v}).join("|")}else if($.isArray(value)){if(value.length>0&&$.isArray(value[0])){upload_params[key]=$.map(value,function(array_value){return array_value.join(",")}).join("|")}else{upload_params[key]=value.join(",")}}}if(!upload_params.callback){upload_params.callback="/cloudinary_cors.html"}upload_params.upload_preset=upload_preset;options.formData=upload_params;if(options.cloudinary_field){options.cloudinaryField=options.cloudinary_field;delete options.cloudinary_field}var html_options=options.html||{};html_options["class"]="cloudinary_fileupload "+(html_options["class"]||"");if(options.multiple)html_options.multiple=true;this.attr(html_options).cloudinary_fileupload(options);return this};$.cloudinary.unsigned_upload_tag=function(upload_preset,upload_params,options){return $("<input/>").attr({type:"file",name:"file"}).unsigned_cloudinary_upload(upload_preset,upload_params,options)}})},{});require.register("src/frontend/vendors/jquery.fileupload",function(require,module,exports){(function(factory){"use strict";if(typeof define==="function"&&define.amd){define(["jquery","jquery.ui.widget"],factory)}else{factory(window.jQuery)}})(function($){"use strict";$.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))"+"|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)"+"|(w(eb)?OSBrowser)|(webOS)"+"|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||$('<input type="file">').prop("disabled"));$.support.xhrFileUpload=!!(window.ProgressEvent&&window.FileReader);$.support.xhrFormDataFileUpload=!!window.FormData;$.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);function getDragHandler(type){var isDragOver=type==="dragover";return function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var dataTransfer=e.dataTransfer;if(dataTransfer&&$.inArray("Files",dataTransfer.types)!==-1&&this._trigger(type,$.Event(type,{delegatedEvent:e}))!==false){e.preventDefault();if(isDragOver){dataTransfer.dropEffect="copy"}}}}$.widget("blueimp.fileupload",{options:{dropZone:$(document),pasteZone:undefined,fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,limitMultiFileUploadSize:undefined,limitMultiFileUploadSizeOverhead:512,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,progressInterval:100,bitrateInterval:500,autoUpload:true,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(message,context){message=this.messages[message]||message.toString();if(context){$.each(context,function(key,value){message=message.replace("{"+key+"}",value)})}return message},formData:function(form){return form.serializeArray()},add:function(e,data){if(e.isDefaultPrevented()){return false}if(data.autoUpload||data.autoUpload!==false&&$(this).fileupload("option","autoUpload")){data.process().done(function(){data.submit()})}},processData:false,contentType:false,cache:false},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:$.support.blobSlice&&function(){var slice=this.slice||this.webkitSlice||this.mozSlice;return slice.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime();this.loaded=0;this.bitrate=0;this.getBitrate=function(now,loaded,interval){var timeDiff=now-this.timestamp;if(!this.bitrate||!interval||timeDiff>interval){this.bitrate=(loaded-this.loaded)*(1e3/timeDiff)*8;this.loaded=loaded;this.timestamp=now}return this.bitrate}},_isXHRUpload:function(options){return!options.forceIframeTransport&&(!options.multipart&&$.support.xhrFileUpload||$.support.xhrFormDataFileUpload)},_getFormData:function(options){var formData;if($.type(options.formData)==="function"){return options.formData(options.form)}if($.isArray(options.formData)){return options.formData}if($.type(options.formData)==="object"){formData=[];$.each(options.formData,function(name,value){formData.push({name:name,value:value})});return formData}return[]},_getTotal:function(files){var total=0;$.each(files,function(index,file){total+=file.size||1});return total},_initProgressObject:function(obj){var progress={loaded:0,total:0,bitrate:0};if(obj._progress){$.extend(obj._progress,progress)}else{obj._progress=progress}},_initResponseObject:function(obj){var prop;if(obj._response){for(prop in obj._response){if(obj._response.hasOwnProperty(prop)){delete obj._response[prop]}}}else{obj._response={}}},_onProgress:function(e,data){if(e.lengthComputable){var now=Date.now?Date.now():(new Date).getTime(),loaded;if(data._time&&data.progressInterval&&now-data._time<data.progressInterval&&e.loaded!==e.total){return}data._time=now;loaded=Math.floor(e.loaded/e.total*(data.chunkSize||data._progress.total))+(data.uploadedBytes||0);this._progress.loaded+=loaded-data._progress.loaded;this._progress.bitrate=this._bitrateTimer.getBitrate(now,this._progress.loaded,data.bitrateInterval);data._progress.loaded=data.loaded=loaded;data._progress.bitrate=data.bitrate=data._bitrateTimer.getBitrate(now,loaded,data.bitrateInterval);this._trigger("progress",$.Event("progress",{delegatedEvent:e}),data);this._trigger("progressall",$.Event("progressall",{delegatedEvent:e}),this._progress)}},_initProgressListener:function(options){var that=this,xhr=options.xhr?options.xhr():$.ajaxSettings.xhr();if(xhr.upload){$(xhr.upload).bind("progress",function(e){
var oe=e.originalEvent;e.lengthComputable=oe.lengthComputable;e.loaded=oe.loaded;e.total=oe.total;that._onProgress(e,options)});options.xhr=function(){return xhr}}},_isInstanceOf:function(type,obj){return Object.prototype.toString.call(obj)==="[object "+type+"]"},_initXHRData:function(options){var that=this,formData,file=options.files[0],multipart=options.multipart||!$.support.xhrFileUpload,paramName=$.type(options.paramName)==="array"?options.paramName[0]:options.paramName;options.headers=$.extend({},options.headers);if(options.contentRange){options.headers["Content-Range"]=options.contentRange}if(!multipart||options.blob||!this._isInstanceOf("File",file)){options.headers["Content-Disposition"]='attachment; filename="'+encodeURI(file.name)+'"'}if(!multipart){options.contentType=file.type||"application/octet-stream";options.data=options.blob||file}else if($.support.xhrFormDataFileUpload){if(options.postMessage){formData=this._getFormData(options);if(options.blob){formData.push({name:paramName,value:options.blob})}else{$.each(options.files,function(index,file){formData.push({name:$.type(options.paramName)==="array"&&options.paramName[index]||paramName,value:file})})}}else{if(that._isInstanceOf("FormData",options.formData)){formData=options.formData}else{formData=new FormData;$.each(this._getFormData(options),function(index,field){formData.append(field.name,field.value)})}if(options.blob){formData.append(paramName,options.blob,file.name)}else{$.each(options.files,function(index,file){if(that._isInstanceOf("File",file)||that._isInstanceOf("Blob",file)){formData.append($.type(options.paramName)==="array"&&options.paramName[index]||paramName,file,file.uploadName||file.name)}})}}options.data=formData}options.blob=null},_initIframeSettings:function(options){var targetHost=$("<a></a>").prop("href",options.url).prop("host");options.dataType="iframe "+(options.dataType||"");options.formData=this._getFormData(options);if(options.redirect&&targetHost&&targetHost!==location.host){options.formData.push({name:options.redirectParamName||"redirect",value:options.redirect})}},_initDataSettings:function(options){if(this._isXHRUpload(options)){if(!this._chunkedUpload(options,true)){if(!options.data){this._initXHRData(options)}this._initProgressListener(options)}if(options.postMessage){options.dataType="postmessage "+(options.dataType||"")}}else{this._initIframeSettings(options)}},_getParamName:function(options){var fileInput=$(options.fileInput),paramName=options.paramName;if(!paramName){paramName=[];fileInput.each(function(){var input=$(this),name=input.prop("name")||"files[]",i=(input.prop("files")||[1]).length;while(i){paramName.push(name);i-=1}});if(!paramName.length){paramName=[fileInput.prop("name")||"files[]"]}}else if(!$.isArray(paramName)){paramName=[paramName]}return paramName},_initFormSettings:function(options){if(!options.form||!options.form.length){options.form=$(options.fileInput.prop("form"));if(!options.form.length){options.form=$(this.options.fileInput.prop("form"))}}options.paramName=this._getParamName(options);if(!options.url){options.url=options.form.prop("action")||location.href}options.type=(options.type||$.type(options.form.prop("method"))==="string"&&options.form.prop("method")||"").toUpperCase();if(options.type!=="POST"&&options.type!=="PUT"&&options.type!=="PATCH"){options.type="POST"}if(!options.formAcceptCharset){options.formAcceptCharset=options.form.attr("accept-charset")}},_getAJAXSettings:function(data){var options=$.extend({},this.options,data);this._initFormSettings(options);this._initDataSettings(options);return options},_getDeferredState:function(deferred){if(deferred.state){return deferred.state()}if(deferred.isResolved()){return"resolved"}if(deferred.isRejected()){return"rejected"}return"pending"},_enhancePromise:function(promise){promise.success=promise.done;promise.error=promise.fail;promise.complete=promise.always;return promise},_getXHRPromise:function(resolveOrReject,context,args){var dfd=$.Deferred(),promise=dfd.promise();context=context||this.options.context||promise;if(resolveOrReject===true){dfd.resolveWith(context,args)}else if(resolveOrReject===false){dfd.rejectWith(context,args)}promise.abort=dfd.promise;return this._enhancePromise(promise)},_addConvenienceMethods:function(e,data){var that=this,getPromise=function(args){return $.Deferred().resolveWith(that,args).promise()};data.process=function(resolveFunc,rejectFunc){if(resolveFunc||rejectFunc){data._processQueue=this._processQueue=(this._processQueue||getPromise([this])).pipe(function(){if(data.errorThrown){return $.Deferred().rejectWith(that,[data]).promise()}return getPromise(arguments)}).pipe(resolveFunc,rejectFunc)}return this._processQueue||getPromise([this])};data.submit=function(){if(this.state()!=="pending"){data.jqXHR=this.jqXHR=that._trigger("submit",$.Event("submit",{delegatedEvent:e}),this)!==false&&that._onSend(e,this)}return this.jqXHR||that._getXHRPromise()};data.abort=function(){if(this.jqXHR){return this.jqXHR.abort()}this.errorThrown="abort";that._trigger("fail",null,this);return that._getXHRPromise(false)};data.state=function(){if(this.jqXHR){return that._getDeferredState(this.jqXHR)}if(this._processQueue){return that._getDeferredState(this._processQueue)}};data.processing=function(){return!this.jqXHR&&this._processQueue&&that._getDeferredState(this._processQueue)==="pending"};data.progress=function(){return this._progress};data.response=function(){return this._response}},_getUploadedBytes:function(jqXHR){var range=jqXHR.getResponseHeader("Range"),parts=range&&range.split("-"),upperBytesPos=parts&&parts.length>1&&parseInt(parts[1],10);return upperBytesPos&&upperBytesPos+1},_chunkedUpload:function(options,testOnly){options.uploadedBytes=options.uploadedBytes||0;var that=this,file=options.files[0],fs=file.size,ub=options.uploadedBytes,mcs=options.maxChunkSize||fs,slice=this._blobSlice,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,upload;if(!(this._isXHRUpload(options)&&slice&&(ub||mcs<fs))||options.data){return false}if(testOnly){return true}if(ub>=fs){file.error=options.i18n("uploadedBytes");return this._getXHRPromise(false,options.context,[null,"error",file.error])}upload=function(){var o=$.extend({},options),currentLoaded=o._progress.loaded;o.blob=slice.call(file,ub,ub+mcs,file.type);o.chunkSize=o.blob.size;o.contentRange="bytes "+ub+"-"+(ub+o.chunkSize-1)+"/"+fs;that._initXHRData(o);that._initProgressListener(o);jqXHR=(that._trigger("chunksend",null,o)!==false&&$.ajax(o)||that._getXHRPromise(false,o.context)).done(function(result,textStatus,jqXHR){ub=that._getUploadedBytes(jqXHR)||ub+o.chunkSize;if(currentLoaded+o.chunkSize-o._progress.loaded){that._onProgress($.Event("progress",{lengthComputable:true,loaded:ub-o.uploadedBytes,total:ub-o.uploadedBytes}),o)}options.uploadedBytes=o.uploadedBytes=ub;o.result=result;o.textStatus=textStatus;o.jqXHR=jqXHR;that._trigger("chunkdone",null,o);that._trigger("chunkalways",null,o);if(ub<fs){upload()}else{dfd.resolveWith(o.context,[result,textStatus,jqXHR])}}).fail(function(jqXHR,textStatus,errorThrown){o.jqXHR=jqXHR;o.textStatus=textStatus;o.errorThrown=errorThrown;that._trigger("chunkfail",null,o);that._trigger("chunkalways",null,o);dfd.rejectWith(o.context,[jqXHR,textStatus,errorThrown])})};this._enhancePromise(promise);promise.abort=function(){return jqXHR.abort()};upload();return promise},_beforeSend:function(e,data){if(this._active===0){this._trigger("start");this._bitrateTimer=new this._BitrateTimer;this._progress.loaded=this._progress.total=0;this._progress.bitrate=0}this._initResponseObject(data);this._initProgressObject(data);data._progress.loaded=data.loaded=data.uploadedBytes||0;data._progress.total=data.total=this._getTotal(data.files)||1;data._progress.bitrate=data.bitrate=0;this._active+=1;this._progress.loaded+=data.loaded;this._progress.total+=data.total},_onDone:function(result,textStatus,jqXHR,options){var total=options._progress.total,response=options._response;if(options._progress.loaded<total){this._onProgress($.Event("progress",{lengthComputable:true,loaded:total,total:total}),options)}response.result=options.result=result;response.textStatus=options.textStatus=textStatus;response.jqXHR=options.jqXHR=jqXHR;this._trigger("done",null,options)},_onFail:function(jqXHR,textStatus,errorThrown,options){var response=options._response;if(options.recalculateProgress){this._progress.loaded-=options._progress.loaded;this._progress.total-=options._progress.total}response.jqXHR=options.jqXHR=jqXHR;response.textStatus=options.textStatus=textStatus;response.errorThrown=options.errorThrown=errorThrown;this._trigger("fail",null,options)},_onAlways:function(jqXHRorResult,textStatus,jqXHRorError,options){this._trigger("always",null,options)},_onSend:function(e,data){if(!data.submit){this._addConvenienceMethods(e,data)}var that=this,jqXHR,aborted,slot,pipe,options=that._getAJAXSettings(data),send=function(){that._sending+=1;options._bitrateTimer=new that._BitrateTimer;jqXHR=jqXHR||((aborted||that._trigger("send",$.Event("send",{delegatedEvent:e}),options)===false)&&that._getXHRPromise(false,options.context,aborted)||that._chunkedUpload(options)||$.ajax(options)).done(function(result,textStatus,jqXHR){that._onDone(result,textStatus,jqXHR,options)}).fail(function(jqXHR,textStatus,errorThrown){that._onFail(jqXHR,textStatus,errorThrown,options)}).always(function(jqXHRorResult,textStatus,jqXHRorError){that._onAlways(jqXHRorResult,textStatus,jqXHRorError,options);that._sending-=1;that._active-=1;if(options.limitConcurrentUploads&&options.limitConcurrentUploads>that._sending){var nextSlot=that._slots.shift();while(nextSlot){if(that._getDeferredState(nextSlot)==="pending"){nextSlot.resolve();break}nextSlot=that._slots.shift()}}if(that._active===0){that._trigger("stop")}});return jqXHR};this._beforeSend(e,options);if(this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending){if(this.options.limitConcurrentUploads>1){slot=$.Deferred();this._slots.push(slot);pipe=slot.pipe(send)}else{this._sequence=this._sequence.pipe(send,send);pipe=this._sequence}pipe.abort=function(){aborted=[undefined,"abort","abort"];if(!jqXHR){if(slot){slot.rejectWith(options.context,aborted)}return send()}return jqXHR.abort()};return this._enhancePromise(pipe)}return send()},_onAdd:function(e,data){var that=this,result=true,options=$.extend({},this.options,data),files=data.files,filesLength=files.length,limit=options.limitMultiFileUploads,limitSize=options.limitMultiFileUploadSize,overhead=options.limitMultiFileUploadSizeOverhead,batchSize=0,paramName=this._getParamName(options),paramNameSet,paramNameSlice,fileSet,i,j=0;if(limitSize&&(!filesLength||files[0].size===undefined)){limitSize=undefined}if(!(options.singleFileUploads||limit||limitSize)||!this._isXHRUpload(options)){fileSet=[files];paramNameSet=[paramName]}else if(!(options.singleFileUploads||limitSize)&&limit){fileSet=[];paramNameSet=[];for(i=0;i<filesLength;i+=limit){fileSet.push(files.slice(i,i+limit));paramNameSlice=paramName.slice(i,i+limit);if(!paramNameSlice.length){paramNameSlice=paramName}paramNameSet.push(paramNameSlice)}}else if(!options.singleFileUploads&&limitSize){fileSet=[];paramNameSet=[];for(i=0;i<filesLength;i=i+1){batchSize+=files[i].size+overhead;if(i+1===filesLength||batchSize+files[i+1].size+overhead>limitSize||limit&&i+1-j>=limit){fileSet.push(files.slice(j,i+1));paramNameSlice=paramName.slice(j,i+1);if(!paramNameSlice.length){paramNameSlice=paramName}paramNameSet.push(paramNameSlice);j=i+1;batchSize=0}}}else{paramNameSet=paramName}data.originalFiles=files;$.each(fileSet||files,function(index,element){var newData=$.extend({},data);newData.files=fileSet?element:[element];newData.paramName=paramNameSet[index];that._initResponseObject(newData);that._initProgressObject(newData);that._addConvenienceMethods(e,newData);result=that._trigger("add",$.Event("add",{delegatedEvent:e}),newData);return result});return result},_replaceFileInput:function(data){var input=data.fileInput,inputClone=input.clone(true);data.fileInputClone=inputClone;$("<form></form>").append(inputClone)[0].reset();input.after(inputClone).detach();$.cleanData(input.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(i,el){if(el===input[0]){return inputClone[0]}return el});if(input[0]===this.element[0]){this.element=inputClone}},_handleFileTreeEntry:function(entry,path){var that=this,dfd=$.Deferred(),errorHandler=function(e){if(e&&!e.entry){e.entry=entry}dfd.resolve([e])},successHandler=function(entries){that._handleFileTreeEntries(entries,path+entry.name+"/").done(function(files){dfd.resolve(files)}).fail(errorHandler)},readEntries=function(){dirReader.readEntries(function(results){if(!results.length){successHandler(entries)}else{entries=entries.concat(results);readEntries()}},errorHandler)},dirReader,entries=[];path=path||"";if(entry.isFile){if(entry._file){entry._file.relativePath=path;dfd.resolve(entry._file)}else{entry.file(function(file){file.relativePath=path;dfd.resolve(file)},errorHandler)}}else if(entry.isDirectory){dirReader=entry.createReader();readEntries()}else{dfd.resolve([])}return dfd.promise()},_handleFileTreeEntries:function(entries,path){var that=this;return $.when.apply($,$.map(entries,function(entry){return that._handleFileTreeEntry(entry,path)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(dataTransfer){dataTransfer=dataTransfer||{};var items=dataTransfer.items;if(items&&items.length&&(items[0].webkitGetAsEntry||items[0].getAsEntry)){return this._handleFileTreeEntries($.map(items,function(item){var entry;if(item.webkitGetAsEntry){entry=item.webkitGetAsEntry();if(entry){entry._file=item.getAsFile()}return entry}return item.getAsEntry()}))}return $.Deferred().resolve($.makeArray(dataTransfer.files)).promise()},_getSingleFileInputFiles:function(fileInput){fileInput=$(fileInput);var entries=fileInput.prop("webkitEntries")||fileInput.prop("entries"),files,value;if(entries&&entries.length){return this._handleFileTreeEntries(entries)}files=$.makeArray(fileInput.prop("files"));if(!files.length){value=fileInput.prop("value");if(!value){return $.Deferred().resolve([]).promise()}files=[{name:value.replace(/^.*\\/,"")}]}else if(files[0].name===undefined&&files[0].fileName){$.each(files,function(index,file){file.name=file.fileName;file.size=file.fileSize})}return $.Deferred().resolve(files).promise()},_getFileInputFiles:function(fileInput){if(!(fileInput instanceof $)||fileInput.length===1){return this._getSingleFileInputFiles(fileInput)}return $.when.apply($,$.map(fileInput,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(e){var that=this,data={fileInput:$(e.target),form:$(e.target.form)};this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;if(that.options.replaceFileInput){that._replaceFileInput(data)}if(that._trigger("change",$.Event("change",{delegatedEvent:e}),data)!==false){that._onAdd(e,data)}})},_onPaste:function(e){var items=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,data={files:[]};if(items&&items.length){$.each(items,function(index,item){var file=item.getAsFile&&item.getAsFile();if(file){data.files.push(file)}});if(this._trigger("paste",$.Event("paste",{delegatedEvent:e}),data)!==false){this._onAdd(e,data)}}},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var that=this,dataTransfer=e.dataTransfer,data={};if(dataTransfer&&dataTransfer.files&&dataTransfer.files.length){e.preventDefault();this._getDroppedFiles(dataTransfer).always(function(files){data.files=files;if(that._trigger("drop",$.Event("drop",{delegatedEvent:e}),data)!==false){that._onAdd(e,data)}})}},_onDragOver:getDragHandler("dragover"),_onDragEnter:getDragHandler("dragenter"),_onDragLeave:getDragHandler("dragleave"),_initEventHandlers:function(){if(this._isXHRUpload(this.options)){this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave});this._on(this.options.pasteZone,{paste:this._onPaste})}if($.support.fileInput){this._on(this.options.fileInput,{change:this._onChange})}},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_setOption:function(key,value){var reinit=$.inArray(key,this._specialOptions)!==-1;if(reinit){this._destroyEventHandlers()}this._super(key,value);if(reinit){this._initSpecialOptions();this._initEventHandlers()}},_initSpecialOptions:function(){var options=this.options;if(options.fileInput===undefined){options.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]')}else if(!(options.fileInput instanceof $)){options.fileInput=$(options.fileInput)}if(!(options.dropZone instanceof $)){options.dropZone=$(options.dropZone)}if(!(options.pasteZone instanceof $)){options.pasteZone=$(options.pasteZone)}},_getRegExp:function(str){var parts=str.split("/"),modifiers=parts.pop();parts.shift();return new RegExp(parts.join("/"),modifiers)},_isRegExpOption:function(key,value){return key!=="url"&&$.type(value)==="string"&&/^\/.*\/[igm]{0,3}$/.test(value)},_initDataAttributes:function(){var that=this,options=this.options,clone=$(this.element[0].cloneNode(false)),data=clone.data();clone.remove();$.each(data,function(key,value){var dataAttributeName="data-"+key.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();if(clone.attr(dataAttributeName)){if(that._isRegExpOption(key,value)){value=that._getRegExp(value)}options[key]=value}})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(data){var that=this;if(!data||this.options.disabled){return}if(data.fileInput&&!data.files){this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;that._onAdd(null,data)})}else{data.files=$.makeArray(data.files);this._onAdd(null,data)}},send:function(data){if(data&&!this.options.disabled){if(data.fileInput&&!data.files){var that=this,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,aborted;promise.abort=function(){aborted=true;if(jqXHR){return jqXHR.abort()}dfd.reject(null,"abort","abort");return promise};this._getFileInputFiles(data.fileInput).always(function(files){if(aborted){return}if(!files.length){dfd.reject();return}data.files=files;jqXHR=that._onSend(null,data);jqXHR.then(function(result,textStatus,jqXHR){dfd.resolve(result,textStatus,jqXHR)},function(jqXHR,textStatus,errorThrown){dfd.reject(jqXHR,textStatus,errorThrown)})});return this._enhancePromise(promise)}data.files=$.makeArray(data.files);if(data.files.length){return this._onSend(null,data)}}return this._getXHRPromise(false,data&&data.context)}})})},{});require.register("src/frontend/vendors/jquery.iframe-transport",function(require,module,exports){(function(factory){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{factory(window.jQuery)}})(function($){"use strict";var counter=0;$.ajaxTransport("iframe",function(options){if(options.async){var initialIframeSrc=options.initialIframeSrc||"javascript:false;",form,iframe,addParamChar;return{send:function(_,completeCallback){form=$('<form style="display:none;"></form>');form.attr("accept-charset",options.formAcceptCharset);addParamChar=/\?/.test(options.url)?"&":"?";if(options.type==="DELETE"){options.url=options.url+addParamChar+"_method=DELETE";options.type="POST"}else if(options.type==="PUT"){options.url=options.url+addParamChar+"_method=PUT";options.type="POST"}else if(options.type==="PATCH"){options.url=options.url+addParamChar+"_method=PATCH";options.type="POST"}counter+=1;iframe=$('<iframe src="'+initialIframeSrc+'" name="iframe-transport-'+counter+'"></iframe>').bind("load",function(){var fileInputClones,paramNames=$.isArray(options.paramName)?options.paramName:[options.paramName];iframe.unbind("load").bind("load",function(){var response;try{response=iframe.contents();if(!response.length||!response[0].firstChild){throw new Error}}catch(e){response=undefined}completeCallback(200,"success",{iframe:response});$('<iframe src="'+initialIframeSrc+'"></iframe>').appendTo(form);window.setTimeout(function(){form.remove()},0)});form.prop("target",iframe.prop("name")).prop("action",options.url).prop("method",options.type);if(options.formData){$.each(options.formData,function(index,field){$('<input type="hidden"/>').prop("name",field.name).val(field.value).appendTo(form)})}if(options.fileInput&&options.fileInput.length&&options.type==="POST"){fileInputClones=options.fileInput.clone();options.fileInput.after(function(index){return fileInputClones[index]});if(options.paramName){options.fileInput.each(function(index){$(this).prop("name",paramNames[index]||options.paramName)})}form.append(options.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data");options.fileInput.removeAttr("form")}form.submit();if(fileInputClones&&fileInputClones.length){options.fileInput.each(function(index,input){var clone=$(fileInputClones[index]);$(input).prop("name",clone.prop("name")).attr("form",clone.attr("form"));clone.replaceWith(input)})}});form.append(iframe).appendTo(document.body)},abort:function(){if(iframe){iframe.unbind("load").prop("src",initialIframeSrc)}if(form){form.remove()}}}}});$.ajaxSetup({converters:{"iframe text":function(iframe){return iframe&&$(iframe[0].body).text()},"iframe json":function(iframe){return iframe&&$.parseJSON($(iframe[0].body).text())},"iframe html":function(iframe){return iframe&&$(iframe[0].body).html()},"iframe xml":function(iframe){var xmlDoc=iframe&&iframe[0];return xmlDoc&&$.isXMLDoc(xmlDoc)?xmlDoc:$.parseXML(xmlDoc.XMLDocument&&xmlDoc.XMLDocument.xml||$(xmlDoc.body).html())},"iframe script":function(iframe){return iframe&&$.globalEval($(iframe[0].body).text())}}})})},{});require.register("src/frontend/vendors/jquery.put.delete",function(require,module,exports){module.exports=jQuery.each(["put","delete"],function(i,method){return jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=void 0}return jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}})},{});require.register("src/frontend/vendors/jquery.tagsinput",function(require,module,exports){(function($){var delimiter=new Array;var tags_callbacks=new Array;$.fn.doAutosize=function(o){var minWidth=$(this).data("minwidth"),maxWidth=$(this).data("maxwidth"),val="",input=$(this),testSubject=$("#"+$(this).data("tester_id"));if(val===(val=input.val())){return}var escaped=val.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");testSubject.html(escaped);var testerWidth=testSubject.width(),newWidth=testerWidth+o.comfortZone>=minWidth?testerWidth+o.comfortZone:minWidth,currentWidth=input.width(),isValidWidthChange=newWidth<currentWidth&&newWidth>=minWidth||newWidth>minWidth&&newWidth<maxWidth;if(isValidWidthChange){input.width(newWidth)}};$.fn.resetAutosize=function(options){var minWidth=$(this).data("minwidth")||options.minInputWidth||$(this).width(),maxWidth=$(this).data("maxwidth")||options.maxInputWidth||$(this).closest(".tagsinput").width()-options.inputPadding,val="",input=$(this),testSubject=$("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:input.css("fontSize"),fontFamily:input.css("fontFamily"),fontWeight:input.css("fontWeight"),letterSpacing:input.css("letterSpacing"),whiteSpace:"nowrap"}),testerId=$(this).attr("id")+"_autosize_tester";if(!$("#"+testerId).length>0){testSubject.attr("id",testerId);testSubject.appendTo("body")}input.data("minwidth",minWidth);input.data("maxwidth",maxWidth);input.data("tester_id",testerId);input.css("width",minWidth)};$.fn.destroy_tagsinput=function(){for(k in tags_callbacks){if(tags_callbacks[k]!=undefined){if(tags_callbacks[k].onAddTag!=undefined){tags_callbacks[k].onAddTag=null}if(tags_callbacks[k].onChange!=undefined){tags_callbacks[k].onChange=null}if(tags_callbacks[k].onRemoveTag!=undefined){tags_callbacks[k].onRemoveTag=null}}tags_callbacks[k]=null}};$.fn.addTag=function(value,options){options=jQuery.extend({focus:false,callback:true},options);this.each(function(){var id=$(this).attr("id");var tagslist=$(this).val().split(delimiter[id]);if(tagslist[0]==""){tagslist=new Array}value=jQuery.trim(value);if(options.unique){var skipTag=$(this).tagExist(value);if(skipTag==true){$("#"+id+"_tag").addClass("not_valid")}}else{var skipTag=false}if(value!=""&&skipTag!=true){$("<span>").addClass("tag").append($("<span>").text(value).append("&nbsp;&nbsp;"),$("<a>",{href:"#",title:"Removing tag",text:"x"}).click(function(){return $("#"+id).removeTag(escape(value))})).insertBefore("#"+id+"_addTag");tagslist.push(value);$("#"+id+"_tag").val("");if(options.focus){$("#"+id+"_tag").focus()}else{$("#"+id+"_tag").blur()}$.fn.tagsInput.updateTagsField(this,tagslist);if(options.callback&&tags_callbacks[id]&&tags_callbacks[id]["onAddTag"]){var f=tags_callbacks[id]["onAddTag"];f.call(this,value)}if(tags_callbacks[id]&&tags_callbacks[id]["onChange"]){var i=tagslist.length;var f=tags_callbacks[id]["onChange"];f.call(this,$(this),tagslist[i-1])}}});return false};$.fn.removeTag=function(value){value=unescape(value);this.each(function(){var id=$(this).attr("id");var old=$(this).val().split(delimiter[id]);$("#"+id+"_tagsinput .tag").remove();str="";for(i=0;i<old.length;i++){if(old[i]!=value){str=str+delimiter[id]+old[i]}}$.fn.tagsInput.importTags(this,str);if(tags_callbacks[id]&&tags_callbacks[id]["onRemoveTag"]){var f=tags_callbacks[id]["onRemoveTag"];f.call(this,value)}});return false};$.fn.tagExist=function(val){var id=$(this).attr("id");var tagslist=$(this).val().split(delimiter[id]);return jQuery.inArray(val,tagslist)>=0};$.fn.importTags=function(str){id=$(this).attr("id");$("#"+id+"_tagsinput .tag").remove();$.fn.tagsInput.importTags(this,str)};$.fn.tagsInput=function(options){var settings=jQuery.extend({interactive:true,defaultText:"add a tag",minChars:0,width:"300px",height:"100px",autocomplete:{selectFirst:false},hide:true,delimiter:",",unique:true,removeWithBackspace:true,placeholderColor:"#666666",autosize:true,comfortZone:20,inputPadding:6*2},options);this.each(function(){if(settings.hide){$(this).hide()}var id=$(this).attr("id");if(!id||delimiter[$(this).attr("id")]){id=$(this).attr("id","tags"+(new Date).getTime()).attr("id")}var data=jQuery.extend({pid:id,real_input:"#"+id,holder:"#"+id+"_tagsinput",input_wrapper:"#"+id+"_addTag",fake_input:"#"+id+"_tag"},settings);delimiter[id]=data.delimiter;if(settings.onAddTag||settings.onRemoveTag||settings.onChange){tags_callbacks[id]=new Array;tags_callbacks[id]["onAddTag"]=settings.onAddTag;tags_callbacks[id]["onRemoveTag"]=settings.onRemoveTag;tags_callbacks[id]["onChange"]=settings.onChange}var markup='<div id="'+id+'_tagsinput" class="tagsinput"><div id="'+id+'_addTag">';if(settings.interactive){markup=markup+'<input id="'+id+'_tag" value="" data-default="'+settings.defaultText+'" />'}markup=markup+'</div><div class="tags_clear"></div></div>';$(markup).insertAfter(this);$(data.holder).css("width",settings.width);$(data.holder).css("min-height",settings.height);$(data.holder).css("height",settings.height);if($(data.real_input).val()!=""){$.fn.tagsInput.importTags($(data.real_input),$(data.real_input).val())}if(settings.interactive){$(data.fake_input).val($(data.fake_input).attr("data-default"));$(data.fake_input).css("color",settings.placeholderColor);$(data.fake_input).resetAutosize(settings);$(data.holder).bind("click",data,function(event){$(event.data.fake_input).focus()});$(data.fake_input).bind("focus",data,function(event){if($(event.data.fake_input).val()==$(event.data.fake_input).attr("data-default")){$(event.data.fake_input).val("")}$(event.data.fake_input).css("color","#000000")});if(settings.autocomplete_url!=undefined){autocomplete_options={source:settings.autocomplete_url};for(attrname in settings.autocomplete){autocomplete_options[attrname]=settings.autocomplete[attrname]}if(jQuery.Autocompleter!==undefined){$(data.fake_input).autocomplete(settings.autocomplete_url,settings.autocomplete);$(data.fake_input).bind("result",data,function(event,data,formatted){if(data){$("#"+id).addTag(data[0]+"",{focus:true,unique:settings.unique})}})}else if(jQuery.ui.autocomplete!==undefined){$(data.fake_input).autocomplete(autocomplete_options);$(data.fake_input).bind("autocompleteselect",data,function(event,ui){$(event.data.real_input).addTag(ui.item.value,{focus:true,unique:settings.unique});return false})}}else{$(data.fake_input).bind("blur",data,function(event){var d=$(this).attr("data-default");if($(event.data.fake_input).val()!=""&&$(event.data.fake_input).val()!=d){if(event.data.minChars<=$(event.data.fake_input).val().length&&(!event.data.maxChars||event.data.maxChars>=$(event.data.fake_input).val().length))$(event.data.real_input).addTag($(event.data.fake_input).val(),{focus:true,unique:settings.unique})}else{$(event.data.fake_input).val($(event.data.fake_input).attr("data-default"));$(event.data.fake_input).css("color",settings.placeholderColor)}return false})}$(data.fake_input).bind("keypress",data,function(event){if(event.which==event.data.delimiter.charCodeAt(0)||event.which==13){event.preventDefault();if(event.data.minChars<=$(event.data.fake_input).val().length&&(!event.data.maxChars||event.data.maxChars>=$(event.data.fake_input).val().length))$(event.data.real_input).addTag($(event.data.fake_input).val(),{focus:true,unique:settings.unique});$(event.data.fake_input).resetAutosize(settings);return false}else if(event.data.autosize){$(event.data.fake_input).doAutosize(settings)}});data.removeWithBackspace&&$(data.fake_input).bind("keydown",function(event){if(event.keyCode==8&&$(this).val()==""){event.preventDefault();var last_tag=$(this).closest(".tagsinput").find(".tag:last").text();var id=$(this).attr("id").replace(/_tag$/,"");last_tag=last_tag.replace(/[\s]+x$/,"");$("#"+id).removeTag(escape(last_tag));$(this).trigger("focus")}});$(data.fake_input).blur();if(data.unique){$(data.fake_input).keydown(function(event){if(event.keyCode==8||String.fromCharCode(event.which).match(/\w+|[,\/]+/)){$(this).removeClass("not_valid")}})}}});return this};$.fn.tagsInput.updateTagsField=function(obj,tagslist){var id=$(obj).attr("id");$(obj).val(tagslist.join(delimiter[id]))};$.fn.tagsInput.importTags=function(obj,val){$(obj).val("");var id=$(obj).attr("id");var tags=val.split(delimiter[id]);for(i=0;i<tags.length;i++){$(obj).addTag(tags[i],{focus:false,callback:false})}if(tags_callbacks[id]&&tags_callbacks[id]["onChange"]){var f=tags_callbacks[id]["onChange"];f.call(obj,obj,tags[i])}}})(jQuery)},{});require.register("src/frontend/vendors/jquery.ui.widget",function(require,module,exports){(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{factory(jQuery)}})(function($){var widget_uuid=0,widget_slice=Array.prototype.slice;$.cleanData=function(orig){return function(elems){var events,elem,i;for(i=0;(elem=elems[i])!=null;i++){try{events=$._data(elem,"events");if(events&&events.remove){$(elem).triggerHandler("remove")}}catch(e){}}orig(elems)}}($.cleanData);$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget}$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){
if(!this._createWidget){return new constructor(options,element)}if(arguments.length){this._createWidget(options,element)}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base;basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return}proxiedPrototype[prop]=function(){var _super=function(){return base.prototype[prop].apply(this,arguments)},_superApply=function(args){return base.prototype[prop].apply(this,args)};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue}}()});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix||name:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)});delete existingConstructor._childConstructors}else{base._childConstructors.push(constructor)}$.widget.bridge(name,constructor);return constructor};$.widget.extend=function(target){var input=widget_slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value)}else{target[key]=value}}}}return target};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=widget_slice.call(arguments,1),returnValue=this;options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(options==="instance"){returnValue=instance;return false}if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'")}if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance")}methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false}})}else{this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{});if(instance._init){instance._init()}}else{$.data(this,fullName,new object(options,this))}})}return returnValue}};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=widget_uuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy()}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow)}this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options)}if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]]}key=parts.pop();if(arguments.length===1){return curOption[key]===undefined?null:curOption[key]}curOption[key]=value}else{if(arguments.length===1){return this.options[key]===undefined?null:this.options[key]}options[key]=value}}this._setOptions(options);return this},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key])}return this},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled",!!value);if(value){this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}}return this},enable:function(){return this._setOptions({disabled:false})},disable:function(){return this._setOptions({disabled:true})},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false}if(!handlers){handlers=element;element=this.element;delegateElement=this.widget()}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element)}$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass("ui-state-disabled"))){return}return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments)}if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++}var match=event.match(/^([\w:-]*)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy)}else{element.bind(eventName,handlerProxy)}})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;element.unbind(eventName).undelegate(eventName)},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover")},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus")},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop]}}}this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented())}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options}}var hasOptions,effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options}}hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay)}if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options)}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback)}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0])}next()})}}});var widget=$.widget})},{});require.register("src/frontend/vendors/jstorage",function(require,module,exports){(function(){"use strict";var JSTORAGE_VERSION="0.4.12",$=window.jQuery||window.$||(window.$={}),JSON={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(str){return String(str).evalJSON()}||$.parseJSON||$.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||$.toJSON};if(typeof JSON.parse!=="function"||typeof JSON.stringify!=="function"){throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page")}var _storage={__jstorage_meta:{CRC32:{}}},_storage_service={jStorage:"{}"},_storage_elm=null,_storage_size=0,_backend=false,_observers={},_observer_timeout=false,_observer_update=0,_pubsub_observers={},_pubsub_last=+new Date,_ttl_timeout,_XMLService={isXML:function(elm){var documentElement=(elm?elm.ownerDocument||elm:0).documentElement;return documentElement?documentElement.nodeName!=="HTML":false},encode:function(xmlNode){if(!this.isXML(xmlNode)){return false}try{return(new XMLSerializer).serializeToString(xmlNode)}catch(E1){try{return xmlNode.xml}catch(E2){}}return false},decode:function(xmlString){var dom_parser="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(_xmlString){var xml_doc=new ActiveXObject("Microsoft.XMLDOM");xml_doc.async="false";xml_doc.loadXML(_xmlString);return xml_doc},resultXML;if(!dom_parser){return false}resultXML=dom_parser.call("DOMParser"in window&&new DOMParser||window,xmlString,"text/xml");return this.isXML(resultXML)?resultXML:false}};function _init(){var localStorageReallyWorks=false;if("localStorage"in window){try{window.localStorage.setItem("_tmptest","tmpval");localStorageReallyWorks=true;window.localStorage.removeItem("_tmptest")}catch(BogusQuotaExceededErrorOnIos5){}}if(localStorageReallyWorks){try{if(window.localStorage){_storage_service=window.localStorage;_backend="localStorage";_observer_update=_storage_service.jStorage_update}}catch(E3){}}else if("globalStorage"in window){try{if(window.globalStorage){if(window.location.hostname=="localhost"){_storage_service=window.globalStorage["localhost.localdomain"]}else{_storage_service=window.globalStorage[window.location.hostname]}_backend="globalStorage";_observer_update=_storage_service.jStorage_update}}catch(E4){}}else{_storage_elm=document.createElement("link");if(_storage_elm.addBehavior){_storage_elm.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(_storage_elm);try{_storage_elm.load("jStorage")}catch(E){_storage_elm.setAttribute("jStorage","{}");_storage_elm.save("jStorage");_storage_elm.load("jStorage")}var data="{}";try{data=_storage_elm.getAttribute("jStorage")}catch(E5){}try{_observer_update=_storage_elm.getAttribute("jStorage_update")}catch(E6){}_storage_service.jStorage=data;_backend="userDataBehavior"}else{_storage_elm=null;return}}_load_storage();_handleTTL();_setupObserver();_handlePubSub();if("addEventListener"in window){window.addEventListener("pageshow",function(event){if(event.persisted){_storageObserver()}},false)}}function _reloadData(){var data="{}";if(_backend=="userDataBehavior"){_storage_elm.load("jStorage");try{data=_storage_elm.getAttribute("jStorage")}catch(E5){}try{_observer_update=_storage_elm.getAttribute("jStorage_update")}catch(E6){}_storage_service.jStorage=data}_load_storage();_handleTTL();_handlePubSub()}function _setupObserver(){if(_backend=="localStorage"||_backend=="globalStorage"){if("addEventListener"in window){window.addEventListener("storage",_storageObserver,false)}else{document.attachEvent("onstorage",_storageObserver)}}else if(_backend=="userDataBehavior"){setInterval(_storageObserver,1e3)}}function _storageObserver(){var updateTime;clearTimeout(_observer_timeout);_observer_timeout=setTimeout(function(){if(_backend=="localStorage"||_backend=="globalStorage"){updateTime=_storage_service.jStorage_update}else if(_backend=="userDataBehavior"){_storage_elm.load("jStorage");try{updateTime=_storage_elm.getAttribute("jStorage_update")}catch(E5){}}if(updateTime&&updateTime!=_observer_update){_observer_update=updateTime;_checkUpdatedKeys()}},25)}function _checkUpdatedKeys(){var oldCrc32List=JSON.parse(JSON.stringify(_storage.__jstorage_meta.CRC32)),newCrc32List;_reloadData();newCrc32List=JSON.parse(JSON.stringify(_storage.__jstorage_meta.CRC32));var key,updated=[],removed=[];for(key in oldCrc32List){if(oldCrc32List.hasOwnProperty(key)){if(!newCrc32List[key]){removed.push(key);continue}if(oldCrc32List[key]!=newCrc32List[key]&&String(oldCrc32List[key]).substr(0,2)=="2."){updated.push(key)}}}for(key in newCrc32List){if(newCrc32List.hasOwnProperty(key)){if(!oldCrc32List[key]){updated.push(key)}}}_fireObservers(updated,"updated");_fireObservers(removed,"deleted")}function _fireObservers(keys,action){keys=[].concat(keys||[]);var i,j,len,jlen;if(action=="flushed"){keys=[];for(var key in _observers){if(_observers.hasOwnProperty(key)){keys.push(key)}}action="deleted"}for(i=0,len=keys.length;i<len;i++){if(_observers[keys[i]]){for(j=0,jlen=_observers[keys[i]].length;j<jlen;j++){_observers[keys[i]][j](keys[i],action)}}if(_observers["*"]){for(j=0,jlen=_observers["*"].length;j<jlen;j++){_observers["*"][j](keys[i],action)}}}}function _publishChange(){var updateTime=(+new Date).toString();if(_backend=="localStorage"||_backend=="globalStorage"){try{_storage_service.jStorage_update=updateTime}catch(E8){_backend=false}}else if(_backend=="userDataBehavior"){_storage_elm.setAttribute("jStorage_update",updateTime);_storage_elm.save("jStorage")}_storageObserver()}function _load_storage(){if(_storage_service.jStorage){try{_storage=JSON.parse(String(_storage_service.jStorage))}catch(E6){_storage_service.jStorage="{}"}}else{_storage_service.jStorage="{}"}_storage_size=_storage_service.jStorage?String(_storage_service.jStorage).length:0;if(!_storage.__jstorage_meta){_storage.__jstorage_meta={}}if(!_storage.__jstorage_meta.CRC32){_storage.__jstorage_meta.CRC32={}}}function _save(){_dropOldEvents();try{_storage_service.jStorage=JSON.stringify(_storage);if(_storage_elm){_storage_elm.setAttribute("jStorage",_storage_service.jStorage);_storage_elm.save("jStorage")}_storage_size=_storage_service.jStorage?String(_storage_service.jStorage).length:0}catch(E7){}}function _checkKey(key){if(typeof key!="string"&&typeof key!="number"){throw new TypeError("Key name must be string or numeric")}if(key=="__jstorage_meta"){throw new TypeError("Reserved key name")}return true}function _handleTTL(){var curtime,i,TTL,CRC32,nextExpire=Infinity,changed=false,deleted=[];clearTimeout(_ttl_timeout);if(!_storage.__jstorage_meta||typeof _storage.__jstorage_meta.TTL!="object"){return}curtime=+new Date;TTL=_storage.__jstorage_meta.TTL;CRC32=_storage.__jstorage_meta.CRC32;for(i in TTL){if(TTL.hasOwnProperty(i)){if(TTL[i]<=curtime){delete TTL[i];delete CRC32[i];delete _storage[i];changed=true;deleted.push(i)}else if(TTL[i]<nextExpire){nextExpire=TTL[i]}}}if(nextExpire!=Infinity){_ttl_timeout=setTimeout(_handleTTL,Math.min(nextExpire-curtime,2147483647))}if(changed){_save();_publishChange();_fireObservers(deleted,"deleted")}}function _handlePubSub(){var i,len;if(!_storage.__jstorage_meta.PubSub){return}var pubelm,_pubsubCurrent=_pubsub_last,needFired=[];for(i=len=_storage.__jstorage_meta.PubSub.length-1;i>=0;i--){pubelm=_storage.__jstorage_meta.PubSub[i];if(pubelm[0]>_pubsub_last){_pubsubCurrent=pubelm[0];needFired.unshift(pubelm)}}for(i=needFired.length-1;i>=0;i--){_fireSubscribers(needFired[i][1],needFired[i][2])}_pubsub_last=_pubsubCurrent}function _fireSubscribers(channel,payload){if(_pubsub_observers[channel]){for(var i=0,len=_pubsub_observers[channel].length;i<len;i++){try{_pubsub_observers[channel][i](channel,JSON.parse(JSON.stringify(payload)))}catch(E){}}}}function _dropOldEvents(){if(!_storage.__jstorage_meta.PubSub){return}var retire=+new Date-2e3;for(var i=0,len=_storage.__jstorage_meta.PubSub.length;i<len;i++){if(_storage.__jstorage_meta.PubSub[i][0]<=retire){_storage.__jstorage_meta.PubSub.splice(i,_storage.__jstorage_meta.PubSub.length-i);break}}if(!_storage.__jstorage_meta.PubSub.length){delete _storage.__jstorage_meta.PubSub}}function _publish(channel,payload){if(!_storage.__jstorage_meta){_storage.__jstorage_meta={}}if(!_storage.__jstorage_meta.PubSub){_storage.__jstorage_meta.PubSub=[]}_storage.__jstorage_meta.PubSub.unshift([+new Date,channel,payload]);_save();_publishChange()}function murmurhash2_32_gc(str,seed){var l=str.length,h=seed^l,i=0,k;while(l>=4){k=str.charCodeAt(i)&255|(str.charCodeAt(++i)&255)<<8|(str.charCodeAt(++i)&255)<<16|(str.charCodeAt(++i)&255)<<24;k=(k&65535)*1540483477+(((k>>>16)*1540483477&65535)<<16);k^=k>>>24;k=(k&65535)*1540483477+(((k>>>16)*1540483477&65535)<<16);h=(h&65535)*1540483477+(((h>>>16)*1540483477&65535)<<16)^k;l-=4;++i}switch(l){case 3:h^=(str.charCodeAt(i+2)&255)<<16;case 2:h^=(str.charCodeAt(i+1)&255)<<8;case 1:h^=str.charCodeAt(i)&255;h=(h&65535)*1540483477+(((h>>>16)*1540483477&65535)<<16)}h^=h>>>13;h=(h&65535)*1540483477+(((h>>>16)*1540483477&65535)<<16);h^=h>>>15;return h>>>0}$.jStorage={version:JSTORAGE_VERSION,set:function(key,value,options){_checkKey(key);options=options||{};if(typeof value=="undefined"){this.deleteKey(key);return value}if(_XMLService.isXML(value)){value={_is_xml:true,xml:_XMLService.encode(value)}}else if(typeof value=="function"){return undefined}else if(value&&typeof value=="object"){value=JSON.parse(JSON.stringify(value))}_storage[key]=value;_storage.__jstorage_meta.CRC32[key]="2."+murmurhash2_32_gc(JSON.stringify(value),2538058380);this.setTTL(key,options.TTL||0);_fireObservers(key,"updated");return value},get:function(key,def){_checkKey(key);if(key in _storage){if(_storage[key]&&typeof _storage[key]=="object"&&_storage[key]._is_xml){return _XMLService.decode(_storage[key].xml)}else{return _storage[key]}}return typeof def=="undefined"?null:def},deleteKey:function(key){_checkKey(key);if(key in _storage){delete _storage[key];if(typeof _storage.__jstorage_meta.TTL=="object"&&key in _storage.__jstorage_meta.TTL){delete _storage.__jstorage_meta.TTL[key]}delete _storage.__jstorage_meta.CRC32[key];_save();_publishChange();_fireObservers(key,"deleted");return true}return false},setTTL:function(key,ttl){var curtime=+new Date;_checkKey(key);ttl=Number(ttl)||0;if(key in _storage){if(!_storage.__jstorage_meta.TTL){_storage.__jstorage_meta.TTL={}}if(ttl>0){_storage.__jstorage_meta.TTL[key]=curtime+ttl}else{delete _storage.__jstorage_meta.TTL[key]}_save();_handleTTL();_publishChange();return true}return false},getTTL:function(key){var curtime=+new Date,ttl;_checkKey(key);if(key in _storage&&_storage.__jstorage_meta.TTL&&_storage.__jstorage_meta.TTL[key]){ttl=_storage.__jstorage_meta.TTL[key]-curtime;return ttl||0}return 0},flush:function(){_storage={__jstorage_meta:{CRC32:{}}};_save();_publishChange();_fireObservers(null,"flushed");return true},storageObj:function(){function F(){}F.prototype=_storage;return new F},index:function(){var index=[],i;for(i in _storage){if(_storage.hasOwnProperty(i)&&i!="__jstorage_meta"){index.push(i)}}return index},storageSize:function(){return _storage_size},currentBackend:function(){return _backend},storageAvailable:function(){return!!_backend},listenKeyChange:function(key,callback){_checkKey(key);if(!_observers[key]){_observers[key]=[]}_observers[key].push(callback)},stopListening:function(key,callback){_checkKey(key);if(!_observers[key]){return}if(!callback){delete _observers[key];return}for(var i=_observers[key].length-1;i>=0;i--){if(_observers[key][i]==callback){_observers[key].splice(i,1)}}},subscribe:function(channel,callback){channel=(channel||"").toString();if(!channel){throw new TypeError("Channel not defined")}if(!_pubsub_observers[channel]){_pubsub_observers[channel]=[]}_pubsub_observers[channel].push(callback)},publish:function(channel,payload){channel=(channel||"").toString();if(!channel){throw new TypeError("Channel not defined")}_publish(channel,payload)},reInit:function(){_reloadData()},noConflict:function(saveInGlobal){delete window.$.jStorage;if(saveInGlobal){window.jStorage=this}return this}};_init()})()},{});require.register("src/frontend/vendors/modernizr.custom",function(require,module,exports){window.Modernizr=function(a,b,c){function A(a){j.cssText=a}function B(a,b){return A(n.join(a+";")+(b||""))}function C(a,b){return typeof a===b}function D(a,b){return!!~(""+a).indexOf(b)}function E(a,b){for(var d in a){var e=a[d];if(!D(e,"-")&&j[e]!==c)return b=="pfx"?e:!0}return!1}function F(a,b,d){for(var e in a){var f=b[a[e]];if(f!==c)return d===!1?a[e]:C(f,"function")?f.bind(d||b):f}return!1}function G(a,b,c){var d=a.charAt(0).toUpperCase()+a.slice(1),e=(a+" "+p.join(d+" ")+d).split(" ");return C(b,"string")||C(b,"undefined")?E(e,b):(e=(a+" "+q.join(d+" ")+d).split(" "),F(e,b,c))}function H(){e.input=function(c){for(var d=0,e=c.length;d<e;d++)t[c[d]]=c[d]in k;return t.list&&(t.list=!!b.createElement("datalist")&&!!a.HTMLDataListElement),t}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),e.inputtypes=function(a){for(var d=0,e,f,h,i=a.length;d<i;d++)k.setAttribute("type",f=a[d]),e=k.type!=="text",e&&(k.value=l,k.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(f)&&k.style.WebkitAppearance!==c?(g.appendChild(k),h=b.defaultView,e=h.getComputedStyle&&h.getComputedStyle(k,null).WebkitAppearance!=="textfield"&&k.offsetHeight!==0,g.removeChild(k)):/^(search|tel)$/.test(f)||(/^(url|email)$/.test(f)?e=k.checkValidity&&k.checkValidity()===!1:e=k.value!=l)),s[a[d]]=!!e;return s}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var d="2.8.3",e={},f=!0,g=b.documentElement,h="modernizr",i=b.createElement(h),j=i.style,k=b.createElement("input"),l=":)",m={}.toString,n=" -webkit- -moz- -o- -ms- ".split(" "),o="Webkit Moz O ms",p=o.split(" "),q=o.toLowerCase().split(" "),r={},s={},t={},u=[],v=u.slice,w,x=function(a,c,d,e){var f,i,j,k,l=b.createElement("div"),m=b.body,n=m||b.createElement("body");if(parseInt(d,10))while(d--)j=b.createElement("div"),j.id=e?e[d]:h+(d+1),l.appendChild(j);return f=["&#173;",'<style id="s',h,'">',a,"</style>"].join(""),l.id=h,(m?l:n).innerHTML+=f,n.appendChild(l),m||(n.style.background="",n.style.overflow="hidden",k=g.style.overflow,g.style.overflow="hidden",g.appendChild(n)),i=c(l,a),m?l.parentNode.removeChild(l):(n.parentNode.removeChild(n),g.style.overflow=k),!!i},y={}.hasOwnProperty,z;!C(y,"undefined")&&!C(y.call,"undefined")?z=function(a,b){return y.call(a,b)}:z=function(a,b){return b in a&&C(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function")throw new TypeError;var d=v.call(arguments,1),e=function(){if(this instanceof e){var a=function(){};a.prototype=c.prototype;var f=new a,g=c.apply(f,d.concat(v.call(arguments)));return Object(g)===g?g:f}return c.apply(b,d.concat(v.call(arguments)))};return e}),r.backgroundsize=function(){return G("backgroundSize")},r.csstransforms=function(){return!!G("transform")},r.csstransforms3d=function(){var a=!!G("perspective");return a&&"webkitPerspective"in g.style&&x("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(b,c){a=b.offsetLeft===9&&b.offsetHeight===3}),a},r.video=function(){var a=b.createElement("video"),c=!1;try{if(c=!!a.canPlayType)c=new Boolean(c),c.ogg=a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),c.h264=a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),c.webm=a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")}catch(d){}return c};for(var I in r)z(r,I)&&(w=I.toLowerCase(),e[w]=r[I](),u.push((e[w]?"":"no-")+w));return e.input||H(),e.addTest=function(a,b){if(typeof a=="object")for(var d in a)z(a,d)&&e.addTest(d,a[d]);else{a=a.toLowerCase();if(e[a]!==c)return e;b=typeof b=="function"?b():b,typeof f!="undefined"&&f&&(g.className+=" "+(b?"":"no-")+a),e[a]=b}return e},A(""),i=k=null,function(a,b){function l(a,b){var c=a.createElement("p"),d=a.getElementsByTagName("head")[0]||a.documentElement;return c.innerHTML="x<style>"+b+"</style>",d.insertBefore(c.lastChild,d.firstChild)}function m(){var a=s.elements;return typeof a=="string"?a.split(" "):a}function n(a){var b=j[a[h]];return b||(b={},i++,a[h]=i,j[i]=b),b}function o(a,c,d){c||(c=b);if(k)return c.createElement(a);d||(d=n(c));var g;return d.cache[a]?g=d.cache[a].cloneNode():f.test(a)?g=(d.cache[a]=d.createElem(a)).cloneNode():g=d.createElem(a),g.canHaveChildren&&!e.test(a)&&!g.tagUrn?d.frag.appendChild(g):g}function p(a,c){a||(a=b);if(k)return a.createDocumentFragment();c=c||n(a);var d=c.frag.cloneNode(),e=0,f=m(),g=f.length;for(;e<g;e++)d.createElement(f[e]);return d}function q(a,b){b.cache||(b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag()),a.createElement=function(c){return s.shivMethods?o(c,a,b):b.createElem(c)},a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+m().join().replace(/[\w\-]+/g,function(a){return b.createElem(a),b.frag.createElement(a),'c("'+a+'")'})+");return n}")(s,b.frag)}function r(a){a||(a=b);var c=n(a);return s.shivCSS&&!g&&!c.hasCSS&&(c.hasCSS=!!l(a,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),k||q(a,c),a}var c="3.7.0",d=a.html5||{},e=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,f=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,g,h="_html5shiv",i=0,j={},k;(function(){try{var a=b.createElement("a");a.innerHTML="<xyz></xyz>",g="hidden"in a,k=a.childNodes.length==1||function(){b.createElement("a");var a=b.createDocumentFragment();return typeof a.cloneNode=="undefined"||typeof a.createDocumentFragment=="undefined"||typeof a.createElement=="undefined"}()}catch(c){g=!0,k=!0}})();var s={elements:d.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:c,shivCSS:d.shivCSS!==!1,supportsUnknownElements:k,shivMethods:d.shivMethods!==!1,type:"default",shivDocument:r,createElement:o,createDocumentFragment:p};a.html5=s,r(b)}(this,b),e._version=d,e._prefixes=n,e._domPrefixes=q,e._cssomPrefixes=p,e.testProp=function(a){return E([a])},e.testAllProps=G,e.testStyles=x,g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(f?" js "+u.join(" "):""),e}(this,this.document)},{});require.register("src/frontend/vendors/notify.min",function(require,module,exports){(function(t,i,n,e){"use strict";var r,o,s,a,l,h,c,p,u,d,f,A,m,w,g,y,b,v,x,C,S,E,M,k,H,D,F,T=[].indexOf||function(t){for(var i=0,n=this.length;n>i;i++)if(i in this&&this[i]===t)return i;return-1};S="notify",C=S+"js",s=S+"!blank",M={t:"top",m:"middle",b:"bottom",l:"left",c:"center",r:"right"},m=["l","c","r"],F=["t","m","b"],b=["t","b","l","r"],v={t:"b",m:null,b:"t",l:"r",c:null,r:"l"},x=function(t){var i;return i=[],n.each(t.split(/\W+/),function(t,n){var r;return r=n.toLowerCase().charAt(0),M[r]?i.push(r):e}),i},D={},a={name:"core",html:'<div class="'+C+'-wrapper">\n  <div class="'+C+'-arrow"></div>\n  <div class="'+C+'-container"></div>\n</div>',css:"."+C+"-corner {\n  position: fixed;\n  margin: 5px;\n  z-index: 1050;\n}\n\n."+C+"-corner ."+C+"-wrapper,\n."+C+"-corner ."+C+"-container {\n  position: relative;\n  display: block;\n  height: inherit;\n  width: inherit;\n  margin: 3px;\n}\n\n."+C+"-wrapper {\n  z-index: 1;\n  position: absolute;\n  display: inline-block;\n  height: 0;\n  width: 0;\n}\n\n."+C+"-container {\n  display: none;\n  z-index: 1;\n  position: absolute;\n}\n\n."+C+"-hidable {\n  cursor: pointer;\n}\n\n[data-notify-text],[data-notify-html] {\n  position: relative;\n}\n\n."+C+"-arrow {\n  position: absolute;\n  z-index: 2;\n  width: 0;\n  height: 0;\n}"},H={"border-radius":["-webkit-","-moz-"]},f=function(t){return D[t]},o=function(i,e){var r,o,s,a;if(!i)throw"Missing Style name";if(!e)throw"Missing Style definition";if(!e.html)throw"Missing Style HTML";return(null!=(a=D[i])?a.cssElem:void 0)&&(t.console&&console.warn(""+S+": overwriting style '"+i+"'"),D[i].cssElem.remove()),e.name=i,D[i]=e,r="",e.classes&&n.each(e.classes,function(t,i){return r+="."+C+"-"+e.name+"-"+t+" {\n",n.each(i,function(t,i){return H[t]&&n.each(H[t],function(n,e){return r+="  "+e+t+": "+i+";\n"}),r+="  "+t+": "+i+";\n"}),r+="}\n"}),e.css&&(r+="/* styles for "+e.name+" */\n"+e.css),r&&(e.cssElem=y(r),e.cssElem.attr("id","notify-"+e.name)),s={},o=n(e.html),u("html",o,s),u("text",o,s),e.fields=s},y=function(t){var i;i=l("style"),i.attr("type","text/css"),n("head").append(i);try{i.html(t)}catch(e){i[0].styleSheet.cssText=t}return i},u=function(t,i,e){var r;return"html"!==t&&(t="text"),r="data-notify-"+t,p(i,"["+r+"]").each(function(){var i;return i=n(this).attr(r),i||(i=s),e[i]=t})},p=function(t,i){return t.is(i)?t:t.find(i)},E={clickToHide:!0,autoHide:!0,autoHideDelay:5e3,arrowShow:!0,arrowSize:5,breakNewLines:!0,elementPosition:"bottom",globalPosition:"top right",style:"bootstrap",className:"error",showAnimation:"slideDown",showDuration:400,hideAnimation:"slideUp",hideDuration:200,gap:5},g=function(t,i){var e;return e=function(){},e.prototype=t,n.extend(!0,new e,i)},h=function(t){return n.extend(E,t)},l=function(t){return n("<"+t+"></"+t+">")},A={},d=function(t){var i;return t.is("[type=radio]")&&(i=t.parents("form:first").find("[type=radio]").filter(function(i,e){return n(e).attr("name")===t.attr("name")}),t=i.first()),t},w=function(t,i,n){var r,o;if("string"==typeof n)n=parseInt(n,10);else if("number"!=typeof n)return;if(!isNaN(n))return r=M[v[i.charAt(0)]],o=i,t[r]!==e&&(i=M[r.charAt(0)],n=-n),t[i]===e?t[i]=n:t[i]+=n,null},k=function(t,i,n){if("l"===t||"t"===t)return 0;if("c"===t||"m"===t)return n/2-i/2;if("r"===t||"b"===t)return n-i;throw"Invalid alignment"},c=function(t){return c.e=c.e||l("div"),c.e.text(t).html()},r=function(){function t(t,i,e){"string"==typeof e&&(e={className:e}),this.options=g(E,n.isPlainObject(e)?e:{}),this.loadHTML(),this.wrapper=n(a.html),this.options.clickToHide&&this.wrapper.addClass(""+C+"-hidable"),this.wrapper.data(C,this),this.arrow=this.wrapper.find("."+C+"-arrow"),this.container=this.wrapper.find("."+C+"-container"),this.container.append(this.userContainer),t&&t.length&&(this.elementType=t.attr("type"),this.originalElement=t,this.elem=d(t),this.elem.data(C,this),this.elem.before(this.wrapper)),this.container.hide(),this.run(i)}return t.prototype.loadHTML=function(){var t;return t=this.getStyle(),this.userContainer=n(t.html),this.userFields=t.fields},t.prototype.show=function(t,i){var n,r,o,s,a,l=this;if(r=function(){return t||l.elem||l.destroy(),i?i():e},a=this.container.parent().parents(":hidden").length>0,o=this.container.add(this.arrow),n=[],a&&t)s="show";else if(a&&!t)s="hide";else if(!a&&t)s=this.options.showAnimation,n.push(this.options.showDuration);else{if(a||t)return r();
s=this.options.hideAnimation,n.push(this.options.hideDuration)}return n.push(r),o[s].apply(o,n)},t.prototype.setGlobalPosition=function(){var t,i,e,r,o,s,a,h;return h=this.getPosition(),a=h[0],s=h[1],o=M[a],t=M[s],r=a+"|"+s,i=A[r],i||(i=A[r]=l("div"),e={},e[o]=0,"middle"===t?e.top="45%":"center"===t?e.left="45%":e[t]=0,i.css(e).addClass(""+C+"-corner"),n("body").append(i)),i.prepend(this.wrapper)},t.prototype.setElementPosition=function(){var t,i,r,o,s,a,l,h,c,p,u,d,f,A,g,y,x,C,S,E,H,D,z,Q,B,R,N,P,U;for(z=this.getPosition(),E=z[0],C=z[1],S=z[2],u=this.elem.position(),h=this.elem.outerHeight(),d=this.elem.outerWidth(),c=this.elem.innerHeight(),p=this.elem.innerWidth(),Q=this.wrapper.position(),s=this.container.height(),a=this.container.width(),A=M[E],y=v[E],x=M[y],l={},l[x]="b"===E?h:"r"===E?d:0,w(l,"top",u.top-Q.top),w(l,"left",u.left-Q.left),U=["top","left"],B=0,N=U.length;N>B;B++)H=U[B],g=parseInt(this.elem.css("margin-"+H),10),g&&w(l,H,g);if(f=Math.max(0,this.options.gap-(this.options.arrowShow?r:0)),w(l,x,f),this.options.arrowShow){for(r=this.options.arrowSize,i=n.extend({},l),t=this.userContainer.css("border-color")||this.userContainer.css("background-color")||"white",R=0,P=b.length;P>R;R++)H=b[R],D=M[H],H!==y&&(o=D===A?t:"transparent",i["border-"+D]=""+r+"px solid "+o);w(l,M[y],r),T.call(b,C)>=0&&w(i,M[C],2*r)}else this.arrow.hide();return T.call(F,E)>=0?(w(l,"left",k(C,a,d)),i&&w(i,"left",k(C,r,p))):T.call(m,E)>=0&&(w(l,"top",k(C,s,h)),i&&w(i,"top",k(C,r,c))),this.container.is(":visible")&&(l.display="block"),this.container.removeAttr("style").css(l),i?this.arrow.removeAttr("style").css(i):e},t.prototype.getPosition=function(){var t,i,n,e,r,o,s,a;if(i=this.options.position||(this.elem?this.options.elementPosition:this.options.globalPosition),t=x(i),0===t.length&&(t[0]="b"),n=t[0],0>T.call(b,n))throw"Must be one of ["+b+"]";return(1===t.length||(e=t[0],T.call(F,e)>=0&&(r=t[1],0>T.call(m,r)))||(o=t[0],T.call(m,o)>=0&&(s=t[1],0>T.call(F,s))))&&(t[1]=(a=t[0],T.call(m,a)>=0?"m":"l")),2===t.length&&(t[2]=t[1]),t},t.prototype.getStyle=function(t){var i;if(t||(t=this.options.style),t||(t="default"),i=D[t],!i)throw"Missing style: "+t;return i},t.prototype.updateClasses=function(){var t,i;return t=["base"],n.isArray(this.options.className)?t=t.concat(this.options.className):this.options.className&&t.push(this.options.className),i=this.getStyle(),t=n.map(t,function(t){return""+C+"-"+i.name+"-"+t}).join(" "),this.userContainer.attr("class",t)},t.prototype.run=function(t,i){var r,o,a,l,h,u=this;if(n.isPlainObject(i)?n.extend(this.options,i):"string"===n.type(i)&&(this.options.className=i),this.container&&!t)return this.show(!1),e;if(this.container||t){o={},n.isPlainObject(t)?o=t:o[s]=t;for(a in o)r=o[a],l=this.userFields[a],l&&("text"===l&&(r=c(r),this.options.breakNewLines&&(r=r.replace(/\n/g,"<br/>"))),h=a===s?"":"="+a,p(this.userContainer,"[data-notify-"+l+h+"]").html(r));return this.updateClasses(),this.elem?this.setElementPosition():this.setGlobalPosition(),this.show(!0),this.options.autoHide?(clearTimeout(this.autohideTimer),this.autohideTimer=setTimeout(function(){return u.show(!1)},this.options.autoHideDelay)):e}},t.prototype.destroy=function(){return this.wrapper.remove()},t}(),n[S]=function(t,i,e){return t&&t.nodeName||t.jquery?n(t)[S](i,e):(e=i,i=t,new r(null,i,e)),t},n.fn[S]=function(t,i){return n(this).each(function(){var e;return e=d(n(this)).data(C),e?e.run(t,i):new r(n(this),t,i)}),this},n.extend(n[S],{defaults:h,addStyle:o,pluginOptions:E,getStyle:f,insertCSS:y}),n(function(){return y(a.css).attr("id","core-notify"),n(i).on("click","."+C+"-hidable",function(){return n(this).trigger("notify-hide")}),n(i).on("notify-hide","."+C+"-wrapper",function(){var t;return null!=(t=n(this).data(C))?t.show(!1):void 0})})})(window,document,jQuery),$.notify.addStyle("bootstrap",{html:"<div>\n<span data-notify-text></span>\n</div>",classes:{base:{"font-weight":"bold",padding:"8px 15px 8px 14px","text-shadow":"0 1px 0 rgba(255, 255, 255, 0.5)","background-color":"#fcf8e3",border:"1px solid #fbeed5","border-radius":"4px","white-space":"nowrap","padding-left":"25px","background-repeat":"no-repeat","background-position":"3px 7px"},error:{color:"#B94A48","background-color":"#F2DEDE","border-color":"#EED3D7","background-image":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAtRJREFUeNqkVc1u00AQHq+dOD+0poIQfkIjalW0SEGqRMuRnHos3DjwAH0ArlyQeANOOSMeAA5VjyBxKBQhgSpVUKKQNGloFdw4cWw2jtfMOna6JOUArDTazXi/b3dm55socPqQhFka++aHBsI8GsopRJERNFlY88FCEk9Yiwf8RhgRyaHFQpPHCDmZG5oX2ui2yilkcTT1AcDsbYC1NMAyOi7zTX2Agx7A9luAl88BauiiQ/cJaZQfIpAlngDcvZZMrl8vFPK5+XktrWlx3/ehZ5r9+t6e+WVnp1pxnNIjgBe4/6dAysQc8dsmHwPcW9C0h3fW1hans1ltwJhy0GxK7XZbUlMp5Ww2eyan6+ft/f2FAqXGK4CvQk5HueFz7D6GOZtIrK+srupdx1GRBBqNBtzc2AiMr7nPplRdKhb1q6q6zjFhrklEFOUutoQ50xcX86ZlqaZpQrfbBdu2R6/G19zX6XSgh6RX5ubyHCM8nqSID6ICrGiZjGYYxojEsiw4PDwMSL5VKsC8Yf4VRYFzMzMaxwjlJSlCyAQ9l0CW44PBADzXhe7xMdi9HtTrdYjFYkDQL0cn4Xdq2/EAE+InCnvADTf2eah4Sx9vExQjkqXT6aAERICMewd/UAp/IeYANM2joxt+q5VI+ieq2i0Wg3l6DNzHwTERPgo1ko7XBXj3vdlsT2F+UuhIhYkp7u7CarkcrFOCtR3H5JiwbAIeImjT/YQKKBtGjRFCU5IUgFRe7fF4cCNVIPMYo3VKqxwjyNAXNepuopyqnld602qVsfRpEkkz+GFL1wPj6ySXBpJtWVa5xlhpcyhBNwpZHmtX8AGgfIExo0ZpzkWVTBGiXCSEaHh62/PoR0p/vHaczxXGnj4bSo+G78lELU80h1uogBwWLf5YlsPmgDEd4M236xjm+8nm4IuE/9u+/PH2JXZfbwz4zw1WbO+SQPpXfwG/BBgAhCNZiSb/pOQAAAAASUVORK5CYII=)"},success:{color:"#468847","background-color":"#DFF0D8","border-color":"#D6E9C6","background-image":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAutJREFUeNq0lctPE0Ecx38zu/RFS1EryqtgJFA08YCiMZIAQQ4eRG8eDGdPJiYeTIwHTfwPiAcvXIwXLwoXPaDxkWgQ6islKlJLSQWLUraPLTv7Gme32zoF9KSTfLO7v53vZ3d/M7/fIth+IO6INt2jjoA7bjHCJoAlzCRw59YwHYjBnfMPqAKWQYKjGkfCJqAF0xwZjipQtA3MxeSG87VhOOYegVrUCy7UZM9S6TLIdAamySTclZdYhFhRHloGYg7mgZv1Zzztvgud7V1tbQ2twYA34LJmF4p5dXF1KTufnE+SxeJtuCZNsLDCQU0+RyKTF27Unw101l8e6hns3u0PBalORVVVkcaEKBJDgV3+cGM4tKKmI+ohlIGnygKX00rSBfszz/n2uXv81wd6+rt1orsZCHRdr1Imk2F2Kob3hutSxW8thsd8AXNaln9D7CTfA6O+0UgkMuwVvEFFUbbAcrkcTA8+AtOk8E6KiQiDmMFSDqZItAzEVQviRkdDdaFgPp8HSZKAEAL5Qh7Sq2lIJBJwv2scUqkUnKoZgNhcDKhKg5aH+1IkcouCAdFGAQsuWZYhOjwFHQ96oagWgRoUov1T9kRBEODAwxM2QtEUl+Wp+Ln9VRo6BcMw4ErHRYjH4/B26AlQoQQTRdHWwcd9AH57+UAXddvDD37DmrBBV34WfqiXPl61g+vr6xA9zsGeM9gOdsNXkgpEtTwVvwOklXLKm6+/p5ezwk4B+j6droBs2CsGa/gNs6RIxazl4Tc25mpTgw/apPR1LYlNRFAzgsOxkyXYLIM1V8NMwyAkJSctD1eGVKiq5wWjSPdjmeTkiKvVW4f2YPHWl3GAVq6ymcyCTgovM3FzyRiDe2TaKcEKsLpJvNHjZgPNqEtyi6mZIm4SRFyLMUsONSSdkPeFtY1n0mczoY3BHTLhwPRy9/lzcziCw9ACI+yql0VLzcGAZbYSM5CCSZg1/9oc/nn7+i8N9p/8An4JMADxhH+xHfuiKwAAAABJRU5ErkJggg==)"},info:{color:"#3A87AD","background-color":"#D9EDF7","border-color":"#BCE8F1","background-image":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QYFAhkSsdes/QAAA8dJREFUOMvVlGtMW2UYx//POaWHXg6lLaW0ypAtw1UCgbniNOLcVOLmAjHZolOYlxmTGXVZdAnRfXQm+7SoU4mXaOaiZsEpC9FkiQs6Z6bdCnNYruM6KNBw6YWewzl9z+sHImEWv+vz7XmT95f/+3/+7wP814v+efDOV3/SoX3lHAA+6ODeUFfMfjOWMADgdk+eEKz0pF7aQdMAcOKLLjrcVMVX3xdWN29/GhYP7SvnP0cWfS8caSkfHZsPE9Fgnt02JNutQ0QYHB2dDz9/pKX8QjjuO9xUxd/66HdxTeCHZ3rojQObGQBcuNjfplkD3b19Y/6MrimSaKgSMmpGU5WevmE/swa6Oy73tQHA0Rdr2Mmv/6A1n9w9suQ7097Z9lM4FlTgTDrzZTu4StXVfpiI48rVcUDM5cmEksrFnHxfpTtU/3BFQzCQF/2bYVoNbH7zmItbSoMj40JSzmMyX5qDvriA7QdrIIpA+3cdsMpu0nXI8cV0MtKXCPZev+gCEM1S2NHPvWfP/hL+7FSr3+0p5RBEyhEN5JCKYr8XnASMT0xBNyzQGQeI8fjsGD39RMPk7se2bd5ZtTyoFYXftF6y37gx7NeUtJJOTFlAHDZLDuILU3j3+H5oOrD3yWbIztugaAzgnBKJuBLpGfQrS8wO4FZgV+c1IxaLgWVU0tMLEETCos4xMzEIv9cJXQcyagIwigDGwJgOAtHAwAhisQUjy0ORGERiELgG4iakkzo4MYAxcM5hAMi1WWG1yYCJIcMUaBkVRLdGeSU2995TLWzcUAzONJ7J6FBVBYIggMzmFbvdBV44Corg8vjhzC+EJEl8U1kJtgYrhCzgc/vvTwXKSib1paRFVRVORDAJAsw5FuTaJEhWM2SHB3mOAlhkNxwuLzeJsGwqWzf5TFNdKgtY5qHp6ZFf67Y/sAVadCaVY5YACDDb3Oi4NIjLnWMw2QthCBIsVhsUTU9tvXsjeq9+X1d75/KEs4LNOfcdf/+HthMnvwxOD0wmHaXr7ZItn2wuH2SnBzbZAbPJwpPx+VQuzcm7dgRCB57a1uBzUDRL4bfnI0RE0eaXd9W89mpjqHZnUI5Hh2l2dkZZUhOqpi2qSmpOmZ64Tuu9qlz/SEXo6MEHa3wOip46F1n7633eekV8ds8Wxjn37Wl63VVa+ej5oeEZ/82ZBETJjpJ1Rbij2D3Z/1trXUvLsblCK0XfOx0SX2kMsn9dX+d+7Kf6h8o4AIykuffjT8L20LU+w4AZd5VvEPY+XpWqLV327HR7DzXuDnD8r+ovkBehJ8i+y8YAAAAASUVORK5CYII=)"},warn:{color:"#C09853","background-color":"#FCF8E3","border-color":"#FBEED5","background-image":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAABJlBMVEXr6eb/2oD/wi7/xjr/0mP/ykf/tQD/vBj/3o7/uQ//vyL/twebhgD/4pzX1K3z8e349vK6tHCilCWbiQymn0jGworr6dXQza3HxcKkn1vWvV/5uRfk4dXZ1bD18+/52YebiAmyr5S9mhCzrWq5t6ufjRH54aLs0oS+qD751XqPhAybhwXsujG3sm+Zk0PTwG6Shg+PhhObhwOPgQL4zV2nlyrf27uLfgCPhRHu7OmLgAafkyiWkD3l49ibiAfTs0C+lgCniwD4sgDJxqOilzDWowWFfAH08uebig6qpFHBvH/aw26FfQTQzsvy8OyEfz20r3jAvaKbhgG9q0nc2LbZxXanoUu/u5WSggCtp1anpJKdmFz/zlX/1nGJiYmuq5Dx7+sAAADoPUZSAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfdBgUBGhh4aah5AAAAlklEQVQY02NgoBIIE8EUcwn1FkIXM1Tj5dDUQhPU502Mi7XXQxGz5uVIjGOJUUUW81HnYEyMi2HVcUOICQZzMMYmxrEyMylJwgUt5BljWRLjmJm4pI1hYp5SQLGYxDgmLnZOVxuooClIDKgXKMbN5ggV1ACLJcaBxNgcoiGCBiZwdWxOETBDrTyEFey0jYJ4eHjMGWgEAIpRFRCUt08qAAAAAElFTkSuQmCC)"}}})},{});require.register("src/frontend/vendors/parallax.min",function(require,module,exports){!function(t,i,e,s){function o(i,e){var h=this;"object"==typeof e&&(delete e.refresh,delete e.render,t.extend(this,e)),this.$element=t(i),!this.imageSrc&&this.$element.is("img")&&(this.imageSrc=this.$element.attr("src"));var n=(this.position+"").toLowerCase().match(/\S+/g)||[];return n.length<1&&n.push("center"),1==n.length&&n.push(n[0]),"top"==n[0]||"bottom"==n[0]||"left"==n[1]||"right"==n[1]?(h.positionX=n[1],h.positionY=n[0]):(h.positionX=n[0],h.positionY=n[1]),this.positionX!=s&&(n[0]=this.positionX.toLowerCase()),this.positionY!=s&&(n[1]=this.positionY.toLowerCase()),"left"!=this.positionX&&"right"!=this.positionX&&(this.positionX=isNaN(parseInt(this.positionX))?"center":parseInt(this.positionX)),"top"!=this.positionY&&"bottom"!=this.positionY&&(this.positionY=isNaN(parseInt(this.positionY))?"center":parseInt(this.positionY)),this.position=this.positionX+(isNaN(this.positionX)?"":"px")+" "+this.positionY+(isNaN(this.positionY)?"":"px"),navigator.userAgent.match(/(iPod|iPhone|iPad)/)?(this.iosFix&&!this.$element.is("img")&&this.$element.css({backgroundImage:"url("+this.imageSrc+")",backgroundSize:"cover",backgroundPosition:this.position}),this):navigator.userAgent.match(/(Android)/)?(this.androidFix&&!this.$element.is("img")&&this.$element.css({backgroundImage:"url("+this.imageSrc+")",backgroundSize:"cover",backgroundPosition:this.position}),this):(this.$mirror=t("<div />").prependTo("body"),this.$slider=t("<img />").prependTo(this.$mirror),this.$mirror.addClass("parallax-mirror").css({visibility:"hidden",zIndex:this.zIndex,position:"fixed",top:0,left:0,overflow:"hidden"}),this.$slider.addClass("parallax-slider").one("load",function(){h.naturalHeight&&h.naturalWidth||(h.naturalHeight=this.naturalHeight||this.height||1,h.naturalWidth=this.naturalWidth||this.width||1),h.aspectRatio=h.naturalWidth/h.naturalHeight,o.isSetup||o.setup(),o.sliders.push(h),o.isFresh=!1,o.requestRender()}),this.$slider[0].src=this.imageSrc,void((this.naturalHeight&&this.naturalWidth||this.$slider[0].complete)&&this.$slider.trigger("load")))}function h(s){return this.each(function(){var h=t(this),n="object"==typeof s&&s;this==i||this==e||h.is("body")?o.configure(n):h.data("px.parallax")||(n=t.extend({},h.data(),n),h.data("px.parallax",new o(this,n))),"string"==typeof s&&o[s]()})}!function(){for(var t=0,e=["ms","moz","webkit","o"],s=0;s<e.length&&!i.requestAnimationFrame;++s)i.requestAnimationFrame=i[e[s]+"RequestAnimationFrame"],i.cancelAnimationFrame=i[e[s]+"CancelAnimationFrame"]||i[e[s]+"CancelRequestAnimationFrame"];i.requestAnimationFrame||(i.requestAnimationFrame=function(e){var s=(new Date).getTime(),o=Math.max(0,16-(s-t)),h=i.setTimeout(function(){e(s+o)},o);return t=s+o,h}),i.cancelAnimationFrame||(i.cancelAnimationFrame=function(t){clearTimeout(t)})}(),t.extend(o.prototype,{speed:.2,bleed:0,zIndex:-100,iosFix:!0,androidFix:!0,position:"center",refresh:function(){this.boxWidth=this.$element.outerWidth(),this.boxHeight=this.$element.outerHeight()+2*this.bleed,this.boxOffsetTop=this.$element.offset().top-this.bleed,this.boxOffsetLeft=this.$element.offset().left,this.boxOffsetBottom=this.boxOffsetTop+this.boxHeight;var t=o.winHeight,i=o.docHeight,e=Math.min(this.boxOffsetTop,i-t),s=Math.max(this.boxOffsetTop+this.boxHeight-t,0),h=this.boxHeight+(e-s)*(1-this.speed)|0,n=(this.boxOffsetTop-e)*(1-this.speed)|0;if(h*this.aspectRatio>=this.boxWidth){this.imageWidth=h*this.aspectRatio|0,this.imageHeight=h,this.offsetBaseTop=n;var r=this.imageWidth-this.boxWidth;this.offsetLeft="left"==this.positionX?0:"right"==this.positionX?-r:isNaN(this.positionX)?-r/2|0:Math.max(this.positionX,-r)}else{this.imageWidth=this.boxWidth,this.imageHeight=this.boxWidth/this.aspectRatio|0,this.offsetLeft=0;var r=this.imageHeight-h;this.offsetBaseTop="top"==this.positionY?n:"bottom"==this.positionY?n-r:isNaN(this.positionY)?n-r/2|0:n+Math.max(this.positionY,-r)}},render:function(){var t=o.scrollTop,i=o.scrollLeft,e=t+o.winHeight;this.visibility=this.boxOffsetBottom>t&&this.boxOffsetTop<e?"visible":"hidden",this.mirrorTop=this.boxOffsetTop-t,this.mirrorLeft=this.boxOffsetLeft-i,this.offsetTop=this.offsetBaseTop-this.mirrorTop*(1-this.speed),this.$mirror.css({transform:"translate3d(0px, 0px, 0px)",visibility:this.visibility,top:this.mirrorTop,left:this.mirrorLeft,height:this.boxHeight,width:this.boxWidth}),this.$slider.css({transform:"translate3d(0px, 0px, 0px)",position:"absolute",top:this.offsetTop,left:this.offsetLeft,height:this.imageHeight,width:this.imageWidth})}}),t.extend(o,{scrollTop:0,scrollLeft:0,winHeight:0,winWidth:0,docHeight:1<<30,docWidth:1<<30,sliders:[],isReady:!1,isFresh:!1,isBusy:!1,setup:function(){if(!this.isReady){var s=t(e),h=t(i);h.on("scroll.px.parallax load.px.parallax",function(){var t=o.docHeight-o.winHeight,i=o.docWidth-o.winWidth;o.scrollTop=Math.max(0,Math.min(t,h.scrollTop())),o.scrollLeft=Math.max(0,Math.min(i,h.scrollLeft())),o.requestRender()}).on("resize.px.parallax load.px.parallax",function(){o.winHeight=h.height(),o.winWidth=h.width(),o.docHeight=s.height(),o.docWidth=s.width(),o.isFresh=!1,o.requestRender()}),this.isReady=!0}},configure:function(i){"object"==typeof i&&(delete i.refresh,delete i.render,t.extend(this.prototype,i))},refresh:function(){t.each(this.sliders,function(){this.refresh()}),this.isFresh=!0},render:function(){this.isFresh||this.refresh(),t.each(this.sliders,function(){this.render()})},requestRender:function(){var t=this;this.isBusy||(this.isBusy=!0,i.requestAnimationFrame(function(){t.render(),t.isBusy=!1}))}});var n=t.fn.parallax;t.fn.parallax=h,t.fn.parallax.Constructor=o,t.fn.parallax.noConflict=function(){return t.fn.parallax=n,this},t(e).on("ready.px.parallax.data-api",function(){t('[data-parallax="scroll"]').parallax()})}(jQuery,window,document)},{});require.register("src/frontend/vendors/reconnecting-websocket",function(require,module,exports){(function(global,factory){if(typeof define==="function"&&define.amd){define([],factory)}else if(typeof module!=="undefined"&&module.exports){module.exports=factory()}else{global.ReconnectingWebSocket=factory()}})(this,function(){function ReconnectingWebSocket(url,protocols,options){var settings={debug:false,automaticOpen:true,reconnectInterval:1e3,maxReconnectInterval:3e4,reconnectDecay:1.5,timeoutInterval:2e3};if(!options){options={}}for(var key in settings){if(typeof options[key]!=="undefined"){this[key]=options[key]}else{this[key]=settings[key]}}this.url=url;this.reconnectAttempts=0;this.readyState=WebSocket.CONNECTING;this.protocol=null;var self=this;var ws;var forcedClose=false;var timedOut=false;var eventTarget=document.createElement("div");eventTarget.addEventListener("open",function(event){self.onopen(event)});eventTarget.addEventListener("close",function(event){self.onclose(event)});eventTarget.addEventListener("connecting",function(event){self.onconnecting(event)});eventTarget.addEventListener("message",function(event){self.onmessage(event)});eventTarget.addEventListener("error",function(event){self.onerror(event)});this.addEventListener=eventTarget.addEventListener.bind(eventTarget);this.removeEventListener=eventTarget.removeEventListener.bind(eventTarget);this.dispatchEvent=eventTarget.dispatchEvent.bind(eventTarget);function generateEvent(s,args){var evt=document.createEvent("CustomEvent");evt.initCustomEvent(s,false,false,args);return evt}this.open=function(reconnectAttempt){ws=new WebSocket(self.url,protocols||[]);if(!reconnectAttempt){eventTarget.dispatchEvent(generateEvent("connecting"))}if(self.debug||ReconnectingWebSocket.debugAll){console.debug("ReconnectingWebSocket","attempt-connect",self.url)}var localWs=ws;var timeout=setTimeout(function(){if(self.debug||ReconnectingWebSocket.debugAll){console.debug("ReconnectingWebSocket","connection-timeout",self.url)}timedOut=true;localWs.close();timedOut=false},self.timeoutInterval);ws.onopen=function(event){clearTimeout(timeout);if(self.debug||ReconnectingWebSocket.debugAll){console.debug("ReconnectingWebSocket","onopen",self.url)}self.protocol=ws.protocol;self.readyState=WebSocket.OPEN;self.reconnectAttempts=0;var e=generateEvent("open");e.isReconnect=reconnectAttempt;reconnectAttempt=false;eventTarget.dispatchEvent(e)};ws.onclose=function(event){clearTimeout(timeout);ws=null;if(forcedClose){self.readyState=WebSocket.CLOSED;eventTarget.dispatchEvent(generateEvent("close"))}else{self.readyState=WebSocket.CONNECTING;var e=generateEvent("connecting");e.code=event.code;e.reason=event.reason;e.wasClean=event.wasClean;eventTarget.dispatchEvent(e);if(!reconnectAttempt&&!timedOut){if(self.debug||ReconnectingWebSocket.debugAll){console.debug("ReconnectingWebSocket","onclose",self.url)}eventTarget.dispatchEvent(generateEvent("close"))}var timeout=self.reconnectInterval*Math.pow(self.reconnectDecay,self.reconnectAttempts);setTimeout(function(){self.reconnectAttempts++;self.open(true)},timeout>self.maxReconnectInterval?self.maxReconnectInterval:timeout)}};ws.onmessage=function(event){if(self.debug||ReconnectingWebSocket.debugAll){console.debug("ReconnectingWebSocket","onmessage",self.url,event.data)}var e=generateEvent("message");e.data=event.data;eventTarget.dispatchEvent(e)};ws.onerror=function(event){if(self.debug||ReconnectingWebSocket.debugAll){console.debug("ReconnectingWebSocket","onerror",self.url,event)}eventTarget.dispatchEvent(generateEvent("error"))}};if(this.automaticOpen==true){this.open(false)}this.send=function(data){if(ws){if(self.debug||ReconnectingWebSocket.debugAll){console.debug("ReconnectingWebSocket","send",self.url,data)}return ws.send(data)}else{throw"INVALID_STATE_ERR : Pausing to reconnect websocket"}};this.close=function(code,reason){if(typeof code=="undefined"){code=1e3}forcedClose=true;if(ws){ws.close(code,reason)}};this.refresh=function(){if(ws){ws.close()}}}ReconnectingWebSocket.prototype.onopen=function(event){};ReconnectingWebSocket.prototype.onclose=function(event){};ReconnectingWebSocket.prototype.onconnecting=function(event){};ReconnectingWebSocket.prototype.onmessage=function(event){};ReconnectingWebSocket.prototype.onerror=function(event){};ReconnectingWebSocket.debugAll=false;ReconnectingWebSocket.CONNECTING=WebSocket.CONNECTING;ReconnectingWebSocket.OPEN=WebSocket.OPEN;ReconnectingWebSocket.CLOSING=WebSocket.CLOSING;ReconnectingWebSocket.CLOSED=WebSocket.CLOSED;return ReconnectingWebSocket})},{});require.register("src/frontend/vendors/waveform",function(require,module,exports){(function(){var JSONP,Waveform,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};window.Waveform=Waveform=function(){Waveform.name="Waveform";function Waveform(options){this.redraw=__bind(this.redraw,this);this.container=options.container;this.canvas=options.canvas;this.data=options.data||[];this.outerColor=options.outerColor||"transparent";this.innerColor=options.innerColor||"#000000";this.interpolate=true;if(options.interpolate===false){this.interpolate=false}if(this.canvas==null){if(this.container){this.canvas=this.createCanvas(this.container,options.width||this.container.clientWidth,options.height||this.container.clientHeight)}else{throw"Either canvas or container option must be passed"}}this.patchCanvasForIE(this.canvas);this.context=this.canvas.getContext("2d");this.width=parseInt(this.context.canvas.width,10);this.height=parseInt(this.context.canvas.height,10);if(options.data){this.update(options)}}Waveform.prototype.setData=function(data){return this.data=data};Waveform.prototype.setDataInterpolated=function(data){return this.setData(this.interpolateArray(data,this.width))};Waveform.prototype.setDataCropped=function(data){return this.setData(this.expandArray(data,this.width))};Waveform.prototype.update=function(options){if(options.interpolate!=null){this.interpolate=options.interpolate}if(this.interpolate===false){this.setDataCropped(options.data)}else{this.setDataInterpolated(options.data)}return this.redraw()};Waveform.prototype.redraw=function(){var d,i,middle,t,_i,_len,_ref,_results;this.clear();if(typeof this.innerColor==="function"){this.context.fillStyle=this.innerColor()}else{this.context.fillStyle=this.innerColor}middle=this.height/2;i=0;_ref=this.data;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){d=_ref[_i];t=this.width/this.data.length;if(typeof this.innerColor==="function"){this.context.fillStyle=this.innerColor(i/this.width,d)}this.context.clearRect(t*i,middle-middle*d,t,middle*d*2);this.context.fillRect(t*i,middle-middle*d,t,middle*d*2);_results.push(i++)}return _results};Waveform.prototype.clear=function(){this.context.fillStyle=this.outerColor;this.context.clearRect(0,0,this.width,this.height);return this.context.fillRect(0,0,this.width,this.height)};Waveform.prototype.patchCanvasForIE=function(canvas){var oldGetContext;if(typeof window.G_vmlCanvasManager!=="undefined"){canvas=window.G_vmlCanvasManager.initElement(canvas);oldGetContext=canvas.getContext;return canvas.getContext=function(a){var ctx;ctx=oldGetContext.apply(canvas,arguments);canvas.getContext=oldGetContext;return ctx}}};Waveform.prototype.createCanvas=function(container,width,height){var canvas;canvas=document.createElement("canvas");container.appendChild(canvas);canvas.width=width;canvas.height=height;return canvas};Waveform.prototype.expandArray=function(data,limit,defaultValue){var i,newData,_i,_ref;if(defaultValue==null){defaultValue=0}newData=[];if(data.length>limit){newData=data.slice(data.length-limit,data.length)}else{for(i=_i=0,_ref=limit-1;0<=_ref?_i<=_ref:_i>=_ref;i=0<=_ref?++_i:--_i){newData[i]=data[i]||defaultValue}}return newData};Waveform.prototype.linearInterpolate=function(before,after,atPoint){return before+(after-before)*atPoint};Waveform.prototype.interpolateArray=function(data,fitCount){var after,atPoint,before,i,newData,springFactor,tmp;newData=new Array;springFactor=new Number((data.length-1)/(fitCount-1));newData[0]=data[0];i=1;while(i<fitCount-1){tmp=i*springFactor;before=new Number(Math.floor(tmp)).toFixed();after=new Number(Math.ceil(tmp)).toFixed();atPoint=tmp-before;newData[i]=this.linearInterpolate(data[before],data[after],atPoint);i++}newData[fitCount-1]=data[data.length-1];return newData};Waveform.prototype.optionsForSyncedStream=function(options){var innerColorWasSet,that;if(options==null){options={}}innerColorWasSet=false;that=this;return{whileplaying:this.redraw,whileloading:function(){var stream;if(!innerColorWasSet){stream=this;that.innerColor=function(x,y){if(x<stream.position/stream.durationEstimate){return options.playedColor||"rgba(255,  102, 0, 0.8)"}else if(x<stream.bytesLoaded/stream.bytesTotal){return options.loadedColor||"rgba(0, 0, 0, 0.8)"}else{return options.defaultColor||"rgba(0, 0, 0, 0.4)"}};innerColorWasSet=true}return this.redraw}}};Waveform.prototype.dataFromSoundCloudTrack=function(track){var _this=this;return JSONP.get("http://www.waveformjs.org/w",{url:track.waveform_url},function(data){return _this.update({data:data})})};return Waveform}();JSONP=function(){var config,counter,encode,head,jsonp,key,load,query,setDefaults,window;load=function(url){var done,head,script;script=document.createElement("script");done=false;script.src=url;script.async=true;script.onload=script.onreadystatechange=function(){if(!done&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){done=true;script.onload=script.onreadystatechange=null;if(script&&script.parentNode){return script.parentNode.removeChild(script)}}};if(!head){head=document.getElementsByTagName("head")[0]}return head.appendChild(script)};encode=function(str){return encodeURIComponent(str)};jsonp=function(url,params,callback,callbackName){var key,query,uniqueName;query=(url||"").indexOf("?")===-1?"?":"&";callbackName=callbackName||config["callbackName"]||"callback";uniqueName=callbackName+"_json"+ ++counter;params=params||{};for(key in params){if(params.hasOwnProperty(key)){query+=encode(key)+"="+encode(params[key])+"&"}}window[uniqueName]=function(data){callback(data);try{delete window[uniqueName]}catch(_error){}return window[uniqueName]=null};load(url+query+callbackName+"="+uniqueName);return uniqueName};setDefaults=function(obj){var config;return config=obj};counter=0;head=void 0;query=void 0;key=void 0;window=this;config={};return{get:jsonp,init:setDefaults}}()}).call(this)},{});require.register("src/lib/cloudinary/default_images",function(require,module,exports){module.exports={cover:"/images/default_room_cover.jpg",cover_mobile:"/images/default_room_cover_mobile.jpg",cover_thumb:"/images/default_room_thumb.jpg",cover_thumb_mobile:"/images/default_room_thumb_mobile.jpg",cover_thumb_player:"/images/default_room_thumb_70.png",cover_uploaded_mix:"/images/default_uploaded_mix_cover.png",avatar:"/images/profile-1.jpg"}},{});require.register("src/lib/cloudinary/transform",function(require,module,exports){var DEFAULT,Transform;DEFAULT=require("./default_images");Transform={all:function(url){return{top_bar:Transform.top_bar(url),avatar:Transform.avatar(url),chat_thumb:Transform.chat_thumb(url),chat_sidebar:Transform.chat_sidebar(url),chat_sidebar_popup:Transform.chat_sidebar_popup(url),explore_thumb:Transform.explore_thumb(url)}},all_cover:function(url){return{explore_thumb:Transform.explore_thumb(url),cover:Transform.cover(url)}},top_bar:function(url){if(!url||url==null||url.indexOf("upload/")<0){return"/images/profile-49.jpg"}else{return url.replace("upload/","upload/w_28,h_28,c_fill/")}},avatar:function(url){if(!url||url==null||url.indexOf("upload/")<0){return DEFAULT.avatar}else{return url.replace("upload/","upload/w_150,h_150,c_fill/")}},cover:function(url){if(!url||url==null||url.indexOf("upload/")<0){return DEFAULT.cover}else{return url.replace("upload/","upload/w_1140,h_350,c_fill/")}},og_image:function(url){if(!url||url==null||url.indexOf("upload/")<0){return""}else{return url.replace("upload/","upload/w_1200,h_630,c_fill/")}},cover_mobile:function(url){if(!url||url==null||url.indexOf("upload/")<0){return DEFAULT.cover_mobile}else{return url.replace("upload/","upload/w_400,h_184,c_fill/")}},cover_thumb:function(url,avatar){if(avatar==null){avatar=DEFAULT.avatar}if(!url||url==null||url.indexOf("upload/")<0){url=avatar}return url.replace("upload/","upload/w_200,h_167,c_fill,g_center/")},chat_thumb:function(url){if(!url||url==null||url.indexOf("upload/")<0){return"/images/profile-36.jpg"}else{return url.replace("upload/","upload/w_36,h_36,c_fill/")}},chat_sidebar:function(url){if(!url||url==null||url.indexOf("upload/")<0){return"/images/profile-36.jpg"}else{return url.replace("upload/","upload/w_55,h_55,c_fill/")}},chat_sidebar_popup:function(url){if(!url||url==null||url.indexOf("upload/")<0){return"/images/profile-36.jpg"}else{return url.replace("upload/","upload/w_84,h_84,c_fill/")}},explore_thumb:function(url){if(!url||url==null||url.indexOf("upload/")<0){return DEFAULT.cover_thumb}else{return url.replace("upload/","upload/w_210,h_210,c_fill/")}},explore_thumb_mobile:function(url){if(!url||url==null||url.indexOf("upload/")<0){return DEFAULT.cover_thumb_mobile}else{return url.replace("upload/","upload/w_370,h_186,c_fill/")}},player_thumb:function(url){if(!url||url==null||url.indexOf("upload/")<0){return DEFAULT.cover_thumb_player}else{return url.replace("upload/","upload/w_70,h_70,c_fill/")}},upload_mix_cover:function(url){if(!url||url==null||url.indexOf("upload/")<0){return DEFAULT.cover_uploaded_mix}else{return url.replace("upload/","upload/w_290,h_290,c_fill/")}}};module.exports=Transform},{"./default_images":"src/lib/cloudinary/default_images"});require.register("src/lib/tools/strings/autolink",function(require,module,exports){var replace_all;replace_all=require("./replace_all");require("../../../frontend/vendors/autolink-min.js");module.exports=function(str){if(typeof str==="string"&&str.length>0){str=replace_all("<br />","<br /> ",str);return str.autoLink({target:"_blank",rel:"nofollow"})}else{return""}}},{"./replace_all":"src/lib/tools/strings/replace_all","../../../frontend/vendors/autolink-min.js":"src/frontend/vendors/autolink-min"});require.register("src/lib/tools/strings/link_to_text",function(require,module,exports){var replace_all,strip_tags;strip_tags=require("./strip_tags");replace_all=require("./replace_all");module.exports=function(str){if(typeof str==="string"&&str.length>0){str=replace_all("<br /> ","\n",str);str=replace_all("<br> ","\n",str);str=replace_all("<br />","\n",str);str=replace_all("<br>","\n",str);return strip_tags(str)}else{return""}}},{"./strip_tags":"src/lib/tools/strings/strip_tags","./replace_all":"src/lib/tools/strings/replace_all"});require.register("src/lib/tools/strings/replace_all",function(require,module,exports){module.exports=function(find,replace,str){if(typeof str==="string"&&str.length>0){return str.replace(new RegExp(find,"g"),replace)}else{return str}}},{});require.register("src/lib/tools/strings/strip_tags",function(require,module,exports){module.exports=function(str){if(typeof str==="string"&&str.length>0){return str.replace(/(<([^>]+)>)/gi,"")}else{return""}}},{});require("src/frontend/scripts/app")})();